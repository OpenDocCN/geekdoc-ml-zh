# äººå·¥ç¥ç»ç½‘ç»œæµ‹è¯•

> åŸæ–‡ï¼š[`geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_ANN.html`](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_ANN.html)

è¿ˆå…‹å°”Â·JÂ·çš®å°”å¥‡ï¼Œæ•™æˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡

[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy) | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao) | [åœ°ç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446) | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python ä¸­åº”ç”¨åœ°ç»Ÿè®¡å­¦ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)

ç”µå­ä¹¦â€œPython ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ï¼šå¸¦ä»£ç çš„å®æˆ˜æŒ‡å—â€çš„ç« èŠ‚ã€‚

å¼•ç”¨æ­¤ç”µå­ä¹¦å¦‚ä¸‹ï¼š

çš®å°”å¥‡ï¼ŒM.J.ï¼Œ2024ï¼Œ*Python ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ï¼šå¸¦ä»£ç çš„å®æˆ˜æŒ‡å—* [ç”µå­ä¹¦]. Zenodo. doi:10.5281/zenodo.15169138 ![DOI](https://doi.org/10.5281/zenodo.15169138)

æœ¬ä¹¦ä¸­çš„å·¥ä½œæµç¨‹ä»¥åŠæ›´å¤šå†…å®¹åœ¨æ­¤å¤„å¯ç”¨ï¼š

å¼•ç”¨ MachineLearningDemos GitHub ä»“åº“å¦‚ä¸‹ï¼š

çš®å°”å¥‡ï¼ŒM.J.ï¼Œ2024ï¼Œ*MachineLearningDemos: Python æœºå™¨å­¦ä¹ æ¼”ç¤ºå·¥ä½œæµç¨‹å­˜å‚¨åº“*ï¼ˆ0.0.3ï¼‰[è½¯ä»¶]. Zenodo. DOI: 10.5281/zenodo.13835312\. GitHub ä»“åº“ï¼š[GeostatsGuy/MachineLearningDemos](https://github.com/GeostatsGuy/MachineLearningDemos) ![DOI](https://zenodo.org/doi/10.5281/zenodo.13835312)

ä½œè€…ï¼šè¿ˆå…‹å°”Â·JÂ·çš®å°”å¥‡

Â© ç‰ˆæƒ 2024ã€‚

è¿™ç« æ˜¯å…³äº/æ¼”ç¤º **äººå·¥ç¥ç»ç½‘ç»œ** çš„æ•™ç¨‹ã€‚

**YouTube è®²åº§**ï¼šæŸ¥çœ‹æˆ‘åœ¨ä»¥ä¸‹æ–¹é¢çš„è®²åº§ï¼š

+   [äººå·¥ç¥ç»ç½‘ç»œ](https://youtu.be/A9PiCMY_6nM?si=NxWSU_5RgQ4w55EL)

+   [å·ç§¯ç¥ç»ç½‘ç»œ](https://youtu.be/za2my_XDoOs?si=LeHU6p2_fc9dX4Yt)

è¿™äº›è®²åº§éƒ½æ˜¯æˆ‘ YouTube ä¸Šçš„ [æœºå™¨å­¦ä¹ è¯¾ç¨‹](https://youtube.com/playlist?list=PLG19vXLQHvSC2ZKFIkgVpI9fCjkN38kwf&si=XonjO2wHdXffMpeI) çš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸­åŒ…å«æœ‰è‰¯å¥½æ–‡æ¡£è®°å½•çš„ Python å·¥ä½œæµç¨‹å’Œäº¤äº’å¼ä»ªè¡¨æ¿ã€‚æˆ‘çš„ç›®æ ‡æ˜¯åˆ†äº«æ˜“äºç†è§£ã€å¯æ“ä½œå’Œå¯é‡å¤çš„æ•™è‚²å†…å®¹ã€‚å¦‚æœä½ æƒ³çŸ¥é“æˆ‘çš„åŠ¨æœºï¼Œè¯·æŸ¥çœ‹ [è¿ˆå…‹å°”çš„ç»å†](https://michaelpyrcz.com/my-story)ã€‚

## åŠ¨æœº

äººå·¥ç¥ç»ç½‘ç»œéå¸¸å¼ºå¤§ï¼Œæ˜¯åŸºäºå¤§è„‘ç±»æ¯”çš„è‡ªç„¶å¯å‘è®¡ç®—

+   æˆ‘è®¤ä¸ºå®ƒä»¬å°±åƒçˆ¬è¡ŒåŠ¨ç‰©çš„è„‘ï¼Œæ²¡æœ‰è®¡åˆ’å’Œé«˜çº§æ¨ç†

æ­¤å¤–ï¼Œäººå·¥ç¥ç»ç½‘ç»œæ˜¯è®¸å¤šå…¶ä»–æ·±åº¦å­¦ä¹ æ–¹æ³•çš„åŸºçŸ³ï¼Œä¾‹å¦‚ï¼Œ

+   å·ç§¯ç¥ç»ç½‘ç»œ

+   å¾ªç¯ç¥ç»ç½‘ç»œ

+   ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ

+   è‡ªåŠ¨ç¼–ç å™¨

è‡ªç„¶å¯å‘è®¡ç®—æ­£åœ¨å¯»æ‰¾è‡ªç„¶ç•Œçš„çµæ„Ÿæ¥å¼€å‘æ–°çš„é—®é¢˜è§£å†³æ–¹æ³•ï¼Œ

+   **äººå·¥ç¥ç»ç½‘ç»œ**æ˜¯å—ç”Ÿç‰©ç¥ç»ç½‘ç»œå¯å‘çš„

+   **èŠ‚ç‚¹** - åœ¨æˆ‘ä»¬çš„æ¨¡å‹ä¸­æ˜¯äººå·¥ç¥ç»å…ƒï¼Œç®€å•çš„å¤„ç†å™¨

+   **èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥**æ˜¯äººå·¥çªè§¦

æ™ºèƒ½æ˜¯ä»è®¸å¤šè¿æ¥çš„ç®€å•å¤„ç†å™¨ä¸­äº§ç”Ÿçš„ã€‚åœ¨æœ¬ç« çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘å°†ä½¿ç”¨èŠ‚ç‚¹å’Œè¿æ¥æœ¯è¯­æ¥æè¿°æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œã€‚

## ç¥ç»ç½‘ç»œæ¦‚å¿µ

è¿™é‡Œæœ‰ä¸€äº›äººå·¥ç¥ç»ç½‘ç»œçš„å…³é”®æ–¹é¢ï¼Œ

**åŸºæœ¬è®¾è®¡** - *â€œâ€¦ä¸€ä¸ªç”±è®¸å¤šç®€å•ã€é«˜åº¦äº’è”çš„å¤„ç†å…ƒç´ ç»„æˆçš„è®¡ç®—ç³»ç»Ÿï¼Œå®ƒä»¬é€šè¿‡å¯¹å¤–éƒ¨è¾“å…¥çš„åŠ¨æ€çŠ¶æ€å“åº”æ¥å¤„ç†ä¿¡æ¯ã€‚â€* Caudill (1989)ã€‚

**ä»ç„¶æ˜¯ä¸€ä¸ªé¢„æµ‹æ¨¡å‹** - è™½ç„¶è¿™äº›æ¨¡å‹å¯èƒ½éå¸¸å¤æ‚ï¼Œç”šè‡³æœ‰æ•°ç™¾ä¸‡ä¸ªå¯è®­ç»ƒæ¨¡å‹å‚æ•°ã€æƒé‡å’Œåå·®ï¼Œä½†å®ƒä»¬ä»ç„¶æ˜¯ä¸€ä¸ªå°†é¢„æµ‹ç‰¹å¾æ˜ å°„åˆ°å“åº”ç‰¹å¾çš„å‡½æ•°ï¼Œ

$$ Y=f(X)+\epsilon $$

**ç›‘ç£å­¦ä¹ ** â€“ æˆ‘ä»¬æä¾›å¸¦æœ‰é¢„æµ‹ç‰¹å¾ï¼Œ$X_1,\ldots,ğ‘‹_ğ‘š$ å’Œå“åº”ç‰¹å¾ï¼ˆ$ğ‘Œ_1,\ldots,ğ‘Œ_K$ï¼‰çš„è®­ç»ƒæ•°æ®ï¼ŒæœŸæœ›æ¨¡å‹é¢„æµ‹è¯¯å·®ï¼Œ$\epsilon$ã€‚

**éçº¿æ€§** - é€šè¿‡åº”ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°æ¥æ¨¡å‹éçº¿æ€§å…³ç³»ï¼Œå°†éçº¿æ€§å¼•å…¥åˆ°ç³»ç»Ÿä¸­

**é€šç”¨å‡½æ•°é€¼è¿‘å™¨ï¼ˆé€šç”¨é€¼è¿‘å®šç†ï¼‰** - ANNs èƒ½å¤Ÿå­¦ä¹ åŒºé—´å†… $f$ çš„ä»»ä½•å¯èƒ½å‡½æ•°å½¢çŠ¶ï¼Œå¯¹äºä»»æ„å®½ï¼ˆå•éšè—å±‚ï¼‰ç”± Cybenko (1989) æå‡ºï¼Œå¯¹äºä»»æ„æ·±åº¦ç”± Lu å’Œå…¶ä»–äºº (2017) æå‡º

## ä¸€ä¸ªç®€å•çš„ç½‘ç»œ

è¦å¼€å§‹ï¼Œè®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œå•éšè—å±‚ï¼Œå…¨è¿æ¥ï¼Œå‰é¦ˆç¥ç»ç½‘ç»œï¼Œ

![](img/832ee38f2f09d395115eb31b95358103.png)

ç®€å•æ¼”ç¤ºäººå·¥ç¥ç»ç½‘ç»œã€‚

æˆ‘ä»¬åœ¨ä¸‹é¢çš„æè¿°ä¸­ä½¿ç”¨è¿™ä¸ªç¤ºä¾‹äººå·¥ç¥ç»ç½‘ç»œï¼Œå¹¶å°†å…¶ä½œä¸ºæˆ‘ä»¬å°†æ‰‹åŠ¨è®­ç»ƒå’Œé¢„æµ‹çš„å®é™…ç¤ºä¾‹ï¼

ç°åœ¨è®©æˆ‘ä»¬æ ‡è®°æˆ‘ä»¬ç½‘ç»œçš„éƒ¨åˆ†ï¼Œ

![](img/0be0dcf09e698cf22dc0881c818c0dbc.png)

å¸¦æœ‰æ ‡è®°çš„ç®€å•æ¼”ç¤ºäººå·¥ç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬ 3 ä¸ªè¾“å…¥èŠ‚ç‚¹ã€2 ä¸ªéšè—èŠ‚ç‚¹å’Œ 1 ä¸ªè¾“å‡ºèŠ‚ç‚¹å®Œå…¨è¿æ¥ã€‚

æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œå…·æœ‰ï¼Œ

+   3 ä¸ªé¢„æµ‹ç‰¹å¾ï¼Œ$X_1$ã€$X_2$ å’Œ $X_3$

+   3 ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œ$I_1$ã€$I_2$ å’Œ $I_3$

+   2 ä¸ªéšè—å±‚èŠ‚ç‚¹ï¼Œ$H_4$ å’Œ $H_5$

+   1 ä¸ªè¾“å‡ºèŠ‚ç‚¹ï¼Œ$O_6$

+   1 ä¸ªå“åº”ç‰¹å¾ï¼Œ$Y_1$

å…¶ä¸­æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯å®Œå…¨è¿æ¥çš„ã€‚æ³¨æ„ï¼Œæ·±åº¦å­¦ä¹ æ˜¯ä¸€ä¸ªå…·æœ‰è¶…è¿‡ 1 ä¸ªéšè—å±‚çš„ç¥ç»ç½‘ç»œï¼Œä½†ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨æˆ‘ä»¬çš„éæ·±åº¦å­¦ä¹ äººå·¥ç¥ç»ç½‘ç»œã€‚

## ç½‘ç»œå‘½åæ³•çš„è¯„è®º

å…³äºæˆ‘çš„ç½‘ç»œå‘½åæ³•çš„å‡ ç‚¹è¯„è®ºã€‚æˆ‘çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–ç®€æ´æ€§å’Œæ¸…æ™°åº¦ï¼Œ

+   **ç½‘ç»œèŠ‚ç‚¹å’Œè¿æ¥** - æˆ‘é€‰æ‹©ä¸ºæ‰€æœ‰èŠ‚ç‚¹ä½¿ç”¨å”¯ä¸€çš„æ•°å­—ï¼Œ$I_1$, $I_2$, $I_3$, $H_4$, $H_5$ å’Œ $O_6$ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªå±‚é‡å¤ä½¿ç”¨æ•°å­—ï¼Œä¾‹å¦‚ $I_1$, $I_2$, $I_3$, $H_1$, $H_2$ å’Œ $O_1$ï¼Œä»¥ç®€åŒ–æƒé‡çš„è¡¨ç¤ºï¼›å› æ­¤ï¼Œå½“æˆ‘è¯´ $\lambda_{1,4}$ æ—¶ï¼Œä½ çŸ¥é“è¿™ä¸ªæƒé‡åœ¨ç½‘ç»œçš„å“ªä¸ªä½ç½®åº”ç”¨ï¼Œä»èŠ‚ç‚¹ $I_1$ åˆ°èŠ‚ç‚¹ $H_4$ã€‚

+   **èŠ‚ç‚¹è¾“å‡º** - æˆ‘ä½¿ç”¨èŠ‚ç‚¹æ ‡ç­¾æ¥æè¿°èŠ‚ç‚¹çš„è¾“å‡ºï¼Œä¾‹å¦‚ $O_6$ æ˜¯è¾“å‡ºèŠ‚ç‚¹ï¼Œ$O_6$ï¼Œä»¥åŠä»èŠ‚ç‚¹ $O_6$ è¾“å‡ºçš„ä¿¡å·æˆ–å€¼ï¼Œ

$$ O_6 = \sigma \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 \right) $$

+   **é¢„æ¿€æ´»å’Œåæ¿€æ´»** - åœ¨æˆ‘ä»¬çš„èŠ‚ç‚¹ $H_4$, $H_5$ å’Œ $O_6$ ä¸­ï¼Œæˆ‘ä»¬æœ‰èŠ‚ç‚¹æ¿€æ´»å‰çš„è¾“å…¥å’Œæ¿€æ´»åçš„è¾“å‡ºï¼Œæˆ‘ä½¿ç”¨ $H_{4_{in}}$, $H_{5_{in}}$ å’Œ $O_{6_{in}}$ æ¥è¡¨ç¤ºé¢„æ¿€æ´»è¾“å…¥ï¼Œ

$$ H_{4_{in}} = \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 $$$$ H_{5_{in}} = \lambda_{1,5} \cdot I_1 + \lambda_{2,5} \cdot I_2 + \lambda_{2,5} \cdot I_3 $$$$ O_{6_{in}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 $$

$\quad$ ä»¥åŠ $H_4$, $H_5$ å’Œ $O_6$ ä½œä¸ºåæ¿€æ´»èŠ‚ç‚¹çš„è¾“å‡ºã€‚

$$ H_{4} = \sigma \left( H_{4_{in}} \right) = \sigma \left( \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 \right) $$$$ H_{5} = \sigma \left( H_{5_{in}} \right) = \sigma \left( \lambda_{1,5} \cdot I_1 + \lambda_{2,5} \cdot I_2 + \lambda_{2,5} \cdot I_3 \right) $$$$ O_6 = \sigma \left( O_{6_{in}} \right) = \sigma \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 \right) $$

æ¸…æ™°ã€æ˜ç¡®çš„ç¬¦å·å¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨ä½¿ç”¨åå‘ä¼ æ’­æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»é€æ­¥é€šè¿‡èŠ‚ç‚¹ï¼Œä»åæ¿€æ´»åˆ°é¢„æ¿€æ´»ã€‚

+   åœ¨ç¥ç»ç½‘ç»œæ–‡çŒ®ä¸­ï¼Œé€šå¸¸ä½¿ç”¨åƒ $z$ è¿™æ ·çš„å˜é‡è¿›è¡Œé¢„æ¿€æ´»ï¼Œä½†æˆ‘è®¤ä¸ºè¿™å¾ˆæ¨¡ç³Šï¼Œå¯èƒ½ä¼šå¼•èµ·æ··æ·†ï¼Œå› ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªèºä¸é’‰å’Œèºæ¯çš„æ–¹æ³•ï¼Œæ˜ç¡®æè¿°æ¯ä¸ªæ–¹ç¨‹ï¼Œä»¥ç²¾ç¡®æè¿°ç¥ç»ç½‘ç»œæ˜¯å¦‚ä½•è®­ç»ƒå’Œé¢„æµ‹çš„

## ç½‘ç»œæ–¹æ³•æè¿°

è®©æˆ‘ä»¬è°ˆè°ˆç½‘ç»œï¼Œå…¶ç»„æˆéƒ¨åˆ†ä»¥åŠä¿¡æ¯æ˜¯å¦‚ä½•åœ¨ç½‘ç»œä¸­æµåŠ¨çš„ã€‚

**å‰é¦ˆ** â€“ æ‰€æœ‰ä¿¡æ¯ä»å·¦åˆ°å³æµåŠ¨ã€‚æ¯ä¸ªèŠ‚ç‚¹æ²¿ç€è¿æ¥å°†ç›¸åŒçš„ä¿¡å·å‘é€åˆ°ä¸‹ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œ

![](img/02be26cd4d5476666cd2e1a72c3005fe.png)

å‰é¦ˆï¼Œå…¨è¿æ¥ï¼Œæ¯ä¸ªèŠ‚ç‚¹å°†ç›¸åŒçš„ä¿¡å·å‘é€åˆ°ä¸‹ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚

**è¾“å…¥å±‚** - è¾“å…¥ç‰¹å¾ç›´æ¥ä¼ é€’åˆ°è¾“å…¥èŠ‚ç‚¹ï¼Œå¯¹äºè¿ç»­é¢„æµ‹ç‰¹å¾ï¼Œæ¯ä¸ªç‰¹å¾æœ‰ä¸€ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œå¹¶ä¸”ç‰¹å¾æ˜¯ï¼Œ

+   å°†æœ€å°/æœ€å¤§å½’ä¸€åŒ–åˆ°èŒƒå›´ $\left[ âˆ’1,1 \right]$ æˆ– $\left[ 0,1 \right]$ ä»¥æé«˜æ¿€æ´»å‡½æ•°çš„æ•æ„Ÿæ€§ï¼Œå¹¶æ¶ˆé™¤é¢„æµ‹ç‰¹å¾ä¸­å°ºåº¦å·®å¼‚çš„å½±å“ï¼Œä»¥æé«˜è§£å†³æ–¹æ¡ˆçš„ç¨³å®šæ€§ï¼Œå³ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¹³æ»‘å‡å°‘è®­ç»ƒæŸå¤±

![](img/cb20e85861a55df55677b55ce737bbd5.png)

çªå‡ºæ˜¾ç¤ºè¾“å…¥å±‚ï¼Œè¿™æ˜¯æ¥æ”¶å½’ä¸€åŒ–é¢„æµ‹ç‰¹å¾çš„ç¬¬ä¸€å±‚ã€‚

å¯¹äºåˆ†ç±»é¢„æµ‹ç‰¹å¾ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªé¢„æµ‹ç‰¹å¾ä¸­çš„æ¯ä¸ªç±»åˆ«æœ‰ä¸€ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œå³ç‰¹å¾çš„ä¸€çƒ­ç¼–ç åï¼Œæ¯ä¸ªç¼–ç éƒ½ä¼ é€’åˆ°ä¸€ä¸ªå•ç‹¬çš„è¾“å…¥èŠ‚ç‚¹ã€‚

+   å›å¿†ä¸€ä¸‹ä¸€çƒ­ç¼–ç ï¼Œå¦‚æœç‰¹å®šç±»åˆ«ä¸º 1ï¼Œå¦åˆ™ä¸º 0ï¼Œç”¨é•¿åº¦ç­‰äºç±»åˆ«æ•°é‡çš„äºŒè¿›åˆ¶å‘é‡æ›¿æ¢åˆ†ç±»ç‰¹å¾ã€‚

![](img/51d695aaaa36c3450f3997691fb0090f.png)

æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œä¸­çš„è¾“å…¥å±‚è¢«çªå‡ºæ˜¾ç¤ºã€‚è¿™æ˜¯æ¥æ”¶å•ä¸ªåˆ†ç±»é¢„æµ‹ç‰¹å¾çš„ä¸€çƒ­ç¼–ç çš„ç¬¬ä¸€å±‚ã€‚

+   æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ºæ¯ä¸ªåˆ†ç±»é¢„æµ‹ç‰¹å¾ä½¿ç”¨å•ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œå¹¶ä¸ºæ¯ä¸ªç±»åˆ«åˆ†é…é˜ˆå€¼ï¼Œä¾‹å¦‚å¯¹äº 3 ä¸ªç±»åˆ«ï¼Œå¯ä»¥æ˜¯ $\left[ 0.0, 0.5, 1.0 \right]$ï¼Œä½†è¿™å‡è®¾åˆ†ç±»ç‰¹å¾æ˜¯é¡ºåºçš„ã€‚

**éšè—å±‚** - è¾“å…¥å±‚å€¼ $I_1, I_2, I_2$ ä¸å¯å­¦ä¹ çš„æƒé‡ç›¸ä¹˜ï¼Œ

$$ \lambda_{1,4}, \lambda_{2,4}, \lambda_{3,4}, \lambda_{1,5}, \lambda_{2,5}, \lambda_{3,5} $$

+   åœ¨éšè—å±‚èŠ‚ç‚¹ä¸­ï¼ŒåŠ æƒè¾“å…¥å±‚å€¼ï¼Œ$\lambda_{1,4} \cdot I_1, \lambda_{2,4} \cdot I_2 \cdot I_2, \ldots, \lambda_{3,5} \cdot I_3$ ä¸æ¯ä¸ªèŠ‚ç‚¹ä¸­å¯è®­ç»ƒçš„åç½®é¡¹ $b_4$ å’Œ $b_5$ ç›¸åŠ ã€‚

$$ H_{4_{in}} = \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 $$$$ H_{5_{in}} = \lambda_{1,5} \cdot I_1 + \lambda_{2,5} \cdot I_2 + \lambda_{3,5} \cdot I_3 + b_5 $$

éçº¿æ€§æ¿€æ´»å‡½æ•°è¢«åº”ç”¨ï¼Œ

$$ H_{4} = \sigma \bigl( \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 \bigr) $$$$ H_{5} = \sigma \bigl( \lambda_{1,5} \cdot I_1 + \lambda_{2,5} \cdot I_2 + \lambda_{3,5} \cdot I_3 + b_5 \bigr) $$

+   è¾“å…¥å±‚èŠ‚ç‚¹åˆ°æ‰€æœ‰éšè—å±‚èŠ‚ç‚¹çš„è¾“å‡ºæ˜¯æ’å®šçš„ï¼ˆå†æ¬¡å¼ºè°ƒï¼Œæ¯ä¸ªèŠ‚ç‚¹å°†ç›¸åŒçš„å€¼å‘é€åˆ°ä¸‹ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ï¼‰

![](img/e2342c26953974528579d98e504c15c8.png)

æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œä¸­çš„éšè—å±‚è¢«çªå‡ºæ˜¾ç¤ºã€‚è¾“å…¥å±‚èŠ‚ç‚¹çš„è¾“å‡ºè¢«åŠ æƒå¹¶ä¼ é€’åˆ°éšè—å±‚èŠ‚ç‚¹ã€‚éšè—å±‚èŠ‚ç‚¹åˆ°æ‰€æœ‰è¾“å‡ºå±‚èŠ‚ç‚¹çš„è¾“å‡ºæ˜¯æ’å®šçš„ã€‚

**è¾“å‡ºå±‚** - å¯¹äºè¿ç»­å“åº”ç‰¹å¾ï¼Œæ¯ä¸ªå½’ä¸€åŒ–å“åº”ç‰¹å¾æœ‰ä¸€ä¸ªè¾“å‡ºèŠ‚ç‚¹ã€‚å†æ¬¡è®¡ç®—è¾“å…¥çš„åŠ æƒçº¿æ€§ç»„åˆåŠ ä¸ŠèŠ‚ç‚¹åç½®ï¼Œ

$$ O_{6_{in}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

ç„¶ååº”ç”¨æ¿€æ´»å‡½æ•°ï¼Œä½†å¯¹äºè¿ç»­å“åº”ç‰¹å¾ï¼Œé€šå¸¸åº”ç”¨æ’ç­‰ï¼ˆçº¿æ€§ï¼‰å˜æ¢ï¼Œ

$$ O_6 = \alpha \bigl( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \bigr) = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 = O_{6_{in}} $$

+   ä»å½’ä¸€åŒ–åˆ°åŸå§‹å“åº”ç‰¹å¾çš„åè½¬æ¢ç„¶ååº”ç”¨ä»¥æ¢å¤æœ€ç»ˆé¢„æµ‹

+   å°±åƒè¿ç»­é¢„æµ‹ç‰¹å¾ä¸€æ ·ï¼Œå¯¹è¿ç»­å“åº”ç‰¹å¾åº”ç”¨æœ€å°/æœ€å¤§å½’ä¸€åŒ–ï¼Œå°†å…¶èŒƒå›´è®¾ç½®ä¸º[âˆ’1,1]æˆ–[0,1]ï¼Œä»¥æé«˜æ¿€æ´»å‡½æ•°çš„æ•æ„Ÿæ€§

![](img/87d8ca10f44d6d5d97c7e6ced2d415e5.png)

çªå‡ºæ˜¾ç¤ºæˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œçš„è¾“å‡ºå±‚ã€‚éšè—å±‚èŠ‚ç‚¹çš„è¾“å‡ºè¢«åŠ æƒå¹¶ä¼ é€’åˆ°è¾“å‡ºå±‚èŠ‚ç‚¹ã€‚éšè—å±‚èŠ‚ç‚¹çš„è¾“å‡ºæ˜¯æ’å®šçš„ï¼Œä½†æƒé‡åœ¨éšè—å±‚èŠ‚ç‚¹åˆ°è¾“å‡ºå±‚èŠ‚ç‚¹çš„è¿æ¥ä¸­å˜åŒ–ã€‚

åœ¨åˆ†ç±»å“åº”ç‰¹å¾çš„æƒ…å†µä¸‹ï¼Œå†æ¬¡åº”ç”¨ one-hot ç¼–ç ï¼Œå› æ­¤ï¼Œæ¯ä¸ªç±»åˆ«éƒ½æœ‰ä¸€ä¸ªè¾“å‡ºèŠ‚ç‚¹ã€‚

+   é¢„æµ‹æ˜¯æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡

![](img/11c0969ef52f11e6929df9ff8e4d92c2.png)

çªå‡ºæ˜¾ç¤ºè¾“å…¥å±‚ï¼Œè¿™æ˜¯æ¥æ”¶å•ä¸ªåˆ†ç±»é¢„æµ‹ç‰¹å¾ one-hot ç¼–ç çš„ç¬¬ä¸€å±‚ã€‚

## ç½‘ç»œæ¦‚è¿°

ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½æ¦‚è¿°äººå·¥ç¥ç»ç½‘ç»œã€‚

+   æˆ‘ä»¬éµå¾ªå•ä¸€è·¯å¾„æ¥å±•ç¤ºä¸ä½¿ç”¨äººå·¥ç¥ç»ç½‘ç»œè¿›è¡Œé¢„æµ‹ç›¸å…³çš„ç²¾ç¡®è®¡ç®—

ä¸‹æ–‡å°†è§£é‡Šå®Œæ•´çš„æ­£å‘ä¼ é€’ã€‚

**åœ¨è¾“å…¥å±‚èŠ‚ç‚¹å†…éƒ¨** - è¾“å…¥å±‚èŠ‚ç‚¹ä»…ä¼ é€’é¢„æµ‹ç‰¹å¾ï¼Œ

+   å½’ä¸€åŒ–çš„è¿ç»­é¢„æµ‹ç‰¹å¾å€¼

+   å•ä¸ª one-hot ç¼–ç å€¼[0 æˆ– 1]ç”¨äºåˆ†ç±»é¢„æµ‹ç‰¹å¾

å°†è¾“å…¥ä¼ é€’åˆ°éšè—å±‚èŠ‚ç‚¹ï¼Œä½¿ç”¨é€šç”¨å‘é‡è¡¨ç¤ºï¼Œ

$$ I = X $$![](img/4e1c6258eff75f9d4ce767b39cd522fb.png)

äººå·¥ç¥ç»ç½‘ç»œçš„æ¦‚è¿°ï¼Œè¾“å…¥å±‚èŠ‚ç‚¹æ¥æ”¶å•ä¸ªåˆ†ç±»é¢„æµ‹ç‰¹å¾çš„ one-hot ç¼–ç å¹¶å°†å…¶ä¼ é€’ç»™æ‰€æœ‰éšè—å±‚èŠ‚ç‚¹ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼æ³›åŒ–æ‰€æœ‰è¾“å…¥å±‚èŠ‚ç‚¹ï¼Œ

$$ H_j = H_{j_{in}} = X_j $$

**åœ¨éšè—å±‚èŠ‚ç‚¹å†…éƒ¨**

éšè—å±‚èŠ‚ç‚¹æ˜¯ç®€å•çš„å¤„ç†å™¨ã€‚å®ƒä»¬å¯¹è¾“å…¥è¿›è¡Œçº¿æ€§åŠ æƒçš„ç»„åˆï¼Œæ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹åç½®é¡¹ï¼Œç„¶åå°†ç»“æœè¿›è¡Œéçº¿æ€§è½¬æ¢ï¼Œè¿™ç§è½¬æ¢ç§°ä¸ºæ¿€æ´»å‡½æ•°ï¼Œ$\alpha$ã€‚

+   ç¡®å®ï¼Œä¸€ä¸ªéå¸¸ç®€å•çš„å¤„ç†å™¨ï¼

+   é€šè¿‡è®¸å¤šç›¸äº’è¿æ¥çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬è·å¾—ä¸€ä¸ªéå¸¸çµæ´»çš„é¢„æµ‹å™¨ï¼Œèƒ½å¤Ÿè¡¨å¾å¤æ‚ã€éçº¿æ€§çš„æ¨¡å¼ã€‚

åœ¨æ¿€æ´»ä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰ï¼Œ

$$ H_{4_{in}} = \sum_{i=1}^{3} \left( \lambda_{i,4} \cdot I_i \right) + b_4 $$

åœ¨æ¿€æ´»ä¹‹åï¼Œæˆ‘ä»¬æœ‰ï¼Œ

$$ H_4 = \alpha \left(H_{4_{in}} \right) $$

æˆ‘ä»¬å¯ä»¥ç”¨é€šç”¨å‘é‡è¡¨ç¤ºæ³•åœ¨èŠ‚ç‚¹ä¸­è¡¨è¾¾è¿™ä¸ªç®€å•çš„å¤„ç†å™¨ï¼Œ

$$ H_4 = \alpha \left(b_4 + \lambda_{j,4}^T I \right) $$![](img/b2f8e46ea497049f4b95c03b8812eea7.png)

äººå·¥ç¥ç»ç½‘ç»œçš„æ¦‚è¿°ï¼Œéšè—å±‚çº¿æ€§åŠ æƒè¾“å…¥æ¥è‡ªæ¯ä¸ªè¾“å…¥å±‚èŠ‚ç‚¹ï¼Œæ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹åç½®é¡¹ï¼Œç„¶ååº”ç”¨æ¿€æ´»å‡½æ•°ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ä¸‹ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œå³æˆ‘ä»¬çš„ç¤ºä¾‹äººå·¥ç¥ç»ç½‘ç»œçš„è¾“å‡ºå±‚ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼æ¨å¹¿æ‰€æœ‰éšè—å±‚èŠ‚ç‚¹ï¼Œ

$$ H_{j_{in}} = \sum_{i=1}^{|I|} \left( \lambda_{i,j} \cdot I_i \right) + b_j $$

æ¿€æ´»åï¼ŒèŠ‚ç‚¹è¾“å‡ºä¸ºï¼Œ

$$ H_{j_{in}} = \sigma \bigl( \sum_{i=1}^{|I|} \left( \lambda_{i,j} \cdot I_i \right) + b_j \bigr) $$

**è¾“å‡ºå±‚èŠ‚ç‚¹å†…éƒ¨**

è¾“å‡ºå±‚èŠ‚ç‚¹é‡‡ç”¨èŠ‚ç‚¹è¾“å…¥çš„çº¿æ€§åŠ æƒç»„åˆï¼Œæ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹åç½®é¡¹ï¼Œç„¶åä½¿ç”¨ä¸éšè—å±‚èŠ‚ç‚¹ç›¸åŒçš„æ¿€æ´»å‡½æ•°$\alpha$è¿›è¡Œè½¬æ¢ï¼Œ

åœ¨æ¿€æ´»ä¹‹å‰ï¼Œ

$$ O_{6_{in}} = \sum_{i=4}^{5} \left( \lambda_{i,6} \cdot H_i \right) + b_6 $$

æ¿€æ´»åï¼Œå‡è®¾æ’ç­‰æ¿€æ´»ï¼Œæˆ‘ä»¬æœ‰ï¼Œ

$$ O_6 = \alpha \left(O_{6_{in}} \right) $$

æˆ‘ä»¬å¯ä»¥ç”¨é€šç”¨å‘é‡ç¬¦å·è¡¨ç¤ºèŠ‚ç‚¹ä¸­çš„ç®€å•å¤„ç†å™¨ï¼Œ

$$ O_6 = \alpha\left(b_6 + \lambda_{j,6}^T H\right) $$![](img/22c5dd7e545497f42cf0b949f0b92954.png)

äººå·¥ç¥ç»ç½‘ç»œçš„æ¦‚è¿°ï¼Œè¾“å‡ºå±‚çº¿æ€§åŠ æƒè¾“å…¥æ¥è‡ªæ¯ä¸ªéšè—å±‚èŠ‚ç‚¹ï¼Œæ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹åç½®é¡¹ï¼Œç„¶ååº”ç”¨æ¿€æ´»å‡½æ•°ï¼Œé€šå¸¸å¯¹äºè¿ç»­å“åº”ç‰¹å¾æ˜¯çº¿æ€§çš„ï¼Œå¹¶å°†å…¶ä½œä¸ºè¾“å‡ºä¼ é€’ã€‚

å¯¹äºåˆ†ç±»å“åº”ç‰¹å¾ï¼Œé€šå¸¸åº”ç”¨ softmax æ¿€æ´»ï¼Œ

$$ O_j = \alpha(O_{j_{in}}) = \frac{e^{O_{j_{in}}}}{\sum_{\iota=1}^{K} e^{O_{\iota_{in}}}} $$![](img/ff80ab0dac26f531ce5cc5ce3cd9cf5d.png)

äººå·¥ç¥ç»ç½‘ç»œçš„æ¦‚è¿°ï¼Œè¾“å‡ºå±‚çº¿æ€§åŠ æƒè¾“å…¥æ¥è‡ªæ¯ä¸ªéšè—å±‚èŠ‚ç‚¹ï¼Œæ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹åç½®é¡¹ï¼Œç„¶ååº”ç”¨æ¿€æ´»å‡½æ•°ï¼Œé€šå¸¸å¯¹äºè¿ç»­å“åº”ç‰¹å¾æ˜¯çº¿æ€§çš„ï¼Œå¹¶å°†å…¶ä½œä¸ºè¾“å‡ºä¼ é€’ã€‚

softmax æ¿€æ´»ç¡®ä¿æ‰€æœ‰è¾“å‡ºå±‚èŠ‚ç‚¹çš„è¾“å‡ºéƒ½æ˜¯æœ‰æ•ˆçš„æ¦‚ç‡ï¼ŒåŒ…æ‹¬ï¼Œ

+   **éè´Ÿæ€§** - é€šè¿‡æŒ‡æ•°è¿ç®—

+   **å°é—­** - é€šè¿‡åˆ†æ¯å½’ä¸€åŒ–ç»“æœï¼Œæ¦‚ç‡ä¹‹å’Œä¸º 1.0

æ³¨æ„ï¼Œå¯¹äºæ‰€æœ‰æœªæ¥çš„è®¨è®ºå’Œæ¼”ç¤ºï¼Œæˆ‘å‡è®¾ä¸€ä¸ªæ ‡å‡†åŒ–çš„è¿ç»­å“åº”ç‰¹å¾ã€‚

## ç½‘ç»œæ­£å‘ä¼ é€’

ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†ä¸€æ¡è·¯å¾„ä¸Šç½‘ç»œçš„æ¦‚è¿°ï¼Œè®©æˆ‘ä»¬ç»“åˆé€šè¿‡æˆ‘ä»¬ç½‘ç»œçš„å…¨éƒ¨è·¯å¾„æ¥æ¼”ç¤ºäººå·¥ç¥ç»ç½‘ç»œçš„ä¸€æ¬¡å®Œæ•´æ­£å‘ä¼ é€’ã€‚

+   è¿™æ˜¯è¿›è¡Œé¢„æµ‹æ‰€éœ€çš„è®¡ç®—ï¼Œä¸ä½¿ç”¨ outï¼Œ

$$ O_6 = \sigma_{O_6} \bigl( \lambda_{4,6} \cdot \sigma_{H_4} \left( \lambda_{1,4} I_1 + \lambda_{2,4} I_2 + \lambda_{3,4} I_3 + b_4 \right) + \lambda_{5,6} \cdot \sigma_{H_5} \left( \lambda_{1,5} I_1 + \lambda_{2,5} I_2 + \lambda_{3,5} I_3 + b_5 \right) + b_6 \bigr) $$

å…¶ä¸­æ¿€æ´»å‡½æ•° $\sigma_{H_4}$ = $\sigma_{H_5}$ = $\sigma$ æ˜¯ Sigmoidï¼Œè€Œ $\sigma_{O_6}$ æ˜¯çº¿æ€§ï¼ˆæ’ç­‰ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç®€åŒ–å‰å‘ä¼ æ’­ä¸ºï¼Œ

$$ O_6 = \lambda_{4,6} \cdot \sigma \left( \lambda_{1,4} I_1 + \lambda_{2,4} I_2 + \lambda_{3,4} I_3 + b_4 \right) + \lambda_{5,6} \cdot \sigma \left( \lambda_{1,5} I_1 + \lambda_{2,5} I_2 + \lambda_{3,5} I_3 + b_5 \right) + b_6 $$

è¿™å¼ºè°ƒäº†æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œæ˜¯ä¸€ä¸ªåµŒå¥—çš„æ¿€æ´»çº¿æ€§ç³»ç»Ÿé›†åˆï¼Œå³çº¿æ€§åŠ æƒçš„å¹³å‡å€¼åŠ ä¸Šåº”ç”¨äºæ¿€æ´»å‡½æ•°çš„åå·®é¡¹ã€‚

## æ¨¡å‹å‚æ•°æ•°é‡

é€šå¸¸æƒ…å†µä¸‹ï¼Œäººå·¥ç¥ç»ç½‘ç»œä¸­æœ‰è®¸å¤šæ¨¡å‹å‚æ•°ï¼Œ$theta$ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ˜ç¡®è¿™äº›å®šä¹‰æ¥æè¿°æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œï¼Œ

+   **ç¥ç»ç½‘ç»œå®½åº¦** - ç¥ç»ç½‘ç»œå±‚çš„èŠ‚ç‚¹æ•°

+   **ç¥ç»ç½‘ç»œæ·±åº¦** - ç¥ç»ç½‘ç»œä¸­çš„å±‚æ•°ï¼Œé€šå¸¸è¾“å…¥å±‚ä¸åŒ…æ‹¬åœ¨è¿™ä¸ªè®¡ç®—ä¸­

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å‡è®¾ä¸€ä¸ªç´§å‡‘çš„è¡¨ç¤ºæ³•ç”¨äºä¸€ä¸ª 3 å±‚äººå·¥ç¥ç»ç½‘ç»œï¼Œè¾“å…¥ã€è¾“å‡ºå’Œ 1 ä¸ªéšè—å±‚ï¼Œæ¯å±‚çš„å®½åº¦ä¸ºï¼Œ

+   è¾“å…¥èŠ‚ç‚¹æ•° $p$

+   éšè—å±‚èŠ‚ç‚¹æ•° $m$

+   å’Œè¾“å‡ºèŠ‚ç‚¹æ•° $k$

![](img/1b5b7051a7f760fb3b71c71560ca7613.png)

äººå·¥ç¥ç»ç½‘ç»œçš„å®½åº¦è¡¨ç¤ºæ³•ï¼Œè¾“å…¥èŠ‚ç‚¹æ•° $p$ï¼Œéšè—å±‚èŠ‚ç‚¹æ•° $m$ï¼Œå’Œè¾“å‡ºèŠ‚ç‚¹æ•° $k$ã€‚

å…¨è¿æ¥ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªè¿æ¥éƒ½æœ‰ä¸€ä¸ªæƒé‡ï¼Œ

$$ \lambda_{ğ¼_{1,\ldots,ğ‘},ğ»_{1,\ldots,ğ‘š} } \quad \text{å’Œ} \quad \lambda_{ğ»_{1,\ldots,ğ‘š},ğ‘‚_{1,\ldots,ğ‘˜} } $$

åœ¨å…¨è¿æ¥çš„æƒ…å†µä¸‹ï¼Œæƒé‡çš„æ•°é‡æ˜¯

$$ ğ‘ \times ğ‘š \quad \text{å’Œ} \quad ğ‘š \times ğ‘˜ $$

å¹¶ä¸”åœ¨æ¯ä¸ªéšè—å±‚èŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªåå·®é¡¹ï¼Œ

$$ ğ‘_{H_{1,\ldots,m} } $$

å¹¶ä¸”åœ¨æ¯ä¸ªè¾“å‡ºèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªåå·®é¡¹ï¼Œ

$$ ğ‘_{O_{1,\ldots,k} } $$

å› æ­¤ï¼Œæ¨¡å‹å‚æ•°çš„æ•°é‡æ˜¯ï¼Œ

$$ |\theta| = ğ‘ \times ğ‘š + ğ‘š \times ğ‘˜ + ğ‘š + ğ‘˜ $$

è¿™å‡è®¾æ¯ä¸ªéšè—å±‚èŠ‚ç‚¹å’Œè¾“å‡ºå±‚èŠ‚ç‚¹æœ‰ä¸€ä¸ªå”¯ä¸€çš„åå·®é¡¹ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç›¸åŒçš„åå·®é¡¹å¯èƒ½åº”ç”¨äºæ•´ä¸ªå±‚ã€‚

å¯¹äºæˆ‘ä»¬çš„ä¾‹å­ï¼Œ$p = 3$ï¼Œ$m = 2$ å’Œ $k = 1$ï¼Œé‚£ä¹ˆæ¨¡å‹å‚æ•°çš„æ•°é‡æ˜¯ï¼Œ

$$ |\theta| = ğ‘ \times ğ‘š + ğ‘š \times ğ‘˜ + ğ‘š + ğ‘˜ $$

ä»£å…¥åæˆ‘ä»¬å¾—åˆ°ï¼Œ

$$ |\theta| = 3 \times 2 + 2 \times 1 + 2 + 1 = 11 $$

æˆ‘é€‰æ‹©è¿™ä¸ªä½œä¸ºå¯ç®¡ç†çš„å‚æ•°æ•°é‡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®­ç»ƒå’Œå¯è§†åŒ–æˆ‘ä»¬çš„æ¨¡å‹ï¼Œä½†é€šè¿‡å¢åŠ æˆ‘ä»¬äººå·¥ç¥ç»ç½‘ç»œçš„å®½åº¦ï¼Œè€ƒè™‘ä¸€ä¸ªæ›´å…¸å‹çš„æ¨¡å‹å¤§å°ï¼Œå³ $p = 10$ï¼Œ$m = 20$ å’Œ $k = 3$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æœ‰æ›´å¤šçš„æ¨¡å‹å‚æ•°ï¼Œ

$$ |\theta| = 10 \times 20 + 20 \times 3 + 20 + 3 = 283 $$

å¦‚æœæˆ‘ä»¬æ·»åŠ éšè—å±‚ï¼Œå¢åŠ æˆ‘ä»¬äººå·¥ç¥ç»ç½‘ç»œçš„æ·±åº¦ï¼Œæ¨¡å‹å‚æ•°çš„æ•°é‡å°†è¿…é€Ÿå¢é•¿ã€‚

+   æˆ‘ä»¬å¯ä»¥æ¨å¹¿è¿™ä¸ªè®¡ç®—åˆ°ä»»ä½•å…¨è¿æ¥çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼Œç»™å®šä¸€ä¸ª $W$ å‘é‡ï¼ŒåŒ…å«èŠ‚ç‚¹çš„æ•°é‡ï¼Œå³æ¯å±‚çš„å®½åº¦ï¼Œ

$$ \mathbf{L} = [l_0, l_1, l_2, \dots, l_n] $$

å…¶ä¸­ï¼Œ

+   $l_0$ æ˜¯è¾“å…¥ç¥ç»å…ƒçš„æ•°é‡

+   $l_1, \dots, l_{n-1}$ æ˜¯éšè—å±‚çš„å®½åº¦

+   $l_n$ æ˜¯è¾“å‡ºç¥ç»å…ƒçš„æ•°é‡

è¿æ¥æƒé‡çš„æ€»æ•°æ˜¯ï¼Œ

$$ |\theta_{weights}| = \sum_{i=1}^{n} l_i \cdot l_{i-1} $$

èŠ‚ç‚¹åç½®çš„æ€»æ•°ï¼ˆè¾“å…¥å±‚èŠ‚ç‚¹ä¸­æ²¡æœ‰åç½®å‚æ•°ï¼Œ$l_0$ï¼‰æ˜¯ï¼Œ

$$ |\theta_{biases}| = \sum_{i=1}^{n} l_i $$

å¯è®­ç»ƒæ¨¡å‹å‚æ•°ã€è¿æ¥æƒé‡å’ŒèŠ‚ç‚¹åç½®çš„æ€»æ•°æ˜¯ï¼Œ

$$ |\theta| = \sum_{i=1}^{n} \left( l_i \cdot l_{i-1} + l_i \right) = \sum_{i=1}^{n} l_i \cdot (l_{i-1} + 1) $$

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå…·æœ‰ 4 ä¸ªéšè—å±‚çš„äººå·¥ç¥ç»ç½‘ç»œç¤ºä¾‹ï¼Œç½‘ç»œå®½åº¦æŒ‰å±‚å‘é‡è¡¨ç¤ºï¼Œ

$$ \mathbf{L} = [10, 8, 6, 4, 2, 1] $$

è¿æ¥æƒé‡çš„æ€»æ•°æ˜¯ï¼Œ

$$ |\theta_{L_{weights}}| = \sum_{i=1}^{5} l_i \cdot l_{i-1} = (8 \cdot 10) + (6 \cdot 8) + (4 \cdot 6) + (2 \cdot 4) + (1 \cdot 2) = 80 + 48 + 24 + 8 + 2 = 162 $$

èŠ‚ç‚¹åç½®çš„æ€»æ•°æ˜¯ï¼Œ

$$ |\theta_{L_{biases}}| = \sum_{i=1}^{5} l_i = 8 + 6 + 4 + 2 + 1 = 21 $$

æœ€åï¼Œå¯è®­ç»ƒå‚æ•°çš„æ€»æ•°æ˜¯ï¼Œ

$$ |\theta_L| = \sum_{i=1}^{5} l_i \cdot (l_{i-1} + 1) = (8 \cdot 11) + (6 \cdot 9) + (4 \cdot 7) + (2 \cdot 5) + (1 \cdot 3) = 88 + 54 + 28 + 10 + 3 = 183 $$

## æ¿€æ´»å‡½æ•°

æ¿€æ´»å‡½æ•°æ˜¯åŠ æƒèŠ‚ç‚¹è¾“å…¥çš„çº¿æ€§ç»„åˆåŠ ä¸ŠèŠ‚ç‚¹åç½®é¡¹çš„è½¬æ¢ã€‚éçº¿æ€§æ¿€æ´»ï¼Œ

+   å¼•å…¥ç½‘ç»œçš„éçº¿æ€§å±æ€§å’Œå¤æ‚æ€§

+   é˜²æ­¢ç½‘ç»œå´©æºƒ

æ²¡æœ‰éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œæˆ‘ä»¬å°†å¾—åˆ°çº¿æ€§å›å½’ï¼Œæ•´ä¸ªç³»ç»Ÿä¼šå´©æºƒã€‚

å…³äºæ¿€æ´»å‡½æ•°çš„æ›´å¤šä¿¡æ¯ä»¥åŠéçº¿æ€§æ¿€æ´»ç¼ºå¤±æ—¶å¯¼è‡´çš„å¤šçº¿æ€§å›å½’å´©æºƒçš„æ¼”ç¤ºï¼Œè¯·å‚é˜…æœ¬ç”µå­ä¹¦çš„ç›¸å…³ç« èŠ‚ï¼Œ[ç¥ç»ç½‘ç»œæ¿€æ´»å‡½æ•°](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_activation_functions.html)ã€‚

## è®­ç»ƒç½‘ç»œæ­¥éª¤

è®­ç»ƒäººå·¥ç¥ç»ç½‘ç»œé€šè¿‡ä»¥ä¸‹æ­¥éª¤è¿­ä»£è¿›è¡Œï¼Œ

1.  åˆå§‹åŒ–æ¨¡å‹å‚æ•°

1.  å‰å‘ä¼ é€’ä»¥è¿›è¡Œé¢„æµ‹

1.  æ ¹æ®é¢„æµ‹å’ŒçœŸå®å€¼åœ¨è®­ç»ƒæ•°æ®ä¸Šè®¡ç®—è¯¯å·®å¯¼æ•°

1.  é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œåå‘ä¼ æ’­è¯¯å·®å¯¼æ•°ï¼Œä»¥è®¡ç®—æ‰€æœ‰æ¨¡å‹æƒé‡å’Œåç½®å‚æ•°çš„è¯¯å·®å¯¼æ•°

1.  æ ¹æ®å¯¼æ•°å’Œå­¦ä¹ ç‡æ›´æ–°æ¨¡å‹å‚æ•°

1.  é‡å¤ç›´åˆ°æ”¶æ•›ã€‚

![](img/c3a5bc8956f8ceda05ddf9b582cd141d.png)

è®­ç»ƒäººå·¥ç¥ç»ç½‘ç»œçš„è¿­ä»£æ­¥éª¤ã€‚

ä¸‹é¢æ˜¯æ¯ä¸ªæ­¥éª¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œ

1.  **åˆå§‹åŒ–æ¨¡å‹å‚æ•°** - é€šå¸¸ä½¿ç”¨æ¥è¿‘é›¶çš„å°éšæœºå€¼åˆå§‹åŒ–æ‰€æœ‰æ¨¡å‹å‚æ•°ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§æ–¹æ³•ï¼Œ

+   **Xavier æƒé‡åˆå§‹åŒ–** - ä»ç”± $U[\text{min}, \text{max}]$ æŒ‡å®šçš„å‡åŒ€åˆ†å¸ƒä¸­éšæœºå®ç°ï¼Œ

$$ \lambda_{i,j} = F_U^{-1} \left[ \frac{-1}{\sqrt{p}}, \frac{1}{\sqrt{p}} \right] (p^\ell) $$

å…¶ä¸­ $F^{-1}_U$ æ˜¯ CDF çš„é€†ï¼Œ$p$ æ˜¯è¾“å…¥çš„æ•°é‡ï¼Œ$p^{\ell}$ æ˜¯ä»å‡åŒ€åˆ†å¸ƒ $U[0,1]$ ä¸­æŠ½å–çš„éšæœºç´¯ç§¯æ¦‚ç‡å€¼ã€‚

+   **å½’ä¸€åŒ– Xavier æƒé‡åˆå§‹åŒ–** - ä»ç”± $U[\text{min}, \text{max}]$ æŒ‡å®šçš„å‡åŒ€åˆ†å¸ƒä¸­éšæœºå–å€¼ï¼Œ

$$ \lambda_{i,j} = F_U^{-1} \left[ \frac{-1}{\sqrt{p}+k}, \frac{1}{\sqrt{p}+k} \right] (p^\ell) $$

å…¶ä¸­ $F^{-1}_U$ æ˜¯ CDF çš„é€†ï¼Œ$p$ æ˜¯è¾“å…¥çš„æ•°é‡ï¼Œ$k$ æ˜¯è¾“å‡ºçš„æ•°é‡ï¼Œ$p^{\ell}$ æ˜¯ä»å‡åŒ€åˆ†å¸ƒ $U[0,1]$ ä¸­æŠ½å–çš„éšæœºç´¯ç§¯æ¦‚ç‡å€¼ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªéšè—å±‚èŠ‚ç‚¹ï¼Œ

![](img/b2f8e46ea497049f4b95c03b8812eea7.png)

ç¬¬ä¸€ä¸ªéšè—å±‚èŠ‚ç‚¹æœ‰ 3 ä¸ªè¾“å…¥ï¼Œ1 ä¸ªè¾“å‡ºã€‚

æˆ‘ä»¬æœ‰ $p = 3$ å’Œ $k = 1$ï¼Œå¹¶ä»å‡åŒ€åˆ†å¸ƒä¸­æŠ½å–ï¼Œ

$$ U \left[ \frac{-1}{\sqrt{p}+k}, \frac{1}{\sqrt{p}+k} \right] = U \left[ \frac{-1}{\sqrt{3}+1}, \frac{1}{\sqrt{3}+1} \right] $$

1.  **å‰å‘ä¼ æ’­** - è¿›è¡Œé¢„æµ‹ï¼Œ$\hat{y}$ã€‚åˆå§‹é¢„æµ‹åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£å°†æ˜¯éšæœºçš„ï¼Œä½†ä¼šéšç€è¿­ä»£æ¬¡æ•°çš„å¢åŠ è€Œæ”¹è¿›ã€‚å¯¹äºæˆ‘ä»¬çš„æ¨¡å‹ï¼Œå‰å‘ä¼ æ’­æ˜¯ï¼Œ

$$ O_6 = \lambda_{4,6} \cdot \sigma \left( \lambda_{1,4} I_1 + \lambda_{2,4} I_2 + \lambda_{3,4} I_3 + b_4 \right) + \lambda_{5,6} \cdot \sigma \left( \lambda_{1,5} I_1 + \lambda_{2,5} I_2 + \lambda_{3,5} I_3 + b_5 \right) + b_6 $$![](img/08556ecbd47d143019d0163dc95761cf.png)

ä½¿ç”¨éšæœºæ¨¡å‹å‚æ•°ã€æƒé‡å’Œåå·®åˆå§‹åŒ–çš„äººå·¥ç¥ç»ç½‘ç»œè¿›è¡Œé¢„æµ‹ã€‚

1.  **è®¡ç®—è¯¯å·®å¯¼æ•°** - ç»™å®šä¸€ä¸ªæŸå¤±ï¼Œ

$$ L = \frac{1}{2} \left(\hat{y} - y \right)Â² $$

ä»¥åŠè¯¯å·®å¯¼æ•°ï¼Œå³ç»™å®šæ¨¡å‹ä¼°è®¡çš„å˜åŒ–ï¼Œè¯¯å·®çš„å˜åŒ–ç‡ï¼Œ

$$ \frac{\partial L}{\partial \hat{y}} = \hat{Y} - Y $$

ç°åœ¨ï¼Œæˆ‘ä»¬åªè€ƒè™‘å•ä¸ªä¼°è®¡ï¼Œç¨åæˆ‘ä»¬å°†è®¨è®ºè¶…è¿‡ 1 ä¸ªè®­ç»ƒæ•°æ®ã€‚

1.  **åå‘ä¼ æ’­è¯¯å·®å¯¼æ•°** - æˆ‘ä»¬é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œåå‘è®¡ç®—æ‰€æœ‰æ¨¡å‹æƒé‡å’Œåå·®å‚æ•°çš„è¯¯å·®å¯¼æ•°ï¼Œä¾‹å¦‚ï¼Œä¾‹å¦‚æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºï¼Œ

$$ \frac{\partial L}{\partial H_4} = \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial L}{\partial O_6} = \lambda_{4,6} \cdot \bigl( (1 - O_6) \cdot O_6 \bigr) \cdot (O_6 - y) $$

1.  **æ›´æ–°æ¨¡å‹å‚æ•°** - æ ¹æ®å¯¼æ•° $\frac{\partial L}{\partial \lambda_{i,j}}$ å’Œå­¦ä¹ ç‡ $\eta$ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ

$$ \lambda_{i,j}^{\ell} = \lambda_{i,j}^{\ell - 1} + \eta \cdot \frac{\partial L}{\partial \lambda_{i,j}} $$

1.  **é‡å¤ç›´åˆ°æ”¶æ•›** - è¿”å›æ­¥éª¤ 1ï¼Œç›´åˆ°è¯¯å·® $L$ é™ä½åˆ°å¯æ¥å—çš„æ°´å¹³ï¼Œå³æ¨¡å‹æ”¶æ•›æ˜¯åœæ­¢è¿­ä»£çš„æ¡ä»¶

è¿™äº›æ˜¯æ­¥éª¤ï¼Œç°åœ¨è®©æˆ‘ä»¬æ·±å…¥åˆ°æ¯ä¸ªæ­¥éª¤çš„ç»†èŠ‚ï¼Œä½†é¦–å…ˆè®©æˆ‘ä»¬ä»åå‘ä¼ æ’­çš„æ•°å­¦æ¡†æ¶â€”â€”é“¾å¼æ³•åˆ™å¼€å§‹ã€‚

## é“¾å¼æ³•åˆ™

åæ€åï¼Œå¾ˆæ˜æ˜¾ï¼Œé€šè¿‡æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œçš„å‰å‘ä¼ é€’æ¶‰åŠä¸€ç³»åˆ—åµŒå¥—æ“ä½œï¼Œè¿™äº›æ“ä½œé€æ­¥å°†è¾“å…¥ä¿¡å·ä»è¾“å…¥èŠ‚ç‚¹ä¼ æ’­åˆ°æ¯ä¸€å±‚ï¼Œæœ€ç»ˆåˆ°è¾¾è¾“å‡ºèŠ‚ç‚¹ã€‚

å› æ­¤æˆ‘ä»¬å¯ä»¥å°†æ­¤è¡¨ç¤ºä¸ºä¸€ç³»åˆ—åµŒå¥—æ“ä½œï¼Œ

$$ f = f(x) \quad g = g(f) \quad y = h(g) $$

ç°åœ¨ä»¥è¿™ç§å½¢å¼å¼ºè°ƒæ“ä½œçš„åµŒå¥—ï¼Œ

$$ y = h \bigl( g(f(x)) \bigr) $$

é€šè¿‡å°†é“¾å¼æ³•åˆ™åº”ç”¨äºåµŒå¥—å‡½æ•° $y = h \bigl( g(f(x)) \bigr)$ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚è§£ $\frac{\partial y}{\partial x}$ å¦‚ä¸‹ï¼Œ

$$ \frac{\partial y}{\partial x} = \frac{\partial h}{\partial g} \cdot \frac{\partial g}{\partial f} \cdot \frac{\partial f}{\partial x} $$

å…¶ä¸­æˆ‘ä»¬å°†æ‰€æœ‰ç®—å­çš„åå¯¼æ•°é“¾å¼ç›¸åŠ ï¼Œä»¥æ±‚è§£ç»™å®šè¾“å…¥ $x$ çš„è¾“å‡º $y$ çš„å¯¼æ•°ã€‚

+   æˆ‘ä»¬å¯ä»¥åœ¨åµŒå¥—å‡½æ•°çš„ä»»ä½•ä¸­é—´ç‚¹è®¡ç®—å¯¼æ•°ï¼Œä¾‹å¦‚ï¼Œå‘åèµ°ä¸€æ­¥ï¼Œ

$$ \frac{\partial f}{\partial x} $$

ç°åœ¨æ˜¯ä¸¤æ­¥ï¼Œ

$$ \frac{\partial g}{\partial x} = \frac{\partial g}{\partial f} \cdot \frac{\partial f}{\partial x} $$

å¹¶ä¸”ä¸€ç›´ç”¨ä¸‰ä¸ªæ­¥éª¤ï¼Œ

$$ \frac{\partial y}{\partial x} = \frac{\partial h}{\partial g} \cdot \frac{\partial g}{\partial f} \cdot \frac{\partial f}{\partial x} $$

è¿™å°±æ˜¯æˆ‘ä»¬é€šè¿‡åå‘ä¼ æ’­æ‰€åšçš„äº‹æƒ…ï¼Œä½†è¿™å¯èƒ½è¿‡äºæŠ½è±¡ï¼è®©æˆ‘ä»¬è½¬å‘ä¸€ä¸ªéå¸¸ç®€å•çš„åªæœ‰è¿™ä¸‰ä¸ªèŠ‚ç‚¹çš„æ­£å‘ä¼ æ’­ç¥ç»ç½‘ç»œï¼Œ

+   $I_1$ - è¾“å…¥èŠ‚ç‚¹

+   $H_2 = h(I_1)$ - éšè—å±‚èŠ‚ç‚¹ï¼Œæ˜¯ $I_1$ çš„å‡½æ•°

+   $O_3 = o(H_2)$ - è¾“å‡ºèŠ‚ç‚¹ï¼Œæ˜¯ $H_2$ çš„å‡½æ•°

+   è¿™ä»ç„¶æ˜¯æœ‰æ„ä¸ºä¹‹çš„æŠ½è±¡ï¼Œå³æ²¡æœ‰æåŠæƒé‡å’Œåå·®ï¼Œä»¥å¸®åŠ©æ‚¨é€šè¿‡é“¾å¼æ³•åˆ™å‘å±•ç¥ç»ç½‘ç»œåå‘ä¼ æ’­çš„å¿ƒç†æ¡†æ¶ï¼Œæˆ‘ä»¬å°†åœ¨è¿™æ¬¡è®¨è®ºä¹‹åç«‹å³æ·±å…¥ç»†èŠ‚ã€‚

è¾“å‡º $O_3$ é€šè¿‡è¿™äº›åµŒå¥—å‡½æ•°ä¾èµ–äºè¾“å…¥ $I_1$ï¼š

$$ O_3 = o \bigl( h(I_1) \bigr) $$

ä½¿ç”¨**é“¾å¼æ³•åˆ™**ï¼Œåå‘ä¼ æ’­ä¸€æ­¥çš„è¾“å‡ºæ¢¯åº¦ï¼Œ

$$ \frac{\partial O_3}{\partial H_2} $$

ä»¥åŠåå‘ä¼ æ’­ä¸¤æ­¥ï¼Œ

$$ \frac{\partial O_3}{\partial I_1} = \frac{\partial H_2}{\partial I_1} \cdot \frac{\partial O_3}{\partial H_2} $$

è¿™æ˜¾ç¤ºäº†æ¢¯åº¦å¦‚ä½•é€šè¿‡ç½‘ç»œ**åå‘ä¼ æ’­**ï¼Œ

+   $\frac{\partial O_3}{\partial I_1}$ - æ˜¯éšè—èŠ‚ç‚¹çš„å±€éƒ¨æ¢¯åº¦

+   $\frac{\partial O_3}{\partial H_2}$ - æ˜¯è¾“å‡ºèŠ‚ç‚¹çš„å±€éƒ¨æ¢¯åº¦

é€šè¿‡åå‘ä¼ æ’­ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ç›¸å¯¹äºç½‘ç»œæ‰€æœ‰éƒ¨åˆ†çš„å¯¼æ•°ï¼Œè¾“å…¥èŠ‚ç‚¹ä¿¡å· $I_1$ æˆ–éšè—èŠ‚ç‚¹ä¿¡å· $H_2$ å¦‚ä½•å½±å“è¾“å‡º $O_3$ï¼Œåˆ†åˆ«æ˜¯ $\frac{\partial O_3}{\partial I_1}$ å’Œ $frac{\partial O_3}{\partial H_2}$ã€‚

+   æ›´é‡è¦çš„æ˜¯ï¼Œè¾“å…¥ $I_1$ æˆ– $H_2$ çš„å˜åŒ–å¦‚ä½•å½±å“æ¨¡å‹æŸå¤±çš„å˜åŒ–ï¼Œåˆ†åˆ«æ˜¯ $\frac{\partial L}{\partial I_1}$ å’Œ $frac{\partial L}{\partial H_2}$ã€‚

è¿™ä¸€ç³»åˆ—çš„åå¯¼æ•°ï¼Œé€æ­¥åå‘é€šè¿‡ç¥ç»ç½‘ç»œå±‚ï¼Œæ˜¯**åå‘ä¼ æ’­**èƒŒåçš„åŸºæœ¬æœºåˆ¶ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ¨å¯¼å¹¶æ¼”ç¤ºåå‘ä¼ æ’­çš„å„ä¸ªéƒ¨åˆ†ï¼Œç„¶åæœ€ç»ˆå°†å®ƒä»¬ç»„åˆèµ·æ¥ï¼Œå±•ç¤ºæ•´ä¸ªç½‘ç»œçš„åå‘ä¼ æ’­ã€‚

## ç¥ç»ç½‘ç»œåå‘ä¼ æ’­æ„å»ºå—

è®©æˆ‘ä»¬è®¨è®ºåå‘ä¼ æ’­çš„æ•°å€¼æ„å»ºå—ã€‚ä¸€æ—¦ä½ ç†è§£äº†è¿™äº›åå‘ä¼ æ’­æ„å»ºå—ï¼Œä½ å°†èƒ½å¤Ÿæ‰‹åŠ¨åå‘ä¼ æ’­æˆ‘ä»¬çš„ç®€å•ç½‘ç»œï¼Œç”šè‡³ä»»ä½•å¤æ‚çš„äººå·¥ç¥ç»ç½‘ç»œï¼Œ

1.  è®¡ç®—æŸå¤±å¯¼æ•°

1.  é€šè¿‡èŠ‚ç‚¹è¿›è¡Œåå‘ä¼ æ’­

1.  æ²¿ç€è¿æ¥è¿›è¡Œåå‘ä¼ æ’­

1.  è€ƒè™‘å¤šæ¡è·¯å¾„

1.  å…³äºæƒé‡å’Œåç½®çš„æŸå¤±å¯¼æ•°

ç›®å‰ï¼Œæˆ‘æ¼”ç¤ºäº†å•ä¸ªè®­ç»ƒæ•°æ®æ ·æœ¬ $y$ çš„è¿™ä¸ªæŸå¤±å¯¼æ•°çš„åå‘ä¼ æ’­ã€‚

+   æˆ‘å°†åœ¨åé¢è®¨è®ºå¤šä¸ªæ ·æœ¬ï¼Œ$y_i, i=1, \ldots, n$

è®©æˆ‘ä»¬ä»è®¡ç®—æŸå¤±å¯¼æ•°å¼€å§‹ã€‚

### è®¡ç®—æŸå¤±å¯¼æ•°

åå‘ä¼ æ’­åŸºäºå°†æŸå¤±å¯¼æ•°åˆ†é…æˆ–ä¼ æ’­å›ç¥ç»ç½‘ç»œçš„æ¦‚å¿µï¼Œ

+   æˆ‘ä»¬è®¡ç®—æŸå¤±å¯¼æ•°ï¼Œç„¶åæŒ‰é¡ºåºä»ç½‘ç»œè¾“å‡ºåå‘åˆ†å¸ƒåˆ°ç½‘ç»œè¾“å…¥

+   é‡è¦çš„æ˜¯è¦çŸ¥é“æˆ‘ä»¬æ­£åœ¨å¤„ç†å¯¼æ•°ï¼Œå¹¶ä¸”åå‘ä¼ æ’­å¹¶ä¸æ˜¯åœ¨åˆ†é…è¯¯å·®ï¼Œå°½ç®¡æ­£å¦‚ä½ å°†çœ‹åˆ°çš„ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼

æˆ‘ä»¬é¦–å…ˆå®šä¹‰æŸå¤±ï¼Œç»™å®šçœŸå®å€¼ $ğ‘¦$ å’Œæˆ‘ä»¬çš„é¢„æµ‹ $\hat{y} = O_6$ï¼Œæˆ‘ä»¬è®¡ç®— $LÂ²$ æŸå¤±å¦‚ä¸‹ï¼Œ

$$ L = \frac{1}{2} \left( \hat{y} - y \right)Â² $$

æˆ‘ä»¬é€‰æ‹©çš„æŸå¤±å‡½æ•°å…è®¸æˆ‘ä»¬ä½¿ç”¨é¢„æµ‹è¯¯å·®ä½œä¸ºæŸå¤±å¯¼æ•°ï¼æˆ‘ä»¬è®¡ç®—æŸå¤±å¯¼æ•°ä½œä¸ºæŸå¤±ç›¸å¯¹äºä¼°è®¡çš„åå¯¼æ•°ï¼Œ$\frac{\partial ğ¿}{\partial \hat{y}}$,

$$ \frac{\partial \mathcal{L}}{\partial \hat{y}} = \frac{\partial \frac{1}{2} \left( \hat{y} - y \right)Â² }{\partial \hat{y}} = \hat{y} - y $$

ä½ æ˜ç™½æˆ‘çš„æ„æ€ï¼Œæˆ‘ä»¬æ­£åœ¨åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ï¼Œä½†ç”±äºæˆ‘ä»¬å¯¹ $LÂ²$ æŸå¤±çš„å…¬å¼åŒ–ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—è¾“å‡ºèŠ‚ç‚¹è¾“å‡ºå¤„çš„è¯¯å·®ï¼Œä½†å†æ¬¡å¼ºè°ƒâ€”â€”å®ƒæ˜¯æŸå¤±å¯¼æ•°ã€‚

![](img/6abf780fa4544caa6735a8f4ad075bd2.png)

è®¡ç®—è¾“å‡ºå±‚èŠ‚ç‚¹ $O_6$ çš„æŸå¤±å¯¼æ•°ã€‚

å¯¹äºæˆ‘ä»¬çš„ç®€å•äººå·¥ç¥ç»ç½‘ç»œï¼Œè¾“å‡ºåœ¨èŠ‚ç‚¹ $O_6$ï¼Œæˆ‘ä»¬çš„æŸå¤±å¯¼æ•°æ˜¯ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial O_6} = \frac{\partial \mathcal{L}}{\hat{y}} = \hat{y} - y = O_6 - y $$

å› æ­¤ï¼Œè¿™æ˜¯æˆ‘ä»¬åå‘ä¼ æ’­åˆ°è¾“å‡ºèŠ‚ç‚¹çš„æŸå¤±å¯¼æ•°ï¼Œæˆ‘ä»¬ç°åœ¨å‡†å¤‡é€šè¿‡æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œåå‘ä¼ æ’­è¿™ä¸ªæŸå¤±å¯¼æ•°ï¼Œè®©æˆ‘ä»¬è°ˆè°ˆå¦‚ä½•é€æ­¥é€šè¿‡èŠ‚ç‚¹å’Œæ²¿ç€è¿æ¥ã€‚

### å…·æœ‰æ’ç­‰æ¿€æ´»å‡½æ•°çš„è¾“å‡ºèŠ‚ç‚¹ $O_6$ çš„åå‘ä¼ æ’­

è®©æˆ‘ä»¬é€šè¿‡è¾“å‡ºèŠ‚ç‚¹ $O_6$ ä»åæ¿€æ´»åˆ°å‰æ¿€æ´»è¿›è¡Œåå‘ä¼ æ’­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»å‡½æ•°çš„åå¯¼æ•°ã€‚

+   ç”±äºè¿™æ˜¯ä¸€ä¸ªå…·æœ‰å›å½’äººå·¥ç¥ç»ç½‘ç»œçš„è¾“å‡ºèŠ‚ç‚¹ï¼Œæˆ‘é€‰æ‹©äº†æ’ç­‰æˆ–çº¿æ€§æ¿€æ´»å‡½æ•°ã€‚

![](img/1141c4e67c550f275e9079501fe522b2.png)

é€šè¿‡èŠ‚ç‚¹ $O_6$ ä» $O_6$ åæ¿€æ´»è¾“å‡ºåˆ° $O_{6_{in}}$ å‰æ¿€æ´»è¾“å…¥çš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

è¾“å‡ºèŠ‚ç‚¹ $O_6$ å¤„çš„æ’ç­‰æ¿€æ´»å‡½æ•°å®šä¹‰ä¸ºï¼š

$$ O_6 = \sigma(O_{6_{in}}) = O_6 $$

èŠ‚ç‚¹ $O_6$ å¤„çš„æ’ç­‰æ¿€æ´»å‡½æ•°çš„å¯¼æ•°ç›¸å¯¹äºå…¶è¾“å…¥ $O_{6_{in}}$ï¼Œå³ç©¿è¿‡èŠ‚ç‚¹ $O_6$ï¼Œä¸ºï¼Œ

$$ \frac{\partial O_6}{\partial O_{6_{in}}} = \frac{\partial \left(O_{6_{in}} \right)}{\partial O_{6_{in}}} = 1.0 $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦èŠ‚ç‚¹ $O_6$ çš„è¾“å‡ºä¿¡å·ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªä¿¡å·æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»¥ä»èŠ‚ç‚¹è¾“å‡ºç›¸å¯¹äºæŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_6}$ åå‘ä¼ æ’­ï¼Œä»¥åŠä»èŠ‚ç‚¹è¾“å…¥ç›¸å¯¹äºæŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}}$ åå‘ä¼ æ’­ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = 1.0 \cdot (O_6 - y) $$

æ—¢ç„¶æˆ‘ä»¬å·²ç»é€šè¿‡è¾“å‡ºèŠ‚ç‚¹è¿›è¡Œäº†åå‘ä¼ æ’­ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬æ²¿ç€éšè—å±‚ä¸­ä» $H_4$ åˆ° $O_6$ çš„è¿æ¥è¿›è¡Œåå‘ä¼ æ’­ã€‚

### æ²¿ç€è¿æ¥çš„åå‘ä¼ æ’­

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ²¿ç€èŠ‚ç‚¹ $O_6$ å’Œ $H_4$ ä¹‹é—´çš„è¿æ¥è¿›è¡Œåå‘ä¼ æ’­ã€‚

![](img/1c686c4b3a6fe96317a79c7333542353.png)

é€šè¿‡èŠ‚ç‚¹ $O_6$ ä» $O_6$ åæ¿€æ´»è¾“å‡ºåˆ° $O_{6_{in}}$ å‰æ¿€æ´»è¾“å…¥çš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ï¼Œç„¶åæ²¿ç€è¿æ¥åˆ°èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºã€‚

åœ¨å‰æ¿€æ´»é˜¶æ®µï¼ŒèŠ‚ç‚¹ $ğ‘‚_6$ çš„è¾“å…¥è®¡ç®—å¦‚ä¸‹ï¼Œ

$$ O_{6_{\text{in}}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

æˆ‘ä»¬è®¡ç®—è¿æ¥ä¸Šçš„å¯¼æ•°å¦‚ä¸‹ï¼Œ

$$ \frac{\partial O_{6_{\text{in}}}}{\partial H_4} = \frac{\partial}{\partial H_4} \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \right) = \lambda_{4,6} $$

é€šè¿‡è§£å†³ä¸Šè¿°åå¯¼æ•°ï¼Œæˆ‘ä»¬å‘ç°é€šè¿‡åº”ç”¨è¿æ¥æƒé‡æ¥æ²¿ç€è¿æ¥è¿›è¡Œåå‘ä¼ æ’­ã€‚

$$ \frac{\partial O_{6_{\text{in}}}}{\partial H_4} = \lambda_{4,6} $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦å½“å‰çš„è¿æ¥æƒé‡ $\lambda_{4,6}$ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†å…¶æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œé€šè¿‡ $H_4$ åˆ° $O_6$ çš„è¿æ¥ä»æŸå¤±ç›¸å¯¹äºè¾“å‡ºå±‚èŠ‚ç‚¹è¾“å…¥çš„å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}}$ åå‘ä¼ æ’­åˆ°æŸå¤±ç›¸å¯¹äºéšè—å±‚èŠ‚ç‚¹è¾“å‡ºçš„å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial H_4}$ã€‚

$$ \frac{\partial \mathcal{L}}{\partial H_4} = \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = \lambda_{4,6} \bigl( \cdot (1 - O_6) \cdot O_6 \bigr) \cdot (O_6 - y) $$

### å¸¦æœ‰ sigmoid æ¿€æ´»çš„èŠ‚ç‚¹åå‘ä¼ æ’­

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªéšè—å±‚èŠ‚ç‚¹ $H_4$ ä»åæ¿€æ´»åˆ°å‰æ¿€æ´»è¿›è¡Œåå‘ä¼ æ’­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»å‡½æ•°çš„åå¯¼æ•°ã€‚

+   æˆ‘ä»¬å‡è®¾æ‰€æœ‰éšè—å±‚èŠ‚ç‚¹ä½¿ç”¨ sigmoid æ¿€æ´»

+   å¯¹äºè¶…çº§æ¸…æ™°çš„é€»è¾‘ï¼Œæ¯ä¸ªäººéƒ½å°†æ¿€æ´»å¯¼æ•°ä½œä¸ºè¾“å‡ºè€Œä¸æ˜¯å…¸å‹è¾“å…¥çš„å‡½æ•°æ¥æ±‚è§£ï¼Œ

![](img/10ef488402716c36aa45b497ea54f6bb.png)

é€šè¿‡èŠ‚ç‚¹ $H_4$ ä» $H_4$ åæ¿€æ´»è¾“å‡ºåˆ° $H_{4_{in}}$ å‰æ¿€æ´»è¾“å…¥çš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

è¾“å‡ºèŠ‚ç‚¹ $H_4$ çš„ sigmoid æ¿€æ´»å®šä¹‰ä¸ºï¼š

$$ H_4 = \sigma(H_{4_{in}}) = \frac{1}{1 + e^{-H_{4_{in}}}} $$

èŠ‚ç‚¹ $H_4$ çš„ sigmoid æ¿€æ´»ç›¸å¯¹äºå…¶è¾“å…¥ $H_{4_{in}}$ çš„å¯¼æ•°ï¼Œå³ç©¿è¶ŠèŠ‚ç‚¹ $H_4$ æ˜¯ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = \frac{\partial}{\partial H_{4_{in}}} \left( \frac{1}{1 + e^{-H_{4_{in}}}} \right) $$

ç°åœ¨ï¼Œä¸ºäº†ç´§å‡‘çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬è®¾ï¼Œ

$$ u = e^{-H_{4_{in}}} $$

å¹¶ä»£å…¥æˆ‘ä»¬å¾—åˆ°ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = \frac{\partial}{\partial H_{4_{in}}} \left( \frac{1}{1 + u} \right) $$

é€šè¿‡é“¾å¼æ³•åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ‰©å±•ä¸ºï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = \frac{\partial}{\partial H_{4_{in}}} \left( \frac{1}{1 + u} \right) = -\frac{u}{(1 + u)Â²} \cdot \frac{\partial u}{\partial H_{4_{in}}} $$

$u = e^{-H_{4_{in}}}$ å…³äº $H_{4_{in}}$ çš„å¯¼æ•°æ˜¯ï¼š

$$ \frac{\partial u}{\partial H_{4_{in}}} = -e^{-H_{4_{in}}} = -u $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥æ›¿æ¢ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = -\frac{1}{(1+u)Â²} \cdot (-u) = \frac{u}{(1+u)Â²} $$

ç”¨èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºè¡¨ç¤ºï¼Œ$H_4 = \frac{1}{1 + u}$,

$$ \frac{\partial H_4}{\partial H_{4_{\text{in}}}} = \frac{\left(1 - H_4\right)/H_4}{\left(1/H_4\right)Â²} = \frac{1 - H_4}{H_4} \cdot H_4Â² = \left(1 - H_4\right) \cdot H_4 $$

å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æˆ‘ä»¬çš„èŠ‚ç‚¹ $H_4$ ä»èŠ‚ç‚¹åæ¿€æ´»è¾“å‡º $H_4$ åˆ°èŠ‚ç‚¹å‰æ¿€æ´»è¾“å…¥ $H_{4_{in}}$ è¿›è¡Œåå‘ä¼ æ’­ï¼Œé€šè¿‡ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{\text{in}}}} = \left(1 - H_4\right) \cdot H_4 $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºä¿¡å· $H_4$ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªä¿¡å·æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»¥ä»æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºä»¥åŠèŠ‚ç‚¹ $H_4$ çš„è¾“å…¥ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥å¤„ç†ç½‘ç»œä¸­èŠ‚ç‚¹çš„æ‰€æœ‰åå‘ä¼ æ’­æƒ…å†µã€‚

### æ²¿å¦ä¸€æ¡è¿æ¥è¿›è¡Œåå‘ä¼ æ’­

ä¸ºäº†è¿ç»­æ€§å’Œå®Œæ•´æ€§ï¼Œè®©æˆ‘ä»¬é‡å¤ä¹‹å‰æè¿°çš„æ–¹æ³•ï¼Œä»¥æ²¿è¿æ¥ $I_1$ åˆ° $H_4$ è¿›è¡Œåå‘ä¼ æ’­ã€‚

![](img/76f408b8ed852b03a168e6069bb716db.png)

æ²¿ç€ä» $H_4$ åˆ° $I_1$ çš„è¿æ¥è¿›è¡ŒæŸå¤±å¯¼æ•°çš„åå‘ä¼ æ’­ã€‚

å†æ¬¡ï¼ŒèŠ‚ç‚¹ $H_4$ çš„è¾“å…¥çš„é¢„æ¿€æ´»è®¡ç®—å¦‚ä¸‹ï¼Œ

$$ H_{4_{\text{in}}} = \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 $$

æˆ‘ä»¬è®¡ç®—æ²¿è¿æ¥çš„å¯¼æ•°å¦‚ä¸‹ï¼Œ

$$ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} = \frac{\partial \left(\lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 \right)}{\partial I_1} = \lambda_{1,4} $$

é€šè¿‡æ±‚è§£ä¸Šè¿°åå¯¼æ•°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡åº”ç”¨è¿æ¥æƒé‡æ²¿è¿æ¥è¿›è¡Œåå‘ä¼ æ’­ã€‚

$$ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} = \lambda_{4,6} $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦å½“å‰çš„è¿æ¥æƒé‡ $\lambda_{4,6}$ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæƒé‡æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»¥ä»æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°è¾“å‡ºå±‚èŠ‚ç‚¹è¾“å…¥ $\frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}}$ï¼Œåˆ°éšè—å±‚èŠ‚ç‚¹è¾“å‡º $\frac{\partial \mathcal{L}}{\partial H_4}$ çš„ $H_4$ åˆ° $O_6$ è¿æ¥ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) $$

### è€ƒè™‘å¤šæ¡è·¯å¾„

æˆ‘ä»¬å…³äºèŠ‚ç‚¹è¾“å‡º $I_1$ çš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial I_1}$ æ˜¯ä¸æ­£ç¡®çš„ï¼

+   æˆ‘ä»¬å·²ç»è€ƒè™‘äº†ä» $O_6$ åˆ° $H_4$ åˆ° $I_1$ çš„è·¯å¾„ï¼Œä½†æ²¡æœ‰è€ƒè™‘ä» $O_6$ åˆ° $H_5$ åˆ° $I_1$ çš„è·¯å¾„

![](img/6a68404e4b3d2589dcfe15beb5175c60.png)

ä»è¾“å‡ºèŠ‚ç‚¹ $O_6$ åˆ°è¾“å…¥èŠ‚ç‚¹ $I_1$ çš„åå‘ä¼ æ’­å­˜åœ¨å¤šæ¡è·¯å¾„ã€‚

ä¸ºäº†è€ƒè™‘å¤šæ¡è·¯å¾„ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹æ‰€æœ‰è·¯å¾„è¿›è¡Œæ±‚å’Œã€‚

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} + \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

æˆ‘ä»¬å¯ä»¥è¯„ä¼°ä¸ºï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) + \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \cdot 1.0 \cdot (O_6 - y) $$

ç„¶åé€šè¿‡ç§»é™¤ 1.0 å€¼å’Œåˆ†ç»„é¡¹è¿›è¡Œç®€åŒ–ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \left[ \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

### é€šè¿‡è¾“å…¥èŠ‚ç‚¹è¿›è¡Œæ’ç­‰æ¿€æ´»çš„é€†ä¼ æ’­

è®©æˆ‘ä»¬é€šè¿‡è¾“å…¥èŠ‚ç‚¹ $I_1$ ä»åæ¿€æ´»åˆ°å‰æ¿€æ´»è¿›è¡Œé€†ä¼ æ’­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»å‡½æ•°çš„åå¯¼æ•°ã€‚

+   ç”±äºè¿™æ˜¯ä¸€ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œæˆ‘é€‰æ‹©äº†æ’ç­‰æˆ–çº¿æ€§æ¿€æ´»å‡½æ•°ã€‚

![](img/bd05208edfb4ac5d5cc0f8cfe808ae50.png)

ä»èŠ‚ç‚¹ $I_1$ çš„åæ¿€æ´»è¾“å‡ºåˆ°å‰æ¿€æ´»è¾“å…¥çš„æŸå¤±å¯¼æ•°é€†ä¼ æ’­ã€‚

è¾“å‡ºèŠ‚ç‚¹ $I_1$ ä¸Šçš„æ’ç­‰æ¿€æ´»å®šä¹‰ä¸ºï¼š

$$ I_1 = \sigma(I_{1_{in}}) = I_1 $$

èŠ‚ç‚¹ $I_1$ ä¸Šæ’ç­‰æ¿€æ´»ç›¸å¯¹äºå…¶è¾“å…¥ $I_{1_{in}}$ çš„å¯¼æ•°ï¼Œå³é€šè¿‡èŠ‚ç‚¹ $I_1$ ä¼ é€’ï¼Œæ˜¯ï¼Œ

$$ \frac{\partial I_1}{\partial I_{1_{in}}} = \frac{\partial \left(I_{1_{in}} \right)}{\partial I_{1_{in}}} = 1.0 $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦ $I_1$ï¼Œå³ä»èŠ‚ç‚¹è¾“å‡ºçš„ä¿¡å·ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå€¼æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»èŠ‚ç‚¹è¾“å‡ºç›¸å¯¹äºæŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial I_1}$ é€†ä¼ æ’­åˆ°èŠ‚ç‚¹è¾“å…¥ç›¸å¯¹äºæŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial I_{1_{\text{in}}}}$ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = \frac{\partial I_1}{\partial I_{1_{in}}} \cdot \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} + \frac{\partial I_1}{\partial I_{1_{in}}} \cdot \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªå½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = 1.0 \cdot \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) + 1.0 \cdot \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \cdot 1.0 \cdot (O_6 - y) $$

ä¸ºäº†ä¹è¶£ï¼Œæˆ‘è®¾è®¡äº†è¿™ç§è¡¨ç¤ºæ³•ä»¥å®ç°æœ€å¤§æ¸…æ™°åº¦ï¼Œ

$$ \frac{\partial L}{\partial I_{1_{\text{in}}}} = \overbrace{1.0}^{\textstyle \frac{\partial I_{1}}{\partial I_{1_{in}}}} \left[ \overbrace{\lambda_{1,4}}^{\textstyle \frac{\partial H_{4_{\text{in}}}}{\partial I_1}} \cdot \overbrace{(1 - H_4) \cdot H_4}^{\textstyle \frac{\partial H_4}{\partial H_{4_{\text{in}}}}} \cdot \overbrace{\lambda_{4,6}}^{\textstyle \frac{\partial O_{6_{\text{in}}}}{\partial H_4}} \cdot \overbrace{1.0}^{\textstyle \frac{\partial O_{6}}{\partial O_{6_{in}}}} \cdot \overbrace{(O_6 - Y_1^N)}^{\textstyle \frac{\partial L}{\partial O_{6}}} + \overbrace{\lambda_{1,5}}^{\textstyle \frac{\partial H_{5_{\text{in}}}}{\partial I_1}} \cdot \overbrace{(1 - H_5) \cdot H_5}^{\textstyle \frac{\partial H_5}{\partial H_{5_{\text{in}}}}} \cdot \overbrace{\lambda_{5,6}}^{\textstyle \frac{\partial O_{6_{\text{in}}}}{\partial H_5}} \cdot \overbrace{1.0}^{\textstyle \frac{\partial O_{6}}{\partial O_{6_{in}}}} \cdot \overbrace{(O_6 - Y_1^N)}^{\textstyle \frac{\partial L}{\partial O_{6}}} \right] $$

ä½†è¿™å¯ä»¥é€šè¿‡ç§»é™¤ 1.0 å€¼å¹¶ç»„åˆé¡¹æ¥ç®€åŒ–ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = \left[ \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

ä¸ºäº†å®Œæ•´æ€§ï¼Œè¿™é‡Œæ˜¯å…¶ä»–è¾“å…¥èŠ‚ç‚¹çš„åå‘ä¼ æ’­ï¼Œè¿™é‡Œæ˜¯ $\frac{\partial \mathcal{L}}{\partial I_{2_{in}}}$ï¼Œ

![](img/9b186fef88b4e0ad1fa6191394b0e0dd.png)

è¾“å…¥èŠ‚ç‚¹ 2 çš„æŸå¤±å¯¼æ•°åå‘ä¼ æ’­ã€‚

ä¸ºäº†ç®€æ´ï¼Œæˆ‘å·²ç§»é™¤ 1.0 å¹¶åˆå¹¶åŒç±»é¡¹ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{2_{in}}} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_2} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_2} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{2_{in}}} = \left[ \lambda_{2,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{2,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

è¿™é‡Œæ˜¯ $\frac{\partial \mathcal{L}}{\partial I_{3_{in}}}$,

![](img/90c6a46319d78ae1b9d4f8cdc131fd2a.png)

è¾“å…¥èŠ‚ç‚¹ 3 çš„æŸå¤±å¯¼æ•°åå‘ä¼ æ’­ã€‚

ä¸ºäº†ç®€æ´ï¼Œæˆ‘å·²ç§»é™¤ 1.0 å¹¶åˆå¹¶åŒç±»é¡¹ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{3_{in}}} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_3} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_3} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{3_{in}}} = \left[ \lambda_{3,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{3,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

### ç›¸å¯¹äºæƒé‡å’Œåç½®çš„æŸå¤±å¯¼æ•°

ç°åœ¨æˆ‘ä»¬å·²ç»é€šè¿‡æˆ‘ä»¬çš„ç½‘ç»œåå‘ä¼ æ’­äº†æŸå¤±å¯¼æ•°ã€‚

![](img/97de6228871f7910de4d7a8fa86e0bd8.png)

æ‰€æœ‰ç½‘ç»œèŠ‚ç‚¹è¾“å…¥å’Œè¾“å‡ºçš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

ç°åœ¨æˆ‘ä»¬æœ‰äº†ç›¸å¯¹äºç½‘ç»œä¸­æ¯ä¸ªèŠ‚ç‚¹çš„è¾“å…¥å’Œè¾“å‡ºçš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial I_1},\quad \frac{\partial \mathcal{L}}{\partial I_{2_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial I_2},\quad \frac{\partial \mathcal{L}}{\partial I_{3_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial I_3},\quad \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial H_4},\quad \frac{\partial \mathcal{L}}{\partial H_5},\quad \frac{\partial \mathcal{L}}{\partial H_5},\quad \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial O_6} $$

ä½†æˆ‘ä»¬å®é™…ä¸Šéœ€è¦çš„æ˜¯ç›¸å¯¹äºæ¯ä¸ªè¿æ¥æƒé‡çš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial \lambda_{1,4}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{2,4}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{3,4}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{1,5}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{2,5}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{3,5}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{4,6}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{5,6}} $$

ä»¥åŠèŠ‚ç‚¹åå·®ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial b_4},\quad \frac{\partial \mathcal{L}}{\partial b_5},\quad \frac{\partial \mathcal{L}}{\partial b_6} $$

æˆ‘ä»¬å¦‚ä½•å°†æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°è¿æ¥æƒé‡ï¼Ÿè®©æˆ‘ä»¬ä» $H_4$ åˆ° $O_6$ çš„è¿æ¥å¼€å§‹ã€‚

![](img/bf1e650cd4b0613fa09aa5d5c0e72e26.png)

åå‘ä¼ æ’­çš„è¿æ¥æƒé‡ç›¸å…³çš„æŸå¤±å¯¼æ•°ã€‚

é¢„æ¿€æ´»ï¼ŒèŠ‚ç‚¹ $O_6$ çš„è¾“å…¥ä¸ºï¼Œ

$$ O_{6_{\text{in}}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

æˆ‘ä»¬è®¡ç®—ä¸è¿æ¥æƒé‡ç›¸å…³çš„å¯¼æ•°ï¼Œ

$$ \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} = \frac{\partial \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \right)}{\partial \lambda_{4,6}} = H_4 $$

æˆ‘ä»¬éœ€è¦å°†å‰ä¸€å±‚èŠ‚ç‚¹çš„è¾“å‡ºé€šè¿‡è¿æ¥ä¼ é€’ï¼Œä»¥ä¾¿åå‘ä¼ æ’­åˆ°ä¸è¿æ¥æƒé‡ç›¸å…³çš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial \lambda_{4,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = H_4 \cdot 1.0 \cdot (O_6 - y) $$

ç°åœ¨ï¼Œä¸ºäº†å®Œæ•´æ€§ï¼Œè¿™é‡Œåˆ—å‡ºäº†æˆ‘ä»¬ç½‘ç»œæ‰€æœ‰è¿æ¥æƒé‡çš„æ–¹ç¨‹ã€‚

$$ \frac{\partial \mathcal{L}}{\partial \lambda_{1,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{1,4}} \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = I_1 \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{2,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{2,4}} \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = I_2 \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{3,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{3,4}} \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = I_3 \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{1,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{1,5}} \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} = I_1 \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{2,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{2,5}} \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} = I_2 \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{3,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{3,5}} \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} = I_3 \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{4,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = H_4 \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{5,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{5,6}} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = H_5 \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$

çœ‹çœ‹è¿™ä¸ªæ¨¡å¼ï¼Œå…³äºè¿æ¥æƒé‡çš„æŸå¤±å¯¼æ•°æ˜¯ï¼Œ

$$ \text{è¿æ¥ä¿¡å·} \times \text{ä¸‹ä¸€èŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•°} $$

ç°åœ¨æˆ‘ä»¬å¦‚ä½•å°†æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°èŠ‚ç‚¹åç½®ï¼Ÿè®©æˆ‘ä»¬ä» $O_6$ èŠ‚ç‚¹å¼€å§‹ã€‚

![](img/646997a228f8c1e8a3b2743ac13e388a.png)

å…³äºèŠ‚ç‚¹åç½®çš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

ä¸€æ¬¡åˆä¸€æ¬¡ï¼ŒèŠ‚ç‚¹ $O_6$ çš„é¢„æ¿€æ´»è¾“å…¥æ˜¯ï¼Œ

$$ O_{6_{\text{in}}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

æˆ‘ä»¬è®¡ç®—è¿æ¥æƒé‡çš„å¯¼æ•°å¦‚ä¸‹ï¼Œ

$$ \frac{\partial O_{6_{\text{in}}}}{\partial b_6} = \frac{\partial \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \right)}{\partial b_6} = 1.0 $$

å› æ­¤ï¼Œæˆ‘ä»¬çš„åç½®æŸå¤±å¯¼æ•°ç­‰äºèŠ‚ç‚¹è¾“å…¥æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial b_6} = \frac{\partial O_{6_{\text{in}}}}{\partial b_6} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = 1.0 \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$

ä¸ºäº†å®Œæ•´æ€§ï¼Œè¿™é‡Œåˆ—å‡ºäº†ç›¸å¯¹äºèŠ‚ç‚¹åå·®çš„æ‰€æœ‰æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial b_6} = \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial b_4} = \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial b_5} = \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$

çœ‹çœ‹è¿™ä¸ªæ¨¡å¼ï¼Œç›¸å¯¹äºèŠ‚ç‚¹åå·®çš„æŸå¤±å¯¼æ•°æ˜¯ï¼Œ

$$ \text{èŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•°} $$

## åå‘ä¼ æ’­ç¤ºä¾‹

è®©æˆ‘ä»¬å°†ä¸Šé¢è§£é‡Šçš„åå‘ä¼ æ’­æ–¹æ³•åº”ç”¨åˆ°æˆ‘çš„äº¤äº’å¼ç¥ç»ç½‘ç»œä¸­ã€‚

+   è¿™æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€æ¬¡è®­ç»ƒå‘¨æœŸä»…æœ‰ä¸€ä¸ªæ ·æœ¬çš„ç»“æœï¼Œ

![](img/b8b7d56b334d9728490cb2bc1408535e.png)

ç¬¬ä¸€æ¬¡è¿­ä»£çš„åå‘ä¼ æ’­ç»“æœã€‚

æˆ‘çš„äº¤äº’å¼ä»ªè¡¨æ¿æä¾›äº†æ¯ä¸ªèŠ‚ç‚¹ç›¸å¯¹äºè¾“å…¥çš„æ‰€æœ‰æŸå¤±å¯¼æ•°ä»¥åŠæ¯ä¸ªèŠ‚ç‚¹çš„è¾“å‡ºä¿¡å·ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®— $\frac{\partial L}{\partial \lambda_{4,6}}$ å¦‚ä¸‹ï¼Œ

$$ \frac{\partial L}{\partial \lambda_{4,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} \cdot \frac{\partial L}{\partial O_{6_{\text{in}}}} = H_4 \cdot \frac{\partial L}{\partial O_{6_{\text{in}}}} = 0.42 \cdot 1.00 = 0.42 $$

è¿™æ˜¯å…¶ä»–éšè—å±‚åˆ°è¾“å‡ºèŠ‚ç‚¹è¿æ¥ç›¸å¯¹äºè¿æ¥æƒé‡çš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial L}{\partial \lambda_{5,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{5,6}} \cdot \frac{\partial L}{\partial O_{6_{\text{in}}}} = H_5 \cdot \frac{\partial L}{\partial O_{6_{\text{in}}}} = 0.60 \cdot 1.00 = 0.60 $$

ç°åœ¨è®©æˆ‘ä»¬è·å–æ‰€æœ‰è¾“å…¥åˆ°éšè—å±‚è¿æ¥çš„æ•°æ®ï¼Œ

$$ \frac{\partial L}{\partial \lambda_{1,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{1,4}} \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = I_1 \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = 0.50 \cdot (-0.13) = -0.07 $$$$ \frac{\partial L}{\partial \lambda_{1,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{1,5}} \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = I_1 \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = 0.50 \cdot (-0.10) = -0.05 $$$$ \frac{\partial L}{\partial \lambda_{2,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{2,4}} \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = I_2 \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = 0.20 \cdot (-0.13) = -0.03 $$$$ \frac{\partial L}{\partial \lambda_{2,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{2,5}} \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = I_2 \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = 0.20 \cdot (-0.10) = -0.02 $$$$ \frac{\partial L}{\partial \lambda_{3,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{3,4}} \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = I_3 \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = 0.70 \cdot (-0.13) = -0.09 $$$$ \frac{\partial L}{\partial \lambda_{3,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{3,5}} \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = I_3 \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = 0.70 \cdot (-0.10) = -0.07 $$

è¿™å¤„ç†äº†æ‰€æœ‰è¿æ¥æƒé‡è¯¯å·®å¯¼æ•°ï¼Œç°åœ¨æˆ‘ä»¬æ¥å¤„ç†èŠ‚ç‚¹åå·®è¯¯å·®å¯¼æ•°ã€‚

+   èŠ‚ç‚¹åå·®è¯¯å·®å¯¼æ•°ä¸èŠ‚ç‚¹æ¿€æ´»è¯¯å·®å¯¼æ•°ç›¸åŒã€‚ç°åœ¨æˆ‘ä»¬æ¥è®¡ç®—éšè—å±‚ä¸­çš„åå·®é¡¹ï¼Œ

$$ \frac{\partial L}{\partial b_4} = \frac{\partial H_{4_{\text{in}}}}{\partial b_4} \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = 1.0 \cdot (-0.13) = -0.13 $$$$ \frac{\partial L}{\partial b_5} = \frac{\partial H_{5_{\text{in}}}}{\partial b_5} \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = 1.0 \cdot (-0.1) = -0.10 $$

## æ›´æ–°æ¨¡å‹å‚æ•°

å…³äºæ¯ä¸ªæ¨¡å‹å‚æ•°çš„æŸå¤±å¯¼æ•°æ˜¯æ¢¯åº¦ï¼Œå› æ­¤æˆ‘ä»¬å‡†å¤‡å¥½ä½¿ç”¨æ¢¯åº¦ä¸‹é™ä¼˜åŒ–ï¼Œå¹¶æ·»åŠ ï¼Œ

+   **å­¦ä¹ ç‡** - ä¸ºäº†ç¼©æ”¾æ¨¡å‹æ›´æ–°çš„å˜åŒ–ç‡ï¼Œæˆ‘ä»¬åˆ†é…ä¸€ä¸ªå­¦ä¹ ç‡ï¼Œ$\eta$ã€‚å¯¹äºä¸Šé¢æˆ‘ä»¬çš„æ¨¡å‹å‚æ•°ç¤ºä¾‹ï¼Œ

$$ \lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \eta \cdot \frac{\partial L}{\partial \lambda_{4,6}} $$$$ \lambda_{1,4}^{\ell} = \lambda_{1,4}^{\ell - 1} + \eta \cdot \frac{\partial L}{\partial \lambda_{1,4}} $$$$ b_j^{\ell} = b_j^{\ell - 1} + \eta \cdot \frac{\partial L}{\partial b_j} $$

+   è®°ä½ï¼Œè¿™ä¸ªæ¢¯åº¦è®¡ç®—å’Œæ¨¡å‹å‚æ•°ã€æƒé‡å’Œåå·®æ›´æ–°çš„è¿‡ç¨‹æ˜¯è¿­ä»£çš„ï¼Œè¢«ç§°ä¸ºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–ã€‚

+   ç›®æ ‡æ˜¯æ¢ç´¢æŸå¤±è¶…æ›²é¢ï¼Œé¿å…å’Œé€ƒç¦»å±€éƒ¨æœ€å°å€¼ï¼Œæœ€ç»ˆæ‰¾åˆ°å…¨å±€æœ€å°å€¼ã€‚

+   å­¦ä¹ ç‡ï¼Œä¹Ÿç§°ä¸ºæ­¥é•¿ï¼Œé€šå¸¸è®¾ç½®åœ¨ 0.0 å’Œ 1.0 ä¹‹é—´ï¼Œæ³¨æ„åœ¨ TensorFlow çš„ Keras æ¨¡å—ä¸­é»˜è®¤å€¼ä¸º 0.01

+   **ä½å­¦ä¹ ç‡** â€“ æ›´ç¨³å®šï¼Œä½†è§£çš„é€Ÿåº¦è¾ƒæ…¢ï¼Œå¯èƒ½ä¼šé™·å…¥å±€éƒ¨æœ€å°å€¼

+   **é«˜å­¦ä¹ ç‡** â€“ å¯èƒ½ä¸ç¨³å®šï¼Œä½†å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¿«çš„è§£ï¼Œå¯èƒ½ä¼šåç¦»å…¨å±€æœ€å°å€¼

ä¸€ç§ç­–ç•¥æ˜¯å¼€å§‹ä½¿ç”¨é«˜å­¦ä¹ ç‡ï¼Œç„¶ååœ¨è¿­ä»£è¿‡ç¨‹ä¸­é™ä½å­¦ä¹ ç‡

+   **å­¦ä¹ ç‡è¡°å‡** - è®¾ç½®ä¸º > 0 ä»¥é¿å…å‡è½»æŒ¯è¡ï¼Œ

$$ \eta^{\ell} = \eta^{\ell - 1} \cdot \left( \frac{1}{1 + \text{decay} \cdot \ell} \right) $$

å…¶ä¸­ $\ell$ æ˜¯æ¨¡å‹è®­ç»ƒè½®æ¬¡

æ³¨æ„ï¼Œæ¨¡å‹å‚æ•°æ›´æ–°æ˜¯é’ˆå¯¹å•ä¸ªè®­ç»ƒæ•°æ®æ¡ˆä¾‹çš„ï¼Ÿè€ƒè™‘è¿™ä¸ªå•ä¸ªæ¨¡å‹å‚æ•°ï¼Œ

æˆ‘ä»¬è®¡ç®—æ‰¹ä¸­æ‰€æœ‰æ ·æœ¬çš„æ›´æ–°ï¼Œå¹¶åº”ç”¨æ›´æ–°çš„å¹³å‡å€¼ã€‚

$$ \frac{\partial L}{\partial \lambda_{4,6}} = H_4 \cdot \frac{\partial L}{\partial O_{6_{\text{in}}}} = 0.42 \cdot 1.00 = 0.42 $$

åº”ç”¨äºæ›´æ–° $\lambda_{4,6}$ å‚æ•°ï¼Œ

$$ \lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \eta \cdot \frac{\partial L}{\partial \lambda_{4,6}} $$

ä¾èµ–äº $H_4$ èŠ‚ç‚¹è¾“å‡ºå’Œ $L$ é”™è¯¯ï¼Œè¿™äº›æ˜¯é’ˆå¯¹å•ä¸ªæ ·æœ¬çš„ï¼Œ$ğ‘¥_1,\ldots,ğ‘¥_ğ‘š$ å’Œ $ğ‘¦$ï¼›å› æ­¤ï¼Œæˆ‘ä»¬ä¸èƒ½è®¡ç®—æ‰€æœ‰ $1,\ldots,n$ è®­ç»ƒæ•°æ®æ ·æœ¬çš„å•ä¸ªå‚æ•°æ›´æ–°ã€‚

+   è€Œæˆ‘ä»¬å¯ä»¥è®¡ç®— $1,\ldots,n$ æ¬¡æ›´æ–°ï¼Œç„¶åå°†æ‰€æœ‰æ›´æ–°çš„å¹³å‡å€¼åº”ç”¨åˆ°æˆ‘ä»¬çš„æ¨¡å‹å‚æ•°ä¸Šï¼Œ

$$ \lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \frac{1}{n_{batch}} \sum_{i=1}^{n_{batch}} \eta \cdot \frac{\partial L}{\partial \lambda_{4,6}} $$

+   ç”±äºå­¦ä¹ ç‡æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç§»å‡ºæ±‚å’Œç¬¦å·ä¹‹å¤–ï¼Œç°åœ¨æˆ‘ä»¬æ­£åœ¨å¹³å‡æ¢¯åº¦ï¼Œ

$$ \lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \eta \frac{1}{n_{batch}} \sum_{i=1}^{n_{batch}} \frac{\partial L}{\partial \lambda_{4,6}} $$

## è®­ç»ƒè½®æ¬¡

è¿™æ­£æ˜¯è®¨è®ºéšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–çš„å¥½æ—¶æœºï¼Œé¦–å…ˆè®©æˆ‘ä»¬å®šä¹‰ä¸€äº›å¸¸è§æœ¯è¯­ï¼Œ

+   **æ‰¹é‡æ¢¯åº¦ä¸‹é™** - åœ¨é€šè¿‡æ‰€æœ‰æ•°æ®åæ›´æ–°æ¨¡å‹å‚æ•°

+   **éšæœºæ¢¯åº¦ä¸‹é™** - åœ¨æ¯ä¸ªæ ·æœ¬æ•°æ®ä¸Šæ›´æ–°æ¨¡å‹å‚æ•°

+   **å°æ‰¹é‡æ¢¯åº¦ä¸‹é™** - åœ¨é€šè¿‡å•ä¸ªæ‰¹æ¬¡åæ›´æ–°æ¨¡å‹å‚æ•°

ä½¿ç”¨æ•°æ®å­é›†ï¼Œç§°ä¸ºæ‰¹æ¬¡ï¼Œé€šè¿‡å¼•å…¥éšæœºæ€§æ¥ä½¿ç”¨å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼Œ

+   ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæˆ‘ä»¬çš„ 100 ä¸ªæ ·æœ¬åˆ†æˆ 4 æ‰¹æ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å•ç‹¬éå†æ¯ä¸€æ‰¹

+   æˆ‘ä»¬åŠ å¿«äº†å•ä¸ªæ›´æ–°ï¼Œæ›´å°‘çš„æ•°æ®æ›´å¿«åœ°è®¡ç®—ï¼Œä½†å¼•å…¥äº†æ›´å¤šçš„é”™è¯¯

+   è¿™é€šå¸¸æœ‰åŠ©äºè®­ç»ƒæ¢ç´¢å…¨å±€æœ€å°å€¼ï¼Œå¹¶é¿å…é™·å…¥å±€éƒ¨æœ€å°å€¼å’ŒæŸå¤±è¶…æ›²é¢ä¸Šçš„è„Š

æœ€åï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå®šä¹‰çš„æœ€åä¸€ä¸ªå®šä¹‰ï¼Œ

+   **è½®æ¬¡** - æ˜¯å¯¹å…¨éƒ¨æ•°æ®çš„å•æ¬¡éå†ï¼Œæ‰€ä»¥å¦‚æœæœ‰ 4 ä¸ªå°æ‰¹é‡ï¼Œé‚£ä¹ˆæ›´æ–°æ¨¡å‹å‚æ•°çš„è¿­ä»£æ¬¡æ•°å°†æ˜¯ 4 æ¬¡

æˆ‘è¿˜ä¼šæ·»åŠ è®¸å¤šå…¶ä»–è€ƒè™‘å› ç´ ï¼ŒåŒ…æ‹¬ï¼Œ

+   åŠ¨é‡

+   è‡ªé€‚åº”ä¼˜åŒ–

ç°åœ¨æˆ‘ä»¬æ‰‹åŠ¨æ„å»ºä¸Šè¿°äººå·¥ç¥ç»ç½‘ç»œå¹¶å¯è§†åŒ–è§£å†³æ–¹æ¡ˆï¼

+   è¿™æ˜¯ç”±æ‰‹ç»˜çš„ï¼Œè¿™æ ·ä½ å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªè®¡ç®—ã€‚æˆ‘æ•…æ„é¿å…ä½¿ç”¨ TensorFlow æˆ– PyTorchã€‚

## äº¤äº’å¼ä»ªè¡¨æ¿

æˆ‘ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ„å»ºäº†ä¸€ä¸ªäº¤äº’å¼ Python ä»ªè¡¨æ¿ï¼Œç”¨äºè®­ç»ƒäººå·¥ç¥ç»ç½‘ç»œã€‚ä½ å¯ä»¥é€æ­¥é€šè¿‡è®­ç»ƒè¿­ä»£ï¼Œå¹¶åœ¨è®­ç»ƒæ—¶é—´æ­¥é•¿ä¸­è§‚å¯Ÿï¼Œ

+   æ¨¡å‹å‚æ•°

+   å‰å‘ä¼ é€’é¢„æµ‹

+   é”™è¯¯å¯¼æ•°çš„åå‘ä¼ æ’­

å¦‚æœä½ æƒ³è¦çœ‹åˆ°äººå·¥ç¥ç»ç½‘ç»œçš„å®é™…åº”ç”¨ï¼Œè¯·æŸ¥çœ‹æˆ‘çš„[ANN äº¤äº’å¼ Python ä»ªè¡¨æ¿](https://github.com/GeostatsGuy/DataScienceInteractivePython/blob/main/Interactive_ANN.ipynb)ï¼Œ

![å›¾ç‰‡](img/ab7e3b58fcfdbf8f7a2c19b5d78c7736.png)

äº¤äº’å¼äººå·¥ç¥ç»ç½‘ç»œè®­ç»ƒ Python ä»ªè¡¨æ¿ã€‚

## å¯¼å…¥æ‰€éœ€çš„åŒ…

æˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›æ ‡å‡†åŒ…ã€‚è¿™äº›åº”è¯¥å·²ç»ä¸ Anaconda 3 ä¸€èµ·å®‰è£…ã€‚

```py
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from matplotlib.ticker import (MultipleLocator, AutoMinorLocator, AutoLocator) # control of axes ticks
plt.rc('axes', axisbelow=True)                            # set axes and grids in the background for all plots
import math
seed = 13 
```

å¦‚æœä½ é‡åˆ°åŒ…å¯¼å…¥é”™è¯¯ï¼Œä½ å¯èƒ½éœ€è¦é¦–å…ˆå®‰è£…è¿™äº›åŒ…ä¸­çš„ä¸€äº›ã€‚è¿™é€šå¸¸å¯ä»¥é€šè¿‡åœ¨ Windows ä¸Šæ‰“å¼€å‘½ä»¤çª—å£ï¼Œç„¶åè¾“å…¥â€˜python -m pip install [package-name]â€™æ¥å®Œæˆã€‚æ›´å¤šå¸®åŠ©å¯ä»¥åœ¨ç›¸åº”åŒ…çš„æ–‡æ¡£ä¸­æ‰¾åˆ°ã€‚

## å£°æ˜å‡½æ•°

è¿™é‡Œæ˜¯åˆ›å»ºã€è®­ç»ƒå’Œå¯è§†åŒ–æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œçš„å‡½æ•°ã€‚

```py
def add_grid():
    plt.gca().grid(True, which='major',linewidth = 1.0); plt.gca().grid(True, which='minor',linewidth = 0.2) # add y grids
    plt.gca().tick_params(which='major',length=7); plt.gca().tick_params(which='minor', length=4)
    plt.gca().xaxis.set_minor_locator(AutoMinorLocator()); plt.gca().yaxis.set_minor_locator(AutoMinorLocator()) # turn on minor ticks 

def calculate_angle_rads(x1, y1, x2, y2):
    dx = x2 - x1     # Calculate the differences
    dy = y2 - y1
    angle_rads = math.atan2(dy, dx)    # Calculate the angle in radians
    #angle_degrees = math.degrees(angle_radians)    # Convert the angle to degrees
    return angle_rads

def offset(pto, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = pto[0] + distance * math.cos(angle_rads) # Calculate the new coordinates
    y_new = pto[1] + distance * math.sin(angle_rads)
    return np.array((x_new, y_new))

def offsetx(xo, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates
    return np.array((xo, x_new))

def offset_arrx(xo, distance, angle_deg,size): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates
    x_arr = x_new + size * math.cos(angle_rads+2.48) # Calculate the new coordinates
    return np.array((x_new, x_arr))

def offsety(yo, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates
    return np.array((yo, y_new))

def offset_arry(yo, distance, angle_deg,size): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates
    y_arr = y_new + size * math.sin(angle_rads+2.48) # Calculate the new coordinates
    return np.array((y_new, y_arr))

def lint(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    x = x1 + t * (x2 - x1)
    y = y1 + t * (y2 - y1)
    return np.array((x, y))

def lintx(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    x = x1 + t * (x2 - x1)
    return x

def linty(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    y = y1 + t * (y2 - y1)
    return y

def lint_intx(x1, y1, x2, y2, ts, te):
    # Calculate the interpolated coordinates
    xs = x1 + ts * (x2 - x1)
    xe = x1 + te * (x2 - x1)
    return np.array((xs,xe))

def lint_inty(x1, y1, x2, y2, ts, te):
    # Calculate the interpolated coordinates
    ys = y1 + ts * (y2 - y1)
    ye = y1 + te * (y2 - y1)
    return np.array((ys,ye))

def lint_int_arrx(x1, y1, x2, y2, ts, te, size):
    # Calculate the interpolated coordinates
    xe = x1 + te * (x2 - x1)
    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)
    x_arr = xe + size * math.cos(line_angle_rads+2.48) # Calculate the new coordinates
    return np.array((xe,x_arr))

def lint_int_arry(x1, y1, x2, y2, ts, te, size):
    # Calculate the interpolated coordinates
    ye = y1 + te * (y2 - y1)
    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)
    y_arr = ye + size * math.sin(line_angle_rads+2.48) # Calculate the new coordinates
    return np.array((ye,y_arr))

def as_si(x, ndp): # from xnx on StackOverflow https://stackoverflow.com/questions/31453422/displaying-numbers-with-x-instead-of-e-scientific-notation-in-matplotlib 
    s = '{x:0.{ndp:d}e}'.format(x=x, ndp=ndp)
    m, e = s.split('e')
    return r'{m:s}\times 10^{{{e:d}}}'.format(m=m, e=int(e)) 
```

## ç®€å• ANN

æˆ‘ç¼–å†™äº†è¿™æ®µä»£ç æ¥æŒ‡å®šä¸€ä¸ªç®€å•çš„ ANNï¼š

+   ä¸‰ä¸ªè¾“å…¥èŠ‚ç‚¹ã€2 ä¸ªéšè—èŠ‚ç‚¹å’Œ 1 ä¸ªè¾“å‡ºèŠ‚ç‚¹

é€šè¿‡è¿­ä»£æ‰§è¡Œå‰å‘è®¡ç®—å’Œåå‘ä¼ æ’­æ¥è®­ç»ƒ ANNã€‚æˆ‘è®¡ç®—ï¼š

+   é”™è¯¯ç„¶åä¼ æ’­åˆ°æ¯ä¸ªèŠ‚ç‚¹

+   æ±‚è§£è¯¯å·®å¯¹æ¯ä¸ªæƒé‡å’Œåå·®çš„åå¯¼æ•°

æ‰€æœ‰æƒé‡ã€åå·®å’Œæ‰€æœ‰æ—¶é—´æ­¥é•¿çš„åå¯¼æ•°éƒ½è®°å½•åœ¨å‘é‡ä¸­ä»¥ä¾¿ç»˜å›¾

```py
x1 = 0.5; x2 = 0.2; x3 = 0.7; y = 0.3 # training data
lr = 0.2 # learning rate

np.random.seed(seed=seed)

nepoch = 1000

y4 = np.zeros(nepoch); y5 = np.zeros(nepoch); y6 = np.zeros(nepoch)

w14 = np.zeros(nepoch); w24 = np.zeros(nepoch); w34 = np.zeros(nepoch)
w15 = np.zeros(nepoch); w25 = np.zeros(nepoch); w35 = np.zeros(nepoch)
w46 = np.zeros(nepoch); w56 = np.zeros(nepoch)

dw14 = np.zeros(nepoch); dw24 = np.zeros(nepoch); dw34 = np.zeros(nepoch)
dw15 = np.zeros(nepoch); dw25 = np.zeros(nepoch); dw35 = np.zeros(nepoch)
dw46 = np.zeros(nepoch); dw56 = np.zeros(nepoch)

db4 = np.zeros(nepoch); db5 = np.zeros(nepoch); db6 = np.zeros(nepoch)

b4 = np.zeros(nepoch); b5 = np.zeros(nepoch); b6 = np.zeros(nepoch)
y4 = np.zeros(nepoch); y5 = np.zeros(nepoch); y6 = np.zeros(nepoch)
d4 = np.zeros(nepoch); d5 = np.zeros(nepoch); d6 = np.zeros(nepoch)

# initialize the weights - Xavier Weight Initialization 
lower, upper = -(1.0 / np.sqrt(3.0)), (1.0 / np.sqrt(3.0)) # lower and upper bound for the weights, uses inputs to node
#lower, upper = -(sqrt(6.0) / sqrt(3.0 + 2.0)), (sqrt(6.0) / sqrt(3.0 + 2.0)) # Normalized Xavier weights, integrates ouputs also
w14[0] = lower + np.random.random() * (upper - lower); 
w24[0] = lower + np.random.random() * (upper - lower); 
w34[0] = lower + np.random.random() * (upper - lower);
w15[0] = lower + np.random.random() * (upper - lower); 
w25[0] = lower + np.random.random() * (upper - lower); 
w35[0] = lower + np.random.random() * (upper - lower);

lower, upper = -(1.0 / np.sqrt(2.0)), (1.0 / np.sqrt(2.0))
#lower, upper = -(sqrt(6.0) / sqrt(2.0 + 1.0)), (sqrt(6.0) / sqrt(2.0 + 1.0)) # Normalized Xavier weights, integrates ouputs also

w46[0] = lower + np.random.random() * (upper - lower); 
w56[0] = lower + np.random.random() * (upper - lower);     

#b4[0] = np.random.random(); b5[0] = np.random.random(); b6[0] = np.random.random()
b4[0] = (np.random.random()-0.5)*0.5; b5[0] = (np.random.random()-0.5)*0.5; b6[0] = (np.random.random()-0.5)*0.5; # small random value 

for i in range(0,nepoch):

# forward pass of model
    y4[i] = w14[i]*x1 + w24[i]*x2 + w34[i]*x3 + b4[i]; 
    y4[i] = 1.0/(1 + math.exp(-1*y4[i]))

    y5[i] = w15[i]*x1 + w25[i]*x2 + w35[i]*x3 + b5[i]
    y5[i] = 1.0/(1 + math.exp(-1*y5[i]))

    y6[i] = w46[i]*y4[i] + w56[i]*y5[i] + b6[i]
#    y6[i] = 1.0/(1 + math.exp(-1*y6[i])) # sgimoid / logistic activation at o6 

# back propagate the error through the nodes
#    d6[i] = y6[i]*(1-y6[i])*(y-y6[i]) # sgimoid / logistic activation at o6 
    d6[i] = (y-y6[i]) # identity activation o at o6
    d5[i] = y5[i]*(1-y5[i])*w56[i]*d6[i]; d4[i] = y4[i]*(1-y4[i])*w46[i]*d6[i]

# calculate the change in weights
    if i < nepoch - 1:
        dw14[i] = lr*d4[i]*x1; dw24[i] = lr*d4[i]*x2; dw34[i] = lr*d4[i]*x3
        dw15[i] = lr*d5[i]*x1; dw25[i] = lr*d5[i]*x2; dw35[i] = lr*d5[i]*x3
        dw46[i] = lr*d6[i]*y4[i]; dw56[i] = lr*d6[i]*y5[i] 

        db4[i] = lr*d4[i]; db5[i] = lr*d5[i]; db6[i] = lr*d6[i];

        w14[i+1] = w14[i] + dw14[i]; w24[i+1] = w24[i] + dw24[i]; w34[i+1] = w34[i] + dw34[i] 
        w15[i+1] = w15[i] + dw15[i]; w25[i+1] = w25[i] + dw25[i]; w35[i+1] = w35[i] + dw35[i] 
        w46[i+1] = w46[i] + dw46[i]; w56[i+1] = w56[i] + dw56[i]

        b4[i+1] = b4[i] + db4[i]; b5[i+1] = b5[i] + db5[i]; b6[i+1] = b6[i] + db6[i] 
```

## ç°åœ¨å¯è§†åŒ–ç‰¹å®šæ—¶é—´æ­¥é•¿çš„ç½‘ç»œ

æˆ‘ä¸‹é¢å†™äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ç½‘ç»œå¯è§†åŒ–ï¼Œé€‰æ‹© iepoch å¹¶å¯è§†åŒ–ç‰¹å®šæ—¶é—´æ­¥é•¿çš„äººå·¥ç¥ç»ç½‘ç»œã€‚

```py
iepoch = 1

dx = -0.19; dy = -0.09; edge = 1.0

o6x = 17; o6y =5; h5x = 10; h5y = 3.5; h4x = 10; h4y = 6.5
i1x = 3; i1y = 9.0; i2x = 3; i2y = 5; i3x = 3; i3y = 1.0; buffer = 0.5

plt.subplot(111)
plt.gca().set_axis_off()

circle_i1 = plt.Circle((i1x,i1y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_1$',(i1x+dx,i1y+dy),zorder=100); 
circle_i1b = plt.Circle((i1x,i1y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)

circle_i2 = plt.Circle((i2x,i2y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_2$',(i2x+dx,i2y+dy),zorder=100); 
circle_i2b = plt.Circle((i2x,i2y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_i2); plt.gca().add_patch(circle_i2b)

circle_i3 = plt.Circle((i3x,i3y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_3$',(i3x+dx,i3y+dy),zorder=100); 
circle_i3b = plt.Circle((i3x,i3y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_i3); plt.gca().add_patch(circle_i3b)

circle_h4 = plt.Circle((h4x,h4y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$H_4$',(h4x+dx,h4y+dy),zorder=100); 
circle_h4b = plt.Circle((h4x,h4y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_h4); plt.gca().add_patch(circle_h4b)

circle_h5 = plt.Circle((h5x,h5y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$H_5$',(h5x+dx,h5y+dy),zorder=100); 
circle_h5b = plt.Circle((h5x,h5y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_h5); plt.gca().add_patch(circle_h5b)

circle_o6 = plt.Circle((o6x,o6y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$O_6$',(o6x+dx,o6y+dy),zorder=100); 
circle_o6b = plt.Circle((o6x,o6y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_o6); plt.gca().add_patch(circle_o6b)

plt.plot([i1x-edge,i1x],[i1y,i1y],color='grey',lw=1.0,zorder=1)
plt.plot([i2x-edge,i2x],[i2y,i2y],color='grey',lw=1.0,zorder=1)
plt.plot([i3x-edge,i3x],[i3y,i3y],color='grey',lw=1.0,zorder=1)

plt.annotate(r'$x_1$ = ' + str(np.round(x1,2)),(i1x-buffer-1.6,i1y-0.05),size=8,zorder=200,color='grey',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) 
plt.annotate(r'$x_2$ = ' + str(np.round(x2,2)),(i2x-buffer-1.6,i2y-0.05),size=8,zorder=200,color='grey',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) 
plt.annotate(r'$x_3$ = ' + str(np.round(x3,2)),(i3x-buffer-1.6,i3y-0.05),size=8,zorder=200,color='grey',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) 

plt.plot([i1x,h4x],[i1y,h4y],color='lightcoral',lw=1.0,zorder=1)
plt.plot([i2x,h4x],[i2y,h4y],color='red',lw=1.0,zorder=1)
plt.plot([i3x,h4x],[i3y,h4y],color='darkred',lw=1.0,zorder=1)

plt.plot([i1x,h5x],[i1y,h5y],color='dodgerblue',lw=1.0,zorder=1)
plt.plot([i2x,h5x],[i2y,h5y],color='blue',lw=1.0,zorder=1)
plt.plot([i3x,h5x],[i3y,h5y],color='darkblue',lw=1.0,zorder=1)

plt.plot([h4x,o6x],[h4y,o6y],color='orange',lw=1.0,zorder=1)
plt.plot([h5x,o6x],[h5y,o6y],color='darkorange',lw=1.0,zorder=1)

plt.plot([o6x+edge,o6x],[o6y,o6y],color='grey',lw=1.0,zorder=1)
plt.annotate(r'$\hat{y}$ = ' + str(np.round(y6[iepoch],2)),(o6x+buffer+0.7,o6y-0.05),size=8,zorder=200,color='grey',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) 

plt.plot(offsetx(h4x,2,-12),offsety(h4y,2,-12)+0.1,color='orange',lw=1.0,zorder=1)
plt.plot(offset_arrx(h4x,2,-12,0.2),offset_arry(h4y,2,-12,0.2)+0.1,color='orange',lw=1.0,zorder=1)
plt.annotate(r'$H_{4}$ = ' + str(np.round(y4[iepoch],2)),(lintx(h4x,h4y,o6x,o6y,0.08),linty(h4x,h4y,o6x,o6y,0.08)-0.0),size=8,zorder=200,color='orange',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12)

plt.plot(offsetx(h5x,2,12),offsety(h5y,2,12)+0.1,color='darkorange',lw=1.0,zorder=1)
plt.plot(offset_arrx(h5x,2,12,0.2),offset_arry(h5y,2,12,0.2)+0.1,color='darkorange',lw=1.0,zorder=1)
plt.annotate(r'$H_{5}$ = ' + str(np.round(y5[iepoch],2)),(lintx(h5x,h5y,o6x,o6y,0.07),linty(h5x,h5y,o6x,o6y,0.07)+0.25),size=8,zorder=200,color='darkorange',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)

plt.annotate(r'$\frac{\partial P}{\partial O_{6_{in}}}$ = ' + str(np.round(d6[iepoch],2)),(o6x-0.5,o6y-0.7),size=10)
plt.annotate(r'$\frac{\partial P}{\partial H_{4_{in}}}$ = ' + str(np.round(d4[iepoch],2)),(h4x-0.5,h4y-0.7),size=10)
plt.annotate(r'$\frac{\partial P}{\partial H_{5_{in}}}$ = ' + str(np.round(d5[iepoch],2)),(h5x-0.5,h5y-0.7),size=10)

plt.annotate(r'$\frac{\partial P}{\partial \hat{y}}$ = ' + str(np.round(d6[iepoch],2)),(o6x,o6y-1.2),size=10)
plt.annotate(r'$\frac{\partial P}{\partial H_{4_{out}}}$ = ' + str(np.round(w46[iepoch]*d6[iepoch],2)),(h4x,h4y-1.2),size=10)
plt.annotate(r'$\frac{\partial P}{\partial H_{5_{out}}}$ = ' + str(np.round(w56[iepoch]*d6[iepoch],2)),(h5x,h5y-1.2),size=10)

plt.plot(lint_intx(h4x, h4y, o6x, o6y,0.4,0.6),lint_inty(h4x,h4y,o6x,o6y,0.4,0.6)-0.1,color='orange',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(o6x,o6y,h4x,h4y,0.4,0.6,0.2),lint_int_arry(o6x,o6y,h4x,h4y,0.4,0.6,0.2)-0.1,color='orange',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{4,6}}$ = ' + str(np.round(dw46[iepoch]/lr,4)),(lintx(h4x,h4y,o6x,o6y,0.5)-0.6,linty(h4x,h4y,o6x,o6y,0.5)-0.72),size=10,zorder=200,color='orange',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-11)

plt.plot(lint_intx(h5x, h5y, o6x, o6y,0.4,0.6),lint_inty(h5x,h5y,o6x,o6y,0.4,0.6)-0.1,color='darkorange',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(o6x,o6y,h5x,h5y,0.4,0.6,0.2),lint_int_arry(o6x,o6y,h5x,h5y,0.4,0.6,0.2)-0.1,color='darkorange',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{5,6}}$ = ' + str(np.round(dw56[iepoch]/lr,4)),(lintx(h5x,h5y,o6x,o6y,0.5)-0.4,linty(h5x,h5y,o6x,o6y,0.5)-0.6),size=10,zorder=200,color='darkorange',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)

plt.plot(offsetx(i1x,2,-20),offsety(i1y,2,-20)+0.1,color='lightcoral',lw=1.0,zorder=1)
plt.plot(offset_arrx(i1x,2,-20,0.2),offset_arry(i1y,2,-20,0.2)+0.1,color='lightcoral',lw=1.0,zorder=1)
plt.annotate(r'$I_{1}$ = ' + str(np.round(x1,2)),(lintx(i1x,i1y,h4x,h4y,0.1),linty(i1x,i1y,h4x,h4y,0.1)),size=8,zorder=200,color='lightcoral',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-20)

plt.plot(offsetx(i2x,2,12),offsety(i2y,2,12)+0.1,color='red',lw=1.0,zorder=1)
plt.plot(offset_arrx(i2x,2,12,0.2),offset_arry(i2y,2,12,0.2)+0.1,color='red',lw=1.0,zorder=1)
plt.annotate(r'$I_{2}$ = ' + str(np.round(x2,2)),(lintx(i2x,i2y,h4x,h4y,0.1),linty(i2x,i2y,h4x,h4y,0.1)+0.22),size=8,zorder=200,color='red',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)

plt.plot(offsetx(i3x,2,38),offsety(i3y,2,38)+0.1,color='darkred',lw=1.0,zorder=1)
plt.plot(offset_arrx(i3x,2,38,0.2),offset_arry(i3y,2,38,0.2)+0.1,color='darkred',lw=1.0,zorder=1)
plt.annotate(r'$I_{3}$ = ' + str(np.round(x3,2)),(lintx(i3x,i3y,h4x,h4y,0.08)-0.2,linty(i3x,i3y,h4x,h4y,0.08)+0.2),size=8,zorder=200,color='darkred',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=38)

plt.annotate(r'$\lambda_{1,4}$ = ' + str(np.round(w14[iepoch],2)),((i1x+h4x)*0.45,(i1y+h4y)*0.5-0.05),size=8,zorder=200,color='lightcoral',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-18) 
plt.annotate(r'$\lambda_{2,4}$ = ' + str(np.round(w24[iepoch],2)),((i2x+h4x)*0.45-0.3,(i2y+h4y)*0.5-0.03),size=8,zorder=200,color='red',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=10) 
plt.annotate(r'$\lambda_{3,4}$ = ' + str(np.round(w34[iepoch],2)),((i3x+h4x)*0.45-1.2,(i3y+h4y)*0.5-1.1),size=8,zorder=200,color='darkred',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=38) 

plt.annotate(r'$\lambda_{1,5}$ = ' + str(np.round(w15[iepoch],2)),((i1x+h5x)*0.55-2.5,(i1y+h5y)*0.5+0.9),size=8,zorder=200,color='dodgerblue',
    bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-36) 
plt.annotate(r'$\lambda_{2,5}$ = ' + str(np.round(w25[iepoch],2)),((i2x+h5x)*0.55-1.5,(i2y+h5y)*0.5+0.05),size=8,zorder=200,color='blue',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12) 
plt.annotate(r'$\lambda_{3,5}$ = ' + str(np.round(w35[iepoch],2)),((i3x+h5x)*0.55-1.0,(i3y+h5y)*0.5+0.1),size=8,zorder=200,color='darkblue',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=20) 

plt.annotate(r'$\lambda_{4,6}$ = ' + str(np.round(w46[iepoch],2)),((h4x+o6x)*0.47,(h4y+o6y)*0.47+0.39),size=8,zorder=200,color='orange',
    bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12) 
plt.annotate(r'$\lambda_{5,6}$ = ' + str(np.round(w56[iepoch],2)),((h5x+o6x)*0.47,(h5y+o6y)*0.47+0.26),size=8,zorder=200,color='darkorange',
    bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=12) 

plt.plot(lint_intx(i1x, i1y, h4x, h4y,0.4,0.6),lint_inty(i1x,i1y,h4x,h4y,0.4,0.6)-0.1,color='lightcoral',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h4x,h4y,i1x,i1y,0.4,0.6,0.2),lint_int_arry(h4x,h4y,i1x,i1y,0.4,0.6,0.2)-0.1,color='lightcoral',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{1,4}} =$' + r'${0:s}$'.format(as_si(dw14[iepoch]/lr,2)),(lintx(i1x,i1y,h4x,h4y,0.5)-0.6,linty(i1x,i1y,h4x,h4y,0.5)-1.0),size=8,zorder=200,color='lightcoral',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-20)

plt.plot(lint_intx(i2x, i2y, h4x, h4y,0.3,0.5),lint_inty(i2x,i2y,h4x,h4y,0.3,0.5)-0.1,color='red',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h4x,h4y,i2x,i2y,0.5,0.7,0.2),lint_int_arry(h4x,h4y,i2x,i2y,0.5,0.7,0.2)-0.12,color='red',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{2,4}} =$' + r'${0:s}$'.format(as_si(dw24[iepoch]/lr,2)),(lintx(i2x,i2y,h4x,h4y,0.5)-1.05,linty(i2x,i2y,h4x,h4y,0.5)-0.7),size=8,zorder=200,color='red',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)

plt.plot(lint_intx(i3x, i3y, h4x, h4y,0.2,0.4),lint_inty(i3x,i3y,h4x,h4y,0.2,0.4)-0.1,color='darkred',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h4x,h4y,i3x,i3y,0.5,0.8,0.2),lint_int_arry(h4x,h4y,i3x,i3y,0.5,0.8,0.2)-0.12,color='darkred',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{3,4}} =$' + r'${0:s}$'.format(as_si(dw34[iepoch]/lr,2)),(lintx(i3x,i3y,h4x,h4y,0.5)-1.7,linty(i3x,i3y,h4x,h4y,0.5)-1.7),size=8,zorder=200,color='darkred',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=38)

plt.plot(lint_intx(i3x, i3y, h5x, h5y,0.4,0.6),lint_inty(i3x,i3y,h5x,h5y,0.4,0.6)-0.1,color='darkblue',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h5x,h5y,i3x,i3y,0.4,0.6,0.2),lint_int_arry(h5x,h5y,i3x,i3y,0.4,0.6,0.2)-0.12,color='darkblue',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{3,5}} =$' + r'${0:s}$'.format(as_si(dw35[iepoch]/lr,2)),(lintx(i3x,i3y,h5x,h5y,0.5)-0.4,linty(i3x,i3y,h5x,h5y,0.5)-0.6),size=8,zorder=200,color='darkblue',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=20)

plt.plot(lint_intx(i2x, i2y, h5x, h5y,0.3,0.5),lint_inty(i2x,i2y,h5x,h5y,0.3,0.5)-0.1,color='blue',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h5x,h5y,i2x,i2y,0.3,0.7,0.2),lint_int_arry(h5x,h5y,i2x,i2y,0.3,0.7,0.2)-0.12,color='blue',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{2,5}} =$' + r'${0:s}$'.format(as_si(dw25[iepoch]/lr,2)),(lintx(i2x,i2y,h5x,h5y,0.5)-1.2,linty(i2x,i2y,h5x,h5y,0.5)-0.65),size=8,zorder=200,color='blue',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12)

plt.plot(lint_intx(i1x, i1y, h5x, h5y,0.2,0.4),lint_inty(i1x,i1y,h5x,h5y,0.2,0.4)-0.1,color='dodgerblue',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h5x,h5y,i1x,i1y,0.2,0.8,0.2),lint_int_arry(h5x,h5y,i1x,i1y,0.2,0.8,0.2)-0.12,color='dodgerblue',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{1,5}} =$' + r'${0:s}$'.format(as_si(dw15[iepoch]/lr,2)),(lintx(i1x,i1y,h5x,h5y,0.5)-2.2,linty(i1x,i1y,h4x,h4y,0.5)-1.5),size=8,zorder=200,color='dodgerblue',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-36,xycoords = 'data')

plt.subplots_adjust(left=0.0, bottom=0.0, right=1.5, top=1.0, wspace=0.2, hspace=0.2); plt.show() 
```

![å›¾ç‰‡](img/6c1b34f06ebf3ebfafbbd206fc1033ca.png)

## æ£€æŸ¥ ANN æ”¶æ•›æ€§

ç°åœ¨æˆ‘ä»¬ç»˜åˆ¶æƒé‡ã€åå·®å’Œé¢„æµ‹å€¼éšæ—¶é—´æ­¥é•¿çš„å˜åŒ–ï¼Œä»¥æ£€æŸ¥è®­ç»ƒçš„æ”¶æ•›æ€§ã€‚

```py
plt.subplot(131)
plt.plot(np.arange(1,nepoch+1,1),y6,color='red',label=r'$\hat{y}$'); plt.xlim([1,nepoch]); plt.ylim([0,1])
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('Simple Artificial Neural Network Prediction')
plt.plot([1,nepoch],[y,y],color='black',ls='--'); plt.vlines(400,-1.5,1.5,color='black')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(132)
plt.plot(np.arange(1,nepoch+1,1),w14,color='lightcoral',label = r'$\lambda_{1,4}$') 
plt.plot(np.arange(1,nepoch+1,1),w24,color='red',label = r'$\lambda_{2,4}$') 
plt.plot(np.arange(1,nepoch+1,1),w34,color='darkred',label = r'$\lambda_{3,4}$') 
plt.plot(np.arange(1,nepoch+1,1),w15,color='dodgerblue',label = r'$\lambda_{1,5}$') 
plt.plot(np.arange(1,nepoch+1,1),w25,color='blue',label = r'$\lambda_{2,5}$') 
plt.plot(np.arange(1,nepoch+1,1),w35,color='darkblue',label = r'$\lambda_{3,5}$')
plt.plot(np.arange(1,nepoch+1,1),w46,color='orange',label = r'$\lambda_{4,6}$')
plt.plot(np.arange(1,nepoch+1,1),w56,color='darkorange',label = r'$\lambda_{5,6}$')
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('Simple Artificial Neural Network Weights')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(133)
plt.plot(np.arange(1,nepoch+1,1),w14,color='lightgreen',label = r'$\phi_{4}$') 
plt.plot(np.arange(1,nepoch+1,1),w24,color='green',label = r'$\phi_{5}$') 
plt.plot(np.arange(1,nepoch+1,1),w34,color='darkgreen',label = r'$\phi_{6}$') 
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('Simple Artificial Neural Network Biases')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplots_adjust(left=0.0, bottom=0.0, right=3.0, top=1.0, wspace=0.2, hspace=0.2); plt.show() 
```

![å›¾ç‰‡](img/41e5da630bdb6e70068ef584a2fc3d47.png)

## æ³¨é‡Š

è¿™æ˜¯å¯¹äººå·¥ç¥ç»ç½‘ç»œçš„åŸºæœ¬å¤„ç†ã€‚å¯ä»¥åšå’Œè®¨è®ºçš„è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘æœ‰å¾ˆå¤šå…¶ä»–èµ„æºã€‚è¯·æŸ¥çœ‹æˆ‘çš„[å…±äº«èµ„æºæ¸…å•](https://michaelpyrcz.com/my-resources)ä»¥åŠæœ¬ç« å¼€å¤´å¸¦æœ‰èµ„æºé“¾æ¥çš„ YouTube è®²åº§é“¾æ¥ã€‚

å¸Œæœ›è¿™æœ‰æ‰€å¸®åŠ©ï¼Œ

*è¿ˆå…‹å°”*

## å…³äºä½œè€…

![å›¾ç‰‡](img/eb709b2c0a0c715da01ae0165efdf3b2.png)

å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ 40 è‹±äº©æ ¡å›­å†…ï¼Œè¿ˆå…‹å°”Â·çš®å°”å¥‡æ•™æˆçš„åŠå…¬å®¤ã€‚

è¿ˆå…‹å°”Â·çš®å°”å¥‡æ˜¯å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡[Cockrell å·¥ç¨‹å­¦é™¢](https://cockrell.utexas.edu/faculty-directory/alphabetical/p)å’Œ[æ°å…‹é€Šåœ°çƒç§‘å­¦å­¦é™¢](https://www.jsg.utexas.edu/researcher/michael_pyrcz/)çš„æ•™æˆï¼Œåœ¨é‚£é‡Œä»–ä»äº‹å’Œæ•™æˆåœ°ä¸‹ã€ç©ºé—´æ•°æ®åˆ†æã€åœ°ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ã€‚è¿ˆå…‹å°”è¿˜ï¼Œ

+   æ˜¯[èƒ½æºåˆ†æ](https://fri.cns.utexas.edu/energy-analytics)æ–°ç”Ÿç ”ç©¶é¡¹ç›®çš„é¦–å¸­ç ”ç©¶å‘˜ï¼Œå¹¶åœ¨å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡è‡ªç„¶ç§‘å­¦å­¦é™¢æœºå™¨å­¦ä¹ å®éªŒå®¤æ‹…ä»»æ ¸å¿ƒæ•™å‘˜

+   [è®¡ç®—æœºä¸åœ°çƒç§‘å­¦](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board)çš„å‰¯ç¼–è¾‘ï¼Œä»¥åŠå›½é™…æ•°å­¦åœ°çƒç§‘å­¦åä¼š[æ•°å­¦åœ°çƒç§‘å­¦](https://link.springer.com/journal/11004/editorial-board)çš„è‘£äº‹ä¼šæˆå‘˜ã€‚

è¿ˆå…‹å°”å·²ç»æ’°å†™äº†è¶…è¿‡ 70 ç¯‡[åŒè¡Œè¯„å®¡çš„å‡ºç‰ˆç‰©](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en)ï¼Œä¸€ä¸ªç”¨äºç©ºé—´æ•°æ®åˆ†æçš„[Python åŒ…](https://pypi.org/project/geostatspy/)ï¼Œåˆè‘—äº†ä¸€æœ¬å…³äºç©ºé—´æ•°æ®åˆ†æçš„æ•™ç§‘ä¹¦[åœ°ç»Ÿè®¡å­¦å‚¨å±‚å»ºæ¨¡](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)ï¼Œå¹¶æ˜¯ä¸¤æœ¬æœ€è¿‘å‘å¸ƒçš„ç”µå­ä¹¦çš„ä½œè€…ï¼Œ[Python åº”ç”¨åœ°ç»Ÿè®¡å­¦ï¼šGeostatsPy å®è·µæŒ‡å—](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)å’Œ[Python åº”ç”¨æœºå™¨å­¦ä¹ ï¼šä»£ç å®è·µæŒ‡å—](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html)ã€‚

è¿ˆå…‹å°”çš„æ‰€æœ‰å¤§å­¦è®²åº§éƒ½å¯ä»¥åœ¨ä»–çš„[YouTube é¢‘é“](https://www.youtube.com/@GeostatsGuyLectures)ä¸Šæ‰¾åˆ°ï¼Œå…¶ä¸­åŒ…å« 100 å¤šä¸ª Python äº¤äº’å¼ä»ªè¡¨æ¿å’Œ 40 å¤šä¸ª GitHub ä»“åº“ä¸­çš„è¯¦ç»†æ–‡æ¡£å·¥ä½œæµç¨‹ï¼Œä»¥æ”¯æŒä»»ä½•æ„Ÿå…´è¶£çš„å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«ã€‚è¦äº†è§£æ›´å¤šå…³äºè¿ˆå…‹å°”çš„å·¥ä½œå’Œå…±äº«æ•™è‚²èµ„æºï¼Œè¯·è®¿é—®ä»–çš„ç½‘ç«™ã€‚

## æƒ³è¦ä¸€èµ·å·¥ä½œå—ï¼Ÿ

æˆ‘å¸Œæœ›è¿™ä¸ªå†…å®¹å¯¹é‚£äº›æƒ³äº†è§£æ›´å¤šå…³äºåœ°ä¸‹å»ºæ¨¡ã€æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ çš„äººæœ‰æ‰€å¸®åŠ©ã€‚å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«éƒ½æ¬¢è¿å‚åŠ ã€‚

+   æƒ³é‚€è¯·æˆ‘åˆ°è´µå…¬å¸è¿›è¡ŒåŸ¹è®­ã€è¾…å¯¼ã€é¡¹ç›®å®¡æŸ¥ã€å·¥ä½œæµç¨‹è®¾è®¡å’Œ/æˆ–å’¨è¯¢ï¼Ÿæˆ‘å¾ˆä¹æ„æ‹œè®¿å¹¶ä¸æ‚¨åˆä½œï¼

+   æ„Ÿå…´è¶£åˆä½œã€æ”¯æŒæˆ‘çš„ç ”ç©¶ç”Ÿç ”ç©¶æˆ–æˆ‘çš„åœ°ä¸‹æ•°æ®åˆ†æä¸æœºå™¨å­¦ä¹ è”ç›Ÿï¼ˆå…±åŒè´Ÿè´£äººæ˜¯çº¦ç¿°Â·ç¦æ–¯ç‰¹æ•™æˆï¼‰ï¼Ÿæˆ‘çš„ç ”ç©¶å°†æ•°æ®åˆ†æã€éšæœºå»ºæ¨¡å’Œæœºå™¨å­¦ä¹ ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œä»¥å¼€å‘æ–°çš„æ–¹æ³•å’Œå·¥ä½œæµç¨‹ï¼Œå¢åŠ ä»·å€¼ã€‚æˆ‘ä»¬æ­£åœ¨è§£å†³å…·æœ‰æŒ‘æˆ˜æ€§çš„åœ°ä¸‹é—®é¢˜ï¼

+   æˆ‘å¯ä»¥é€šè¿‡ mpyrcz@austin.utexas.edu è”ç³»ã€‚

æˆ‘æ€»æ˜¯å¾ˆé«˜å…´è®¨è®ºï¼Œ

*è¿ˆå…‹å°”*

Michael Pyrczï¼Œåšå£«ï¼ŒP.Eng. æ•™æˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ Cockrell å·¥ç¨‹å­¦é™¢å’Œ Jackson åœ°çƒç§‘å­¦å­¦é™¢

æ›´å¤šèµ„æºå¯åœ¨ä»¥ä¸‹é“¾æ¥è·å–ï¼š[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy) | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao) | [åœ°ç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446) | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python ä¸­åº”ç”¨åœ°ç»Ÿè®¡å­¦ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)

## åŠ¨æœº

äººå·¥ç¥ç»ç½‘ç»œéå¸¸å¼ºå¤§ï¼Œæ˜¯åŸºäºå¤§è„‘ç±»æ¯”çš„è‡ªç„¶å¯å‘è®¡ç®—

+   æˆ‘è®¤ä¸ºå®ƒä»¬å°±åƒçˆ¬è¡ŒåŠ¨ç‰©çš„å¤§è„‘ï¼Œæ²¡æœ‰è®¡åˆ’å’Œé«˜çº§æ¨ç†

æ­¤å¤–ï¼Œäººå·¥ç¥ç»ç½‘ç»œæ˜¯è®¸å¤šå…¶ä»–æ·±åº¦å­¦ä¹ æ–¹æ³•çš„åŸºçŸ³ï¼Œä¾‹å¦‚ï¼Œ

+   å·ç§¯ç¥ç»ç½‘ç»œ

+   å¾ªç¯ç¥ç»ç½‘ç»œ

+   ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ

+   è‡ªåŠ¨ç¼–ç å™¨

è‡ªç„¶å¯å‘è®¡ç®—æ­£åœ¨å¯»æ‰¾è‡ªç„¶ç•Œä¸­çš„çµæ„Ÿæ¥å¼€å‘æ–°çš„é—®é¢˜è§£å†³æ–¹æ³•ï¼Œ

+   **äººå·¥ç¥ç»ç½‘ç»œ**æ˜¯å—ç”Ÿç‰©ç¥ç»ç½‘ç»œå¯å‘çš„

+   **èŠ‚ç‚¹** - åœ¨æˆ‘ä»¬çš„æ¨¡å‹ä¸­æ˜¯äººå·¥ç¥ç»å…ƒï¼Œç®€å•çš„å¤„ç†å™¨

+   **èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥æ˜¯äººå·¥çªè§¦**

æ™ºèƒ½æ˜¯ä»è®¸å¤šè¿æ¥çš„ç®€å•å¤„ç†å™¨ä¸­äº§ç”Ÿçš„ã€‚åœ¨æœ¬ç« çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘å°†ä½¿ç”¨èŠ‚ç‚¹å’Œè¿æ¥è¿™ä¸¤ä¸ªæœ¯è¯­æ¥æè¿°æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œã€‚

## ç¥ç»ç½‘ç»œæ¦‚å¿µ

è¿™é‡Œæ˜¯äººå·¥ç¥ç»ç½‘ç»œçš„ä¸€äº›å…³é”®æ–¹é¢ï¼Œ

**åŸºæœ¬è®¾è®¡** - *â€œâ€¦ä¸€ä¸ªç”±è®¸å¤šç®€å•ã€é«˜åº¦äº’è”çš„å¤„ç†å…ƒç´ ç»„æˆçš„è®¡ç®—ç³»ç»Ÿï¼Œå®ƒä»¬é€šè¿‡å¯¹å¤–éƒ¨è¾“å…¥çš„åŠ¨æ€çŠ¶æ€å“åº”æ¥å¤„ç†ä¿¡æ¯ã€‚â€* Caudill (1989)ã€‚

**ä»ç„¶æ˜¯ä¸€ä¸ªé¢„æµ‹æ¨¡å‹** - è™½ç„¶è¿™äº›æ¨¡å‹å¯èƒ½éå¸¸å¤æ‚ï¼Œç”šè‡³æœ‰æ•°ç™¾ä¸‡ä¸ªå¯è®­ç»ƒçš„æ¨¡å‹å‚æ•°ã€æƒé‡å’Œåå·®ï¼Œä½†å®ƒä»¬ä»ç„¶æ˜¯ä¸€ä¸ªä»é¢„æµ‹ç‰¹å¾æ˜ å°„åˆ°å“åº”ç‰¹å¾çš„å‡½æ•°ï¼Œ

$$ Y=f(X)+\epsilon $$

**ç›‘ç£å­¦ä¹ ** â€“ æˆ‘ä»¬æä¾›å¸¦æœ‰é¢„æµ‹ç‰¹å¾çš„æ•°æ®é›†ï¼Œ$X_1,\ldots,ğ‘‹_ğ‘š$ å’Œå“åº”ç‰¹å¾ï¼ˆsï¼‰ï¼Œ$ğ‘Œ_1,\ldots,ğ‘Œ_K$ï¼ŒæœŸæœ›æŸç§æ¨¡å‹é¢„æµ‹è¯¯å·®ï¼Œ$\epsilon$ã€‚

**éçº¿æ€§** - é€šè¿‡åº”ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°æ¥æ¨¡å‹éçº¿æ€§å…³ç³»ï¼Œå°†éçº¿æ€§å¼•å…¥ç³»ç»Ÿ

**é€šç”¨å‡½æ•°é€¼è¿‘å™¨ï¼ˆé€šç”¨é€¼è¿‘å®šç†ï¼‰** - ANNs èƒ½å¤Ÿå­¦ä¹ åœ¨ä»»æ„å®½ï¼ˆå•éšè—å±‚ï¼‰å’Œä»»æ„æ·±åº¦ï¼ˆLu ç­‰äººï¼Œ2017ï¼‰çš„åŒºé—´å†…$f$çš„ä»»ä½•å¯èƒ½å‡½æ•°å½¢çŠ¶ï¼Œç”± Cybenko (1989) å’Œ Lu åŠå…¶åŒäº‹æå‡º

## ä¸€ä¸ªç®€å•çš„ç½‘ç»œ

è¦å¼€å§‹ï¼Œè®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œå•éšè—å±‚ï¼Œå…¨è¿æ¥ï¼Œå‰é¦ˆç¥ç»ç½‘ç»œï¼Œ

![](img/832ee38f2f09d395115eb31b95358103.png)

ç®€å•æ¼”ç¤ºäººå·¥ç¥ç»ç½‘ç»œã€‚

æˆ‘ä»¬åœ¨ä¸‹é¢çš„æè¿°ä¸­ä½¿ç”¨è¿™ä¸ªç¤ºä¾‹äººå·¥ç¥ç»ç½‘ç»œï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªæˆ‘ä»¬å°†é€šè¿‡æ‰‹å·¥è®­ç»ƒå’Œé¢„æµ‹çš„å®é™…ç¤ºä¾‹ï¼

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ ‡æ³¨æˆ‘ä»¬ç½‘ç»œçš„éƒ¨åˆ†ï¼Œ

![](img/0be0dcf09e698cf22dc0881c818c0dbc.png)

æ ‡æ³¨äº†éƒ¨åˆ†çš„ç®€å•æ¼”ç¤ºäººå·¥ç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬ 3 ä¸ªè¾“å…¥èŠ‚ç‚¹ã€2 ä¸ªéšè—èŠ‚ç‚¹å’Œ 1 ä¸ªå®Œå…¨è¿æ¥çš„è¾“å‡ºèŠ‚ç‚¹ã€‚

æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œå…·æœ‰ï¼Œ

+   3 ä¸ªé¢„æµ‹ç‰¹å¾ï¼Œ$X_1$ã€$X_2$ å’Œ $X_3$

+   3 ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œ$I_1$ã€$I_2$ å’Œ $I_3$

+   2 ä¸ªéšè—å±‚èŠ‚ç‚¹ï¼Œ$H_4$ å’Œ $H_5$

+   1 ä¸ªè¾“å‡ºèŠ‚ç‚¹ï¼Œ$O_6$

+   1 ä¸ªå“åº”ç‰¹å¾ï¼Œ$Y_1$

å…¶ä¸­æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯å®Œå…¨è¿æ¥çš„ã€‚æ³¨æ„ï¼Œæ·±åº¦å­¦ä¹ æ˜¯ä¸€ä¸ªå…·æœ‰è¶…è¿‡ 1 ä¸ªéšè—å±‚çš„ç¥ç»ç½‘ç»œï¼Œä½†ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨æˆ‘ä»¬çš„éæ·±åº¦å­¦ä¹ äººå·¥ç¥ç»ç½‘ç»œã€‚

## å…³äºç½‘ç»œå‘½åæ³•çš„æ³¨é‡Š

å…³äºæˆ‘çš„ç½‘ç»œå‘½åæ³•è¿˜æœ‰ä¸€äº›é¢å¤–çš„æ³¨é‡Šã€‚æˆ‘çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–ç®€æ´æ€§å’Œæ¸…æ™°åº¦ï¼Œ

+   **ç½‘ç»œèŠ‚ç‚¹å’Œè¿æ¥** - æˆ‘é€‰æ‹©ä¸ºæ‰€æœ‰èŠ‚ç‚¹ä½¿ç”¨å”¯ä¸€çš„æ•°å­—ï¼Œ$I_1$ã€$I_2$ã€$I_3$ã€$H_4$ã€$H_5$ å’Œ $O_6$ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªå±‚ä¸­é‡å¤æ•°å­—ï¼Œ$I_1$ã€$I_2$ã€$I_3$ã€$H_1$ã€$H_2$ å’Œ $O_1$ï¼Œä»¥ç®€åŒ–æƒé‡çš„è¡¨ç¤ºï¼›å› æ­¤ï¼Œå½“æˆ‘è¯´ $\lambda_{1,4}$ æ—¶ï¼Œä½ çŸ¥é“è¿™ä¸ªæƒé‡åœ¨ç½‘ç»œçš„å“ªä¸ªä½ç½®åº”ç”¨ï¼Œä»èŠ‚ç‚¹ $I_1$ åˆ°èŠ‚ç‚¹ $H_4$ã€‚

+   **èŠ‚ç‚¹è¾“å‡º** - æˆ‘ä½¿ç”¨èŠ‚ç‚¹æ ‡ç­¾æ¥æè¿°èŠ‚ç‚¹çš„è¾“å‡ºï¼Œä¾‹å¦‚ $O_6$ æ˜¯è¾“å‡ºèŠ‚ç‚¹ï¼Œ$O_6$ï¼Œä»¥åŠä»èŠ‚ç‚¹ $O_6$ è¾“å‡ºçš„ä¿¡å·æˆ–å€¼ï¼Œ

$$ O_6 = \sigma \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 \right) $$

+   **å‰æ¿€æ´»å’Œåæ¿€æ´»** - åœ¨æˆ‘ä»¬çš„èŠ‚ç‚¹ $H_4$ã€$H_5$ å’Œ $O_6$ ä¸Šï¼Œæˆ‘ä»¬æœ‰èŠ‚ç‚¹æ¿€æ´»å‰çš„è¾“å…¥å’Œæ¿€æ´»åçš„è¾“å‡ºï¼Œæˆ‘ä½¿ç”¨ $H_{4_{in}}$ã€$H_{5_{in}}$ å’Œ $O_{6_{in}}$ è¡¨ç¤ºå‰æ¿€æ´»è¾“å…¥ï¼Œ

$$ H_{4_{in}} = \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 $$$$ H_{5_{in}} = \lambda_{1,5} \cdot I_1 + \lambda_{2,5} \cdot I_2 + \lambda_{2,5} \cdot I_3 $$$$ O_{6_{in}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 $$

$\quad$ ä»¥åŠ $H_4$ã€$H_5$ å’Œ $O_6$ ä½œä¸ºåæ¿€æ´»èŠ‚ç‚¹çš„è¾“å‡ºã€‚

$$ H_{4} = \sigma \left( H_{4_{in}} \right) = \sigma \left( \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 \right) $$$$ H_{5} = \sigma \left( H_{5_{in}} \right) = \sigma \left( \lambda_{1,5} \cdot I_1 + \lambda_{2,5} \cdot I_2 + \lambda_{2,5} \cdot I_3 \right) $$$$ O_6 = \sigma \left( O_{6_{in}} \right) = \sigma \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 \right) $$

æ¸…æ™°ã€æ¸…æ™°çš„ç¬¦å·å¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨ä½¿ç”¨åå‘ä¼ æ’­æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»éå†èŠ‚ç‚¹ï¼Œä»åæ¿€æ´»åˆ°å‰æ¿€æ´»ã€‚

+   åœ¨ç¥ç»ç½‘ç»œæ–‡çŒ®ä¸­ï¼Œç»å¸¸ä½¿ç”¨åƒ $z$ è¿™æ ·çš„å˜é‡è¿›è¡Œé¢„æ¿€æ´»ï¼Œä½†æˆ‘æ„Ÿè§‰è¿™å¾ˆæ¨¡ç³Šï¼Œå¯èƒ½ä¼šå¼•èµ·æ··æ·†ï¼Œå› ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªèºä¸é’‰å’Œèºæ¯çš„æ–¹æ³•ï¼Œæ˜ç¡®æè¿°æ¯ä¸ªæ–¹ç¨‹ï¼Œä»¥ç²¾ç¡®æè¿°ç¥ç»ç½‘ç»œæ˜¯å¦‚ä½•è®­ç»ƒå’Œé¢„æµ‹çš„

## ç½‘ç»œæ–¹æ³•æè¿°

è®©æˆ‘ä»¬è°ˆè°ˆç½‘ç»œï¼Œå…¶ç»„æˆéƒ¨åˆ†ä»¥åŠä¿¡æ¯å¦‚ä½•é€šè¿‡ç½‘ç»œæµåŠ¨ã€‚

**å‰é¦ˆ** â€“ æ‰€æœ‰ä¿¡æ¯ä»å·¦åˆ°å³æµåŠ¨ã€‚æ¯ä¸ªèŠ‚ç‚¹é€šè¿‡è¿æ¥å°†ç›¸åŒçš„ä¿¡å·å‘é€åˆ°ä¸‹ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œ

![](img/02be26cd4d5476666cd2e1a72c3005fe.png)

å‰é¦ˆï¼Œå…¨è¿æ¥ï¼Œæ¯ä¸ªèŠ‚ç‚¹å°†ç›¸åŒçš„ä¿¡å·å‘é€åˆ°ä¸‹ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚

**è¾“å…¥å±‚** - è¾“å…¥ç‰¹å¾ç›´æ¥ä¼ é€’åˆ°è¾“å…¥èŠ‚ç‚¹ï¼Œå¯¹äºè¿ç»­é¢„æµ‹ç‰¹å¾ï¼Œæ¯ä¸ªç‰¹å¾æœ‰ä¸€ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œç‰¹å¾æ˜¯ï¼Œ

+   å°†æœ€å°/æœ€å¤§å½’ä¸€åŒ–åˆ°èŒƒå›´ $\left[ âˆ’1,1 \right]$ æˆ– $\left[ 0,1 \right]$ ä»¥æé«˜æ¿€æ´»å‡½æ•°çš„æ•æ„Ÿæ€§ï¼Œå¹¶æ¶ˆé™¤é¢„æµ‹ç‰¹å¾ä¸­å°ºåº¦å·®å¼‚çš„å½±å“ï¼Œä»¥æé«˜è§£å†³æ–¹æ¡ˆçš„ç¨³å®šæ€§ï¼Œå³ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¹³æ»‘å‡å°‘è®­ç»ƒæŸå¤±

![](img/cb20e85861a55df55677b55ce737bbd5.png)

çªå‡ºæ˜¾ç¤ºè¾“å…¥å±‚ï¼Œæ¥æ”¶å½’ä¸€åŒ–é¢„æµ‹ç‰¹å¾çš„ç¬¬ä¸€å±‚ã€‚

å¯¹äºåˆ†ç±»é¢„æµ‹ç‰¹å¾ï¼Œæ¯ä¸ªé¢„æµ‹ç‰¹å¾æ¯ä¸ªç±»åˆ«éƒ½æœ‰ä¸€ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œå³ç‰¹å¾ç»è¿‡ç‹¬çƒ­ç¼–ç åï¼Œæ¯ä¸ªç¼–ç ä¼ é€’åˆ°ä¸€ä¸ªå•ç‹¬çš„è¾“å…¥èŠ‚ç‚¹ã€‚

+   å›å¿†ä¸€ä¸‹ç‹¬çƒ­ç¼–ç ï¼Œå¦‚æœå±äºç‰¹å®šç±»åˆ«ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0ï¼Œç”¨é•¿åº¦ç­‰äºç±»åˆ«æ•°é‡çš„äºŒè¿›åˆ¶å‘é‡æ›¿æ¢åˆ†ç±»ç‰¹å¾ã€‚

![](img/51d695aaaa36c3450f3997691fb0090f.png)

æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œè¾“å…¥å±‚è¢«çªå‡ºæ˜¾ç¤ºã€‚æ¥æ”¶å•ä¸ªåˆ†ç±»é¢„æµ‹ç‰¹å¾ç‹¬çƒ­ç¼–ç çš„ç¬¬ä¸€å±‚ã€‚

+   æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ºæ¯ä¸ªåˆ†ç±»é¢„æµ‹ç‰¹å¾ä½¿ç”¨å•ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œå¹¶ä¸ºæ¯ä¸ªç±»åˆ«åˆ†é…é˜ˆå€¼ï¼Œä¾‹å¦‚å¯¹äº 3 ä¸ªç±»åˆ«ï¼Œ$\left[ 0.0, 0.5, 1.0 \right]$ï¼Œä½†è¿™å‡è®¾åˆ†ç±»ç‰¹å¾æ˜¯æœ‰åºçš„

**éšè—å±‚** - è¾“å…¥å±‚å€¼ $I_1, I_2, I_2$ ä¸å¯å­¦ä¹ çš„æƒé‡ç›¸ä¹˜ï¼Œ

$$ \lambda_{1,4}, \lambda_{2,4}, \lambda_{3,4}, \lambda_{1,5}, \lambda_{2,5}, \lambda_{3,5} $$

+   åœ¨éšè—å±‚èŠ‚ç‚¹ä¸­ï¼ŒåŠ æƒè¾“å…¥å±‚å€¼ $\lambda_{1,4} \cdot I_1, \lambda_{2,4} \cdot I_2 \cdot I_2, \ldots, \lambda_{3,5} \cdot I_3$ ä¸æ¯ä¸ªèŠ‚ç‚¹ä¸­å¯è®­ç»ƒåç½®é¡¹çš„åŠ å’Œç›¸åŠ ï¼Œ$b_4$ å’Œ $b_5$ã€‚

$$ H_{4_{in}} = \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 $$$$ H_{5_{in}} = \lambda_{1,5} \cdot I_1 + \lambda_{2,5} \cdot I_2 + \lambda_{3,5} \cdot I_3 + b_5 $$

åº”ç”¨éçº¿æ€§æ¿€æ´»ï¼Œ

$$ H_{4} = \sigma \bigl( \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 \bigr) $$$$ H_{5} = \sigma \bigl( \lambda_{1,5} \cdot I_1 + \lambda_{2,5} \cdot I_2 + \lambda_{3,5} \cdot I_3 + b_5 \bigr) $$

+   è¾“å…¥å±‚èŠ‚ç‚¹åˆ°æ‰€æœ‰éšè—å±‚èŠ‚ç‚¹çš„è¾“å‡ºæ˜¯æ’å®šçš„ï¼ˆå†æ¬¡å¼ºè°ƒï¼Œæ¯ä¸ªèŠ‚ç‚¹å°†ç›¸åŒçš„å€¼å‘é€åˆ°ä¸‹ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ï¼‰

![](img/e2342c26953974528579d98e504c15c8.png)

æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œéšè—å±‚è¢«çªå‡ºæ˜¾ç¤ºã€‚è¾“å…¥å±‚èŠ‚ç‚¹çš„è¾“å‡ºè¢«åŠ æƒå¹¶ä¼ é€’åˆ°éšè—å±‚èŠ‚ç‚¹ã€‚éšè—å±‚èŠ‚ç‚¹åˆ°æ‰€æœ‰è¾“å‡ºå±‚èŠ‚ç‚¹çš„è¾“å‡ºæ˜¯æ’å®šçš„ã€‚

**è¾“å‡ºå±‚** - å¯¹äºè¿ç»­å“åº”ç‰¹å¾ï¼Œæ¯ä¸ªå½’ä¸€åŒ–å“åº”ç‰¹å¾æœ‰ä¸€ä¸ªè¾“å‡ºèŠ‚ç‚¹ã€‚å†æ¬¡è®¡ç®—è¾“å…¥çš„åŠ æƒçº¿æ€§ç»„åˆåŠ ä¸ŠèŠ‚ç‚¹åç½®ï¼Œ

$$ O_{6_{in}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

ç„¶ååº”ç”¨æ¿€æ´»å‡½æ•°ï¼Œä½†å¯¹äºè¿ç»­å“åº”ç‰¹å¾ï¼Œé€šå¸¸åº”ç”¨æ’ç­‰ï¼ˆçº¿æ€§ï¼‰å˜æ¢ï¼Œ

$$ O_6 = \alpha \bigl( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \bigr) = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 = O_{6_{in}} $$

+   ç„¶åä»å½’ä¸€åŒ–åˆ°åŸå§‹å“åº”ç‰¹å¾çš„åè½¬æ¢è¢«åº”ç”¨ï¼Œä»¥æ¢å¤æœ€ç»ˆçš„é¢„æµ‹

+   ä¸è¿ç»­é¢„æµ‹ç‰¹å¾ä¸€æ ·ï¼Œå¯¹è¿ç»­å“åº”ç‰¹å¾åº”ç”¨æœ€å°/æœ€å¤§å½’ä¸€åŒ–ï¼Œå°†å…¶èŒƒå›´è°ƒæ•´ä¸º[âˆ’1,1]æˆ–[0,1]ï¼Œä»¥æé«˜æ¿€æ´»å‡½æ•°çš„æ•æ„Ÿæ€§

![](img/87d8ca10f44d6d5d97c7e6ced2d415e5.png)

æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œè¾“å‡ºå±‚è¢«çªå‡ºæ˜¾ç¤ºã€‚éšè—å±‚èŠ‚ç‚¹çš„è¾“å‡ºè¢«åŠ æƒå¹¶ä¼ é€’åˆ°è¾“å‡ºå±‚èŠ‚ç‚¹ã€‚éšè—å±‚èŠ‚ç‚¹çš„è¾“å‡ºæ˜¯æ’å®šçš„ï¼Œä½†æƒé‡åœ¨éšè—å±‚èŠ‚ç‚¹åˆ°è¾“å‡ºå±‚èŠ‚ç‚¹çš„è¿æ¥ä¸­å˜åŒ–ã€‚

åœ¨åˆ†ç±»å“åº”ç‰¹å¾çš„æƒ…å†µä¸‹ï¼Œå†æ¬¡åº”ç”¨ one-hot ç¼–ç ï¼Œå› æ­¤ï¼Œæ¯ä¸ªç±»åˆ«æœ‰ä¸€ä¸ªè¾“å‡ºèŠ‚ç‚¹ã€‚

+   é¢„æµ‹æ˜¯æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡

![](img/11c0969ef52f11e6929df9ff8e4d92c2.png)

çªå‡ºæ˜¾ç¤ºè¾“å…¥å±‚ï¼Œè¿™æ˜¯æ¥æ”¶å•ä¸ªåˆ†ç±»é¢„æµ‹ç‰¹å¾ one-hot ç¼–ç çš„ç¬¬ä¸€å±‚ã€‚

## éå†ç½‘ç»œ

ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½éå†äººå·¥ç¥ç»ç½‘ç»œã€‚

+   æˆ‘ä»¬éµå¾ªå•ä¸€è·¯å¾„æ¥å±•ç¤ºä¸ä½¿ç”¨äººå·¥ç¥ç»ç½‘ç»œè¿›è¡Œé¢„æµ‹ç›¸å…³çš„ç²¾ç¡®è®¡ç®—

ä¸‹ä¸€ä¸ªå°†è§£é‡Šå®Œæ•´çš„æ­£å‘ä¼ æ’­ã€‚

**è¾“å…¥å±‚èŠ‚ç‚¹å†…éƒ¨** - è¾“å…¥å±‚èŠ‚ç‚¹åªæ˜¯ä¼ é€’é¢„æµ‹ç‰¹å¾ï¼Œ

+   æ ‡å‡†åŒ–çš„è¿ç»­é¢„æµ‹ç‰¹å¾å€¼

+   å¯¹äºåˆ†ç±»é¢„æµ‹ç‰¹å¾ï¼Œæœ‰ä¸€ä¸ªå•ç‹¬çš„ one-hot ç¼–ç å€¼[0 æˆ– 1]

è¿›å…¥éšè—å±‚èŠ‚ç‚¹ï¼Œä½¿ç”¨ä¸€èˆ¬çš„å‘é‡è¡¨ç¤ºï¼Œ

$$ I = X $$![](img/4e1c6258eff75f9d4ce767b39cd522fb.png)

äººå·¥ç¥ç»ç½‘ç»œçš„å·¥ä½œåŸç†ï¼Œè¾“å…¥å±‚èŠ‚ç‚¹æ¥æ”¶å•ä¸ªåˆ†ç±»é¢„æµ‹ç‰¹å¾çš„ one-hot ç¼–ç ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™æ‰€æœ‰éšè—å±‚èŠ‚ç‚¹ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼å¯¹æ‰€æœ‰è¾“å…¥å±‚èŠ‚ç‚¹è¿›è¡Œæ³›åŒ–ï¼Œ

$$ H_j = H_{j_{in}} = X_j $$

**éšè—å±‚èŠ‚ç‚¹å†…éƒ¨**

éšè—å±‚èŠ‚ç‚¹æ˜¯ç®€å•çš„å¤„ç†å™¨ã€‚å®ƒä»¬å¯¹è¾“å…¥è¿›è¡Œçº¿æ€§åŠ æƒç»„åˆï¼Œæ·»åŠ èŠ‚ç‚¹åå·®é¡¹ï¼Œç„¶åéçº¿æ€§åœ°è½¬æ¢ç»“æœï¼Œè¿™ç§è½¬æ¢ç§°ä¸ºæ¿€æ´»å‡½æ•°ï¼Œ$\alpha$ã€‚

+   ç¡®å®ï¼Œä¸€ä¸ªéå¸¸ç®€å•çš„å¤„ç†å™¨ï¼

+   é€šè¿‡è®¸å¤šç›¸äº’è¿æ¥çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬è·å¾—ä¸€ä¸ªéå¸¸çµæ´»çš„é¢„æµ‹å™¨ï¼Œæ¶Œç°å‡ºè¡¨å¾å¤æ‚ã€éçº¿æ€§æ¨¡å¼çš„èƒ½åŠ›ã€‚

åœ¨æ¿€æ´»ä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰ï¼Œ

$$ H_{4_{in}} = \sum_{i=1}^{3} \left( \lambda_{i,4} \cdot I_i \right) + b_4 $$

æ¿€æ´»åï¼Œæˆ‘ä»¬æœ‰ï¼Œ

$$ H_4 = \alpha \left(H_{4_{in}} \right) $$

æˆ‘ä»¬å¯ä»¥ç”¨é€šç”¨å‘é‡ç¬¦å·åœ¨èŠ‚ç‚¹ä¸­è¡¨ç¤ºç®€å•çš„å¤„ç†å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ

$$ H_4 = \alpha \left(b_4 + \lambda_{j,4}^T I \right) $$![](img/b2f8e46ea497049f4b95c03b8812eea7.png)

äººå·¥ç¥ç»ç½‘ç»œçš„æ¦‚è¿°ï¼Œéšè—å±‚çº¿æ€§åœ°åŠ æƒæ¯ä¸ªè¾“å…¥å±‚èŠ‚ç‚¹çš„è¾“å…¥ï¼Œæ·»åŠ èŠ‚ç‚¹åå·®é¡¹ï¼Œç„¶ååº”ç”¨æ¿€æ´»å‡½æ•°ï¼Œå¹¶å°†æ­¤ä¼ é€’ç»™ä¸‹ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œå³æˆ‘ä»¬çš„ç¤ºä¾‹äººå·¥ç¥ç»ç½‘ç»œçš„è¾“å‡ºå±‚ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼å¯¹æ‰€æœ‰éšè—å±‚èŠ‚ç‚¹è¿›è¡Œæ³›åŒ–ï¼Œ

$$ H_{j_{in}} = \sum_{i=1}^{|I|} \left( \lambda_{i,j} \cdot I_i \right) + b_j $$

æ¿€æ´»åï¼ŒèŠ‚ç‚¹è¾“å‡ºæ˜¯ï¼Œ

$$ H_{j_{in}} = \sigma \bigl( \sum_{i=1}^{|I|} \left( \lambda_{i,j} \cdot I_i \right) + b_j \bigr) $$

**è¾“å‡ºå±‚èŠ‚ç‚¹å†…éƒ¨**

è¾“å‡ºå±‚èŠ‚ç‚¹å¯¹èŠ‚ç‚¹çš„è¾“å…¥è¿›è¡Œçº¿æ€§åŠ æƒç»„åˆï¼Œæ·»åŠ èŠ‚ç‚¹åå·®é¡¹ï¼Œç„¶åä½¿ç”¨ä¸éšè—å±‚èŠ‚ç‚¹ç›¸åŒçš„æ¿€æ´»å‡½æ•°ï¼Œ$\alpha$ï¼Œè¿›è¡Œè½¬æ¢ï¼Œ

åœ¨æ¿€æ´»ä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰ï¼Œ

$$ O_{6_{in}} = \sum_{i=4}^{5} \left( \lambda_{i,6} \cdot H_i \right) + b_6 $$

æ¿€æ´»åï¼Œå‡è®¾ä½¿ç”¨æ’ç­‰æ¿€æ´»ï¼Œæˆ‘ä»¬æœ‰ï¼Œ

$$ O_6 = \alpha \left(O_{6_{in}} \right) $$

æˆ‘ä»¬å¯ä»¥ç”¨é€šç”¨å‘é‡ç¬¦å·åœ¨èŠ‚ç‚¹ä¸­è¡¨ç¤ºç®€å•çš„å¤„ç†å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ

$$ O_6 = \alpha\left(b_6 + \lambda_{j,6}^T H\right) $$![](img/22c5dd7e545497f42cf0b949f0b92954.png)

äººå·¥ç¥ç»ç½‘ç»œçš„æ¦‚è¿°ï¼Œè¾“å‡ºå±‚çº¿æ€§åœ°åŠ æƒæ¯ä¸ªéšè—å±‚èŠ‚ç‚¹çš„è¾“å…¥ï¼Œæ·»åŠ èŠ‚ç‚¹åå·®é¡¹ï¼Œç„¶ååº”ç”¨æ¿€æ´»å‡½æ•°ï¼Œé€šå¸¸å¯¹äºè¿ç»­å“åº”ç‰¹å¾æ˜¯çº¿æ€§çš„ï¼Œå¹¶å°†æ­¤ä½œä¸ºè¾“å‡ºä¼ é€’ã€‚

å¯¹äºåˆ†ç±»å“åº”ç‰¹å¾ï¼Œé€šå¸¸åº”ç”¨ softmax æ¿€æ´»ï¼Œ

$$ O_j = \alpha(O_{j_{in}}) = \frac{e^{O_{j_{in}}}}{\sum_{\iota=1}^{K} e^{O_{\iota_{in}}}} $$![](img/ff80ab0dac26f531ce5cc5ce3cd9cf5d.png)

äººå·¥ç¥ç»ç½‘ç»œçš„æ¦‚è¿°ï¼Œè¾“å‡ºå±‚çº¿æ€§åœ°åŠ æƒæ¯ä¸ªéšè—å±‚èŠ‚ç‚¹çš„è¾“å…¥ï¼Œæ·»åŠ èŠ‚ç‚¹åå·®é¡¹ï¼Œç„¶ååº”ç”¨æ¿€æ´»å‡½æ•°ï¼Œé€šå¸¸å¯¹äºè¿ç»­å“åº”ç‰¹å¾æ˜¯çº¿æ€§çš„ï¼Œå¹¶å°†æ­¤ä½œä¸ºè¾“å‡ºä¼ é€’ã€‚

softmax æ¿€æ´»ç¡®ä¿æ‰€æœ‰è¾“å‡ºå±‚èŠ‚ç‚¹çš„è¾“å‡ºéƒ½æ˜¯æœ‰æ•ˆçš„æ¦‚ç‡ï¼ŒåŒ…æ‹¬ï¼Œ

+   **éè´Ÿæ€§** - é€šè¿‡æŒ‡æ•°è¿ç®—

+   **é—­åˆ** - æ¦‚ç‡é€šè¿‡åˆ†æ¯å½’ä¸€åŒ–åæ±‚å’Œä¸º 1.0

æ³¨æ„ï¼Œåœ¨æ‰€æœ‰æœªæ¥çš„è®¨è®ºå’Œæ¼”ç¤ºä¸­ï¼Œæˆ‘å‡è®¾æœ‰ä¸€ä¸ªæ ‡å‡†åŒ–çš„è¿ç»­å“åº”ç‰¹å¾ã€‚

## ç½‘ç»œå‰å‘ä¼ é€’

ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†ä¸€æ¡è·¯å¾„ä¸Šå¯¹ç½‘ç»œçš„éå†ï¼Œè®©æˆ‘ä»¬ç»“åˆç½‘ç»œä¸­çš„æ‰€æœ‰è·¯å¾„æ¥å±•ç¤ºé€šè¿‡äººå·¥ç¥ç»ç½‘ç»œçš„ä¸€æ¬¡å®Œæ•´å‰å‘ä¼ é€’ã€‚

+   è¿™æ˜¯è¿›è¡Œé¢„æµ‹æ‰€éœ€çš„è®¡ç®—ï¼Œ

$$ O_6 = \sigma_{O_6} \bigl( \lambda_{4,6} \cdot \sigma_{H_4} \left( \lambda_{1,4} I_1 + \lambda_{2,4} I_2 + \lambda_{3,4} I_3 + b_4 \right) + \lambda_{5,6} \cdot \sigma_{H_5} \left( \lambda_{1,5} I_1 + \lambda_{2,5} I_2 + \lambda_{3,5} I_3 + b_5 \right) + b_6 \bigr) $$

å…¶ä¸­æ¿€æ´»å‡½æ•°$\sigma_{H_4}$ = $\sigma_{H_5}$ = $\sigma$æ˜¯ Sigmoid å‡½æ•°ï¼Œè€Œ$\sigma_{O_6}$æ˜¯çº¿æ€§ï¼ˆæ’ç­‰ï¼‰å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç®€åŒ–å‰å‘ä¼ é€’ä¸ºï¼Œ

$$ O_6 = \lambda_{4,6} \cdot \sigma \left( \lambda_{1,4} I_1 + \lambda_{2,4} I_2 + \lambda_{3,4} I_3 + b_4 \right) + \lambda_{5,6} \cdot \sigma \left( \lambda_{1,5} I_1 + \lambda_{2,5} I_2 + \lambda_{3,5} I_3 + b_5 \right) + b_6 $$

è¿™å¼ºè°ƒäº†æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œæ˜¯ä¸€ä¸ªåµŒå¥—çš„æ¿€æ´»çº¿æ€§ç³»ç»Ÿï¼Œå³çº¿æ€§åŠ æƒçš„å¹³å‡å€¼åŠ ä¸Šåº”ç”¨äºæ¿€æ´»å‡½æ•°çš„åç½®é¡¹ã€‚

## æ¨¡å‹å‚æ•°æ•°é‡

é€šå¸¸ï¼Œäººå·¥ç¥ç»ç½‘ç»œä¸­æœ‰è®¸å¤šæ¨¡å‹å‚æ•°ï¼Œ$theta$ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ˜ç¡®è¿™äº›å®šä¹‰æ¥æè¿°æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œï¼Œ

+   **ç¥ç»ç½‘ç»œå®½åº¦** - ç¥ç»ç½‘ç»œå±‚ä¸­çš„èŠ‚ç‚¹æ•°

+   **ç¥ç»ç½‘ç»œæ·±åº¦** - ç¥ç»ç½‘ç»œä¸­çš„å±‚æ•°ï¼Œé€šå¸¸è¾“å…¥å±‚ä¸åŒ…æ‹¬åœ¨è¿™ä¸ªè®¡ç®—ä¸­

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å‡è®¾ä¸€ä¸ª 3 å±‚äººå·¥ç¥ç»ç½‘ç»œçš„ç´§å‡‘è¡¨ç¤ºæ³•ï¼ŒåŒ…æ‹¬è¾“å…¥ã€è¾“å‡ºå’Œ 1 ä¸ªéšè—å±‚ï¼Œæ¯å±‚çš„å®½åº¦å¦‚ä¸‹ï¼Œ

+   è¾“å…¥èŠ‚ç‚¹æ•°ï¼Œ$p$

+   éšè—å±‚èŠ‚ç‚¹æ•°ï¼Œ$m$

+   è¾“å‡ºèŠ‚ç‚¹æ•°ï¼Œ$k$

![](img/1b5b7051a7f760fb3b71c71560ca7613.png)

äººå·¥ç¥ç»ç½‘ç»œå®½åº¦ã€è¾“å…¥èŠ‚ç‚¹æ•°ã€$p$ã€éšè—å±‚èŠ‚ç‚¹æ•°ã€$m$å’Œè¾“å‡ºèŠ‚ç‚¹æ•°ã€$k$çš„è¡¨ç¤ºæ³•ã€‚

å®Œå…¨è¿æ¥ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªè¿æ¥éƒ½æœ‰ä¸€ä¸ªæƒé‡ï¼Œ

$$ \lambda_{ğ¼_{1,\ldots,ğ‘},ğ»_{1,\ldots,ğ‘š} } \quad \text{å’Œ} \quad \lambda_{ğ»_{1,\ldots,ğ‘š},ğ‘‚_{1,\ldots,ğ‘˜} } $$

åœ¨å…¨è¿æ¥çš„æƒ…å†µä¸‹ï¼Œæƒé‡çš„æ•°é‡æ˜¯

$$ ğ‘ \times ğ‘š \quad \text{å’Œ} \quad ğ‘š \times ğ‘˜ $$

åœ¨æ¯ä¸ªéšè—å±‚èŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªåç½®é¡¹ï¼Œ

$$ ğ‘_{H_{1,\ldots,m} } $$

åœ¨æ¯ä¸ªè¾“å‡ºèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªåç½®é¡¹ï¼Œ

$$ ğ‘_{O_{1,\ldots,k} } $$

å› æ­¤ï¼Œæ¨¡å‹å‚æ•°çš„æ•°é‡æ˜¯ï¼Œ

$$ |\theta| = ğ‘ \times ğ‘š + ğ‘š \times ğ‘˜ + ğ‘š + ğ‘˜ $$

è¿™å‡è®¾æ¯ä¸ªéšè—å±‚èŠ‚ç‚¹å’Œè¾“å‡ºå±‚èŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªç‹¬ç‰¹çš„åç½®é¡¹ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç›¸åŒçš„åç½®é¡¹å¯èƒ½åº”ç”¨äºæ•´ä¸ªå±‚ã€‚

å¯¹äºæˆ‘ä»¬çš„ä¾‹å­ï¼Œå½“$p = 3$ï¼Œ$m = 2$å’Œ$k = 1$æ—¶ï¼Œæ¨¡å‹å‚æ•°çš„æ•°é‡æ˜¯ï¼Œ

$$ |\theta| = ğ‘ \times ğ‘š + ğ‘š \times ğ‘˜ + ğ‘š + ğ‘˜ $$

ä»£å…¥åæˆ‘ä»¬å¾—åˆ°ï¼Œ

$$ |\theta| = 3 \times 2 + 2 \times 1 + 2 + 1 = 11 $$

æˆ‘é€‰æ‹©è¿™ä¸ªå¯ç®¡ç†çš„å‚æ•°æ•°é‡ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥è®­ç»ƒå’Œå¯è§†åŒ–æˆ‘ä»¬çš„æ¨¡å‹ï¼Œä½†é€šè¿‡å¢åŠ äººå·¥ç¥ç»ç½‘ç»œçš„å®½åº¦ï¼Œä»¥ $p = 10$ï¼Œ$m = 20$ å’Œ $k = 3$ï¼Œæˆ‘ä»¬ä¼šæœ‰æ›´å¤šçš„æ¨¡å‹å‚æ•°ï¼Œ

$$ |\theta| = 10 \times 20 + 20 \times 3 + 20 + 3 = 283 $$

å¦‚æœæˆ‘ä»¬å¢åŠ éšè—å±‚ï¼Œå¢åŠ äººå·¥ç¥ç»ç½‘ç»œçš„æ·±åº¦ï¼Œæ¨¡å‹å‚æ•°çš„æ•°é‡å°†è¿…é€Ÿå¢é•¿ã€‚

+   æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªè®¡ç®—æ¨å¹¿åˆ°ä»»ä½•å…¨è¿æ¥ã€å‰é¦ˆç¥ç»ç½‘ç»œï¼Œç»™å®šä¸€ä¸ª $W$ å‘é‡ï¼ŒåŒ…å«èŠ‚ç‚¹æ•°ï¼Œå³æ¯å±‚çš„å®½åº¦ï¼Œ

$$ \mathbf{L} = [l_0, l_1, l_2, \dots, l_n] $$

å…¶ä¸­ï¼Œ

+   $l_0$ æ˜¯è¾“å…¥ç¥ç»å…ƒçš„æ•°é‡

+   $l_1, \dots, l_{n-1}$ æ˜¯éšè—å±‚çš„å®½åº¦

+   $l_n$ æ˜¯è¾“å‡ºç¥ç»å…ƒçš„æ•°é‡

è¿æ¥æƒé‡çš„æ€»æ•°æ˜¯ï¼Œ

$$ |\theta_{weights}| = \sum_{i=1}^{n} l_i \cdot l_{i-1} $$

èŠ‚ç‚¹åå·®çš„æ€»æ•°ï¼ˆè¾“å…¥å±‚èŠ‚ç‚¹ä¸­æ²¡æœ‰åå·®å‚æ•°ï¼Œ$l_0$ï¼‰æ˜¯ï¼Œ

$$ |\theta_{biases}| = \sum_{i=1}^{n} l_i $$

å¯è®­ç»ƒæ¨¡å‹å‚æ•°ã€è¿æ¥æƒé‡å’ŒèŠ‚ç‚¹åå·®çš„æ€»æ•°æ˜¯ï¼Œ

$$ |\theta| = \sum_{i=1}^{n} \left( l_i \cdot l_{i-1} + l_i \right) = \sum_{i=1}^{n} l_i \cdot (l_{i-1} + 1) $$

è®©æˆ‘ä»¬ä»¥ä¸€ä¸ªæœ‰ 4 ä¸ªéšè—å±‚çš„äººå·¥ç¥ç»ç½‘ç»œä¸ºä¾‹ï¼Œç½‘ç»œå®½åº¦æŒ‰å±‚å‘é‡ï¼Œ

$$ \mathbf{L} = [10, 8, 6, 4, 2, 1] $$

è¿æ¥æƒé‡çš„æ€»æ•°æ˜¯ï¼Œ

$$ |\theta_{L_{weights}}| = \sum_{i=1}^{5} l_i \cdot l_{i-1} = (8 \cdot 10) + (6 \cdot 8) + (4 \cdot 6) + (2 \cdot 4) + (1 \cdot 2) = 80 + 48 + 24 + 8 + 2 = 162 $$

èŠ‚ç‚¹åå·®çš„æ€»æ•°æ˜¯ï¼Œ

$$ |\theta_{L_{biases}}| = \sum_{i=1}^{5} l_i = 8 + 6 + 4 + 2 + 1 = 21 $$

æœ€åï¼Œå¯è®­ç»ƒå‚æ•°çš„æ€»æ•°æ˜¯ï¼Œ

$$ |\theta_L| = \sum_{i=1}^{5} l_i \cdot (l_{i-1} + 1) = (8 \cdot 11) + (6 \cdot 9) + (4 \cdot 7) + (2 \cdot 5) + (1 \cdot 3) = 88 + 54 + 28 + 10 + 3 = 183 $$

## æ¿€æ´»å‡½æ•°

æ¿€æ´»å‡½æ•°æ˜¯åŠ æƒèŠ‚ç‚¹è¾“å…¥çš„çº¿æ€§ç»„åˆåŠ ä¸ŠèŠ‚ç‚¹åå·®é¡¹çš„è½¬æ¢ã€‚éçº¿æ€§æ¿€æ´»ï¼Œ

+   å¼•å…¥äº†ç½‘ç»œçš„éçº¿æ€§å±æ€§å’Œå¤æ‚æ€§

+   é˜²æ­¢ç½‘ç»œå´©æºƒ

æ²¡æœ‰éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œæˆ‘ä»¬ä¼šæœ‰çº¿æ€§å›å½’ï¼Œæ•´ä¸ªç³»ç»Ÿä¼šå´©æºƒã€‚

æ›´å¤šå…³äºæ¿€æ´»å‡½æ•°å’Œæ²¡æœ‰éçº¿æ€§æ¿€æ´»åˆ°å¤šå…ƒçº¿æ€§å›å½’çš„æ¼”ç¤ºä¿¡æ¯ï¼Œè¯·å‚é˜…æœ¬ç”µå­ä¹¦çš„ç›¸å…³ç« èŠ‚ï¼Œ[ç¥ç»ç½‘ç»œæ¿€æ´»å‡½æ•°](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_activation_functions.html)ã€‚

## è®­ç»ƒç½‘ç»œæ­¥éª¤

é€šè¿‡è¿™äº›æ­¥éª¤è¿­ä»£åœ°è®­ç»ƒäººå·¥ç¥ç»ç½‘ç»œï¼Œ

1.  åˆå§‹åŒ–æ¨¡å‹å‚æ•°

1.  å‰å‘ä¼ é€’ä»¥è¿›è¡Œé¢„æµ‹

1.  æ ¹æ®è®­ç»ƒæ•°æ®ä¸­çš„é¢„æµ‹å’ŒçœŸå®å€¼è®¡ç®—è¯¯å·®å¯¼æ•°

1.  é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œåå‘ä¼ æ’­è¯¯å·®å¯¼æ•°ï¼Œä»¥è®¡ç®—æ‰€æœ‰æ¨¡å‹æƒé‡å’Œåç½®å‚æ•°çš„è¯¯å·®å¯¼æ•°

1.  æ ¹æ®å¯¼æ•°å’Œå­¦ä¹ ç‡æ›´æ–°æ¨¡å‹å‚æ•°

1.  é‡å¤ç›´åˆ°æ”¶æ•›ã€‚

![](img/c3a5bc8956f8ceda05ddf9b582cd141d.png)

è®­ç»ƒäººå·¥ç¥ç»ç½‘ç»œçš„è¿­ä»£æ­¥éª¤ã€‚

è¿™é‡Œæ˜¯æ¯ä¸ªæ­¥éª¤çš„ä¸€äº›ç»†èŠ‚ï¼Œ

1.  **åˆå§‹åŒ–æ¨¡å‹å‚æ•°** - é€šå¸¸ä½¿ç”¨æ¥è¿‘é›¶çš„å°éšæœºå€¼åˆå§‹åŒ–æ‰€æœ‰æ¨¡å‹å‚æ•°ã€‚è¿™é‡Œæœ‰ä¸€äº›å¸¸è§çš„æ–¹æ³•ï¼Œ

+   **Xavier æƒé‡åˆå§‹åŒ–** - ä»ç”± $U[\text{min}, \text{max}]$ æŒ‡å®šçš„å‡åŒ€åˆ†å¸ƒä¸­éšæœºå®ç°ï¼Œ

$$ \lambda_{i,j} = F_U^{-1} \left[ \frac{-1}{\sqrt{p}}, \frac{1}{\sqrt{p}} \right] (p^\ell) $$

å…¶ä¸­ $F^{-1}_U$ æ˜¯ CDF çš„é€†ï¼Œ$p$ æ˜¯è¾“å…¥çš„æ•°é‡ï¼Œ$p^{\ell}$ æ˜¯ä»å‡åŒ€åˆ†å¸ƒ $U[0,1]$ ä¸­æŠ½å–çš„éšæœºç´¯ç§¯æ¦‚ç‡å€¼ã€‚

+   **å½’ä¸€åŒ– Xavier æƒé‡åˆå§‹åŒ–** - ä»ç”± $U[\text{min}, \text{max}]$ æŒ‡å®šçš„å‡åŒ€åˆ†å¸ƒä¸­éšæœºå®ç°ï¼Œ

$$ \lambda_{i,j} = F_U^{-1} \left[ \frac{-1}{\sqrt{p}+k}, \frac{1}{\sqrt{p}+k} \right] (p^\ell) $$

å…¶ä¸­ $F^{-1}_U$ æ˜¯ CDF çš„é€†ï¼Œ$p$ æ˜¯è¾“å…¥çš„æ•°é‡ï¼Œ$k$ æ˜¯è¾“å‡ºçš„æ•°é‡ï¼Œ$p^{\ell}$ æ˜¯ä»å‡åŒ€åˆ†å¸ƒ $U[0,1]$ ä¸­æŠ½å–çš„éšæœºç´¯ç§¯æ¦‚ç‡å€¼ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªéšè—å±‚èŠ‚ç‚¹ï¼Œ

![](img/b2f8e46ea497049f4b95c03b8812eea7.png)

ç¬¬ä¸€ä¸ªéšè—å±‚èŠ‚ç‚¹æœ‰ 3 ä¸ªè¾“å…¥ï¼Œ1 ä¸ªè¾“å‡ºã€‚

æˆ‘ä»¬æœ‰ $p = 3$ å’Œ $k = 1$ï¼Œå¹¶ä»å‡åŒ€åˆ†å¸ƒä¸­æŠ½å–ï¼Œ

$$ U \left[ \frac{-1}{\sqrt{p}+k}, \frac{1}{\sqrt{p}+k} \right] = U \left[ \frac{-1}{\sqrt{3}+1}, \frac{1}{\sqrt{3}+1} \right] $$

1.  **æ­£å‘ä¼ æ’­** - ä¸ºäº†åšå‡ºé¢„æµ‹ï¼Œ$\hat{y}$ã€‚åˆå§‹é¢„æµ‹åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£å°†æ˜¯éšæœºçš„ï¼Œä½†ä¼šéšç€è¿­ä»£è€Œæ”¹è¿›ã€‚å†æ¬¡ï¼Œå¯¹äºæˆ‘ä»¬çš„æ¨¡å‹ï¼Œæ­£å‘ä¼ æ’­æ˜¯ï¼Œ

$$ O_6 = \lambda_{4,6} \cdot \sigma \left( \lambda_{1,4} I_1 + \lambda_{2,4} I_2 + \lambda_{3,4} I_3 + b_4 \right) + \lambda_{5,6} \cdot \sigma \left( \lambda_{1,5} I_1 + \lambda_{2,5} I_2 + \lambda_{3,5} I_3 + b_5 \right) + b_6 $$![](img/08556ecbd47d143019d0163dc95761cf.png)

ä½¿ç”¨éšæœºåˆå§‹åŒ–çš„æ¨¡å‹å‚æ•°ã€æƒé‡å’Œåç½®çš„äººå·¥ç¥ç»ç½‘ç»œè¿›è¡Œé¢„æµ‹ã€‚

1.  **è®¡ç®—è¯¯å·®å¯¼æ•°** - ç»™å®šä¸€ä¸ªæŸå¤±ï¼Œ

$$ L = \frac{1}{2} \left(\hat{y} - y \right)Â² $$

ä»¥åŠè¯¯å·®å¯¼æ•°ï¼Œå³è¯¯å·®éšæ¨¡å‹ä¼°è®¡å˜åŒ–çš„å˜åŒ–ç‡ï¼Œ

$$ \frac{\partial L}{\partial \hat{y}} = \hat{Y} - Y $$

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åªè€ƒè™‘ä¸€ä¸ªä¼°è®¡ï¼Œç¨åæˆ‘ä»¬å°†è§£å†³è¶…è¿‡ 1 ä¸ªè®­ç»ƒæ•°æ®ã€‚

1.  **åå‘ä¼ æ’­è¯¯å·®å¯¼æ•°** - æˆ‘ä»¬é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œå›é€€ä»¥è®¡ç®—æ‰€æœ‰æ¨¡å‹æƒé‡å’Œåå·®å‚æ•°çš„è¯¯å·®å¯¼æ•°ï¼Œä¾‹å¦‚ï¼ŒæŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºï¼Œ

$$ \frac{\partial L}{\partial H_4} = \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial L}{\partial O_6} = \lambda_{4,6} \cdot \bigl( (1 - O_6) \cdot O_6 \bigr) \cdot (O_6 - y) $$

1.  **æ›´æ–°æ¨¡å‹å‚æ•°** - åŸºäºå¯¼æ•° $\frac{\partial L}{\partial \lambda_{i,j}}$ å’Œå­¦ä¹ ç‡ $\eta$ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ

$$ \lambda_{i,j}^{\ell} = \lambda_{i,j}^{\ell - 1} + \eta \cdot \frac{\partial L}{\partial \lambda_{i,j}} $$

1.  **é‡å¤ç›´åˆ°æ”¶æ•›** - è¿”å›åˆ°æ­¥éª¤ 1ï¼Œç›´åˆ°è¯¯å·® $L$ é™ä½åˆ°å¯æ¥å—çš„æ°´å¹³ï¼Œå³æ¨¡å‹æ”¶æ•›æ˜¯åœæ­¢è¿­ä»£çš„æ¡ä»¶

è¿™äº›æ˜¯æ­¥éª¤ï¼Œç°åœ¨è®©æˆ‘ä»¬æ·±å…¥æ¢è®¨æ¯ä¸ªæ­¥éª¤çš„ç»†èŠ‚ï¼Œä½†é¦–å…ˆè®©æˆ‘ä»¬ä»åå‘ä¼ æ’­çš„æ•°å­¦æ¡†æ¶â€”â€”é“¾å¼æ³•åˆ™å¼€å§‹ã€‚

## é“¾å¼æ³•åˆ™

åæ€åï¼Œå¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œçš„å‰å‘ä¼ æ’­æ¶‰åŠä¸€ç³»åˆ—åµŒå¥—æ“ä½œï¼Œè¿™äº›æ“ä½œé€æ­¥å°†è¾“å…¥ä¿¡å·ä»è¾“å…¥èŠ‚ç‚¹ä¼ æ’­åˆ°æ¯ä¸€å±‚ï¼Œæœ€ç»ˆåˆ°è¾¾è¾“å‡ºèŠ‚ç‚¹ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ­¤è¡¨ç¤ºä¸ºä¸€ç³»åˆ—åµŒå¥—æ“ä½œï¼Œ

$$ f = f(x) \quad g = g(f) \quad y = h(g) $$

ç°åœ¨ä»¥è¿™ç§å½¢å¼å¼ºè°ƒæ“ä½œçš„åµŒå¥—ï¼Œ

$$ y = h \bigl( g(f(x)) \bigr) $$

é€šè¿‡å°†é“¾å¼æ³•åˆ™åº”ç”¨äºåµŒå¥—å‡½æ•° $y = h \bigl( g(f(x)) \bigr)$ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚è§£ $\frac{\partial y}{\partial x}$ å¦‚ä¸‹ï¼Œ

$$ \frac{\partial y}{\partial x} = \frac{\partial h}{\partial g} \cdot \frac{\partial g}{\partial f} \cdot \frac{\partial f}{\partial x} $$

å…¶ä¸­ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰ç®—å­çš„åå¯¼æ•°é“¾å¼ç›¸åŠ ï¼Œä»¥æ±‚è§£ç»™å®šè¾“å…¥ $x$ çš„è¾“å‡º $y$ çš„å¯¼æ•°ã€‚

+   æˆ‘ä»¬å¯ä»¥åœ¨åµŒå¥—å‡½æ•°çš„ä»»ä½•ä¸­é—´ç‚¹è®¡ç®—å¯¼æ•°ï¼Œä¾‹å¦‚ï¼Œå‘åå›é€€ä¸€æ­¥ï¼Œ

$$ \frac{\partial f}{\partial x} $$

ç°åœ¨å›é€€ä¸¤æ­¥ï¼Œ

$$ \frac{\partial g}{\partial x} = \frac{\partial g}{\partial f} \cdot \frac{\partial f}{\partial x} $$

ç„¶åé€æ­¥å›é€€ä¸‰æ­¥ï¼Œ

$$ \frac{\partial y}{\partial x} = \frac{\partial h}{\partial g} \cdot \frac{\partial g}{\partial f} \cdot \frac{\partial f}{\partial x} $$

è¿™å°±æ˜¯æˆ‘ä»¬é€šè¿‡åå‘ä¼ æ’­æ‰€åšçš„äº‹æƒ…ï¼Œä½†è¿™å¯èƒ½è¿‡äºæŠ½è±¡ï¼è®©æˆ‘ä»¬è½¬å‘ä¸€ä¸ªéå¸¸ç®€å•çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼Œå®ƒåªæœ‰è¿™ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œ

+   $I_1$ - è¾“å…¥èŠ‚ç‚¹

+   $H_2 = h(I_1)$ - éšè—å±‚èŠ‚ç‚¹ï¼Œæ˜¯ $I_1$ çš„å‡½æ•°

+   $O_3 = o(H_2)$ - è¾“å‡ºèŠ‚ç‚¹ï¼Œæ˜¯ $H_2$ çš„å‡½æ•°

+   è¿™ä»ç„¶æ˜¯æœ‰æ„ä¸ºä¹‹çš„æŠ½è±¡ï¼Œå³æ²¡æœ‰æåŠæƒé‡å’Œåå·®ï¼Œä»¥å¸®åŠ©æ‚¨é€šè¿‡é“¾å¼æ³•åˆ™å‘å±•ç¥ç»ç½‘ç»œåå‘ä¼ æ’­çš„å¿ƒæ™ºæ¡†æ¶ï¼Œæˆ‘ä»¬å°†åœ¨è¿™æ¬¡è®¨è®ºä¹‹åç«‹å³æ·±å…¥ç»†èŠ‚ã€‚

è¾“å‡º $O_3$ é€šè¿‡è¿™äº›åµŒå¥—å‡½æ•°ä¾èµ–äºè¾“å…¥ $I_1$ï¼š

$$ O_3 = o \bigl( h(I_1) \bigr) $$

ä½¿ç”¨ **é“¾å¼æ³•åˆ™**ï¼Œè¾“å‡ºç›¸å¯¹äºåå‘ä¼ æ’­ä¸€æ­¥çš„æ¢¯åº¦ï¼Œ

$$ \frac{\partial O_3}{\partial H_2} $$

ä»¥åŠå…³äºåå‘ä¼ æ’­ä¸¤æ­¥çš„ï¼Œ

$$ \frac{\partial O_3}{\partial I_1} = \frac{\partial H_2}{\partial I_1} \cdot \frac{\partial O_3}{\partial H_2} $$

è¿™æ˜¾ç¤ºäº†æ¢¯åº¦æ˜¯å¦‚ä½• **åå‘ä¼ æ’­** é€šè¿‡ç½‘ç»œçš„ï¼Œ

+   $\frac{\partial O_3}{\partial I_1}$ - æ˜¯éšè—èŠ‚ç‚¹çš„å±€éƒ¨æ¢¯åº¦

+   $\frac{\partial O_3}{\partial H_2}$ - æ˜¯è¾“å‡ºèŠ‚ç‚¹çš„å±€éƒ¨æ¢¯åº¦

é€šè¿‡åå‘ä¼ æ’­ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ç›¸å¯¹äºç½‘ç»œæ‰€æœ‰éƒ¨åˆ†çš„å¯¼æ•°ï¼Œå¦‚ä½•è¾“å…¥èŠ‚ç‚¹ä¿¡å· $I_1$ æˆ–éšè—èŠ‚ç‚¹ä¿¡å· $H_2$ å½±å“è¾“å‡º $O_3$ï¼Œåˆ†åˆ«æ˜¯ $\frac{\partial O_3}{\partial I_1}$ å’Œ $frac{\partial O_3}{\partial H_2}$ã€‚

+   æ›´é‡è¦çš„æ˜¯ï¼Œè¾“å…¥ $I_1$ æˆ– $H_2$ çš„å˜åŒ–å¦‚ä½•å½±å“æ¨¡å‹æŸå¤±çš„å˜åŒ–ï¼Œåˆ†åˆ«æ˜¯ $\frac{\partial L}{\partial I_1}$ å’Œ $frac{\partial L}{\partial H_2}$ã€‚

è¿™ä¸€ç³»åˆ—çš„åå¯¼æ•°ï¼Œé€šè¿‡é€æ­¥åå‘é€šè¿‡ç¥ç»ç½‘ç»œå±‚ï¼Œæ˜¯åå‘ä¼ æ’­èƒŒåçš„åŸºæœ¬æœºåˆ¶ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ¨å¯¼å¹¶æ¼”ç¤ºåå‘ä¼ æ’­çš„å„ä¸ªéƒ¨åˆ†ï¼Œç„¶åæœ€ç»ˆå°†å®ƒä»¬ç»„åˆèµ·æ¥ï¼Œä»¥å±•ç¤ºæ•´ä¸ªç½‘ç»œçš„åå‘ä¼ æ’­ã€‚

## ç¥ç»ç½‘ç»œåå‘ä¼ æ’­æ„å»ºå—

è®©æˆ‘ä»¬ä»‹ç»åå‘ä¼ æ’­çš„æ•°å€¼æ„å»ºå—ã€‚ä¸€æ—¦ä½ ç†è§£äº†è¿™äº›åå‘ä¼ æ’­æ„å»ºå—ï¼Œä½ å°†èƒ½å¤Ÿæ‰‹åŠ¨åå‘ä¼ æ’­æˆ‘ä»¬çš„ç®€å•ç½‘ç»œï¼Œç”šè‡³ä»»ä½•å¤æ‚çš„äººå·¥ç¥ç»ç½‘ç»œï¼Œ

1.  è®¡ç®—æŸå¤±å¯¼æ•°

1.  é€šè¿‡èŠ‚ç‚¹çš„åå‘ä¼ æ’­

1.  æ²¿ç€è¿æ¥çš„åå‘ä¼ æ’­

1.  è€ƒè™‘åˆ°å¤šæ¡è·¯å¾„

1.  å…³äºæƒé‡å’Œåç½®çš„æŸå¤±å¯¼æ•°

ç›®å‰æˆ‘æ¼”ç¤ºäº†å•ä¸ªè®­ç»ƒæ•°æ®æ ·æœ¬ $y$ çš„è¿™ä¸ªæŸå¤±å¯¼æ•°çš„åå‘ä¼ æ’­ã€‚

+   æˆ‘å°†åœ¨åé¢å¤„ç†å¤šä¸ªæ ·æœ¬ï¼Œ$y_i, i=1, \ldots, n$

è®©æˆ‘ä»¬ä»è®¡ç®—æŸå¤±å¯¼æ•°å¼€å§‹ã€‚

### è®¡ç®—æŸå¤±å¯¼æ•°

åå‘ä¼ æ’­åŸºäºå°†æŸå¤±å¯¼æ•°åˆ†é…æˆ–ä¼ æ’­å›ç¥ç»ç½‘ç»œçš„æ¦‚å¿µï¼Œ

+   æˆ‘ä»¬è®¡ç®—æŸå¤±å¯¼æ•°ï¼Œç„¶åæŒ‰é¡ºåºä»ç½‘ç»œè¾“å‡ºåå‘åˆ†å¸ƒåˆ°ç½‘ç»œè¾“å…¥

+   é‡è¦çš„æ˜¯è¦çŸ¥é“æˆ‘ä»¬æ­£åœ¨å¤„ç†å¯¼æ•°ï¼Œå¹¶ä¸”åå‘ä¼ æ’­ä¸æ˜¯åˆ†é…é”™è¯¯ï¼Œå°½ç®¡æ­£å¦‚ä½ å°†çœ‹åˆ°çš„ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼

æˆ‘ä»¬é¦–å…ˆå®šä¹‰æŸå¤±ï¼Œç»™å®šçœŸå®å€¼ $ğ‘¦$ å’Œæˆ‘ä»¬çš„é¢„æµ‹ $\hat{y} = O_6$ï¼Œæˆ‘ä»¬è®¡ç®—æˆ‘ä»¬çš„ $LÂ²$ æŸå¤±ä¸ºï¼Œ

$$ L = \frac{1}{2} \left( \hat{y} - y \right)Â² $$

æˆ‘ä»¬é€‰æ‹©æŸå¤±å‡½æ•°å…è®¸æˆ‘ä»¬ä½¿ç”¨é¢„æµ‹è¯¯å·®ä½œä¸ºæŸå¤±å¯¼æ•°ï¼æˆ‘ä»¬è®¡ç®—æŸå¤±å¯¼æ•°ä¸ºæŸå¤±ç›¸å¯¹äºä¼°è®¡çš„åå¯¼æ•°ï¼Œ$\frac{\partial ğ¿}{\partial \hat{y}}$,

$$ \frac{\partial \mathcal{L}}{\partial \hat{y}} = \frac{\partial \frac{1}{2} \left( \hat{y} - y \right)Â² }{\partial \hat{y}} = \hat{y} - y $$

ä½ æ˜ç™½æˆ‘çš„æ„æ€ï¼Œæˆ‘ä»¬æ­£åœ¨åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ï¼Œä½†ç”±äºæˆ‘ä»¬å¯¹ $LÂ²$ æŸå¤±çš„å…¬å¼åŒ–ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—è¾“å‡ºèŠ‚ç‚¹çš„è¯¯å·®ï¼Œä½†å†æ¬¡å¼ºè°ƒâ€”â€”å®ƒæ˜¯æŸå¤±å¯¼æ•°ã€‚

![](img/6abf780fa4544caa6735a8f4ad075bd2.png)

è®¡ç®—è¾“å‡ºå±‚èŠ‚ç‚¹ $O_6$ çš„æŸå¤±å¯¼æ•°ã€‚

å¯¹äºæˆ‘ä»¬ç®€å•çš„äººå·¥ç¥ç»ç½‘ç»œç¤ºä¾‹ï¼Œè¾“å‡ºåœ¨èŠ‚ç‚¹ $O_6$ï¼Œæˆ‘ä»¬çš„æŸå¤±å¯¼æ•°æ˜¯ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial O_6} = \frac{\partial \mathcal{L}}{\hat{y}} = \hat{y} - y = O_6 - y $$

å› æ­¤ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°è¾“å‡ºèŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç°åœ¨å‡†å¤‡å¥½é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œåå‘ä¼ æ’­è¿™ä¸ªæŸå¤±å¯¼æ•°ï¼Œè®©æˆ‘ä»¬è°ˆè°ˆå¦‚ä½•é€æ­¥é€šè¿‡èŠ‚ç‚¹å’Œæ²¿ç€è¿æ¥ã€‚

### å¸¦æœ‰èº«ä»½æ¿€æ´»çš„è¾“å‡ºèŠ‚ç‚¹åå‘ä¼ æ’­

è®©æˆ‘ä»¬é€šè¿‡è¾“å‡ºèŠ‚ç‚¹ $O_6$ ä»åæ¿€æ´»åˆ°å‰æ¿€æ´»åå‘ä¼ æ’­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»å‡½æ•°çš„åå¯¼æ•°ã€‚

+   ç”±äºè¿™æ˜¯ä¸€ä¸ªå›å½’äººå·¥ç¥ç»ç½‘ç»œçš„è¾“å‡ºèŠ‚ç‚¹ï¼Œæˆ‘é€‰æ‹©äº†èº«ä»½æˆ–çº¿æ€§æ¿€æ´»å‡½æ•°ã€‚

![](img/1141c4e67c550f275e9079501fe522b2.png)

é€šè¿‡èŠ‚ç‚¹ $O_6$ åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ï¼Œä» $O_6$ åæ¿€æ´»è¾“å‡ºåˆ° $O_{6_{in}}$ å‰æ¿€æ´»è¾“å…¥ã€‚

è¾“å‡ºèŠ‚ç‚¹ $O_6$ çš„èº«ä»½æ¿€æ´»å®šä¹‰ä¸ºï¼š

$$ O_6 = \sigma(O_{6_{in}}) = O_6 $$

èŠ‚ç‚¹ $O_6$ çš„èº«ä»½æ¿€æ´»ç›¸å¯¹äºå…¶è¾“å…¥ $O_{6_{in}}$ çš„å¯¼æ•°ï¼Œå³ç©¿è¿‡èŠ‚ç‚¹ $O_6$ æ˜¯ï¼Œ

$$ \frac{\partial O_6}{\partial O_{6_{in}}} = \frac{\partial \left(O_{6_{in}} \right)}{\partial O_{6_{in}}} = 1.0 $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦èŠ‚ç‚¹ $O_6$ çš„è¾“å‡ºä¿¡å·ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªä¿¡å·æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»èŠ‚ç‚¹è¾“å‡ºç›¸å¯¹äºæŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_6}$ åå‘ä¼ æ’­ï¼Œåˆ°èŠ‚ç‚¹è¾“å…¥ç›¸å¯¹äºæŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}}$ã€‚

$$ \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = 1.0 \cdot (O_6 - y) $$

ç°åœ¨æˆ‘ä»¬å·²ç»é€šè¿‡è¾“å‡ºèŠ‚ç‚¹åå‘ä¼ æ’­ï¼Œè®©æˆ‘ä»¬ä»éšè—å±‚ $H_4$ åˆ° $O_6$ è¿æ¥åå‘ä¼ æ’­ã€‚

### æ²¿ç€è¿æ¥åå‘ä¼ æ’­

ç°åœ¨è®©æˆ‘ä»¬åå‘ä¼ æ’­èŠ‚ç‚¹ $O_6$ å’Œ $H_4$ ä¹‹é—´çš„è¿æ¥ã€‚

![](img/1c686c4b3a6fe96317a79c7333542353.png)

é€šè¿‡èŠ‚ç‚¹ $O_6$ åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ï¼Œä» $O_6$ åæ¿€æ´»è¾“å‡ºåˆ° $O_{6_{in}}$ å‰æ¿€æ´»è¾“å…¥ï¼Œç„¶åæ²¿ç€è¿æ¥åˆ°èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºã€‚

å‰æ¿€æ´»ï¼ŒèŠ‚ç‚¹ $O_6$ çš„è¾“å…¥è®¡ç®—å¦‚ä¸‹ï¼Œ

$$ O_{6_{\text{in}}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

æˆ‘ä»¬è®¡ç®—è¿æ¥ä¸Šçš„å¯¼æ•°ï¼Œ

$$ \frac{\partial O_{6_{\text{in}}}}{\partial H_4} = \frac{\partial}{\partial H_4} \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \right) = \lambda_{4,6} $$

é€šè¿‡è§£ä¸Šè¿°åå¯¼æ•°ï¼Œæˆ‘ä»¬çœ‹åˆ°é€šè¿‡åº”ç”¨è¿æ¥æƒé‡è¿›è¡Œè¿æ¥çš„åå‘ä¼ æ’­ã€‚

$$ \frac{\partial O_{6_{\text{in}}}}{\partial H_4} = \lambda_{4,6} $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦å½“å‰çš„è¿æ¥æƒé‡ $\lambda_{4,6}$ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†å…¶æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œæ²¿ç€ $H_4$ åˆ° $O_6$ çš„è¿æ¥ä»è¾“å‡ºå±‚èŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}}$ï¼Œåˆ°éšè—å±‚èŠ‚ç‚¹è¾“å‡ºçš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial H_4}$ è¿›è¡Œåå‘ä¼ æ’­ã€‚

$$ \frac{\partial \mathcal{L}}{\partial H_4} = \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = \lambda_{4,6} \bigl( \cdot (1 - O_6) \cdot O_6 \bigr) \cdot (O_6 - y) $$

### é€šè¿‡å…·æœ‰ Sigmoid æ¿€æ´»çš„èŠ‚ç‚¹è¿›è¡Œåå‘ä¼ æ’­

è®©æˆ‘ä»¬é€šè¿‡éšè—å±‚èŠ‚ç‚¹ $H_4$ ä»æ¿€æ´»ååˆ°æ¿€æ´»å‰è¿›è¡Œåå‘ä¼ æ’­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»å‡½æ•°çš„åå¯¼æ•°ã€‚

+   æˆ‘ä»¬å‡è®¾æ‰€æœ‰éšè—å±‚èŠ‚ç‚¹éƒ½ä½¿ç”¨ sigmoid æ¿€æ´»

+   ä¸ºäº†é€»è¾‘çš„æ¸…æ™°ï¼Œæ¯ä¸ªäººéƒ½å°†æ¿€æ´»å¯¼æ•°ä½œä¸ºè¾“å‡ºè€Œä¸æ˜¯å…¸å‹è¾“å…¥çš„å‡½æ•°æ¥è§£æï¼Œ

![å›¾ç‰‡](img/10ef488402716c36aa45b497ea54f6bb.png)

ä»æ¿€æ´»åçš„è¾“å‡º $H_4$ åˆ°æ¿€æ´»å‰çš„è¾“å…¥ $H_{4_{in}}$ çš„èŠ‚ç‚¹ $H_4$ çš„æŸå¤±å¯¼æ•°è¿›è¡Œåå‘ä¼ æ’­ã€‚

è¾“å‡ºèŠ‚ç‚¹ $H_4$ çš„ sigmoid æ¿€æ´»å®šä¹‰ä¸ºï¼š

$$ H_4 = \sigma(H_{4_{in}}) = \frac{1}{1 + e^{-H_{4_{in}}}} $$

èŠ‚ç‚¹ $H_4$ çš„ sigmoid æ¿€æ´»ç›¸å¯¹äºå…¶è¾“å…¥ $H_{4_{in}}$ çš„å¯¼æ•°ï¼Œå³ç©¿è¶ŠèŠ‚ç‚¹ $H_4$ æ˜¯ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = \frac{\partial}{\partial H_{4_{in}}} \left( \frac{1}{1 + e^{-H_{4_{in}}}} \right) $$

ç°åœ¨ï¼Œä¸ºäº†ç®€æ´çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬è®¾ï¼Œ

$$ u = e^{-H_{4_{in}}} $$

æ›¿æ¢åæˆ‘ä»¬å¾—åˆ°ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = \frac{\partial}{\partial H_{4_{in}}} \left( \frac{1}{1 + u} \right) $$

é€šè¿‡é“¾å¼æ³•åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥æ‰©å±•åˆ°ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = \frac{\partial}{\partial H_{4_{in}}} \left( \frac{1}{1 + u} \right) = -\frac{u}{(1 + u)Â²} \cdot \frac{\partial u}{\partial H_{4_{in}}} $$

$u = e^{-H_{4_{in}}}$ å…³äº $H_{4_{in}}$ çš„å¯¼æ•°æ˜¯ï¼š

$$ \frac{\partial u}{\partial H_{4_{in}}} = -e^{-H_{4_{in}}} = -u $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥æ›¿æ¢ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = -\frac{1}{(1+u)Â²} \cdot (-u) = \frac{u}{(1+u)Â²} $$

ç”¨èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºè¡¨ç¤ºï¼Œ$H_4 = \frac{1}{1 + u}$ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{\text{in}}}} = \frac{\left(1 - H_4\right)/H_4}{\left(1/H_4\right)Â²} = \frac{1 - H_4}{H_4} \cdot H_4Â² = \left(1 - H_4\right) \cdot H_4 $$

å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼é€šè¿‡èŠ‚ç‚¹ $H_4$ ä»èŠ‚ç‚¹åæ¿€æ´»è¾“å‡º $H_4$ åå‘ä¼ æ’­åˆ°èŠ‚ç‚¹å‰æ¿€æ´»è¾“å…¥ $H_{4_{\text{in}}}$ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{\text{in}}}} = \left(1 - H_4\right) \cdot H_4 $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºä¿¡å· $H_4$ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªä¿¡å·æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºä»¥åŠèŠ‚ç‚¹ $H_4$ çš„è¾“å…¥ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥å¤„ç†ç½‘ç»œä¸­èŠ‚ç‚¹çš„æ‰€æœ‰åå‘ä¼ æ’­æƒ…å†µã€‚

### æ²¿ç€å¦ä¸€ä¸ªè¿æ¥åå‘ä¼ æ’­

ä¸ºäº†è¿ç»­æ€§å’Œå®Œæ•´æ€§ï¼Œè®©æˆ‘ä»¬é‡å¤ä¹‹å‰æè¿°çš„æ–¹æ³•ï¼Œæ²¿ç€è¿æ¥ $I_1$ åˆ° $H_4$ åå‘ä¼ æ’­ã€‚

![](img/76f408b8ed852b03a168e6069bb716db.png)

æ²¿ç€ä» $H_4$ åˆ° $I_1$ çš„è¿æ¥åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

å†æ¬¡ï¼ŒèŠ‚ç‚¹ $H_4$ çš„å‰æ¿€æ´»è¾“å…¥è®¡ç®—å¦‚ä¸‹ï¼Œ

$$ H_{4_{\text{in}}} = \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 $$

æˆ‘ä»¬æ²¿ç€è¿æ¥è®¡ç®—å¯¼æ•°ï¼Œ

$$ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} = \frac{\partial \left(\lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 \right)}{\partial I_1} = \lambda_{1,4} $$

é€šè¿‡è§£å†³ä¸Šè¿°åå¯¼æ•°ï¼Œæˆ‘ä»¬çœ‹åˆ°é€šè¿‡åº”ç”¨è¿æ¥æƒé‡è¿›è¡Œè¿æ¥çš„åå‘ä¼ æ’­ï¼Œ

$$ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} = \lambda_{4,6} $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦å½“å‰è¿æ¥æƒé‡ $\lambda_{4,6}$ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæƒé‡æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»è¾“å‡ºå±‚èŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}}$ åå‘ä¼ æ’­åˆ°éšè—å±‚èŠ‚ç‚¹è¾“å‡ºçš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial H_4}$ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) $$

### è€ƒè™‘å¤šæ¡è·¯å¾„

æˆ‘ä»¬å…³äºèŠ‚ç‚¹è¾“å‡º $I_1$ çš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial I_1}$ æ˜¯ä¸æ­£ç¡®çš„ï¼

+   æˆ‘ä»¬è€ƒè™‘äº†ä» $O_6$ åˆ° $H_4$ åˆ° $I_1$ çš„è·¯å¾„ï¼Œä½†æ²¡æœ‰è€ƒè™‘ä» $O_6$ åˆ° $H_5$ åˆ° $I_1$ çš„è·¯å¾„

![](img/6a68404e4b3d2589dcfe15beb5175c60.png)

ä»è¾“å‡ºèŠ‚ç‚¹ $O_6$ åˆ°è¾“å…¥èŠ‚ç‚¹ $I_1$ çš„åå‘ä¼ æ’­è·¯å¾„ã€‚

ä¸ºäº†è€ƒè™‘å¤šæ¡è·¯å¾„ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹æ‰€æœ‰è·¯å¾„è¿›è¡Œæ±‚å’Œã€‚

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} + \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

æˆ‘ä»¬å¯ä»¥å°†å…¶è¯„ä¼°ä¸ºï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) + \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \cdot 1.0 \cdot (O_6 - y) $$

ç„¶åé€šè¿‡ç§»é™¤ 1.0 å€¼å’Œåˆå¹¶é¡¹æ¥ç®€åŒ–ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \left[ \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

### é€šè¿‡å…·æœ‰æ’ç­‰æ¿€æ´»çš„è¾“å…¥èŠ‚ç‚¹è¿›è¡Œåå‘ä¼ æ’­

è®©æˆ‘ä»¬é€šè¿‡è¾“å…¥èŠ‚ç‚¹ $I_1$ ä»åæ¿€æ´»åˆ°å‰æ¿€æ´»è¿›è¡Œåå‘ä¼ æ’­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»å‡½æ•°çš„åå¯¼æ•°ã€‚

+   ç”±äºè¿™æ˜¯ä¸€ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œæˆ‘é€‰æ‹©äº†æ’ç­‰æˆ–çº¿æ€§æ¿€æ´»å‡½æ•°ã€‚

![](img/bd05208edfb4ac5d5cc0f8cfe808ae50.png)

é€šè¿‡èŠ‚ç‚¹ $I_1$ çš„æŸå¤±å¯¼æ•°åå‘ä¼ æ’­ï¼Œä» $I_1$ çš„åæ¿€æ´»è¾“å‡ºåˆ° $I_{1_{in}}$ çš„å‰æ¿€æ´»è¾“å…¥ã€‚

è¾“å‡ºèŠ‚ç‚¹ $I_1$ çš„æ’ç­‰æ¿€æ´»å®šä¹‰ä¸ºï¼š

$$ I_1 = \sigma(I_{1_{in}}) = I_1 $$

èŠ‚ç‚¹ $I_1$ çš„æ’ç­‰æ¿€æ´»ç›¸å¯¹äºå…¶è¾“å…¥ $I_{1_{in}}$ çš„å¯¼æ•°ï¼Œå³é€šè¿‡èŠ‚ç‚¹ $I_1$ ä¼ é€’ï¼Œæ˜¯ï¼š

$$ \frac{\partial I_1}{\partial I_{1_{in}}} = \frac{\partial \left(I_{1_{in}} \right)}{\partial I_{1_{in}}} = 1.0 $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦ä»èŠ‚ç‚¹è¾“å‡ºçš„ä¿¡å·$I_1$ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»èŠ‚ç‚¹è¾“å‡ºçš„æŸå¤±å¯¼æ•°$\frac{\partial \mathcal{L}}{\partial I_1}$åå‘ä¼ æ’­åˆ°èŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•°$\frac{\partial \mathcal{L}}{\partial I_{1_{\text{in}}}}$ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = \frac{\partial I_1}{\partial I_{1_{in}}} \cdot \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} + \frac{\partial I_1}{\partial I_{1_{in}}} \cdot \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

æˆ‘ä»¬å¯ä»¥è¯„ä¼°ä¸ºï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = 1.0 \cdot \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) + 1.0 \cdot \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \cdot 1.0 \cdot (O_6 - y) $$

ä¸ºäº†è¶£å‘³æ€§ï¼Œæˆ‘è®¾è®¡äº†è¿™ç§è¡¨ç¤ºæ³•ä»¥å®ç°æœ€å¤§æ¸…æ™°åº¦ï¼Œ

$$ \frac{\partial L}{\partial I_{1_{\text{in}}}} = \overbrace{1.0}^{\textstyle \frac{\partial I_{1}}{\partial I_{1_{in}}}} \left[ \overbrace{\lambda_{1,4}}^{\textstyle \frac{\partial H_{4_{\text{in}}}}{\partial I_1}} \cdot \overbrace{(1 - H_4) \cdot H_4}^{\textstyle \frac{\partial H_4}{\partial H_{4_{\text{in}}}}} \cdot \overbrace{\lambda_{4,6}}^{\textstyle \frac{\partial O_{6_{\text{in}}}}{\partial H_4}} \cdot \overbrace{1.0}^{\textstyle \frac{\partial O_{6}}{\partial O_{6_{in}}}} \cdot \overbrace{(O_6 - Y_1^N)}^{\textstyle \frac{\partial L}{\partial O_{6}}} + \overbrace{\lambda_{1,5}}^{\textstyle \frac{\partial H_{5_{\text{in}}}}{\partial I_1}} \cdot \overbrace{(1 - H_5) \cdot H_5}^{\textstyle \frac{\partial H_5}{\partial H_{5_{\text{in}}}}} \cdot \overbrace{\lambda_{5,6}}^{\textstyle \frac{\partial O_{6_{\text{in}}}}{\partial H_5}} \cdot \overbrace{1.0}^{\textstyle \frac{\partial O_{6}}{\partial O_{6_{in}}}} \cdot \overbrace{(O_6 - Y_1^N)}^{\textstyle \frac{\partial L}{\partial O_{6}}} \right] $$

ä½†è¿™å¯ä»¥é€šè¿‡ç§»é™¤ 1.0 å€¼å¹¶ç»„åˆé¡¹æ¥ç®€åŒ–ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = \left[ \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

ä¸ºäº†å®Œæ•´æ€§ï¼Œè¿™é‡Œæä¾›äº†å…¶ä»–è¾“å…¥èŠ‚ç‚¹çš„åå‘ä¼ æ’­ï¼Œè¿™é‡Œæ˜¯ $\frac{\partial \mathcal{L}}{\partial I_{2_{in}}}$ï¼Œ

![](img/9b186fef88b4e0ad1fa6191394b0e0dd.png)

è¾“å…¥èŠ‚ç‚¹ 2 çš„æŸå¤±å¯¼æ•°çš„åå‘ä¼ æ’­ã€‚

ä¸ºäº†ç®€æ´ï¼Œæˆ‘å·²ç§»é™¤ 1.0s å¹¶å°†åŒç±»é¡¹åˆ†ç»„ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{2_{in}}} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_2} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_2} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{2_{in}}} = \left[ \lambda_{2,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{2,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

è¿™é‡Œæ˜¯ $\frac{\partial \mathcal{L}}{\partial I_{3_{in}}}$ï¼Œ

![](img/90c6a46319d78ae1b9d4f8cdc131fd2a.png)

è¾“å…¥èŠ‚ç‚¹ 3 çš„æŸå¤±å¯¼æ•°çš„åå‘ä¼ æ’­ã€‚

ä¸ºäº†ç®€æ´ï¼Œæˆ‘å·²ç§»é™¤ 1.0s å¹¶å°†åŒç±»é¡¹åˆ†ç»„ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{3_{in}}} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_3} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_3} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{3_{in}}} = \left[ \lambda_{3,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{3,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

### å…³äºæƒé‡å’Œåç½®çš„æŸå¤±å¯¼æ•°

ç°åœ¨æˆ‘ä»¬å·²ç»é€šè¿‡æˆ‘ä»¬çš„ç½‘ç»œåå‘ä¼ æ’­äº†æŸå¤±å¯¼æ•°ã€‚

![](img/97de6228871f7910de4d7a8fa86e0bd8.png)

å…³äºæ‰€æœ‰ç½‘ç»œèŠ‚ç‚¹è¾“å…¥å’Œè¾“å‡ºçš„æŸå¤±å¯¼æ•°çš„åå‘ä¼ æ’­ã€‚

æˆ‘ä»¬å¾—åˆ°äº†ç½‘ç»œä¸­æ¯ä¸ªèŠ‚ç‚¹çš„è¾“å…¥å’Œè¾“å‡ºçš„æŸå¤±å¯¼æ•°ã€‚

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial I_1},\quad \frac{\partial \mathcal{L}}{\partial I_{2_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial I_2},\quad \frac{\partial \mathcal{L}}{\partial I_{3_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial I_3},\quad \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial H_4},\quad \frac{\partial \mathcal{L}}{\partial H_5},\quad \frac{\partial \mathcal{L}}{\partial H_5},\quad \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial O_6} $$

ä½†æˆ‘ä»¬å®é™…ä¸Šéœ€è¦çš„æ˜¯æ¯ä¸ªè¿æ¥æƒé‡çš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial \lambda_{1,4}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{2,4}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{3,4}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{1,5}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{2,5}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{3,5}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{4,6}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{5,6}} $$

ä»¥åŠèŠ‚ç‚¹åå·®ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial b_4},\quad \frac{\partial \mathcal{L}}{\partial b_5},\quad \frac{\partial \mathcal{L}}{\partial b_6} $$

æˆ‘ä»¬å¦‚ä½•å°†æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°è¿æ¥æƒé‡ï¼Ÿè®©æˆ‘ä»¬ä» $H_4$ åˆ° $O_6$ çš„è¿æ¥å¼€å§‹ã€‚

![](img/bf1e650cd4b0613fa09aa5d5c0e72e26.png)

ä¸è¿æ¥æƒé‡ç›¸å…³çš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

é¢„æ¿€æ´»ï¼ŒèŠ‚ç‚¹ $O_6$ çš„è¾“å…¥ä¸ºï¼Œ

$$ O_{6_{\text{in}}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

æˆ‘ä»¬è®¡ç®—è¿æ¥æƒé‡çš„å¯¼æ•°å¦‚ä¸‹ï¼Œ

$$ \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} = \frac{\partial \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \right)}{\partial \lambda_{4,6}} = H_4 $$

æˆ‘ä»¬éœ€è¦å‰ä¸€å±‚èŠ‚ç‚¹é€šè¿‡è¿æ¥ä¼ é€’çš„è¾“å‡ºï¼Œä»¥åå‘ä¼ æ’­åˆ°è¿æ¥æƒé‡ç›¸å¯¹äºè¾“å…¥åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial \lambda_{4,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = H_4 \cdot 1.0 \cdot (O_6 - y) $$

ç°åœ¨ï¼Œä¸ºäº†å®Œæ•´æ€§ï¼Œè¿™é‡Œæ˜¯æˆ‘ä»¬ç½‘ç»œæ‰€æœ‰è¿æ¥æƒé‡çš„æ–¹ç¨‹ã€‚

$$ \frac{\partial \mathcal{L}}{\partial \lambda_{1,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{1,4}} \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = I_1 \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{2,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{2,4}} \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = I_2 \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{3,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{3,4}} \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = I_3 \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{1,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{1,5}} \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} = I_1 \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{2,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{2,5}} \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} = I_2 \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{3,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{3,5}} \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} = I_3 \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{4,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = H_4 \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{5,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{5,6}} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = H_5 \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$

çœ‹çœ‹è¿™ä¸ªæ¨¡å¼ï¼Œå…³äºè¿æ¥æƒé‡çš„æŸå¤±å¯¼æ•°æ˜¯ï¼Œ

$$ \text{è¿æ¥ä¿¡å·} \times \text{ä¸‹ä¸€ä¸ªèŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•°} $$

ç°åœ¨æˆ‘ä»¬å¦‚ä½•å°†æŸå¤±å¯¼æ•°é€†å‘ä¼ æ’­åˆ°èŠ‚ç‚¹åå·®ï¼Ÿè®©æˆ‘ä»¬ä» $O_6$ èŠ‚ç‚¹å¼€å§‹ã€‚

![](img/646997a228f8c1e8a3b2743ac13e388a.png)

å…³äºèŠ‚ç‚¹åå·®çš„é€†å‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

å†æ¬¡ï¼ŒèŠ‚ç‚¹ $O_6$ çš„å‰æ¿€æ´»è¾“å…¥æ˜¯ï¼Œ

$$ O_{6_{\text{in}}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

æˆ‘ä»¬è®¡ç®—è¿æ¥æƒé‡çš„å¯¼æ•°å¦‚ä¸‹ï¼Œ

$$ \frac{\partial O_{6_{\text{in}}}}{\partial b_6} = \frac{\partial \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \right)}{\partial b_6} = 1.0 $$

å› æ­¤ï¼Œæˆ‘ä»¬çš„åå·®æŸå¤±å¯¼æ•°ç­‰äºèŠ‚ç‚¹è¾“å…¥æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial b_6} = \frac{\partial O_{6_{\text{in}}}}{\partial b_6} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = 1.0 \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$

ä¸ºäº†å®Œæ•´æ€§ï¼Œè¿™é‡Œåˆ—å‡ºäº†æ‰€æœ‰å…³äºèŠ‚ç‚¹åç½®çš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial b_6} = \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial b_4} = \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial b_5} = \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$

çœ‹çœ‹è¿™ä¸ªæ¨¡å¼ï¼Œå…³äºèŠ‚ç‚¹åç½®çš„æŸå¤±å¯¼æ•°æ˜¯ï¼Œ

$$ \text{èŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•°} $$

### è®¡ç®—æŸå¤±å¯¼æ•°

åå‘ä¼ æ’­åŸºäºå°†æŸå¤±å¯¼æ•°å‘ååˆ†é…æˆ–ä¼ æ’­é€šè¿‡ç¥ç»ç½‘ç»œçš„æ¦‚å¿µï¼Œ

+   æˆ‘ä»¬è®¡ç®—æŸå¤±å¯¼æ•°ï¼Œç„¶åæŒ‰é¡ºåºä»ç½‘ç»œè¾“å‡ºåå‘åˆ†å¸ƒåˆ°ç½‘ç»œè¾“å…¥

+   é‡è¦çš„æ˜¯è¦çŸ¥é“æˆ‘ä»¬æ­£åœ¨å¤„ç†å¯¼æ•°ï¼Œå¹¶ä¸”åå‘ä¼ æ’­ä¸æ˜¯åˆ†é…é”™è¯¯ï¼Œå°½ç®¡å¦‚æ‚¨æ‰€è§ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼

æˆ‘ä»¬é¦–å…ˆå®šä¹‰æŸå¤±ï¼Œç»™å®šçœŸå®å€¼ $ğ‘¦$ å’Œæˆ‘ä»¬çš„é¢„æµ‹ $\hat{y} = O_6$ï¼Œæˆ‘ä»¬è®¡ç®—æˆ‘ä»¬çš„ $LÂ²$ æŸå¤±å¦‚ä¸‹ï¼Œ

$$ L = \frac{1}{2} \left( \hat{y} - y \right)Â² $$

æˆ‘ä»¬é€‰æ‹©çš„æŸå¤±å‡½æ•°å…è®¸æˆ‘ä»¬ä½¿ç”¨é¢„æµ‹è¯¯å·®ä½œä¸ºæŸå¤±å¯¼æ•°ï¼æˆ‘ä»¬è®¡ç®—æŸå¤±å¯¼æ•°ä½œä¸ºæŸå¤±ç›¸å¯¹äºä¼°è®¡çš„åå¯¼æ•°ï¼Œ$\frac{\partial ğ¿}{\partial \hat{y}}$ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial \hat{y}} = \frac{\partial \frac{1}{2} \left( \hat{y} - y \right)Â² }{\partial \hat{y}} = \hat{y} - y $$

æ‚¨å¯ä»¥çœ‹åˆ°æˆ‘çš„æ„æ€ï¼Œæˆ‘ä»¬æ­£åœ¨åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ï¼Œä½†ç”±äºæˆ‘ä»¬ $LÂ²$ æŸå¤±çš„å…¬å¼ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—è¾“å‡ºèŠ‚ç‚¹çš„é”™è¯¯ï¼Œä½†å†æ¬¡å¼ºè°ƒâ€”â€”å®ƒæ˜¯æŸå¤±å¯¼æ•°ã€‚

![](img/6abf780fa4544caa6735a8f4ad075bd2.png)

åœ¨è¾“å‡ºå±‚èŠ‚ç‚¹ $O_6$ å¤„è®¡ç®—æŸå¤±å¯¼æ•°ã€‚

å¯¹äºæˆ‘ä»¬çš„ç®€å•äººå·¥ç¥ç»ç½‘ç»œç¤ºä¾‹ï¼Œè¾“å‡ºåœ¨èŠ‚ç‚¹ $O_6$ï¼Œæˆ‘ä»¬çš„æŸå¤±å¯¼æ•°æ˜¯ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial O_6} = \frac{\partial \mathcal{L}}{\hat{y}} = \hat{y} - y = O_6 - y $$

å› æ­¤ï¼Œè¿™æ˜¯æˆ‘ä»¬åå‘ä¼ æ’­åˆ°è¾“å‡ºèŠ‚ç‚¹ï¼Œå³è¾“å‡ºèŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç°åœ¨å‡†å¤‡é€šè¿‡æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œåå‘ä¼ æ’­è¿™ä¸ªæŸå¤±å¯¼æ•°ï¼Œè®©æˆ‘ä»¬è°ˆè°ˆæˆ‘ä»¬å¦‚ä½•é€æ­¥é€šè¿‡èŠ‚ç‚¹å’Œè¿æ¥ã€‚

### é€šè¿‡å…·æœ‰æ’ç­‰æ¿€æ´»å‡½æ•°çš„è¾“å‡ºèŠ‚ç‚¹è¿›è¡Œåå‘ä¼ æ’­

è®©æˆ‘ä»¬é€šè¿‡è¾“å‡ºèŠ‚ç‚¹ $O_6$ ä»åæ¿€æ´»åˆ°å‰æ¿€æ´»è¿›è¡Œåå‘ä¼ æ’­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»å‡½æ•°çš„åå¯¼æ•°ã€‚

+   ç”±äºè¿™æ˜¯ä¸€ä¸ªè¾“å‡ºèŠ‚ç‚¹ï¼Œå¹¶ä¸”æˆ‘é€‰æ‹©çš„æ˜¯å›å½’äººå·¥ç¥ç»ç½‘ç»œä¸­çš„æ’ç­‰æˆ–çº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œ

![](img/1141c4e67c550f275e9079501fe522b2.png)

é€šè¿‡èŠ‚ç‚¹ $O_6$ ä»åæ¿€æ´»è¾“å‡ºåˆ°é¢„æ¿€æ´»è¾“å…¥çš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

è¾“å‡ºèŠ‚ç‚¹ $O_6$ çš„æ’ç­‰æ¿€æ´»å®šä¹‰ä¸ºï¼š

$$ O_6 = \sigma(O_{6_{in}}) = O_6 $$

èŠ‚ç‚¹ $O_6$ çš„æ’ç­‰æ¿€æ´»ç›¸å¯¹äºå…¶è¾“å…¥ $O_{6_{in}}$ çš„å¯¼æ•°ï¼Œå³é€šè¿‡èŠ‚ç‚¹ $O_6$ çš„äº¤å‰æ˜¯ï¼Œ

$$ \frac{\partial O_6}{\partial O_{6_{in}}} = \frac{\partial \left(O_{6_{in}} \right)}{\partial O_{6_{in}}} = 1.0 $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦èŠ‚ç‚¹ $O_6$ çš„è¾“å‡ºä¿¡å·ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªä¿¡å·æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»¥ä¾¿ä»èŠ‚ç‚¹è¾“å‡ºçš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_6}$ å’ŒèŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}}$ è¿›è¡Œåå‘ä¼ æ’­ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = 1.0 \cdot (O_6 - y) $$

ç°åœ¨æˆ‘ä»¬å·²ç»é€šè¿‡ä¸€ä¸ªè¾“å‡ºèŠ‚ç‚¹è¿›è¡Œäº†åå‘ä¼ æ’­ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬æ²¿ç€ä»éšè—å±‚åˆ° $H_4$ åˆ° $O_6$ çš„è¿æ¥è¿›è¡Œåå‘ä¼ æ’­ã€‚

### æ²¿ç€è¿æ¥è¿›è¡Œåå‘ä¼ æ’­

ç°åœ¨è®©æˆ‘ä»¬æ²¿ç€èŠ‚ç‚¹ $O_6$ å’Œ $H_4$ ä¹‹é—´çš„è¿æ¥è¿›è¡Œåå‘ä¼ æ’­ã€‚

![](img/1c686c4b3a6fe96317a79c7333542353.png)

é€šè¿‡èŠ‚ç‚¹ $O_6$ ä»åæ¿€æ´»è¾“å‡ºåˆ° $O_{6_{in}}$ é¢„æ¿€æ´»è¾“å…¥çš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ï¼Œç„¶åæ²¿ç€è¿æ¥åˆ°èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºã€‚

é¢„æ¿€æ´»ï¼ŒèŠ‚ç‚¹ $ğ‘‚_6$ çš„è¾“å…¥è®¡ç®—å¦‚ä¸‹ï¼Œ

$$ O_{6_{\text{in}}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

æˆ‘ä»¬è®¡ç®—è¿æ¥çš„å¯¼æ•°å¦‚ä¸‹ï¼Œ

$$ \frac{\partial O_{6_{\text{in}}}}{\partial H_4} = \frac{\partial}{\partial H_4} \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \right) = \lambda_{4,6} $$

é€šè¿‡è§£ä¸Šè¿°åå¯¼æ•°ï¼Œæˆ‘ä»¬çœ‹åˆ°é€šè¿‡åº”ç”¨è¿æ¥æƒé‡è¿›è¡Œè¿æ¥çš„åå‘ä¼ æ’­ã€‚

$$ \frac{\partial O_{6_{\text{in}}}}{\partial H_4} = \lambda_{4,6} $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦å½“å‰çš„è¿æ¥æƒé‡ $\lambda_{4,6}$ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæƒé‡æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»¥ä¾¿æ²¿ç€ä»æŸå¤±å¯¹è¾“å‡ºå±‚èŠ‚ç‚¹è¾“å…¥çš„å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}}$ åˆ°æŸå¤±å¯¹éšè—å±‚èŠ‚ç‚¹è¾“å‡ºçš„å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial H_4}$ çš„ $H_4$ åˆ° $O_6$ è¿æ¥è¿›è¡Œåå‘ä¼ æ’­ã€‚

$$ \frac{\partial \mathcal{L}}{\partial H_4} = \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = \lambda_{4,6} \bigl( \cdot (1 - O_6) \cdot O_6 \bigr) \cdot (O_6 - y) $$

### é€šè¿‡å…·æœ‰ Sigmoid æ¿€æ´»çš„èŠ‚ç‚¹è¿›è¡Œåå‘ä¼ æ’­

è®©æˆ‘ä»¬ä»ä¸€ä¸ªéšè—å±‚èŠ‚ç‚¹ $H_4$ ä»åæ¿€æ´»åˆ°å‰æ¿€æ´»è¿›è¡Œåå‘ä¼ æ’­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»å‡½æ•°çš„åå¯¼æ•°ã€‚

+   æˆ‘ä»¬å‡è®¾æ‰€æœ‰éšè—å±‚èŠ‚ç‚¹ä½¿ç”¨ sigmoid æ¿€æ´»

+   ä¸ºäº†é€»è¾‘ä¸Šçš„æ¸…æ™°ï¼Œæ¯ä¸ªäººéƒ½å°†æ¿€æ´»å¯¼æ•°ä½œä¸ºè¾“å‡ºè€Œä¸æ˜¯å…¸å‹è¾“å…¥çš„å‡½æ•°æ¥è§£æï¼Œ

![](img/10ef488402716c36aa45b497ea54f6bb.png)

é€šè¿‡èŠ‚ç‚¹ $H_4$ ä» $H_4$ åæ¿€æ´»è¾“å‡ºåˆ° $H_{4_{in}}$ å‰æ¿€æ´»è¾“å…¥çš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

è¾“å‡ºèŠ‚ç‚¹ $H_4$ çš„ sigmoid æ¿€æ´»å®šä¹‰ä¸ºï¼š

$$ H_4 = \sigma(H_{4_{in}}) = \frac{1}{1 + e^{-H_{4_{in}}}} $$

èŠ‚ç‚¹ $H_4$ çš„ sigmoid æ¿€æ´»ç›¸å¯¹äºå…¶è¾“å…¥ $H_{4_{in}}$ çš„å¯¼æ•°ï¼Œå³ç©¿è¿‡èŠ‚ç‚¹ $H_4$ æ˜¯ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = \frac{\partial}{\partial H_{4_{in}}} \left( \frac{1}{1 + e^{-H_{4_{in}}}} \right) $$

ç°åœ¨ï¼Œä¸ºäº†ç®€æ´çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬è®¾ï¼Œ

$$ u = e^{-H_{4_{in}}} $$

å¹¶ä»£å…¥æˆ‘ä»¬å¾—åˆ°ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = \frac{\partial}{\partial H_{4_{in}}} \left( \frac{1}{1 + u} \right) $$

é€šè¿‡é“¾å¼æ³•åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ‰©å±•ä¸ºï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = \frac{\partial}{\partial H_{4_{in}}} \left( \frac{1}{1 + u} \right) = -\frac{u}{(1 + u)Â²} \cdot \frac{\partial u}{\partial H_{4_{in}}} $$

$u = e^{-H_{4_{in}}}$ å¯¹ $H_{4_{in}}$ çš„å¯¼æ•°æ˜¯ï¼š

$$ \frac{\partial u}{\partial H_{4_{in}}} = -e^{-H_{4_{in}}} = -u $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»£å…¥ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{in}}} = -\frac{1}{(1+u)Â²} \cdot (-u) = \frac{u}{(1+u)Â²} $$

ç”¨èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºè¡¨ç¤ºï¼Œ$H_4 = \frac{1}{1 + u}$ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{\text{in}}}} = \frac{\left(1 - H_4\right)/H_4}{\left(1/H_4\right)Â²} = \frac{1 - H_4}{H_4} \cdot H_4Â² = \left(1 - H_4\right) \cdot H_4 $$

å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æˆ‘ä»¬çš„èŠ‚ç‚¹ $H_4$ ä»èŠ‚ç‚¹åæ¿€æ´»è¾“å‡º $H_4$ åˆ°èŠ‚ç‚¹å‰æ¿€æ´»è¾“å…¥ $H_{4_{in}}$ è¿›è¡Œåå‘ä¼ æ’­ï¼Œ

$$ \frac{\partial H_4}{\partial H_{4_{\text{in}}}} = \left(1 - H_4\right) \cdot H_4 $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºä¿¡å·ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†å…¶æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°èŠ‚ç‚¹ $H_4$ çš„è¾“å‡ºå’ŒèŠ‚ç‚¹ $H_4$ çš„è¾“å…¥ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥å¤„ç†æˆ‘ä»¬ç½‘ç»œä¸­èŠ‚ç‚¹çš„æ‰€æœ‰åå‘ä¼ æ’­æƒ…å†µã€‚

### æ²¿å¦ä¸€ä¸ªè¿æ¥è¿›è¡Œåå‘ä¼ æ’­

ä¸ºäº†è¿ç»­æ€§å’Œå®Œæ•´æ€§ï¼Œè®©æˆ‘ä»¬é‡å¤ä¹‹å‰æè¿°çš„æ–¹æ³•ï¼Œé€šè¿‡è¿æ¥ $I_1$ åˆ° $H_4$ è¿›è¡Œåå‘ä¼ æ’­ã€‚

![](img/76f408b8ed852b03a168e6069bb716db.png)

æ²¿ç€ä» $H_4$ åˆ° $I_1$ çš„è¿æ¥è¿›è¡ŒæŸå¤±å¯¼æ•°çš„åå‘ä¼ æ’­ã€‚

å†æ¬¡ï¼ŒèŠ‚ç‚¹ $H_4$ çš„å‰æ¿€æ´»è¾“å…¥è®¡ç®—å¦‚ä¸‹ï¼Œ

$$ H_{4_{\text{in}}} = \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 $$

æˆ‘ä»¬è®¡ç®—æ²¿è¿æ¥çš„å¯¼æ•°ï¼Œ

$$ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} = \frac{\partial \left(\lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 \right)}{\partial I_1} = \lambda_{1,4} $$

é€šè¿‡è§£å†³ä¸Šè¿°åå¯¼æ•°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡åº”ç”¨è¿æ¥æƒé‡æ²¿è¿æ¥è¿›è¡Œåå‘ä¼ æ’­ã€‚

$$ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} = \lambda_{4,6} $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦å½“å‰çš„è¿æ¥æƒé‡ $\lambda_{4,6}$ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†å…¶æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»è¾“å‡ºå±‚èŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}}$ï¼Œåˆ°éšè—å±‚èŠ‚ç‚¹è¾“å‡ºçš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial H_4}$ æ²¿ $H_4$ åˆ° $O_6$ è¿æ¥è¿›è¡Œåå‘ä¼ æ’­ã€‚

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} = \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) $$

### è€ƒè™‘å¤šæ¡è·¯å¾„

æˆ‘ä»¬å…³äºèŠ‚ç‚¹è¾“å‡º $I_1$ çš„æŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial I_1}$ æ˜¯ä¸æ­£ç¡®çš„ï¼

+   æˆ‘ä»¬å·²ç»è€ƒè™‘äº†ä» $O_6$ åˆ° $H_4$ åˆ° $I_1$ çš„è·¯å¾„ï¼Œä½†æ²¡æœ‰è€ƒè™‘ä» $O_6$ åˆ° $H_5$ åˆ° $I_1$ çš„è·¯å¾„

![](img/6a68404e4b3d2589dcfe15beb5175c60.png)

ä»è¾“å‡ºèŠ‚ç‚¹ $O_6$ åˆ°è¾“å…¥èŠ‚ç‚¹ $I_1$ çš„åå‘ä¼ æ’­æœ‰å¤šæ¡è·¯å¾„ã€‚

ä¸ºäº†è€ƒè™‘å¤šæ¡è·¯å¾„ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹æ‰€æœ‰è·¯å¾„è¿›è¡Œæ±‚å’Œã€‚

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} + \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

æˆ‘ä»¬å¯ä»¥å°†å…¶è¯„ä¼°ä¸ºï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) + \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \cdot 1.0 \cdot (O_6 - y) $$

ç„¶åé€šè¿‡ç§»é™¤ 1.0 å€¼å’Œåˆ†ç»„é¡¹è¿›è¡Œç®€åŒ–ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_1} = \left[ \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

### é€šè¿‡å…·æœ‰æ’ç­‰æ¿€æ´»çš„è¾“å…¥èŠ‚ç‚¹è¿›è¡Œåå‘ä¼ æ’­

è®©æˆ‘ä»¬é€šè¿‡æˆ‘ä»¬çš„è¾“å…¥èŠ‚ç‚¹ $I_1$ ä»åæ¿€æ´»åˆ°å‰æ¿€æ´»è¿›è¡Œåå‘ä¼ æ’­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»å‡½æ•°çš„åå¯¼æ•°ã€‚

+   ç”±äºè¿™æ˜¯ä¸€ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œæˆ‘é€‰æ‹©äº†æ’ç­‰æˆ–çº¿æ€§æ¿€æ´»å‡½æ•°ã€‚

![](img/bd05208edfb4ac5d5cc0f8cfe808ae50.png)

é€šè¿‡èŠ‚ç‚¹ $I_1$ çš„æŸå¤±å¯¼æ•°åå‘ä¼ æ’­ï¼Œä» $I_1$ çš„åæ¿€æ´»è¾“å‡ºåˆ° $I_{1_{in}}$ çš„å‰æ¿€æ´»è¾“å…¥ã€‚

è¾“å‡ºèŠ‚ç‚¹ $I_1$ çš„æ’ç­‰æ¿€æ´»å®šä¹‰ä¸ºï¼š

$$ I_1 = \sigma(I_{1_{in}}) = I_1 $$

èŠ‚ç‚¹ $I_1$ çš„æ’ç­‰æ¿€æ´»ç›¸å¯¹äºå…¶è¾“å…¥ $I_{1_{in}}$ çš„å¯¼æ•°ï¼Œå³é€šè¿‡èŠ‚ç‚¹ $I_1$ çš„ä¼ é€’ï¼Œæ˜¯ï¼Œ

$$ \frac{\partial I_1}{\partial I_{1_{in}}} = \frac{\partial \left(I_{1_{in}} \right)}{\partial I_{1_{in}}} = 1.0 $$

æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦ $I_1$ï¼Œå³ä»èŠ‚ç‚¹è¾“å‡ºçš„ä¿¡å·ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾å¼æ³•åˆ™ä¸­ï¼Œä»èŠ‚ç‚¹è¾“å‡ºç›¸å¯¹äºæŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial I_1}$ åå‘ä¼ æ’­ï¼Œåˆ°èŠ‚ç‚¹è¾“å…¥ç›¸å¯¹äºæŸå¤±å¯¼æ•° $\frac{\partial \mathcal{L}}{\partial I_{1_{\text{in}}}}$ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = \frac{\partial I_1}{\partial I_{1_{in}}} \cdot \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} + \frac{\partial I_1}{\partial I_{1_{in}}} \cdot \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

æˆ‘ä»¬å¯ä»¥è¿™æ ·è¯„ä¼°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = 1.0 \cdot \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} \cdot 1.0 \cdot (O_6 - y) + 1.0 \cdot \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \cdot 1.0 \cdot (O_6 - y) $$

ä¸ºäº†è¶£å‘³æ€§ï¼Œæˆ‘è®¾è®¡äº†è¿™ç§ç¬¦å·ä»¥å®ç°æœ€å¤§æ¸…æ™°åº¦ï¼Œ

$$ \frac{\partial L}{\partial I_{1_{\text{in}}}} = \overbrace{1.0}^{\textstyle \frac{\partial I_{1}}{\partial I_{1_{in}}}} \left[ \overbrace{\lambda_{1,4}}^{\textstyle \frac{\partial H_{4_{\text{in}}}}{\partial I_1}} \cdot \overbrace{(1 - H_4) \cdot H_4}^{\textstyle \frac{\partial H_4}{\partial H_{4_{\text{in}}}}} \cdot \overbrace{\lambda_{4,6}}^{\textstyle \frac{\partial O_{6_{\text{in}}}}{\partial H_4}} \cdot \overbrace{1.0}^{\textstyle \frac{\partial O_{6}}{\partial O_{6_{in}}}} \cdot \overbrace{(O_6 - Y_1^N)}^{\textstyle \frac{\partial L}{\partial O_{6}}} + \overbrace{\lambda_{1,5}}^{\textstyle \frac{\partial H_{5_{\text{in}}}}{\partial I_1}} \cdot \overbrace{(1 - H_5) \cdot H_5}^{\textstyle \frac{\partial H_5}{\partial H_{5_{\text{in}}}}} \cdot \overbrace{\lambda_{5,6}}^{\textstyle \frac{\partial O_{6_{\text{in}}}}{\partial H_5}} \cdot \overbrace{1.0}^{\textstyle \frac{\partial O_{6}}{\partial O_{6_{in}}}} \cdot \overbrace{(O_6 - Y_1^N)}^{\textstyle \frac{\partial L}{\partial O_{6}}} \right] $$

ä½†å¯ä»¥é€šè¿‡ç§»é™¤ 1.0 å€¼å¹¶åˆå¹¶åŒç±»é¡¹æ¥ç®€åŒ–ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_1} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼äº†ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{in}}} = \left[ \lambda_{1,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{1,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

ä¸ºäº†å®Œæ•´æ€§ï¼Œè¿™é‡Œæä¾›äº†å…¶ä»–è¾“å…¥èŠ‚ç‚¹çš„åå‘ä¼ æ’­ï¼Œè¿™é‡Œæ˜¯ $\frac{\partial \mathcal{L}}{\partial I_{2_{in}}}$ï¼Œ

![](img/9b186fef88b4e0ad1fa6191394b0e0dd.png)

è¾“å…¥èŠ‚ç‚¹ 2 çš„æŸå¤±å¯¼æ•°åå‘ä¼ æ’­ã€‚

ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘å·²ç»ç§»é™¤äº† 1.0 å¹¶åˆå¹¶äº†åŒç±»é¡¹ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{2_{in}}} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_2} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_2} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼äº†ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{2_{in}}} = \left[ \lambda_{2,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{2,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

è¿™é‡Œæ˜¯ $\frac{\partial \mathcal{L}}{\partial I_{3_{in}}}$ï¼Œ

![](img/90c6a46319d78ae1b9d4f8cdc131fd2a.png)

åå‘ä¼ æ’­è¾“å…¥èŠ‚ç‚¹ 3 çš„æŸå¤±å¯¼æ•°ã€‚

ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘å·²ç§»é™¤ 1.0 å¹¶åˆå¹¶äº†åŒç±»é¡¹ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{3_{in}}} = \left[ \frac{\partial H_{4_{\text{in}}}}{\partial I_3} \cdot \frac{\partial H_4}{\partial H_{4_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_4} + \frac{\partial H_{5_{\text{in}}}}{\partial I_3} \cdot \frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \right] \cdot \frac{\partial \mathcal{L}}{\partial O_6} $$

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯„ä¼°è¿™ä¸ªç®€åŒ–çš„å½¢å¼ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{3_{in}}} = \left[ \lambda_{3,4} \cdot \bigl((1 - H_4) \cdot H_4 \bigr) \cdot \lambda_{4,6} + \lambda_{3,5} \cdot \bigl((1 - H_5) \cdot H_5 \bigr) \cdot \lambda_{5,6} \right] \cdot (O_6 - y) $$

### å…³äºæƒé‡å’Œåå·®çš„æŸå¤±å¯¼æ•°

ç°åœ¨æˆ‘ä»¬å·²ç»é€šè¿‡æˆ‘ä»¬çš„ç½‘ç»œåå‘ä¼ æ’­äº†æŸå¤±å¯¼æ•°ã€‚

![](img/97de6228871f7910de4d7a8fa86e0bd8.png)

åå‘ä¼ æ’­æ‰€æœ‰ç½‘ç»œèŠ‚ç‚¹è¾“å…¥å’Œè¾“å‡ºçš„æŸå¤±å¯¼æ•°ã€‚

æˆ‘ä»¬å¾—åˆ°äº†ç½‘ç»œä¸­æ¯ä¸ªèŠ‚ç‚¹è¾“å…¥å’Œè¾“å‡ºçš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial I_{1_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial I_1},\quad \frac{\partial \mathcal{L}}{\partial I_{2_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial I_2},\quad \frac{\partial \mathcal{L}}{\partial I_{3_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial I_3},\quad \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial H_4},\quad \frac{\partial \mathcal{L}}{\partial H_5},\quad \frac{\partial \mathcal{L}}{\partial H_5},\quad \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}},\quad \frac{\partial \mathcal{L}}{\partial O_6} $$

ä½†æˆ‘ä»¬å®é™…ä¸Šéœ€è¦çš„æ˜¯æ¯ä¸ªè¿æ¥æƒé‡çš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial \lambda_{1,4}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{2,4}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{3,4}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{1,5}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{2,5}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{3,5}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{4,6}},\quad \frac{\partial \mathcal{L}}{\partial \lambda_{5,6}} $$

ä»¥åŠèŠ‚ç‚¹åå·®ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial b_4},\quad \frac{\partial \mathcal{L}}{\partial b_5},\quad \frac{\partial \mathcal{L}}{\partial b_6} $$

æˆ‘ä»¬å¦‚ä½•å°†æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°è¿æ¥æƒé‡ï¼Ÿè®©æˆ‘ä»¬ä»$H_4$åˆ°$O_6$çš„è¿æ¥å¼€å§‹ã€‚

![](img/bf1e650cd4b0613fa09aa5d5c0e72e26.png)

å…³äºè¿æ¥æƒé‡çš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

é¢„æ¿€æ´»ï¼ŒèŠ‚ç‚¹$O_6$çš„è¾“å…¥ï¼Œ

$$ O_{6_{\text{in}}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

æˆ‘ä»¬è®¡ç®—å…³äºè¿æ¥æƒé‡çš„å¯¼æ•°å¦‚ä¸‹ï¼Œ

$$ \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} = \frac{\partial \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \right)}{\partial \lambda_{4,6}} = H_4 $$

æˆ‘ä»¬éœ€è¦å°†å‰ä¸€å±‚èŠ‚ç‚¹çš„è¾“å‡ºé€šè¿‡è¿æ¥ä¼ é€’ï¼Œä»¥åå‘ä¼ æ’­åˆ°è¿æ¥æƒé‡ç›¸å¯¹äºä¸‹ä¸€ä¸ªèŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial \lambda_{4,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = H_4 \cdot 1.0 \cdot (O_6 - y) $$

ç°åœ¨ï¼Œä¸ºäº†å®Œæ•´æ€§ï¼Œè¿™é‡Œæ˜¯æˆ‘ä»¬ç½‘ç»œæ‰€æœ‰è¿æ¥æƒé‡çš„æ–¹ç¨‹ã€‚

$$ \frac{\partial \mathcal{L}}{\partial \lambda_{1,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{1,4}} \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = I_1 \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{2,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{2,4}} \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = I_2 \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{3,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{3,4}} \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} = I_3 \cdot \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{1,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{1,5}} \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} = I_1 \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{2,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{2,5}} \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} = I_2 \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{3,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{3,5}} \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} = I_3 \cdot \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{4,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = H_4 \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial \lambda_{5,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{5,6}} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = H_5 \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$

çœ‹åˆ°æ¨¡å¼äº†ï¼Œå…³äºè¿æ¥æƒé‡çš„æŸå¤±å¯¼æ•°æ˜¯ï¼Œ

$$ \text{è¿æ¥ä¿¡å·} \times \text{ä¸‹ä¸€ä¸ªèŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•°} $$

ç°åœ¨å¦‚ä½•å°†æŸå¤±å¯¼æ•°åå‘ä¼ æ’­åˆ°èŠ‚ç‚¹åç½®ï¼Ÿè®©æˆ‘ä»¬ä» $O_6$ èŠ‚ç‚¹å¼€å§‹ã€‚

![](img/646997a228f8c1e8a3b2743ac13e388a.png)

å…³äºèŠ‚ç‚¹åç½®çš„åå‘ä¼ æ’­æŸå¤±å¯¼æ•°ã€‚

å†æ¬¡å¼ºè°ƒï¼Œé¢„æ¿€æ´»ï¼ŒèŠ‚ç‚¹ $O_6$ çš„è¾“å…¥æ˜¯ï¼Œ

$$ O_{6_{\text{in}}} = \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 $$

æˆ‘ä»¬è®¡ç®—è¿æ¥æƒé‡çš„å¯¼æ•°å¦‚ä¸‹ï¼Œ

$$ \frac{\partial O_{6_{\text{in}}}}{\partial b_6} = \frac{\partial \left( \lambda_{4,6} \cdot H_4 + \lambda_{5,6} \cdot H_5 + b_6 \right)}{\partial b_6} = 1.0 $$

å› æ­¤ï¼Œæˆ‘ä»¬çš„åç½®æŸå¤±å¯¼æ•°ç­‰äºèŠ‚ç‚¹è¾“å…¥æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial b_6} = \frac{\partial O_{6_{\text{in}}}}{\partial b_6} \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} = 1.0 \cdot \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$

ä¸ºäº†å®Œæ•´æ€§ï¼Œè¿™é‡Œåˆ—å‡ºäº†æ‰€æœ‰å…³äºèŠ‚ç‚¹åç½®çš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial \mathcal{L}}{\partial b_6} = \frac{\partial \mathcal{L}}{\partial O_{6_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial b_4} = \frac{\partial \mathcal{L}}{\partial H_{4_{\text{in}}}} $$$$ \frac{\partial \mathcal{L}}{\partial b_5} = \frac{\partial \mathcal{L}}{\partial H_{5_{\text{in}}}} $$

çœ‹çœ‹è¿™ä¸ªæ¨¡å¼ï¼Œå…³äºèŠ‚ç‚¹åç½®çš„æŸå¤±å¯¼æ•°æ˜¯ï¼Œ

$$ \text{èŠ‚ç‚¹è¾“å…¥çš„æŸå¤±å¯¼æ•°} $$

## åå‘ä¼ æ’­ç¤ºä¾‹

è®©æˆ‘ä»¬å°†ä¸Šé¢è§£é‡Šçš„åå‘ä¼ æ’­æ–¹æ³•åº”ç”¨åˆ°æˆ‘çš„äº¤äº’å¼ç¥ç»ç½‘ç»œä¸­ã€‚

+   è¿™é‡Œæ˜¯åªæœ‰ 1 ä¸ªæ ·æœ¬çš„ç¬¬ä¸€è½®è®­ç»ƒçš„ç»“æœï¼Œ

![](img/b8b7d56b334d9728490cb2bc1408535e.png)

ç¬¬ä¸€è½®è¿­ä»£çš„åå‘ä¼ æ’­ç»“æœã€‚

æˆ‘çš„äº¤äº’å¼ä»ªè¡¨æ¿æä¾›äº†æ¯ä¸ªèŠ‚ç‚¹ç›¸å¯¹äºè¾“å…¥çš„æ‰€æœ‰æŸå¤±å¯¼æ•°ä»¥åŠæ¯ä¸ªèŠ‚ç‚¹çš„è¾“å‡ºä¿¡å·ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®— $\frac{\partial L}{\partial \lambda_{4,6}}$ å¦‚ä¸‹ï¼Œ

$$ \frac{\partial L}{\partial \lambda_{4,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} \cdot \frac{\partial L}{\partial O_{6_{\text{in}}}} = H_4 \cdot \frac{\partial L}{\partial O_{6_{\text{in}}}} = 0.42 \cdot 1.00 = 0.42 $$

è¿™é‡Œæ˜¯å…³äºå…¶ä»–éšè—å±‚åˆ°è¾“å‡ºèŠ‚ç‚¹è¿æ¥çš„æŸå¤±å¯¼æ•°ï¼Œ

$$ \frac{\partial L}{\partial \lambda_{5,6}} = \frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{5,6}} \cdot \frac{\partial L}{\partial O_{6_{\text{in}}}} = H_5 \cdot \frac{\partial L}{\partial O_{6_{\text{in}}}} = 0.60 \cdot 1.00 = 0.60 $$

ç°åœ¨è®©æˆ‘ä»¬è·å–æ‰€æœ‰è¾“å…¥åˆ°éšè—å±‚è¿æ¥ï¼Œ

$$ \frac{\partial L}{\partial \lambda_{1,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{1,4}} \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = I_1 \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = 0.50 \cdot (-0.13) = -0.07 $$$$ \frac{\partial L}{\partial \lambda_{1,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{1,5}} \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = I_1 \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = 0.50 \cdot (-0.10) = -0.05 $$$$ \frac{\partial L}{\partial \lambda_{2,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{2,4}} \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = I_2 \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = 0.20 \cdot (-0.13) = -0.03 $$$$ \frac{\partial L}{\partial \lambda_{2,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{2,5}} \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = I_2 \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = 0.20 \cdot (-0.10) = -0.02 $$$$ \frac{\partial L}{\partial \lambda_{3,4}} = \frac{\partial H_{4_{\text{in}}}}{\partial \lambda_{3,4}} \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = I_3 \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = 0.70 \cdot (-0.13) = -0.09 $$$$ \frac{\partial L}{\partial \lambda_{3,5}} = \frac{\partial H_{5_{\text{in}}}}{\partial \lambda_{3,5}} \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = I_3 \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = 0.70 \cdot (-0.10) = -0.07 $$

è¿™å¤„ç†äº†æ‰€æœ‰è¿æ¥æƒé‡è¯¯å·®çš„å¯¼æ•°ï¼Œç°åœ¨è®©æˆ‘ä»¬å¤„ç†èŠ‚ç‚¹åç½®è¯¯å·®çš„å¯¼æ•°ã€‚

+   èŠ‚ç‚¹åç½®è¯¯å·®çš„å¯¼æ•°ä¸èŠ‚ç‚¹æ¯ä¸ªæ¿€æ´»è¯¯å·®çš„å¯¼æ•°ç›¸åŒã€‚ç°åœ¨è®©æˆ‘ä»¬è®¡ç®—éšè—å±‚ä¸­çš„åç½®é¡¹ï¼Œ

$$ \frac{\partial L}{\partial b_4} = \frac{\partial H_{4_{\text{in}}}}{\partial b_4} \cdot \frac{\partial L}{\partial H_{4_{\text{in}}}} = 1.0 \cdot (-0.13) = -0.13 $$$$ \frac{\partial L}{\partial b_5} = \frac{\partial H_{5_{\text{in}}}}{\partial b_5} \cdot \frac{\partial L}{\partial H_{5_{\text{in}}}} = 1.0 \cdot (-0.1) = -0.10 $$

## æ›´æ–°æ¨¡å‹å‚æ•°

æ¨¡å‹å‚æ•°ç›¸å¯¹äºæ¯ä¸ªå‚æ•°çš„æŸå¤±å¯¼æ•°æ˜¯æ¢¯åº¦ï¼Œå› æ­¤æˆ‘ä»¬å‡†å¤‡ä½¿ç”¨æ¢¯åº¦ä¸‹é™ä¼˜åŒ–ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œ

+   **å­¦ä¹ ç‡** - ä¸ºäº†ç¼©æ”¾æ¨¡å‹æ›´æ–°çš„å˜åŒ–ç‡ï¼Œæˆ‘ä»¬åˆ†é…ä¸€ä¸ªå­¦ä¹ ç‡ï¼Œ$\eta$ã€‚å¯¹äºä¸Šé¢æåˆ°çš„æ¨¡å‹å‚æ•°ç¤ºä¾‹ï¼Œ

$$ \lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \eta \cdot \frac{\partial L}{\partial \lambda_{4,6}} $$$$ \lambda_{1,4}^{\ell} = \lambda_{1,4}^{\ell - 1} + \eta \cdot \frac{\partial L}{\partial \lambda_{1,4}} $$$$ b_j^{\ell} = b_j^{\ell - 1} + \eta \cdot \frac{\partial L}{\partial b_j} $$

+   å›æƒ³ä¸€ä¸‹ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æ¢¯åº¦è®¡ç®—å’Œæ¨¡å‹å‚æ•°ã€æƒé‡å’Œåç½®çš„æ›´æ–°ï¼Œæ˜¯è¿­ä»£è¿›è¡Œçš„ï¼Œè¢«ç§°ä¸ºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–ã€‚

+   ç›®æ ‡æ˜¯æ¢ç´¢æŸå¤±è¶…æ›²é¢ï¼Œé¿å…å’Œé€ƒç¦»å±€éƒ¨æœ€å°å€¼ï¼Œæœ€ç»ˆæ‰¾åˆ°å…¨å±€æœ€å°å€¼ã€‚

+   å­¦ä¹ ç‡ï¼Œä¹Ÿç§°ä¸ºæ­¥é•¿ï¼Œé€šå¸¸è®¾ç½®åœ¨ 0.0 å’Œ 1.0 ä¹‹é—´ï¼Œæ³¨æ„åœ¨ TensorFlow çš„ Keras æ¨¡å—ä¸­é»˜è®¤ä¸º 0.01

+   **ä½å­¦ä¹ ç‡** â€“ æ›´ç¨³å®šï¼Œä½†è§£çš„é€Ÿåº¦è¾ƒæ…¢ï¼Œå¯èƒ½ä¼šé™·å…¥å±€éƒ¨æœ€å°å€¼

+   **é«˜å­¦ä¹ ç‡** â€“ å¯èƒ½ä¸ç¨³å®šï¼Œä½†å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¿«çš„è§£ï¼Œå¯èƒ½ä¼šå‘æ•£å‡ºå…¨å±€æœ€å°å€¼

ä¸€ç§ç­–ç•¥æ˜¯å¼€å§‹ä½¿ç”¨é«˜å­¦ä¹ ç‡ï¼Œç„¶ååœ¨è¿­ä»£è¿‡ç¨‹ä¸­é™ä½å­¦ä¹ ç‡

+   **å­¦ä¹ ç‡è¡°å‡** - è®¾ç½®ä¸º > 0 ä»¥é¿å…å‡è½»æŒ¯è¡ï¼Œ

$$ \eta^{\ell} = \eta^{\ell - 1} \cdot \left( \frac{1}{1 + \text{decay} \cdot \ell} \right) $$

å…¶ä¸­ $\ell$ æ˜¯æ¨¡å‹è®­ç»ƒå‘¨æœŸ

æ³¨æ„ï¼Œæ¨¡å‹å‚æ•°æ›´æ–°æ˜¯é’ˆå¯¹å•ä¸ªè®­ç»ƒæ•°æ®æ¡ˆä¾‹çš„ï¼Ÿè€ƒè™‘è¿™ä¸ªå•ä¸ªæ¨¡å‹å‚æ•°ï¼Œ

æˆ‘ä»¬è®¡ç®—æ‰¹ä¸­æ‰€æœ‰æ ·æœ¬çš„æ›´æ–°ï¼Œå¹¶åº”ç”¨æ›´æ–°çš„å¹³å‡å€¼ã€‚

$$ \frac{\partial L}{\partial \lambda_{4,6}} = H_4 \cdot \frac{\partial L}{\partial O_{6_{\text{in}}}} = 0.42 \cdot 1.00 = 0.42 $$

åº”ç”¨ä»¥æ›´æ–° $\lambda_{4,6}$ å‚æ•°ï¼Œ

$$ \lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \eta \cdot \frac{\partial L}{\partial \lambda_{4,6}} $$

å®ƒä¾èµ–äº $H_4$ èŠ‚ç‚¹è¾“å‡ºå’Œ $L$ é”™è¯¯ï¼Œè¿™äº›æ˜¯é’ˆå¯¹å•ä¸ªæ ·æœ¬ $ğ‘¥_1,\ldots,ğ‘¥_ğ‘š$ å’Œ $ğ‘¦$ çš„ï¼›å› æ­¤ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨æ‰€æœ‰ $1,\ldots,n$ ä¸ªè®­ç»ƒæ•°æ®æ ·æœ¬ä¸Šè®¡ç®—å•ä¸ªå‚æ•°æ›´æ–°ã€‚

+   æˆ‘ä»¬å¯ä»¥è®¡ç®— $1,\ldots,n$ æ¬¡æ›´æ–°ï¼Œç„¶åå°†æ‰€æœ‰æ›´æ–°çš„å¹³å‡å€¼åº”ç”¨äºæˆ‘ä»¬çš„æ¨¡å‹å‚æ•°ï¼Œ

$$ \lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \frac{1}{n_{batch}} \sum_{i=1}^{n_{batch}} \eta \cdot \frac{\partial L}{\partial \lambda_{4,6}} $$

+   ç”±äºå­¦ä¹ ç‡æ˜¯å¸¸æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç§»å‡ºæ±‚å’Œç¬¦å·ï¼Œç°åœ¨æˆ‘ä»¬æ­£åœ¨å¹³å‡æ¢¯åº¦ï¼Œ

$$ \lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \eta \frac{1}{n_{batch}} \sum_{i=1}^{n_{batch}} \frac{\partial L}{\partial \lambda_{4,6}} $$

## è®­ç»ƒå‘¨æœŸ

ç°åœ¨æ˜¯è®¨è®ºéšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–çš„å¥½æ—¶æœºï¼Œé¦–å…ˆè®©æˆ‘ä»¬å®šä¹‰ä¸€äº›å¸¸è§æœ¯è¯­ï¼Œ

+   **æ‰¹é‡æ¢¯åº¦ä¸‹é™** - åœ¨é€šè¿‡æ‰€æœ‰æ•°æ®åæ›´æ–°æ¨¡å‹å‚æ•°

+   **éšæœºæ¢¯åº¦ä¸‹é™** - åœ¨æ¯ä¸ªæ ·æœ¬æ•°æ®ä¸Šæ›´æ–°æ¨¡å‹å‚æ•°

+   **å°æ‰¹é‡æ¢¯åº¦ä¸‹é™** - åœ¨é€šè¿‡å•ä¸ªæ‰¹åæ›´æ–°æ¨¡å‹å‚æ•°

ä½¿ç”¨å°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ—¶ï¼Œé€šè¿‡ä½¿ç”¨æ•°æ®å­é›†ï¼ˆç§°ä¸ºæ‰¹æ¬¡ï¼‰å¼•å…¥éšæœºæ€§ï¼Œ

+   ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæˆ‘ä»¬çš„ 100 ä¸ªæ ·æœ¬åˆ†æˆ 4 ä¸ªæ‰¹æ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ†åˆ«è¿­ä»£æ¯ä¸ªæ‰¹æ¬¡

+   æˆ‘ä»¬åŠ å¿«äº†å•ä¸ªæ›´æ–°çš„é€Ÿåº¦ï¼Œæ›´å°‘çš„æ•°æ®æ›´å¿«åœ°è®¡ç®—ï¼Œä½†å¼•å…¥äº†æ›´å¤šçš„é”™è¯¯

+   è¿™é€šå¸¸æœ‰åŠ©äºè®­ç»ƒæ¢ç´¢å…¨å±€æœ€å°å€¼ï¼Œå¹¶é¿å…é™·å…¥æŸå¤±è¶…æ›²é¢ä¸Šçš„å±€éƒ¨æœ€å°å€¼å’Œè„Šä¸­

æœ€åï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå®šä¹‰æœ€åä¸€ä¸ªæœ¯è¯­ï¼Œ

+   **å‘¨æœŸ** - æ˜¯å¯¹å…¨éƒ¨æ•°æ®çš„å•æ¬¡éå†ï¼Œå› æ­¤å¦‚æœæœ‰ 4 ä¸ªå°æ‰¹é‡ï¼Œé‚£ä¹ˆå°†è¿›è¡Œ 4 æ¬¡æ›´æ–°æ¨¡å‹å‚æ•°çš„è¿­ä»£

æˆ‘è¿˜ä¼šæ·»åŠ è®¸å¤šå…¶ä»–è€ƒè™‘å› ç´ ï¼ŒåŒ…æ‹¬ï¼Œ

+   åŠ¨é‡

+   è‡ªé€‚åº”ä¼˜åŒ–

ç°åœ¨æˆ‘ä»¬æ‰‹åŠ¨æ„å»ºä¸Šè¿°äººå·¥ç¥ç»ç½‘ç»œå¹¶å¯è§†åŒ–è§£å†³æ–¹æ¡ˆï¼

+   è¿™æ˜¯æ‰‹åŠ¨ç¼–å†™çš„ï¼Œè¿™æ ·ä½ å¯ä»¥çœ‹åˆ°æ¯ä¸ªè®¡ç®—ã€‚æˆ‘æ•…æ„é¿å…ä½¿ç”¨ TensorFlow æˆ– PyTorchã€‚

## äº¤äº’å¼ä»ªè¡¨æ¿

æˆ‘ä½¿ç”¨ä»¥ä¸‹ä»£ç æ„å»ºäº†ä¸€ä¸ªäº¤äº’å¼ Python ä»ªè¡¨æ¿ï¼Œç”¨äºè®­ç»ƒäººå·¥ç¥ç»ç½‘ç»œã€‚ä½ å¯ä»¥é€æ­¥é€šè¿‡è®­ç»ƒè¿­ä»£ï¼Œå¹¶åœ¨è®­ç»ƒæ—¶é—´æ­¥ä¸­è§‚å¯Ÿï¼Œ

+   æ¨¡å‹å‚æ•°

+   å‰å‘ä¼ é€’é¢„æµ‹

+   é”™è¯¯å¯¼æ•°çš„åå‘ä¼ æ’­

å¦‚æœä½ æƒ³çœ‹åˆ°äººå·¥ç¥ç»ç½‘ç»œçš„å®é™…åº”ç”¨ï¼Œè¯·æŸ¥çœ‹æˆ‘çš„[ANN äº¤äº’å¼ Python ä»ªè¡¨æ¿](https://github.com/GeostatsGuy/DataScienceInteractivePython/blob/main/Interactive_ANN.ipynb)ï¼Œ

![å›¾ç‰‡](img/ab7e3b58fcfdbf8f7a2c19b5d78c7736.png)

äº¤äº’å¼äººå·¥ç¥ç»ç½‘ç»œè®­ç»ƒ Python ä»ªè¡¨æ¿ã€‚

## å¯¼å…¥æ‰€éœ€åŒ…

æˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›æ ‡å‡†åŒ…ã€‚è¿™äº›åº”è¯¥å·²ç»ä¸ Anaconda 3 ä¸€èµ·å®‰è£…ã€‚

```py
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from matplotlib.ticker import (MultipleLocator, AutoMinorLocator, AutoLocator) # control of axes ticks
plt.rc('axes', axisbelow=True)                            # set axes and grids in the background for all plots
import math
seed = 13 
```

å¦‚æœä½ é‡åˆ°åŒ…å¯¼å…¥é”™è¯¯ï¼Œä½ å¯èƒ½é¦–å…ˆéœ€è¦å®‰è£…å…¶ä¸­çš„ä¸€äº›åŒ…ã€‚è¿™é€šå¸¸å¯ä»¥é€šè¿‡åœ¨ Windows ä¸Šæ‰“å¼€å‘½ä»¤çª—å£ç„¶åè¾“å…¥â€˜python -m pip install [package-name]â€™æ¥å®Œæˆã€‚æœ‰å…³ç›¸åº”åŒ…çš„æ–‡æ¡£ä¸­æä¾›äº†æ›´å¤šå¸®åŠ©ã€‚

## å£°æ˜å‡½æ•°

è¿™é‡Œæ˜¯åˆ›å»ºã€è®­ç»ƒå’Œå¯è§†åŒ–æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œçš„å‡½æ•°ã€‚

```py
def add_grid():
    plt.gca().grid(True, which='major',linewidth = 1.0); plt.gca().grid(True, which='minor',linewidth = 0.2) # add y grids
    plt.gca().tick_params(which='major',length=7); plt.gca().tick_params(which='minor', length=4)
    plt.gca().xaxis.set_minor_locator(AutoMinorLocator()); plt.gca().yaxis.set_minor_locator(AutoMinorLocator()) # turn on minor ticks 

def calculate_angle_rads(x1, y1, x2, y2):
    dx = x2 - x1     # Calculate the differences
    dy = y2 - y1
    angle_rads = math.atan2(dy, dx)    # Calculate the angle in radians
    #angle_degrees = math.degrees(angle_radians)    # Convert the angle to degrees
    return angle_rads

def offset(pto, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = pto[0] + distance * math.cos(angle_rads) # Calculate the new coordinates
    y_new = pto[1] + distance * math.sin(angle_rads)
    return np.array((x_new, y_new))

def offsetx(xo, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates
    return np.array((xo, x_new))

def offset_arrx(xo, distance, angle_deg,size): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates
    x_arr = x_new + size * math.cos(angle_rads+2.48) # Calculate the new coordinates
    return np.array((x_new, x_arr))

def offsety(yo, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates
    return np.array((yo, y_new))

def offset_arry(yo, distance, angle_deg,size): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates
    y_arr = y_new + size * math.sin(angle_rads+2.48) # Calculate the new coordinates
    return np.array((y_new, y_arr))

def lint(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    x = x1 + t * (x2 - x1)
    y = y1 + t * (y2 - y1)
    return np.array((x, y))

def lintx(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    x = x1 + t * (x2 - x1)
    return x

def linty(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    y = y1 + t * (y2 - y1)
    return y

def lint_intx(x1, y1, x2, y2, ts, te):
    # Calculate the interpolated coordinates
    xs = x1 + ts * (x2 - x1)
    xe = x1 + te * (x2 - x1)
    return np.array((xs,xe))

def lint_inty(x1, y1, x2, y2, ts, te):
    # Calculate the interpolated coordinates
    ys = y1 + ts * (y2 - y1)
    ye = y1 + te * (y2 - y1)
    return np.array((ys,ye))

def lint_int_arrx(x1, y1, x2, y2, ts, te, size):
    # Calculate the interpolated coordinates
    xe = x1 + te * (x2 - x1)
    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)
    x_arr = xe + size * math.cos(line_angle_rads+2.48) # Calculate the new coordinates
    return np.array((xe,x_arr))

def lint_int_arry(x1, y1, x2, y2, ts, te, size):
    # Calculate the interpolated coordinates
    ye = y1 + te * (y2 - y1)
    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)
    y_arr = ye + size * math.sin(line_angle_rads+2.48) # Calculate the new coordinates
    return np.array((ye,y_arr))

def as_si(x, ndp): # from xnx on StackOverflow https://stackoverflow.com/questions/31453422/displaying-numbers-with-x-instead-of-e-scientific-notation-in-matplotlib 
    s = '{x:0.{ndp:d}e}'.format(x=x, ndp=ndp)
    m, e = s.split('e')
    return r'{m:s}\times 10^{{{e:d}}}'.format(m=m, e=int(e)) 
```

## ç®€å• ANN

æˆ‘ç¼–å†™äº†ä»¥ä¸‹ä»£ç æ¥æŒ‡å®šä¸€ä¸ªç®€å•çš„ ANNï¼š

+   ä¸‰ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œ2 ä¸ªéšè—èŠ‚ç‚¹å’Œ 1 ä¸ªè¾“å‡ºèŠ‚ç‚¹

å¹¶ä¸”é€šè¿‡è¿­ä»£æ‰§è¡Œå‰å‘è®¡ç®—å’Œåå‘ä¼ æ’­æ¥è®­ç»ƒ ANNã€‚æˆ‘è®¡ç®—ï¼š

+   é”™è¯¯ä»¥åŠå°†å…¶ä¼ æ’­åˆ°æ¯ä¸ªèŠ‚ç‚¹

+   æ±‚è§£è¯¯å·®ç›¸å¯¹äºæ¯ä¸ªæƒé‡å’Œåå·®çš„åå¯¼æ•°

æ‰€æœ‰æƒé‡ã€åå·®å’Œæ‰€æœ‰æ—¶é—´æ­¥çš„åå¯¼æ•°éƒ½è®°å½•åœ¨å‘é‡ä¸­ä»¥ä¾¿ç»˜å›¾

```py
x1 = 0.5; x2 = 0.2; x3 = 0.7; y = 0.3 # training data
lr = 0.2 # learning rate

np.random.seed(seed=seed)

nepoch = 1000

y4 = np.zeros(nepoch); y5 = np.zeros(nepoch); y6 = np.zeros(nepoch)

w14 = np.zeros(nepoch); w24 = np.zeros(nepoch); w34 = np.zeros(nepoch)
w15 = np.zeros(nepoch); w25 = np.zeros(nepoch); w35 = np.zeros(nepoch)
w46 = np.zeros(nepoch); w56 = np.zeros(nepoch)

dw14 = np.zeros(nepoch); dw24 = np.zeros(nepoch); dw34 = np.zeros(nepoch)
dw15 = np.zeros(nepoch); dw25 = np.zeros(nepoch); dw35 = np.zeros(nepoch)
dw46 = np.zeros(nepoch); dw56 = np.zeros(nepoch)

db4 = np.zeros(nepoch); db5 = np.zeros(nepoch); db6 = np.zeros(nepoch)

b4 = np.zeros(nepoch); b5 = np.zeros(nepoch); b6 = np.zeros(nepoch)
y4 = np.zeros(nepoch); y5 = np.zeros(nepoch); y6 = np.zeros(nepoch)
d4 = np.zeros(nepoch); d5 = np.zeros(nepoch); d6 = np.zeros(nepoch)

# initialize the weights - Xavier Weight Initialization 
lower, upper = -(1.0 / np.sqrt(3.0)), (1.0 / np.sqrt(3.0)) # lower and upper bound for the weights, uses inputs to node
#lower, upper = -(sqrt(6.0) / sqrt(3.0 + 2.0)), (sqrt(6.0) / sqrt(3.0 + 2.0)) # Normalized Xavier weights, integrates ouputs also
w14[0] = lower + np.random.random() * (upper - lower); 
w24[0] = lower + np.random.random() * (upper - lower); 
w34[0] = lower + np.random.random() * (upper - lower);
w15[0] = lower + np.random.random() * (upper - lower); 
w25[0] = lower + np.random.random() * (upper - lower); 
w35[0] = lower + np.random.random() * (upper - lower);

lower, upper = -(1.0 / np.sqrt(2.0)), (1.0 / np.sqrt(2.0))
#lower, upper = -(sqrt(6.0) / sqrt(2.0 + 1.0)), (sqrt(6.0) / sqrt(2.0 + 1.0)) # Normalized Xavier weights, integrates ouputs also

w46[0] = lower + np.random.random() * (upper - lower); 
w56[0] = lower + np.random.random() * (upper - lower);     

#b4[0] = np.random.random(); b5[0] = np.random.random(); b6[0] = np.random.random()
b4[0] = (np.random.random()-0.5)*0.5; b5[0] = (np.random.random()-0.5)*0.5; b6[0] = (np.random.random()-0.5)*0.5; # small random value 

for i in range(0,nepoch):

# forward pass of model
    y4[i] = w14[i]*x1 + w24[i]*x2 + w34[i]*x3 + b4[i]; 
    y4[i] = 1.0/(1 + math.exp(-1*y4[i]))

    y5[i] = w15[i]*x1 + w25[i]*x2 + w35[i]*x3 + b5[i]
    y5[i] = 1.0/(1 + math.exp(-1*y5[i]))

    y6[i] = w46[i]*y4[i] + w56[i]*y5[i] + b6[i]
#    y6[i] = 1.0/(1 + math.exp(-1*y6[i])) # sgimoid / logistic activation at o6 

# back propagate the error through the nodes
#    d6[i] = y6[i]*(1-y6[i])*(y-y6[i]) # sgimoid / logistic activation at o6 
    d6[i] = (y-y6[i]) # identity activation o at o6
    d5[i] = y5[i]*(1-y5[i])*w56[i]*d6[i]; d4[i] = y4[i]*(1-y4[i])*w46[i]*d6[i]

# calculate the change in weights
    if i < nepoch - 1:
        dw14[i] = lr*d4[i]*x1; dw24[i] = lr*d4[i]*x2; dw34[i] = lr*d4[i]*x3
        dw15[i] = lr*d5[i]*x1; dw25[i] = lr*d5[i]*x2; dw35[i] = lr*d5[i]*x3
        dw46[i] = lr*d6[i]*y4[i]; dw56[i] = lr*d6[i]*y5[i] 

        db4[i] = lr*d4[i]; db5[i] = lr*d5[i]; db6[i] = lr*d6[i];

        w14[i+1] = w14[i] + dw14[i]; w24[i+1] = w24[i] + dw24[i]; w34[i+1] = w34[i] + dw34[i] 
        w15[i+1] = w15[i] + dw15[i]; w25[i+1] = w25[i] + dw25[i]; w35[i+1] = w35[i] + dw35[i] 
        w46[i+1] = w46[i] + dw46[i]; w56[i+1] = w56[i] + dw56[i]

        b4[i+1] = b4[i] + db4[i]; b5[i+1] = b5[i] + db5[i]; b6[i+1] = b6[i] + db6[i] 
```

## ç°åœ¨å¯è§†åŒ–ç‰¹å®šæ—¶é—´æ­¥çš„ç½‘ç»œ

æˆ‘åœ¨ä¸‹é¢ç¼–å†™äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ç½‘ç»œå¯è§†åŒ–ï¼Œé€‰æ‹© iepoch å¹¶å¯è§†åŒ–ç‰¹å®šæ—¶é—´æ­¥çš„äººå·¥ç¥ç»ç½‘ç»œã€‚

```py
iepoch = 1

dx = -0.19; dy = -0.09; edge = 1.0

o6x = 17; o6y =5; h5x = 10; h5y = 3.5; h4x = 10; h4y = 6.5
i1x = 3; i1y = 9.0; i2x = 3; i2y = 5; i3x = 3; i3y = 1.0; buffer = 0.5

plt.subplot(111)
plt.gca().set_axis_off()

circle_i1 = plt.Circle((i1x,i1y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_1$',(i1x+dx,i1y+dy),zorder=100); 
circle_i1b = plt.Circle((i1x,i1y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)

circle_i2 = plt.Circle((i2x,i2y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_2$',(i2x+dx,i2y+dy),zorder=100); 
circle_i2b = plt.Circle((i2x,i2y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_i2); plt.gca().add_patch(circle_i2b)

circle_i3 = plt.Circle((i3x,i3y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_3$',(i3x+dx,i3y+dy),zorder=100); 
circle_i3b = plt.Circle((i3x,i3y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_i3); plt.gca().add_patch(circle_i3b)

circle_h4 = plt.Circle((h4x,h4y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$H_4$',(h4x+dx,h4y+dy),zorder=100); 
circle_h4b = plt.Circle((h4x,h4y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_h4); plt.gca().add_patch(circle_h4b)

circle_h5 = plt.Circle((h5x,h5y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$H_5$',(h5x+dx,h5y+dy),zorder=100); 
circle_h5b = plt.Circle((h5x,h5y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_h5); plt.gca().add_patch(circle_h5b)

circle_o6 = plt.Circle((o6x,o6y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$O_6$',(o6x+dx,o6y+dy),zorder=100); 
circle_o6b = plt.Circle((o6x,o6y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);
plt.gca().add_patch(circle_o6); plt.gca().add_patch(circle_o6b)

plt.plot([i1x-edge,i1x],[i1y,i1y],color='grey',lw=1.0,zorder=1)
plt.plot([i2x-edge,i2x],[i2y,i2y],color='grey',lw=1.0,zorder=1)
plt.plot([i3x-edge,i3x],[i3y,i3y],color='grey',lw=1.0,zorder=1)

plt.annotate(r'$x_1$ = ' + str(np.round(x1,2)),(i1x-buffer-1.6,i1y-0.05),size=8,zorder=200,color='grey',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) 
plt.annotate(r'$x_2$ = ' + str(np.round(x2,2)),(i2x-buffer-1.6,i2y-0.05),size=8,zorder=200,color='grey',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) 
plt.annotate(r'$x_3$ = ' + str(np.round(x3,2)),(i3x-buffer-1.6,i3y-0.05),size=8,zorder=200,color='grey',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) 

plt.plot([i1x,h4x],[i1y,h4y],color='lightcoral',lw=1.0,zorder=1)
plt.plot([i2x,h4x],[i2y,h4y],color='red',lw=1.0,zorder=1)
plt.plot([i3x,h4x],[i3y,h4y],color='darkred',lw=1.0,zorder=1)

plt.plot([i1x,h5x],[i1y,h5y],color='dodgerblue',lw=1.0,zorder=1)
plt.plot([i2x,h5x],[i2y,h5y],color='blue',lw=1.0,zorder=1)
plt.plot([i3x,h5x],[i3y,h5y],color='darkblue',lw=1.0,zorder=1)

plt.plot([h4x,o6x],[h4y,o6y],color='orange',lw=1.0,zorder=1)
plt.plot([h5x,o6x],[h5y,o6y],color='darkorange',lw=1.0,zorder=1)

plt.plot([o6x+edge,o6x],[o6y,o6y],color='grey',lw=1.0,zorder=1)
plt.annotate(r'$\hat{y}$ = ' + str(np.round(y6[iepoch],2)),(o6x+buffer+0.7,o6y-0.05),size=8,zorder=200,color='grey',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) 

plt.plot(offsetx(h4x,2,-12),offsety(h4y,2,-12)+0.1,color='orange',lw=1.0,zorder=1)
plt.plot(offset_arrx(h4x,2,-12,0.2),offset_arry(h4y,2,-12,0.2)+0.1,color='orange',lw=1.0,zorder=1)
plt.annotate(r'$H_{4}$ = ' + str(np.round(y4[iepoch],2)),(lintx(h4x,h4y,o6x,o6y,0.08),linty(h4x,h4y,o6x,o6y,0.08)-0.0),size=8,zorder=200,color='orange',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12)

plt.plot(offsetx(h5x,2,12),offsety(h5y,2,12)+0.1,color='darkorange',lw=1.0,zorder=1)
plt.plot(offset_arrx(h5x,2,12,0.2),offset_arry(h5y,2,12,0.2)+0.1,color='darkorange',lw=1.0,zorder=1)
plt.annotate(r'$H_{5}$ = ' + str(np.round(y5[iepoch],2)),(lintx(h5x,h5y,o6x,o6y,0.07),linty(h5x,h5y,o6x,o6y,0.07)+0.25),size=8,zorder=200,color='darkorange',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)

plt.annotate(r'$\frac{\partial P}{\partial O_{6_{in}}}$ = ' + str(np.round(d6[iepoch],2)),(o6x-0.5,o6y-0.7),size=10)
plt.annotate(r'$\frac{\partial P}{\partial H_{4_{in}}}$ = ' + str(np.round(d4[iepoch],2)),(h4x-0.5,h4y-0.7),size=10)
plt.annotate(r'$\frac{\partial P}{\partial H_{5_{in}}}$ = ' + str(np.round(d5[iepoch],2)),(h5x-0.5,h5y-0.7),size=10)

plt.annotate(r'$\frac{\partial P}{\partial \hat{y}}$ = ' + str(np.round(d6[iepoch],2)),(o6x,o6y-1.2),size=10)
plt.annotate(r'$\frac{\partial P}{\partial H_{4_{out}}}$ = ' + str(np.round(w46[iepoch]*d6[iepoch],2)),(h4x,h4y-1.2),size=10)
plt.annotate(r'$\frac{\partial P}{\partial H_{5_{out}}}$ = ' + str(np.round(w56[iepoch]*d6[iepoch],2)),(h5x,h5y-1.2),size=10)

plt.plot(lint_intx(h4x, h4y, o6x, o6y,0.4,0.6),lint_inty(h4x,h4y,o6x,o6y,0.4,0.6)-0.1,color='orange',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(o6x,o6y,h4x,h4y,0.4,0.6,0.2),lint_int_arry(o6x,o6y,h4x,h4y,0.4,0.6,0.2)-0.1,color='orange',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{4,6}}$ = ' + str(np.round(dw46[iepoch]/lr,4)),(lintx(h4x,h4y,o6x,o6y,0.5)-0.6,linty(h4x,h4y,o6x,o6y,0.5)-0.72),size=10,zorder=200,color='orange',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-11)

plt.plot(lint_intx(h5x, h5y, o6x, o6y,0.4,0.6),lint_inty(h5x,h5y,o6x,o6y,0.4,0.6)-0.1,color='darkorange',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(o6x,o6y,h5x,h5y,0.4,0.6,0.2),lint_int_arry(o6x,o6y,h5x,h5y,0.4,0.6,0.2)-0.1,color='darkorange',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{5,6}}$ = ' + str(np.round(dw56[iepoch]/lr,4)),(lintx(h5x,h5y,o6x,o6y,0.5)-0.4,linty(h5x,h5y,o6x,o6y,0.5)-0.6),size=10,zorder=200,color='darkorange',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)

plt.plot(offsetx(i1x,2,-20),offsety(i1y,2,-20)+0.1,color='lightcoral',lw=1.0,zorder=1)
plt.plot(offset_arrx(i1x,2,-20,0.2),offset_arry(i1y,2,-20,0.2)+0.1,color='lightcoral',lw=1.0,zorder=1)
plt.annotate(r'$I_{1}$ = ' + str(np.round(x1,2)),(lintx(i1x,i1y,h4x,h4y,0.1),linty(i1x,i1y,h4x,h4y,0.1)),size=8,zorder=200,color='lightcoral',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-20)

plt.plot(offsetx(i2x,2,12),offsety(i2y,2,12)+0.1,color='red',lw=1.0,zorder=1)
plt.plot(offset_arrx(i2x,2,12,0.2),offset_arry(i2y,2,12,0.2)+0.1,color='red',lw=1.0,zorder=1)
plt.annotate(r'$I_{2}$ = ' + str(np.round(x2,2)),(lintx(i2x,i2y,h4x,h4y,0.1),linty(i2x,i2y,h4x,h4y,0.1)+0.22),size=8,zorder=200,color='red',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)

plt.plot(offsetx(i3x,2,38),offsety(i3y,2,38)+0.1,color='darkred',lw=1.0,zorder=1)
plt.plot(offset_arrx(i3x,2,38,0.2),offset_arry(i3y,2,38,0.2)+0.1,color='darkred',lw=1.0,zorder=1)
plt.annotate(r'$I_{3}$ = ' + str(np.round(x3,2)),(lintx(i3x,i3y,h4x,h4y,0.08)-0.2,linty(i3x,i3y,h4x,h4y,0.08)+0.2),size=8,zorder=200,color='darkred',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=38)

plt.annotate(r'$\lambda_{1,4}$ = ' + str(np.round(w14[iepoch],2)),((i1x+h4x)*0.45,(i1y+h4y)*0.5-0.05),size=8,zorder=200,color='lightcoral',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-18) 
plt.annotate(r'$\lambda_{2,4}$ = ' + str(np.round(w24[iepoch],2)),((i2x+h4x)*0.45-0.3,(i2y+h4y)*0.5-0.03),size=8,zorder=200,color='red',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=10) 
plt.annotate(r'$\lambda_{3,4}$ = ' + str(np.round(w34[iepoch],2)),((i3x+h4x)*0.45-1.2,(i3y+h4y)*0.5-1.1),size=8,zorder=200,color='darkred',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=38) 

plt.annotate(r'$\lambda_{1,5}$ = ' + str(np.round(w15[iepoch],2)),((i1x+h5x)*0.55-2.5,(i1y+h5y)*0.5+0.9),size=8,zorder=200,color='dodgerblue',
    bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-36) 
plt.annotate(r'$\lambda_{2,5}$ = ' + str(np.round(w25[iepoch],2)),((i2x+h5x)*0.55-1.5,(i2y+h5y)*0.5+0.05),size=8,zorder=200,color='blue',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12) 
plt.annotate(r'$\lambda_{3,5}$ = ' + str(np.round(w35[iepoch],2)),((i3x+h5x)*0.55-1.0,(i3y+h5y)*0.5+0.1),size=8,zorder=200,color='darkblue',
             bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=20) 

plt.annotate(r'$\lambda_{4,6}$ = ' + str(np.round(w46[iepoch],2)),((h4x+o6x)*0.47,(h4y+o6y)*0.47+0.39),size=8,zorder=200,color='orange',
    bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12) 
plt.annotate(r'$\lambda_{5,6}$ = ' + str(np.round(w56[iepoch],2)),((h5x+o6x)*0.47,(h5y+o6y)*0.47+0.26),size=8,zorder=200,color='darkorange',
    bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=12) 

plt.plot(lint_intx(i1x, i1y, h4x, h4y,0.4,0.6),lint_inty(i1x,i1y,h4x,h4y,0.4,0.6)-0.1,color='lightcoral',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h4x,h4y,i1x,i1y,0.4,0.6,0.2),lint_int_arry(h4x,h4y,i1x,i1y,0.4,0.6,0.2)-0.1,color='lightcoral',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{1,4}} =$' + r'${0:s}$'.format(as_si(dw14[iepoch]/lr,2)),(lintx(i1x,i1y,h4x,h4y,0.5)-0.6,linty(i1x,i1y,h4x,h4y,0.5)-1.0),size=8,zorder=200,color='lightcoral',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-20)

plt.plot(lint_intx(i2x, i2y, h4x, h4y,0.3,0.5),lint_inty(i2x,i2y,h4x,h4y,0.3,0.5)-0.1,color='red',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h4x,h4y,i2x,i2y,0.5,0.7,0.2),lint_int_arry(h4x,h4y,i2x,i2y,0.5,0.7,0.2)-0.12,color='red',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{2,4}} =$' + r'${0:s}$'.format(as_si(dw24[iepoch]/lr,2)),(lintx(i2x,i2y,h4x,h4y,0.5)-1.05,linty(i2x,i2y,h4x,h4y,0.5)-0.7),size=8,zorder=200,color='red',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)

plt.plot(lint_intx(i3x, i3y, h4x, h4y,0.2,0.4),lint_inty(i3x,i3y,h4x,h4y,0.2,0.4)-0.1,color='darkred',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h4x,h4y,i3x,i3y,0.5,0.8,0.2),lint_int_arry(h4x,h4y,i3x,i3y,0.5,0.8,0.2)-0.12,color='darkred',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{3,4}} =$' + r'${0:s}$'.format(as_si(dw34[iepoch]/lr,2)),(lintx(i3x,i3y,h4x,h4y,0.5)-1.7,linty(i3x,i3y,h4x,h4y,0.5)-1.7),size=8,zorder=200,color='darkred',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=38)

plt.plot(lint_intx(i3x, i3y, h5x, h5y,0.4,0.6),lint_inty(i3x,i3y,h5x,h5y,0.4,0.6)-0.1,color='darkblue',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h5x,h5y,i3x,i3y,0.4,0.6,0.2),lint_int_arry(h5x,h5y,i3x,i3y,0.4,0.6,0.2)-0.12,color='darkblue',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{3,5}} =$' + r'${0:s}$'.format(as_si(dw35[iepoch]/lr,2)),(lintx(i3x,i3y,h5x,h5y,0.5)-0.4,linty(i3x,i3y,h5x,h5y,0.5)-0.6),size=8,zorder=200,color='darkblue',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=20)

plt.plot(lint_intx(i2x, i2y, h5x, h5y,0.3,0.5),lint_inty(i2x,i2y,h5x,h5y,0.3,0.5)-0.1,color='blue',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h5x,h5y,i2x,i2y,0.3,0.7,0.2),lint_int_arry(h5x,h5y,i2x,i2y,0.3,0.7,0.2)-0.12,color='blue',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{2,5}} =$' + r'${0:s}$'.format(as_si(dw25[iepoch]/lr,2)),(lintx(i2x,i2y,h5x,h5y,0.5)-1.2,linty(i2x,i2y,h5x,h5y,0.5)-0.65),size=8,zorder=200,color='blue',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12)

plt.plot(lint_intx(i1x, i1y, h5x, h5y,0.2,0.4),lint_inty(i1x,i1y,h5x,h5y,0.2,0.4)-0.1,color='dodgerblue',lw=1.0,zorder=1)
plt.plot(lint_int_arrx(h5x,h5y,i1x,i1y,0.2,0.8,0.2),lint_int_arry(h5x,h5y,i1x,i1y,0.2,0.8,0.2)-0.12,color='dodgerblue',lw=1.0,zorder=1)
plt.annotate(r'$\frac{\partial P}{\partial \lambda_{1,5}} =$' + r'${0:s}$'.format(as_si(dw15[iepoch]/lr,2)),(lintx(i1x,i1y,h5x,h5y,0.5)-2.2,linty(i1x,i1y,h4x,h4y,0.5)-1.5),size=8,zorder=200,color='dodgerblue',
              bbox=dict(boxstyle="round,pad=0.0", edgecolor='white', facecolor='white', alpha=1.0),rotation=-36,xycoords = 'data')

plt.subplots_adjust(left=0.0, bottom=0.0, right=1.5, top=1.0, wspace=0.2, hspace=0.2); plt.show() 
```

![å›¾ç‰‡](img/6c1b34f06ebf3ebfafbbd206fc1033ca.png)

## æ£€æŸ¥ ANN æ”¶æ•›æ€§

ç°åœ¨æˆ‘ä»¬ç»˜åˆ¶æƒé‡ã€åå·®å’Œé¢„æµ‹éšæ—¶é—´çš„å˜åŒ–ï¼Œä»¥æ£€æŸ¥è®­ç»ƒæ”¶æ•›æ€§ã€‚

```py
plt.subplot(131)
plt.plot(np.arange(1,nepoch+1,1),y6,color='red',label=r'$\hat{y}$'); plt.xlim([1,nepoch]); plt.ylim([0,1])
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('Simple Artificial Neural Network Prediction')
plt.plot([1,nepoch],[y,y],color='black',ls='--'); plt.vlines(400,-1.5,1.5,color='black')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(132)
plt.plot(np.arange(1,nepoch+1,1),w14,color='lightcoral',label = r'$\lambda_{1,4}$') 
plt.plot(np.arange(1,nepoch+1,1),w24,color='red',label = r'$\lambda_{2,4}$') 
plt.plot(np.arange(1,nepoch+1,1),w34,color='darkred',label = r'$\lambda_{3,4}$') 
plt.plot(np.arange(1,nepoch+1,1),w15,color='dodgerblue',label = r'$\lambda_{1,5}$') 
plt.plot(np.arange(1,nepoch+1,1),w25,color='blue',label = r'$\lambda_{2,5}$') 
plt.plot(np.arange(1,nepoch+1,1),w35,color='darkblue',label = r'$\lambda_{3,5}$')
plt.plot(np.arange(1,nepoch+1,1),w46,color='orange',label = r'$\lambda_{4,6}$')
plt.plot(np.arange(1,nepoch+1,1),w56,color='darkorange',label = r'$\lambda_{5,6}$')
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('Simple Artificial Neural Network Weights')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(133)
plt.plot(np.arange(1,nepoch+1,1),w14,color='lightgreen',label = r'$\phi_{4}$') 
plt.plot(np.arange(1,nepoch+1,1),w24,color='green',label = r'$\phi_{5}$') 
plt.plot(np.arange(1,nepoch+1,1),w34,color='darkgreen',label = r'$\phi_{6}$') 
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('Simple Artificial Neural Network Biases')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplots_adjust(left=0.0, bottom=0.0, right=3.0, top=1.0, wspace=0.2, hspace=0.2); plt.show() 
```

![å›¾ç‰‡](img/41e5da630bdb6e70068ef584a2fc3d47.png)

## è¯„è®º

è¿™æ˜¯å¯¹äººå·¥ç¥ç»ç½‘ç»œçš„åŸºæœ¬ä»‹ç»ã€‚å¯ä»¥åšå’Œè®¨è®ºçš„è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘æœ‰å¾ˆå¤šæ›´å¤šçš„èµ„æºã€‚æŸ¥çœ‹æˆ‘çš„[å…±äº«èµ„æºæ¸…å•](https://michaelpyrcz.com/my-resources)ä»¥åŠæœ¬ç« å¼€å¤´å¸¦æœ‰èµ„æºé“¾æ¥çš„è§†é¢‘è®²åº§ YouTube é“¾æ¥ã€‚

å¸Œæœ›è¿™æœ‰æ‰€å¸®åŠ©ï¼Œ

*è¿ˆå…‹å°”*

## å…³äºä½œè€…

![å›¾ç‰‡](img/eb709b2c0a0c715da01ae0165efdf3b2.png)

å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ 40 è‹±äº©æ ¡å›­å†…ï¼Œè¿ˆå…‹å°”Â·çš®å°”å¥‡æ•™æˆçš„åŠå…¬å®¤ã€‚

è¿ˆå…‹å°”Â·çš®å°”å¥‡æ˜¯å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡[Cockrell å·¥ç¨‹å­¦é™¢](https://cockrell.utexas.edu/faculty-directory/alphabetical/p)å’Œ[æ°å…‹é€Šåœ°çƒç§‘å­¦å­¦é™¢](https://www.jsg.utexas.edu/researcher/michael_pyrcz/)çš„æ•™æˆï¼Œåœ¨é‚£é‡Œä»–ä»äº‹å’Œæ•™æˆåœ°ä¸‹ã€ç©ºé—´æ•°æ®åˆ†æã€åœ°ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ã€‚è¿ˆå…‹å°”è¿˜ï¼Œ

+   æ˜¯[èƒ½æºåˆ†æ](https://fri.cns.utexas.edu/energy-analytics)æ–°ç”Ÿç ”ç©¶é¡¹ç›®çš„é¦–å¸­ç ”ç©¶å‘˜ï¼Œå¹¶åœ¨å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡è‡ªç„¶ç§‘å­¦å­¦é™¢æœºå™¨å­¦ä¹ å®éªŒå®¤æ‹…ä»»æ ¸å¿ƒæ•™å‘˜

+   è¿˜æ˜¯[è®¡ç®—æœºä¸åœ°çƒç§‘å­¦](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board)çš„å‰¯ç¼–è¾‘ï¼Œä»¥åŠå›½é™…æ•°å­¦åœ°çƒç§‘å­¦åä¼š[æ•°å­¦åœ°çƒç§‘å­¦](https://link.springer.com/journal/11004/editorial-board)çš„è‘£äº‹ä¼šæˆå‘˜ã€‚

è¿ˆå…‹å°”å·²ç»æ’°å†™äº† 70 å¤šç¯‡[åŒè¡Œè¯„å®¡å‡ºç‰ˆç‰©](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en)ï¼Œä¸€ä¸ªç”¨äºç©ºé—´æ•°æ®åˆ†æçš„[Python åŒ…](https://pypi.org/project/geostatspy/)ï¼Œåˆè‘—äº†ä¸€æœ¬å…³äºç©ºé—´æ•°æ®åˆ†æçš„æ•™ç§‘ä¹¦[åœ°ç»Ÿè®¡å­¦å‚¨å±‚å»ºæ¨¡](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)ï¼Œå¹¶æ˜¯ä¸¤æœ¬æœ€è¿‘å‘å¸ƒçš„ç”µå­ä¹¦çš„ä½œè€…ï¼Œ[Python åº”ç”¨åœ°ç»Ÿè®¡å­¦ï¼šGeostatsPy åŠ¨æ‰‹æŒ‡å—](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)å’Œ[Python åº”ç”¨æœºå™¨å­¦ä¹ ï¼šå¸¦ä»£ç çš„åŠ¨æ‰‹æŒ‡å—](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html)ã€‚

è¿ˆå…‹å°”çš„æ‰€æœ‰å¤§å­¦è®²åº§éƒ½å¯ä»¥åœ¨ä»–çš„[YouTube é¢‘é“](https://www.youtube.com/@GeostatsGuyLectures)ä¸Šæ‰¾åˆ°ï¼Œé™„æœ‰ 100 å¤šä¸ª Python äº¤äº’å¼ä»ªè¡¨æ¿å’Œ 40 å¤šä¸ª GitHub ä»“åº“ä¸­çš„è¯¦ç»†æ–‡æ¡£å·¥ä½œæµç¨‹é“¾æ¥ï¼Œä»¥æ”¯æŒä»»ä½•æ„Ÿå…´è¶£çš„å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«ã€‚æƒ³äº†è§£æ›´å¤šå…³äºè¿ˆå…‹å°”çš„å·¥ä½œå’Œå…±äº«æ•™è‚²èµ„æºï¼Œè¯·è®¿é—®ä»–çš„ç½‘ç«™ã€‚

## æƒ³ä¸€èµ·å·¥ä½œå—ï¼Ÿ

æˆ‘å¸Œæœ›è¿™äº›å†…å®¹å¯¹é‚£äº›æƒ³äº†è§£æ›´å¤šå…³äºåœ°ä¸‹å»ºæ¨¡ã€æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ çš„äººæœ‰æ‰€å¸®åŠ©ã€‚å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«éƒ½æ¬¢è¿å‚åŠ ã€‚

+   æƒ³é‚€è¯·æˆ‘åˆ°è´µå…¬å¸è¿›è¡ŒåŸ¹è®­ã€è¾…å¯¼ã€é¡¹ç›®å®¡æŸ¥ã€å·¥ä½œæµç¨‹è®¾è®¡å’Œ/æˆ–å’¨è¯¢ï¼Ÿæˆ‘å¾ˆä¹æ„æ‹œè®¿å¹¶ä¸æ‚¨åˆä½œï¼

+   æƒ³è¦åˆä½œã€æ”¯æŒæˆ‘çš„ç ”ç©¶ç”Ÿç ”ç©¶æˆ–æˆ‘çš„åœ°ä¸‹æ•°æ®åˆ†æä¸æœºå™¨å­¦ä¹ è”ç›Ÿï¼ˆå…±åŒè´Ÿè´£äººæ˜¯çº¦ç¿°Â·ç¦æ–¯ç‰¹æ•™æˆï¼‰å—ï¼Ÿæˆ‘çš„ç ”ç©¶å°†æ•°æ®åˆ†æã€éšæœºå»ºæ¨¡å’Œæœºå™¨å­¦ä¹ ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œä»¥å¼€å‘æ–°çš„æ–¹æ³•å’Œå·¥ä½œæµç¨‹ï¼Œå¢åŠ ä»·å€¼ã€‚æˆ‘ä»¬æ­£åœ¨è§£å†³å…·æœ‰æŒ‘æˆ˜æ€§çš„åœ°ä¸‹é—®é¢˜ï¼

+   æ‚¨å¯ä»¥é€šè¿‡ mpyrcz@austin.utexas.edu è”ç³»æˆ‘ã€‚

æˆ‘æ€»æ˜¯å¾ˆé«˜å…´è®¨è®ºï¼Œ

*è¿ˆå…‹å°”*

è¿ˆå…‹å°”Â·çš®å°”å¥‡å…¹ï¼Œåšå£«ï¼Œæ³¨å†Œå·¥ç¨‹å¸ˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ Cockrell å·¥ç¨‹å­¦é™¢å’Œ Jackson åœ°çƒç§‘å­¦å­¦é™¢æ•™æˆ

æ›´å¤šèµ„æºå¯åœ¨ä»¥ä¸‹é“¾æ¥è·å–ï¼š[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy) | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao) | [åœ°ç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446) | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python ä¸­åº”ç”¨åœ°ç»Ÿè®¡å­¦ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)
