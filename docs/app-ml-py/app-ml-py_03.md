# è®­ç»ƒå’Œè°ƒæ•´

> åŸæ–‡ï¼š[`geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_training_tuning.html`](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_training_tuning.html)

Michael J. Pyrczï¼Œæ•™æˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡

[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy) | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao) | [åœ°ç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446) | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python åœ°ç»Ÿè®¡å­¦åº”ç”¨ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)

ç”µå­ä¹¦â€œã€ŠPython åº”ç”¨æœºå™¨å­¦ä¹ ï¼šå¸¦ä»£ç çš„æ‰‹åŠ¨æŒ‡å—ã€‹â€çš„ç« èŠ‚ã€‚

è¯·å°†æ­¤ç”µå­ä¹¦å¼•ç”¨å¦‚ä¸‹ï¼š

Pyrcz, M.J., 2024, *ã€ŠPython åº”ç”¨æœºå™¨å­¦ä¹ ï¼šå¸¦ä»£ç çš„æ‰‹åŠ¨æŒ‡å—ã€‹* [ç”µå­ä¹¦]. Zenodo. doi:10.5281/zenodo.15169138 ![DOI](https://doi.org/10.5281/zenodo.15169138)

æœ¬ä¹¦ä¸­çš„å·¥ä½œæµç¨‹ä»¥åŠæ›´å¤šå†…å®¹åœ¨æ­¤å¤„å¯ç”¨ï¼š

å°† MachineLearningDemos GitHub ä»“åº“å¼•ç”¨å¦‚ä¸‹ï¼š

Pyrcz, M.J., 2024, *MachineLearningDemos: Python æœºå™¨å­¦ä¹ æ¼”ç¤ºå·¥ä½œæµç¨‹ä»“åº“* (0.0.3) [è½¯ä»¶]. Zenodo. DOI: 10.5281/zenodo.13835312\. GitHub ä»“åº“ï¼š[GeostatsGuy/MachineLearningDemos](https://github.com/GeostatsGuy/MachineLearningDemos) ![DOI](https://zenodo.org/doi/10.5281/zenodo.13835312)

ä½œè€…ï¼šMichael J. Pyrcz

Â© ç‰ˆæƒæ‰€æœ‰ 2024ã€‚

æœ¬ç« æ˜¯å¯¹**æœºå™¨å­¦ä¹ è®­ç»ƒå’Œè°ƒæ•´**çš„æ€»ç»“ï¼ŒåŒ…æ‹¬åŸºæœ¬æ¦‚å¿µï¼š

+   æ¨¡å‹å‚æ•°è®­ç»ƒå’Œè¶…å‚æ•°è°ƒæ•´

+   æ¨¡å‹è‰¯å¥½æ€§æŒ‡æ ‡

+   äº¤å‰éªŒè¯å·¥ä½œæµç¨‹

+   äº¤å‰éªŒè¯çš„å±€é™æ€§

**YouTube è®²åº§**ï¼šæŸ¥çœ‹æˆ‘åœ¨ä»¥ä¸‹æ–¹é¢çš„è®²åº§ï¼š

+   [è®­ç»ƒå’Œæµ‹è¯•](https://youtu.be/owOSiKT3K8E?si=PrY5lL4Dbi2Ix7fu)

+   [æ¨¡å‹è‰¯å¥½æ€§æŒ‡æ ‡](https://youtu.be/g38sEpFOX-0?si=XPC18zNMCxaIZCOF)

+   [äº¤å‰éªŒè¯è€ƒè™‘å› ç´ ](https://youtu.be/FiX8IWPhTcg?si=K4A3W0zTaiypm7n7)

ä¸ºäº†æ‚¨çš„æ–¹ä¾¿ï¼Œä»¥ä¸‹æ˜¯å¯¹å…³é”®ç‚¹çš„æ€»ç»“ã€‚

## è®­ç»ƒå’Œè°ƒæ•´é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹

åœ¨é¢„æµ‹æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬éµå¾ªæ ‡å‡†çš„æ¨¡å‹è®­ç»ƒå’Œæµ‹è¯•å·¥ä½œæµç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹ç¡®ä¿æˆ‘ä»¬çš„æ¨¡å‹èƒ½å¤Ÿå¾ˆå¥½åœ°æ³›åŒ–åˆ°æ–°çš„æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯å®Œç¾åœ°æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚

![](img/31abfecc21c246ba7144dfb847ab4378.png)

æ ‡å‡†é¢„æµ‹æœºå™¨å­¦ä¹ å»ºæ¨¡å·¥ä½œæµç¨‹ã€‚

è®©æˆ‘ä»¬é€ä¸€äº†è§£å…³é”®æ­¥éª¤ï¼Œ

1.  **è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²** - å°†å¯ç”¨æ•°æ®åˆ’åˆ†ä¸ºäº’æ–¥ä¸”ç©·å°½çš„å­é›†ï¼šä¸€ä¸ªè®­ç»ƒé›†å’Œä¸€ä¸ªæµ‹è¯•é›†ã€‚

+   é€šå¸¸ï¼Œ15%â€“30%çš„æ•°æ®è¢«ä¿ç•™ç”¨äºæµ‹è¯•

+   å‰©ä½™çš„ 70%â€“85%ç”¨äºè®­ç»ƒæ¨¡å‹

1.  **å®šä¹‰è¦æ¢ç´¢çš„è¶…å‚æ•°å€¼èŒƒå›´**ï¼ŒèŒƒå›´ä»ï¼Œ

+   çµæ´»æ€§ä½çš„ç®€å•æ¨¡å‹

+   åˆ°å…·æœ‰é«˜çµæ´»æ€§çš„å¤æ‚æ¨¡å‹

$\quad$ è¿™ä¸€æ­¥å¯èƒ½æ¶‰åŠè°ƒæ•´å¤šä¸ªè¶…å‚æ•°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸ä¼šä½¿ç”¨é«˜æ•ˆçš„é‡‡æ ·æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œç½‘æ ¼æœç´¢ã€éšæœºæœç´¢æˆ–è´å¶æ–¯ä¼˜åŒ–ï¼‰ã€‚

1.  **ä¸ºæ¯ä¸ªè¶…å‚æ•°è®¾ç½®è®­ç»ƒæ¨¡å‹å‚æ•°** - å¯¹äºæ¯ç»„è¶…å‚æ•°ï¼Œåœ¨è®­ç»ƒæ•°æ®ä¸Šè®­ç»ƒä¸€ä¸ªæ¨¡å‹ã€‚è¿™ä¼šäº§ç”Ÿï¼š

+   ä¸€ç³»åˆ—å…·æœ‰ä¸åŒå¤æ‚æ€§çš„è®­ç»ƒæ¨¡å‹

+   æ¯ä¸ªæ¨¡å‹éƒ½æœ‰å‚æ•°è¢«ä¼˜åŒ–ä»¥æœ€å°åŒ–è®­ç»ƒæ•°æ®ä¸Šçš„è¯¯å·®

1.  **åœ¨ä¿ç•™çš„æµ‹è¯•æ•°æ®ä¸Šè¯„ä¼°æ¯ä¸ªæ¨¡å‹** - ä½¿ç”¨æµ‹è¯•æ•°æ®ï¼Œ

+   è¯„ä¼°æ¯ä¸ªè®­ç»ƒæ¨¡å‹åœ¨æœªè§æ•°æ®ä¸Šçš„è¡¨ç°

+   æ€»ç»“æ¯ä¸ªæ¨¡å‹çš„é¢„æµ‹è¯¯å·®ï¼ˆä¾‹å¦‚ï¼Œå‡æ–¹æ ¹è¯¯å·®ï¼ˆRMSEï¼‰ã€å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆMAEï¼‰ã€åˆ†ç±»å‡†ç¡®ç‡ï¼‰

1.  **é€‰æ‹©æœ€å°åŒ–æµ‹è¯•è¯¯å·®çš„è¶…å‚æ•°** - è¿™å°±æ˜¯è¶…å‚æ•°è°ƒæ•´æ­¥éª¤ï¼š

+   é€‰æ‹©åœ¨æµ‹è¯•æ•°æ®ä¸Šè¡¨ç°æœ€ä½³çš„æ¨¡å‹è¶…å‚æ•°

+   è¿™äº›æ˜¯ä½ çš„è°ƒæ•´åçš„è¶…å‚æ•°

1.  **ä½¿ç”¨è°ƒæ•´åçš„è¶…å‚æ•°åœ¨æ‰€æœ‰æ•°æ®ä¸Šé‡æ–°è®­ç»ƒæœ€ç»ˆæ¨¡å‹** - ç°åœ¨å·²ç»ç¡®å®šäº†æœ€ä½³æ¨¡å‹å¤æ‚åº¦ï¼Œ

+   ä½¿ç”¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†é‡æ–°è®­ç»ƒæ¨¡å‹

+   è¿™æœ€å¤§åŒ–äº†ç”¨äºæœ€ç»ˆæ¨¡å‹å‚æ•°ä¼°è®¡çš„æ•°æ®é‡

+   ç»“æœæ¨¡å‹æ˜¯ä½ åœ¨å®é™…åº”ç”¨ä¸­éƒ¨ç½²çš„æ¨¡å‹

## å¸¸è§å…³äºæ¨¡å‹è®­ç»ƒå’Œè°ƒä¼˜å·¥ä½œæµç¨‹çš„é—®é¢˜

ä½œä¸ºä¸€åæ•™æˆï¼Œå½“æˆ‘ä»‹ç»ä¸Šè¿°æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒå’Œè°ƒä¼˜å·¥ä½œæµç¨‹æ—¶ï¼Œæˆ‘ç»å¸¸å¬åˆ°è¿™äº›é—®é¢˜ã€‚

+   **æ­¥éª¤ 1-5 çš„ä¸»è¦ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ** - å”¯ä¸€å¯é çš„ç»“æœæ˜¯è°ƒæ•´åçš„è¶…å‚æ•°ã€‚

$\quad$ æˆ‘ä»¬ä¸ç›´æ¥ä½¿ç”¨æ­¥éª¤ 3 æˆ– 4 ä¸­è®­ç»ƒçš„æ¨¡å‹ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨æ²¡æœ‰è®¿é—®æ‰€æœ‰å¯ç”¨æ•°æ®çš„æƒ…å†µä¸‹è®­ç»ƒçš„ã€‚ç›¸åï¼Œæˆ‘ä»¬ä½¿ç”¨æ‰€æœ‰æ•°æ®å’Œé€‰å®šçš„è¶…å‚æ•°é‡æ–°è®­ç»ƒæœ€ç»ˆæ¨¡å‹ã€‚

+   **ä¸ºä»€ä¹ˆä¸€å¼€å§‹ä¸åœ¨æ‰€æœ‰æ•°æ®ä¸Šè®­ç»ƒæ¨¡å‹ï¼Ÿ** - å› ä¸ºå¦‚æœæˆ‘ä»¬é‚£æ ·åšï¼Œæˆ‘ä»¬å°±æ²¡æœ‰ç‹¬ç«‹çš„æ–¹å¼æ¥è¯„ä¼°æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚ä¸€ä¸ªéå¸¸å¤æ‚çš„æ¨¡å‹å¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆâ€”â€”å®Œç¾åœ°æ‹Ÿåˆè®­ç»ƒæ•°æ®ï¼Œä½†åœ¨æ–°çš„ã€æœªè§è¿‡çš„æ•°æ®ä¸Šè¡¨ç°ä¸ä½³ã€‚

$\quad$ å½“æ¨¡å‹çµæ´»æ€§è¿‡é«˜æ—¶ä¼šå‘ç”Ÿè¿‡æ‹Ÿåˆâ€”â€”å®ƒæ•æ‰äº†å™ªå£°è€Œä¸æ˜¯æ½œåœ¨çš„æ¨¡å¼ã€‚å¦‚æœæ²¡æœ‰ä¿ç•™çš„æµ‹è¯•é›†ï¼Œæˆ‘ä»¬å°±æ— æ³•æ£€æµ‹åˆ°è¿™ä¸€ç‚¹ã€‚

è¿™ä¸ªç”¨äºè®­ç»ƒå’Œè°ƒæ•´é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹çš„å·¥ä½œæµç¨‹æ˜¯ï¼Œ

+   ä¸€ä¸ªåŸºäºç»éªŒã€äº¤å‰éªŒè¯çš„è¿‡ç¨‹

+   å¯¹ç°å®ä¸–ç•Œæ¨¡å‹ä½¿ç”¨çš„ä¸€ä¸ªå®é™…æ¨¡æ‹Ÿ

+   ä¸€ç§è¯†åˆ«æœ€ä½³æ¨¡å‹å¤æ‚åº¦çš„æ–¹æ³•ï¼Œä»¥å¹³è¡¡æ‹Ÿåˆå’Œæ³›åŒ–

æˆ‘å·²ç»å¤šæ¬¡æåˆ°æ¨¡å‹å‚æ•°å’Œæ¨¡å‹è¶…å‚æ•°ï¼Œæ‰€ä»¥æˆ‘æœ‰è´£ä»»ç»™å‡ºå®ƒä»¬çš„å®šä¹‰ã€‚

## æ¨¡å‹å‚æ•°å’Œæ¨¡å‹è¶…å‚æ•°

**æ¨¡å‹å‚æ•°**åœ¨è®­ç»ƒé˜¶æ®µè¢«è°ƒæ•´ä»¥æœ€å°åŒ–è®­ç»ƒæ•°æ®ä¸Šçš„è¯¯å·®ï¼Œå³æ¨¡å‹å‚æ•°æ˜¯ç”¨è®­ç»ƒæ•°æ®è®­ç»ƒçš„ï¼Œå¹¶æ§åˆ¶æ¨¡å‹å¯¹æ•°æ®çš„æ‹Ÿåˆã€‚ä¾‹å¦‚ï¼Œ

+   å¯¹äºä¸Šé¢æœºå™¨å­¦ä¹ å·¥ä½œæµç¨‹ç¤ºä¾‹ä¸­çš„å¤šé¡¹å¼é¢„æµ‹æ€§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œæ¨¡å‹å‚æ•°æ˜¯å¤šé¡¹å¼ç³»æ•°ï¼Œä¾‹å¦‚ï¼Œä¸‰æ¬¡å¤šé¡¹å¼æ¨¡å‹çš„$b_3$ã€$b_2$ã€$b_1$å’Œ$c$ï¼ˆé€šå¸¸ç§°ä¸º$b_0$ï¼‰ã€‚

![å›¾ç‰‡](img/85cce1589249c12a11ff52ea10e6c893.png)

æ¨¡å‹å‚æ•°è¢«è°ƒæ•´ä»¥é€‚åº”æ¨¡å‹ä¸æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå³æ¨¡å‹å‚æ•°è¢«è®­ç»ƒä»¥æœ€å°åŒ–è®­ç»ƒæ•°æ®ï¼ˆx æ ‡è®°ï¼‰ä¸Šçš„è¯¯å·®ã€‚

**æ¨¡å‹è¶…å‚æ•°**éå¸¸ä¸åŒã€‚å®ƒä»¬ä¸ç›´æ¥çº¦æŸæ¨¡å‹ä¸æ•°æ®çš„ä¸€è‡´æ€§ï¼Œè€Œæ˜¯çº¦æŸæ¨¡å‹å¤æ‚æ€§ã€‚æ¨¡å‹è¶…å‚æ•°è¢«é€‰æ‹©ï¼ˆç§°ä¸ºè°ƒæ•´ï¼‰ä»¥æœ€å°åŒ–ä¿ç•™æµ‹è¯•æ•°æ®ä¸Šçš„è¯¯å·®ã€‚å›åˆ°æˆ‘ä»¬å¤šé¡¹å¼é¢„æµ‹æ€§æœºå™¨å­¦ä¹ ç¤ºä¾‹ï¼Œå¤šé¡¹å¼é˜¶æ•°çš„é€‰æ‹©æ˜¯æ¨¡å‹è¶…å‚æ•°ã€‚

![å›¾ç‰‡](img/aef7a81bd36cd7f2b25e1574784b4932.png)

æ¨¡å‹è¶…å‚æ•°è¢«è°ƒæ•´ä»¥æ”¹å˜æ¨¡å‹å¤æ‚åº¦/çµæ´»æ€§ï¼Œå³æ¨¡å‹è¶…å‚æ•°è¢«è°ƒæ•´ä»¥æœ€å°åŒ–ä¿ç•™çš„æµ‹è¯•æ•°æ®ï¼ˆå®å¿ƒåœ†ï¼‰ä¸Šçš„è¯¯å·®ã€‚

æ¨¡å‹å‚æ•°ä¸æ¨¡å‹è¶…å‚æ•°

æ¨¡å‹å‚æ•°æ§åˆ¶æ¨¡å‹æ‹Ÿåˆï¼Œå¹¶ä½¿ç”¨è®­ç»ƒæ•°æ®è¿›è¡Œè®­ç»ƒã€‚æ¨¡å‹è¶…å‚æ•°æ§åˆ¶æ¨¡å‹å¤æ‚æ€§ï¼Œå¹¶ä½¿ç”¨æµ‹è¯•æ•°æ®è¿›è¡Œè°ƒæ•´ã€‚

## å›å½’å’Œåˆ†ç±»

åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å›å½’å’Œåˆ†ç±»ã€‚

+   **å›å½’** - ä¸€ç§é¢„æµ‹æ€§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå…¶ä¸­å“åº”ç‰¹å¾æ˜¯è¿ç»­çš„ã€‚

+   **åˆ†ç±»** - ä¸€ç§é¢„æµ‹æ€§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå…¶ä¸­å“åº”ç‰¹å¾æ˜¯åˆ†ç±»çš„ã€‚

ç»“æœè¡¨æ˜ï¼Œå¯¹äºè¿™äº›ä¸­çš„æ¯ä¸€ä¸ªï¼Œæˆ‘ä»¬éƒ½éœ€è¦æ„å»ºä¸åŒçš„æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ä¸åŒçš„æ–¹æ³•æ¥è¯„ä¼°è¿™äº›æ¨¡å‹ã€‚

+   åœ¨æœ¬è®¨è®ºçš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å…³æ³¨å›å½’ï¼Œä½†åœ¨åé¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿä¼šä»‹ç»åˆ†ç±»æ¨¡å‹ã€‚

ç°åœ¨ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£é¢„æµ‹æ€§æœºå™¨å­¦ä¹ æ¨¡å‹è°ƒæ•´ï¼Œå³é€šè¿‡ç»éªŒæ–¹æ³•è°ƒæ•´æ¨¡å‹å¤æ‚æ€§ä»¥æœ€å°åŒ–æµ‹è¯•è¯¯å·®ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£æµ‹è¯•è¯¯å·®çš„æ¥æºã€‚

+   æˆ‘ä»¬è¯•å›¾æœ€å°åŒ–çš„é‚£ä¸ªäº‹ç‰©çš„æˆå› ï¼

## è®­ç»ƒå’Œæµ‹è¯•æ•°æ®

ä¸ºäº†æ¸…æ™°èµ·è§ï¼Œè€ƒè™‘è¿™æ˜¯é¢„æµ‹æ€§æœºå™¨å­¦ä¹ æ¨¡å‹å‚æ•°è®­ç»ƒå’Œè¶…å‚æ•°è°ƒæ•´å·¥ä½œæµç¨‹ä¸­è®­ç»ƒå’Œæµ‹è¯•æ•°æ®æµç¤ºæ„å›¾ï¼Œ

![å›¾ç‰‡](img/454aec4a3d657f072406100f036592b6.png)

é¢„æµ‹æ€§æœºå™¨å­¦ä¹ æ¨¡å‹å‚æ•°è®­ç»ƒå’Œè¶…å‚æ•°è°ƒæ•´å·¥ä½œæµç¨‹ä¸­è®­ç»ƒå’Œæµ‹è¯•æ•°æ®çš„æµç¨‹ã€‚

**è®­ç»ƒæ•°æ®**,

+   è®­ç»ƒæ¨¡å‹å‚æ•°

+   è®­ç»ƒç”¨äºå®é™…åº”ç”¨çš„æœ€ç»ˆæ¨¡å‹

**æµ‹è¯•æ•°æ®**,

+   ä»è®­ç»ƒæ¨¡å‹å‚æ•°ä¸­ä¿ç•™ä»¥é¿å…æ¨¡å‹è¿‡æ‹Ÿåˆ

+   è°ƒæ•´æ¨¡å‹è¶…å‚æ•°

+   è¿”å›è®­ç»ƒä»¥éƒ¨ç½²æœ€ç»ˆè°ƒæ•´å¥½çš„æ¨¡å‹

## åº”è¯¥ä¿ç•™å¤šå°‘æ•°æ®ç”¨äºæµ‹è¯•ï¼Ÿ

æµ‹è¯•æ•°æ®æ‰€å çš„æ¯”ä¾‹ç”±å„ç§æ¥æºæ¨èï¼Œä»æ€»æ•°æ®é›†çš„ 15%åˆ° 30%ã€‚è¿™æ˜¯ä¸€ä¸ªæŠ˜è¡·æ–¹æ¡ˆï¼Œ

+   ç”¨äºæµ‹è¯•ä¿ç•™çš„æ•°æ®å‡å°‘äº†å¯ç”¨äºè®­ç»ƒçš„æ•°æ®ï¼›å› æ­¤ï¼Œé™ä½äº†æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚

+   ç”¨äºæµ‹è¯•ä¿ç•™çš„æ•°æ®æé«˜äº†å¯¹æ¨¡å‹æ€§èƒ½è¯„ä¼°çš„å‡†ç¡®æ€§ã€‚

ä¸åŒçš„ä½œè€…å·²ç»å¯¹å„ç§è®­ç»ƒå’Œæµ‹è¯•æ¯”ç‡è¿›è¡Œäº†å®éªŒï¼Œå¹¶ä¸ºå…¶åº”ç”¨æ¨èäº†åˆ†å‰²æ–¹æ¡ˆï¼Œ

+   è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²çš„æœ€ä½³æ¯”ä¾‹å–å†³äºé—®é¢˜è®¾ç½®

ä¸ºäº†ç¡®å®šæµ‹è¯•æ•°æ®ä¿ç•™çš„æ¯”ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ¨¡å‹å‚æ•°è®­ç»ƒçš„éš¾åº¦ï¼ˆä¾‹å¦‚ï¼Œæ¨¡å‹å‚æ•°çš„æ•°é‡ï¼‰å’Œæ¨¡å‹è¶…å‚æ•°è°ƒæ•´çš„éš¾åº¦ï¼ˆä¾‹å¦‚ï¼Œè¶…å‚æ•°çš„æ•°é‡ï¼Œå“åº”ç‰¹å¾ç»“æœçš„èŒƒå›´ï¼‰ã€‚

## å…¬å¹³çš„è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²

æœ±åˆ©å®‰Â·è¨æ‹‰æ‰åšå£«å»ºè®®ï¼Œå¯¹äºç©ºé—´é¢„æµ‹é—®é¢˜ï¼Œéšæœºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²å¯èƒ½ä¸å…¬å¹³ã€‚

+   æå‡ºäº†ä¸€ç§[å…¬å¹³çš„è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²æ–¹æ³•](https://www.sciencedirect.com/science/article/pii/S0920410521015023)ï¼Œç”¨äºåŸºäºæ¨¡å‹è®¡åˆ’ç”¨é€”éš¾åº¦çš„ç©ºé—´é¢„æµ‹æ¨¡å‹æ•°æ®åˆ†å‰²ã€‚

+   é¢„æµ‹éš¾åº¦ä¸å…‹é‡Œé‡‘æ–¹å·®ç›¸å…³ï¼Œå®ƒè€ƒè™‘äº†ç©ºé—´è¿ç»­æ€§å’Œè·ç¦»åç§»ï¼Œå³ä¼°è®¡çš„éš¾åº¦ã€‚

+   æµ‹è¯•åˆ†å‰²è¢«è¿­ä»£ä»¥åŒ¹é…æ¨¡å‹åœ¨è®¡åˆ’ç”¨äºç°å®ä¸–ç•Œåº”ç”¨ä¸­çš„å…‹é‡Œé‡‘æ–¹å·®åˆ†å¸ƒ

ä¸ºäº†è¯´æ˜é¢„æµ‹éš¾åº¦è¿™ä¸€æ¦‚å¿µï¼Œè€ƒè™‘ä»¥ä¸‹è¿™ç»„äº•æ—¥å¿—ï¼Œå…¶ä¸­åŒ…å«äº†æµ‹è¯•æ•°æ®çš„éšæœºåˆ†é…å’Œä¿ç•™æ•´ä¸ªè¿ç»­åŒºåŸŸä½œä¸ºæµ‹è¯•æ•°æ®ã€‚

+   **æ˜“äºé¢„æµ‹çš„é—®é¢˜** - å¯¹äºéšæœºåˆ†é…ï¼Œé€šå¸¸è®­ç»ƒæ•°æ®éå¸¸æ¥è¿‘ä¸”ä¸ä¿ç•™çš„æµ‹è¯•æ•°æ®éå¸¸ç›¸ä¼¼

+   **éš¾ä»¥é¢„æµ‹çš„é—®é¢˜** - å¯¹äºç§»é™¤è¿ç»­åŒºåŸŸï¼Œæ²¡æœ‰ç›¸ä¼¼æˆ–æ¥è¿‘çš„è®­ç»ƒæ•°æ®ä¸ä¿ç•™çš„æµ‹è¯•æ•°æ®

![](img/5aa194417f3fa3435f02717796814e62.png)

è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²çš„ä¸¤ä¸ªæ¡ˆä¾‹ï¼Œéšæœºï¼ˆå·¦ï¼‰å’ŒæŒ‰åŒºåŸŸï¼ˆå³ï¼‰ã€‚

è€ƒè™‘ä»¥ä¸‹é¢„æµ‹æ¡ˆä¾‹ï¼Œå³æ¨¡å‹çš„è®¡åˆ’ç°å®ä¸–ç•Œåº”ç”¨ï¼Œä»¥åŠä¸€äº›å…³äºå…¬å¹³è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²çš„å®é™…å»ºè®®ã€‚

1.  å¦‚æœæ¨¡å‹å°†ç”¨äºä½¿ç”¨å¯ç”¨æ•°æ®ä¸­çš„å°åç§»æ¥æ’è¡¥æ•°æ®ï¼Œåˆ™æ„å»ºä¸€ä¸ªé è¿‘æµ‹è¯•æ•°æ®çš„è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰² - éšæœºåˆ†é…ä¿ç•™çš„æµ‹è¯•æ•°æ®å¯èƒ½æ˜¯è¶³å¤Ÿçš„ã€‚

1.  å¦‚æœæ¨¡å‹å°†ç”¨äºé¢„æµ‹å¤§è·ç¦»åç§»ï¼Œåˆ™è¿›è¡Œåˆ†å‰²ï¼Œç»“æœæ˜¯åœ¨è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ä¹‹é—´äº§ç”Ÿå¤§åç§» - ä¿ç•™æ•´ä¸ªäº•ç­’ã€é’»å­”æˆ–ç©ºé—´åŒºåŸŸã€‚

+   æ³¨æ„ï¼Œåœ¨å…¬å¹³çš„è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²ä¸‹ï¼Œè°ƒæ•´åçš„æ¨¡å‹å¯èƒ½åŸºäºæ¨¡å‹çš„è®¡åˆ’ç”¨é€”è€Œæœ‰æ‰€ä¸åŒã€‚

ä½¿ç”¨åƒä¸ºé¢„é’»é¢„æµ‹æ¨¡å‹ä¿ç•™æ•´ä¸ªäº•ç­’è¿™æ ·çš„ç®€å•æ–¹æ³•ï¼Œæˆ–è€…ä½¿ç”¨è¨æ‹‰æ‰åšå£«çš„å·¥ä½œæµç¨‹ï¼Œä½†ä¸è¦å¿½ç•¥è¿™ä¸ªé—®é¢˜ï¼Œè€Œé»˜è®¤ä½¿ç”¨éšæœºé€‰æ‹©ã€‚

+   è™½ç„¶å¦‚æ­¤ï¼Œåœ¨æ•´ä¸ªç”µå­ä¹¦ä¸­ï¼Œä¸ºäº†æ¼”ç¤ºå·¥ä½œæµç¨‹çš„ç®€æ´æ€§å’Œæ¸…æ™°æ€§ï¼Œæˆ‘ä»…ä»…ä½¿ç”¨äº†éšæœºçš„è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†é…ã€‚

## æ¨¡å‹åº¦é‡

ç”±äºæˆ‘ä»¬å·²ç»æ¶µç›–äº†åŸ¹è®­å’Œè°ƒæ•´çš„å·¥ä½œæµç¨‹ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æŒ‡å®šåº”ç”¨è¿™äº›æ¨¡å‹åº¦é‡çš„æ¨¡å‹ã€‚

+   è®­ç»ƒæ¨¡å‹å‚æ•°

+   è°ƒæ•´æ¨¡å‹è¶…å‚æ•°

+   æ¨¡å‹æ£€æŸ¥å’Œæ¯”è¾ƒ

è¿™é‡Œæœ‰ä¸€ä¸ªæµç¨‹å›¾ï¼Œè¯´æ˜äº†è¿™äº›åº¦é‡å¦‚ä½•é€‚åˆæœºå™¨å­¦ä¹ å»ºæ¨¡å·¥ä½œæµç¨‹ã€‚

![](img/d311f90f3b59dd6738b0ce7a12614995.png)

åœ¨æœºå™¨å­¦ä¹ å»ºæ¨¡å·¥ä½œæµç¨‹ä¸­ï¼Œæ¨¡å‹åº¦é‡æœ‰å¤šç§åº”ç”¨ã€‚

æ¨¡å‹åº¦é‡çš„é€‰æ‹©ä¸»è¦å–å†³äºé¢„æµ‹é—®é¢˜çš„ä¸Šä¸‹æ–‡ï¼Œ

+   åˆ†ç±»ä¸å›å½’

+   å•ä¸ªä¼°è®¡ä¸ç©ºé—´ï¼ˆå›¾åƒï¼‰æˆ–æ—¶é—´ï¼ˆä¿¡å·ï¼‰ä¸­çš„æ•´ä¸ªå­é›†

+   ä¼°è®¡ä¸ä¸ç¡®å®šæ€§

æœ‰å…¶ä»–ä¸€äº›è€ƒè™‘å› ç´ ï¼Œä¾‹å¦‚ï¼Œ

+   $LÂ¹$ ä¸ $LÂ²$ èŒƒæ•°åŠå…¶å·®å¼‚ï¼Œä¾‹å¦‚ï¼Œåœ¨å¼‚å¸¸å€¼é²æ£’æ€§ã€è§£çš„ç¨³å®šæ€§å’Œè§£çš„ç¨€ç–æ€§æ–¹é¢

+   ä¸æ¨¡å‹å‡è®¾çš„ä¸€è‡´æ€§ï¼Œä¾‹å¦‚ï¼Œ$rÂ²$ åªå¯¹çº¿æ€§æ¨¡å‹æœ‰æ•ˆ

è®©æˆ‘ä»¬å›é¡¾ä¸€äº›å›å½’æ¨¡å‹çš„å¸¸è§æ¨¡å‹åº¦é‡ï¼Œç„¶åæ˜¯åˆ†ç±»æ¨¡å‹ã€‚

## å‡æ–¹è¯¯å·® (MSE)

å¯¹å¼‚å¸¸å€¼æ•æ„Ÿï¼Œä½†è¿ç»­å¯å¾®ï¼Œå¯¼è‡´æ¨¡å‹è®­ç»ƒæœ‰å°é—­å½¢å¼è¡¨è¾¾å¼ã€‚ç”±äºè¯¯å·®æ˜¯å¹³æ–¹çš„ï¼Œè¯¯å·®å•ä½ä¹Ÿæ˜¯å¹³æ–¹çš„ï¼Œè¿™å¯èƒ½å¯¼è‡´è§£é‡Šæ€§è¾ƒå·®ï¼Œä¾‹å¦‚ï¼Œå‡æ–¹è¯¯å·®ä¸º 23,543 $mDÂ²$ã€‚è¯¥æ–¹ç¨‹æ˜¯ï¼Œ

$$ \text{Test MSE} = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} (y_i - \hat{y}_i)Â² = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} (\Delta y_i)Â² $$

## å‡å€¼ç»å¯¹è¯¯å·® (MAE)

åœ¨å­˜åœ¨å¼‚å¸¸å€¼çš„æƒ…å†µä¸‹å…·æœ‰é²æ£’æ€§ï¼Œä½†ä¸æ˜¯è¿ç»­å¯å¾®çš„ï¼›å› æ­¤ï¼Œæ²¡æœ‰æ¨¡å‹è®­ç»ƒçš„å°é—­å½¢å¼è¡¨è¾¾å¼ï¼Œæ¨¡å‹è®­ç»ƒé€šå¸¸é€šè¿‡è¿­ä»£ä¼˜åŒ–æ¥å®Œæˆã€‚è¯¥æ–¹ç¨‹æ˜¯ï¼Œ

$$ \text{Test MAE} = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} |y_i - \hat{y}_i| = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} |\Delta y_i| $$

## è§£é‡Šçš„æ–¹å·®

æ¨¡å‹æ•è·çš„å“åº”ç‰¹å¾æ–¹å·®çš„æ¯”ç‡ã€‚å‡è®¾æ–¹å·®çš„å¯åŠ æ€§ï¼›å› æ­¤ï¼Œæˆ‘ä»¬åªå¯¹çº¿æ€§æ¨¡å‹ä½¿ç”¨æ­¤æ¨¡å‹åº¦é‡ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬è®¡ç®—æ¨¡å‹è§£é‡Šçš„æ–¹å·®ï¼Œç®€å•åœ°è¯´å°±æ˜¯æ¨¡å‹é¢„æµ‹çš„æ–¹å·®ï¼Œ

$$ \sigma_{\text{explained}}Â² = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} ( \hat{y}_i - \bar{y} )Â² $$

ç„¶åæˆ‘ä»¬è®¡ç®—æ¨¡å‹æœªè§£é‡Šçš„æ–¹å·®ï¼Œä½œä¸ºæ¨¡å‹é¢„æµ‹è¯¯å·®çš„æ–¹å·®ï¼Œ

$$ \sigma_{\text{not explained}}Â² = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} (y_i - \hat{y}_i)Â² $$

ç„¶ååœ¨æ–¹å·®å¯åŠ æ€§çš„å‡è®¾ä¸‹ï¼Œæˆ‘ä»¬è®¡ç®—è§£é‡Šçš„æ–¹å·®ä¸æ‰€æœ‰æ–¹å·®ï¼ˆè§£é‡Šçš„æ–¹å·®åŠ ä¸Šæœªè§£é‡Šçš„æ–¹å·®ï¼‰çš„æ¯”ç‡ï¼Œ

$$ rÂ² = \frac{\sigma_{\text{explained}}Â²}{\sigma_{\text{explained}}Â² + \sigma_{\text{not explained}}Â²} = \frac{\sigma_{\text{explained}}Â²}{\sigma_{\text{total}}Â²} $$

å¯¹äºçº¿æ€§å›å½’ï¼Œå›å¿† $rÂ² = \left( \rho_(X,y) \right)Â²$ï¼›å› æ­¤ï¼Œåƒç›¸å…³ç³»æ•°ä¸€æ ·ï¼Œ$rÂ²$ï¼Œ

+   ä¸å¼‚å¸¸å€¼å’Œæ··åˆå¤šä¸ªæ€»ä½“ç›¸å…³çš„ç›¸å…³æ€§é—®é¢˜ç±»ä¼¼ï¼Œä¾‹å¦‚ï¼Œè¾›æ™®æ£®æ‚–è®º

+   å¯¹äºéçº¿æ€§æ¨¡å‹ï¼Œè€ƒè™‘ä¼ª R å¹³æ–¹æ–¹æ³•

æ­¤å¤–ï¼Œå³ä½¿çº¿æ€§æ¨¡å‹ä¹Ÿå¯èƒ½æœ‰è´Ÿçš„ $rÂ²$ï¼Œå¦‚æœæ¨¡å‹è¶‹åŠ¿ä¸æ•°æ®è¶‹åŠ¿ç›¸çŸ›ç›¾ï¼Œä¾‹å¦‚ï¼Œå¦‚æœä½ ç”¨å…·æœ‰æ­£æ–œç‡çš„çº¿æ€§æ¨¡å‹æ‹Ÿåˆå…·æœ‰è´Ÿæ–œç‡çš„æ•°æ®ï¼

## å†…ç‚¹æ¯”ç‡

æµ‹è¯•æ•°æ®ä¸­ï¼Œ$y_i$ åœ¨æ¨¡å‹ï¼Œ$\hat{y}_i$ çš„è¾¹ç•Œï¼Œ$\epsilon$ å†…çš„æ¯”ä¾‹ï¼Œè®¡ç®—å¦‚ä¸‹ï¼Œ

$$ I_R = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} I(y_i, \hat{y}_i) $$

å…¶ä¸­æŒ‡ç¤ºå˜æ¢ï¼Œ$I_R$ è¢«å®šä¹‰ä¸ºï¼Œ

$$\begin{split} I(y_i, \hat{y}_i) = \begin{cases} 1, & \text{if } |y_i - \hat{y}_i| \leq \epsilon \\ 0, & \text{otherwise} \end{cases} \end{split}$$

è¿™é‡Œæ˜¯ä¸€ä¸ªå†…ç‚¹æ¯”ç‡æ¨¡å‹åº¦é‡ï¼Œ$I_R$ æ¨¡å‹åº¦é‡çš„æ’å›¾ï¼Œ

![](img/3ddaa66ff3998a59b318297be09c60b8.png)

æµ‹è¯•æ•°æ®ï¼Œå…·æœ‰è¾¹ç•Œçš„æ¨¡å‹ï¼Œ$\epsilon$ï¼Œä»¥åŠå¼‚å¸¸å€¼ï¼ˆç™½è‰²ï¼‰å’Œå†…ç‚¹ï¼ˆçº¢è‰²ï¼‰å·²è¯†åˆ«ï¼Œ25 ä¸ªæ•°æ®æ ·æœ¬ä¸­æœ‰ 16 ä¸ªå†…ç‚¹ï¼Œ$ğ¼ğ‘… = 0.64$ã€‚

è™½ç„¶æ’å›¾æ˜¯çº¿æ€§æ¨¡å‹ï¼Œä½†æ­¤åº¦é‡å¯ä»¥åº”ç”¨äºä»»ä½•æ¨¡å‹ã€‚å°½ç®¡å†…ç‚¹æ¯”ç‡æ¨¡å‹åº¦é‡å­˜åœ¨ä¸€äº›ä¸»è§‚æ€§ï¼Œ

+   ä»€ä¹ˆæ˜¯æœ€ä¼˜çš„è¾¹ç•Œé€‰æ‹©ï¼Œ$\epsilon$ï¼Ÿ

## å¸¸è§åˆ†ç±»æ¨¡å‹åº¦é‡

è®©æˆ‘ä»¬å›é¡¾ä¸€äº›å¸¸è§çš„åˆ†ç±»æ¨¡å‹åº¦é‡ã€‚åˆ†ç±»å¯èƒ½æ¯”å›å½’æ›´å¤æ‚ï¼Œå› ä¸ºæˆ‘ä»¬å®é™…ä¸Šè®¡ç®—çš„æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ··æ·†çŸ©é˜µï¼Œ

+   ä¸€ä¸ª $K \times K$ çš„çŸ©é˜µï¼ŒåŒ…å«é¢„æµ‹ï¼ˆx è½´ï¼‰ä¸å®é™…ï¼ˆy è½´ï¼‰ç±»åˆ«çš„é¢‘ç‡ï¼Œä»¥å¯è§†åŒ–åˆ†ç±»æ¨¡å‹çš„æ€§èƒ½ï¼Œå…¶ä¸­ $K$ æ˜¯å“åº”ç‰¹å¾çš„åŸºæ•°ï¼Œå³å¯èƒ½ç±»åˆ«çš„æ•°é‡

+   ä½¿ç”¨åˆ†ç±»æ¨¡å‹å¯è§†åŒ–å¹¶è¯Šæ–­æ‰€æœ‰æ­£ç¡®å’Œé”™è¯¯åˆ†ç±»çš„ç»„åˆï¼Œä¾‹å¦‚ï¼Œç±»åˆ« 1 é€šå¸¸è¢«é”™è¯¯åœ°åˆ†ç±»ä¸ºç±»åˆ« 3ï¼Œ

![](img/0c2a856f882f5bcc7e9df675ea5afb21.png)

å¯¹äºåˆ†ç±»æ¨¡å‹ï¼Œä¸€ä¸ªç¤ºä¾‹æ··æ·†çŸ©é˜µï¼Œ2D çŸ©é˜µï¼ŒåŒ…å«æ‰€æœ‰çœŸå®å’Œé¢„æµ‹ç±»åˆ«çš„é¢‘ç‡ã€‚

+   å®Œç¾å‡†ç¡®åº¦æ˜¯æ¯ä¸ªç±»åˆ«çš„æ•°é‡ï¼Œ$n_1, n_2, \ldots, n_K$ åœ¨å¯¹è§’çº¿ä¸Šï¼Œå³ç±»åˆ« 1 æ€»æ˜¯è¢«é¢„æµ‹ä¸ºç±»åˆ« 1 ç­‰ã€‚

![](img/34df964c246951e764fc3a7e8fecbf96.png)

å®Œç¾å‡†ç¡®åº¦çš„åˆ†ç±»æ¨¡å‹ç¤ºä¾‹æ··æ·†çŸ©é˜µã€‚

+   æ··æ·†çŸ©é˜µè¢«åº”ç”¨äºè®¡ç®—åˆ†ç±»å‡†ç¡®æ€§çš„å•ä¸ªæ±‡æ€»ï¼Œä¾‹å¦‚ï¼Œç²¾ç¡®åº¦ã€å¬å›ç‡ç­‰ã€‚

+   æ¨¡å‹åº¦é‡ç‰¹å®šäºç‰¹å®šç±»åˆ«ï¼Œå¹¶ä¸”å¯èƒ½åœ¨ç±»åˆ«ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼Œå³æˆ‘ä»¬å¯èƒ½å¯¹ç±»åˆ« $k=1$ é¢„æµ‹å¾—å¾ˆå¥½ï¼Œä½†å¯¹ç±»åˆ« $k=3$ åˆ™ä¸ç„¶ã€‚

## ç²¾ç¡®åº¦

å¯¹äºç±»åˆ« $ğ‘˜$ï¼Œç²¾ç¡®åº¦æ˜¯çœŸå®æ­£ä¾‹ä¸æ‰€æœ‰æ­£ä¾‹çš„æ¯”ç‡ï¼Œ

$$ \text{Precision}_k = \frac{n_{k \text{ true positive}}}{n_{k \text{ true positive}} + n_{k \text{ false positive}}} = \frac{\text{true positive}}{\text{all positives}} $$

æˆ‘ä»¬å¯ä»¥ç›´è§‚åœ°æè¿°ç²¾ç¡®åº¦ä½œä¸ºæ¡ä»¶æ¦‚ç‡ï¼Œ

$$ \text{Precision}_k = P \left(k \text{ is happening} \mid \text{model says } k \text{ is happening}\right) $$![](img/020824af3f57f97af1ee2ba6ca6de684.png)

ç¤ºä¾‹æ··æ·†çŸ©é˜µï¼Œå±•ç¤ºäº†æ¯ä¸ªç±»åˆ« $k$ çš„ç²¾ç¡®åº¦æ¨¡å‹æŒ‡æ ‡ã€‚

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¯ä¸ªç±»åˆ«çš„ç²¾ç¡®åº¦ï¼Œ

+   ç±»åˆ« k=1

$$ \text{Precision}_{k=1} = \frac{15}{15 + (5 + 7)} = \frac{15}{27} = 0.56 $$

+   ç±»åˆ« k = 2,

$$ \text{Precision}_{k=2} = \frac{22}{22 + (15 + 15)} = \frac{22}{52} = 0.42 $$

+   ç±»åˆ« k = 3,

$$ \text{Precision}_{k=3} = \frac{4}{4 + (2 + 9)} = \frac{4}{15} = 0.27 $$

## å¬å›ç‡ï¼ˆåœ¨åŒ»å­¦ä¸­ç§°ä¸ºçµæ•åº¦ï¼‰

ç»„ $ğ‘˜$ çš„å¬å›ç‡æ˜¯çœŸå®é˜³æ€§æ•°ä¸ $ğ‘˜$ çš„æ‰€æœ‰æ¡ˆä¾‹æ•°çš„æ¯”ç‡ã€‚

$$ \text{Recall}_k = \frac{n_{k \text{ true positive}}}{n_{k \text{ true positive}} + n_{k \text{ false negative}}} $$

æˆ‘ä»¬å¯ä»¥ç›´è§‚åœ°æè¿°å¬å›ç‡ï¼Œå³æˆ‘ä»¬æ•è·äº†å¤šå°‘ç»„ ğ‘˜ çš„æˆå‘˜ï¼Ÿ

+   æ³¨æ„ï¼Œå¬å›ç‡ä¸è€ƒè™‘å‡é˜³æ€§ã€‚

![](img/94f40c5cd8c775dabd2e31e85c21a9cf.png)

ç¤ºä¾‹æ··æ·†çŸ©é˜µï¼Œå±•ç¤ºäº†æ¯ä¸ªç±»åˆ« $k$ çš„å¬å›ç‡æ¨¡å‹æŒ‡æ ‡ã€‚

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¯ä¸ªç±»åˆ«çš„å¬å›ç‡ï¼Œ

+   ç±»åˆ« k=1

$$ \text{Recall}_{k=1} = \frac{15}{15 + (15 + 2)} = \frac{15}{32} = 0.47 $$

+   ç±»åˆ« k = 2,

$$ \text{Recall}_{k=2} = \frac{22}{22 + (5 + 9)} = \frac{22}{36} = 0.61 $$

+   ç±»åˆ« k = 3,

$$ \text{Recall}_{k=3} = \frac{4}{4 + (7 + 15)} = \frac{4}{26} = 0.15 $$

## ç‰¹å¼‚æ€§

ç»„ $ğ‘˜$ çš„ç‰¹å¼‚æ€§æ˜¯çœŸå®è´Ÿä¾‹æ•°ä¸ $n \ne ğ‘˜$ çš„æ‰€æœ‰è´Ÿä¾‹æ•°çš„æ¯”ç‡ã€‚

$$ \text{Specificity}_k = \frac{n_{k \text{ true negative}}}{n_{\neq k} \, n_{k \text{ true negative}} + n_{k \text{ false positive}}} $$

æˆ‘ä»¬å¯ä»¥ç›´è§‚åœ°æè¿°ç‰¹å¼‚æ€§ï¼Œå³æˆ‘ä»¬æ•è·äº†å¤šå°‘éç»„ $k$ çš„æˆå‘˜ï¼Ÿ

+   æ³¨æ„ï¼Œå¬å›ç‡ä¸è€ƒè™‘çœŸå®é˜³æ€§ã€‚

![](img/22a61637f89b9d1f446385497e2e9b65.png)

ç¤ºä¾‹æ··æ·†çŸ©é˜µï¼Œå±•ç¤ºäº†æ¯ä¸ªç±»åˆ« $k$ çš„å¬å›ç‡æ¨¡å‹æŒ‡æ ‡ã€‚

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¯ä¸ªç±»åˆ«çš„å¬å›ç‡ï¼Œ

+   ç±»åˆ« k=1

$$ \text{Specificity}_{k=1} = \frac{22 + 9 + 15 + 4}{(22 + 9 + 15 + 4) + (5 + 7)} = \frac{50}{62} = 0.81 $$

+   ç±»åˆ« k = 2,

$$ \text{Specificity}_{k=2} = \frac{15 + 2 + 7 + 4}{(15 + 2 + 7 + 4) + (15 + 15)} = \frac{28}{58} = 0.48 $$

+   ç±»åˆ« k = 3,

$$ \text{Specificity}_{k=3} = \frac{15 + 15 + 5 + 22}{(15 + 15 + 5 + 22) + (2 + 9)} = \frac{57}{68} = 0.84 $$

## f1-score

f1-score æ˜¯æ¯ä¸ª $k$ ç±»åˆ«ç²¾ç¡®åº¦å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡æ•°ã€‚

$$ \text{F1-Score}_k = \frac{2}{\frac{1}{\text{Precision}_k} + \frac{1}{\text{Recall}_k}} $$

ç†å¿µæ˜¯å°†ç²¾ç¡®åº¦å’Œå¬å›ç‡åˆå¹¶æˆä¸€ä¸ªå•ä¸€æŒ‡æ ‡ï¼Œå› ä¸ºå®ƒä»¬éƒ½çœ‹åˆ°äº†åˆ†ç±»æ¨¡å‹å‡†ç¡®æ€§çš„ä¸åŒæ–¹é¢ã€‚

+   è°ƒå’Œå¹³å‡æ•°å¯¹æœ€ä½åˆ†æ•æ„Ÿï¼›å› æ­¤ï¼Œä¸€ä¸ªåˆ†æ•°çš„è‰¯å¥½è¡¨ç°ä¸èƒ½å¹³å‡æˆ–å¼¥è¡¥å¦ä¸€ä¸ªåˆ†æ•°çš„ç³Ÿç³•è¡¨ç°

## è®­ç»ƒå’Œæµ‹è¯•ä¿æŒåˆ†ç¦»äº¤å‰éªŒè¯

å¦‚æœåªåº”ç”¨ä¸€ä¸ªè®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²æ¥è°ƒæ•´æˆ‘ä»¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹è¶…å‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ­£åœ¨åº”ç”¨ä¿æŒåˆ†ç¦»äº¤å‰éªŒè¯æ–¹æ³•ã€‚

+   æˆ‘ä»¬å°†æ•°æ®åˆ†å‰²æˆè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ï¼Œè¿™äº›æ˜¯è¯¦å°½ä¸”äº’æ–¥çš„ç»„ã€‚

+   ä½†è¿™ç§äº¤å‰éªŒè¯æ–¹æ³•å¹¶ä¸å…¨é¢ï¼Œæˆ‘ä»¬åªè€ƒè™‘ä¸€ä¸ªæµ‹è¯•åˆ†å‰²ï¼Œå¤§éƒ¨åˆ†æ•°æ®éƒ½æ²¡æœ‰è¢«æµ‹è¯•ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰æ¢ç´¢æ‰€æœ‰å¯èƒ½çš„åˆ†å‰²ç»„åˆï¼ˆæˆ‘ä»¬å°†åœ¨ä¸å…¶ä»–äº¤å‰éªŒè¯æ–¹æ³•æ¯”è¾ƒæ—¶äº†è§£æ›´å¤šå…³äºè¿™ä¸€ç‚¹ï¼‰

![](img/ada2e0334323368c40690e596e78d464.png)

è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ä¿æŒåˆ†ç¦»äº¤å‰éªŒè¯ã€‚

å·¥ä½œæµç¨‹æ˜¯ï¼Œ

1.  ä»æ¨¡å‹è®­ç»ƒä¸­ä¿ç•™æµ‹è¯•æ•°æ®å­é›†

1.  ä½¿ç”¨å‰©ä½™çš„è®­ç»ƒæ•°æ®ä»¥åŠä»£è¡¨ä»ç®€å•åˆ°å¤æ‚æ¨¡å‹çš„å¤šç§è¶…å‚æ•°æ¥è®­ç»ƒæ¨¡å‹

1.  ç„¶åä½¿ç”¨ä¿ç•™çš„æµ‹è¯•æ•°æ®æµ‹è¯•ä»ç®€å•åˆ°å¤æ‚çš„è®­ç»ƒæ¨¡å‹å¥—ä»¶

1.  é€‰æ‹©å…·æœ‰æœ€ä½æµ‹è¯•é”™è¯¯çš„æ¨¡å‹è¶…å‚æ•°ï¼ˆå¤æ‚æ€§ï¼‰

1.  ä½¿ç”¨è°ƒæ•´åçš„è¶…å‚æ•°å’Œæ‰€æœ‰æ•°æ®é‡æ–°è®­ç»ƒæ¨¡å‹ä»¥è¿›è¡Œéƒ¨ç½²

è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯æˆ‘ä»¬å¯ä»¥è½»æ¾è¯„ä¼°è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²ã€‚

+   ç”±äºåªæœ‰ä¸€ä¸ªåˆ†å‰²ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å¯è§†åŒ–å’Œè¯„ä¼°è®­ç»ƒå’Œæµ‹è¯•æ•°æ®æ¡ˆä¾‹ã€è¦†ç›–ç‡å’Œå¹³è¡¡æ€§

è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯è¿™ç§æ–¹æ³•å¯èƒ½å¯¹æµ‹è¯•æ•°æ®çš„ç‰¹å®šé€‰æ‹©æ•æ„Ÿ

+   å› æ­¤ï¼Œä¿æŒåˆ†ç¦»äº¤å‰éªŒè¯å¯èƒ½ä¼šå¯¼è‡´æµ‹è¯•é”™è¯¯ä¸è¶…å‚æ•°çš„å™ªå£°å›¾

## è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•ä¿æŒåˆ†ç¦»äº¤å‰éªŒè¯

å¸¸ç”¨çš„æ›´å®Œæ•´çš„ä¿æŒåˆ†ç¦»äº¤å‰éªŒè¯å·¥ä½œæµç¨‹æ˜¯

1.  **ä½¿ç”¨è®­ç»ƒæ•°æ®åˆ†å‰²è¿›è¡Œè®­ç»ƒ** - æ¨¡å‹ä»è¿™ä¸ªæ•°æ®ä¸­çœ‹åˆ°å¹¶å­¦ä¹ ä»¥è®­ç»ƒæ¨¡å‹å‚æ•°ã€‚

1.  **ä½¿ç”¨éªŒè¯æ•°æ®åˆ†å‰²è¿›è¡ŒéªŒè¯** - è¯„ä¼°æ¨¡å‹å¤æ‚æ€§ç›¸å¯¹äºå‡†ç¡®æ€§çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®æ˜¯ä»æ¨¡å‹å‚æ•°è®­ç»ƒä¸­ä¿ç•™å‡ºæ¥çš„ï¼Œä»¥è°ƒæ•´æ¨¡å‹è¶…å‚æ•°ã€‚è¿™ä¸è®­ç»ƒå’Œæµ‹è¯•å·¥ä½œæµç¨‹ä¸­çš„æµ‹è¯•æ•°æ®ç›¸åŒã€‚

1.  **ä½¿ç”¨æµ‹è¯•æ•°æ®æµ‹è¯•æ¨¡å‹æ€§èƒ½** - æ•°æ®ä¿ç•™åˆ°æ¨¡å‹å®Œæˆï¼Œä»¥æä¾›å¯¹æ¨¡å‹æ€§èƒ½çš„æœ€ç»ˆè¯„ä¼°ã€‚è¿™äº›æ•°æ®åœ¨æ„å»ºæ¨¡å‹æ—¶æ²¡æœ‰å‘æŒ¥ä½œç”¨ï¼Œé€šå¸¸ç”¨äºæ¯”è¾ƒå¤šä¸ªç«äº‰æ¨¡å‹ã€‚

![](img/e1cf2df3d7bb949f562eecd4af03f6c0.png)

è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•ä¿æŒåˆ†ç¦»äº¤å‰éªŒè¯ã€‚

æˆ‘ç†è§£è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•äº¤å‰éªŒè¯å·¥ä½œæµç¨‹çš„åŠ¨æœºã€‚è¿™æ˜¯å°è¯•ç”¨æˆ‘ä»¬çŸ¥é“çœŸç›¸å¹¶èƒ½å‡†ç¡®è®¿é—®å‡†ç¡®æ€§çš„æ¡ˆä¾‹æ¥å®¢è§‚åœ°æ£€æŸ¥æˆ‘ä»¬çš„æ¨¡å‹ã€‚

+   æˆ‘ä»¬çŸ¥é“çœŸç›¸å¹¶èƒ½å‡†ç¡®è®¿é—®å‡†ç¡®æ€§

+   ä¸æ¨¡å‹æ„å»ºã€è®­ç»ƒæ¨¡å‹å‚æ•°æˆ–è°ƒæ•´æ¨¡å‹è¶…å‚æ•°æ— å…³

æˆ‘å¯¹æ­¤è¡¨ç¤ºèµèµï¼Œä½†æˆ‘æœ‰ä¸€äº›æ‹…å¿§ï¼Œ

1.  æˆ‘ä»¬è¿›ä¸€æ­¥å‡å°‘äº†å¯ç”¨äºè®­ç»ƒæ¨¡å‹å‚æ•°å’Œè°ƒæ•´æ¨¡å‹è¶…å‚æ•°çš„æ ·æœ¬æ•°é‡ã€‚

1.  æœ€ç»ˆæˆ‘ä»¬å°†ä½¿ç”¨æ‰€æœ‰æ•°æ®é‡æ–°è®­ç»ƒè°ƒæ•´åçš„æ¨¡å‹ï¼Œå› æ­¤æˆ‘ä»¬æµ‹è¯•çš„æ¨¡å‹å®é™…ä¸Šå¹¶ä¸æ˜¯æœ€ç»ˆéƒ¨ç½²çš„æ¨¡å‹ã€‚

1.  å¦‚æœæµ‹è¯•æ•°æ®æ²¡æœ‰è¢«å‡†ç¡®é¢„æµ‹ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬æ˜¯å¦åŒ…æ‹¬å¦ä¸€è½®æµ‹è¯•ï¼Œä½¿ç”¨æ•°æ®é›†çš„å¦ä¸€éƒ¨åˆ†è¿›è¡Œæµ‹è¯•ï¼Ÿæ— ç©·æ— å°½ï¼Ÿ

## åŠ è½½æ‰€éœ€çš„åº“

ä»¥ä¸‹ä»£ç åŠ è½½æ‰€éœ€çš„åº“ã€‚è¿™äº›åº“åº”è¯¥å·²ç»ä¸ Anaconda 3 ä¸€èµ·å®‰è£…ã€‚

```py
ignore_warnings = True
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.ticker import (MultipleLocator, AutoMinorLocator) # control of axes ticks
from sklearn.model_selection import cross_val_score           # multi-processor K-fold crossvalidation
from sklearn.model_selection import train_test_split          # train and test split
from sklearn.model_selection import KFold                     # K-fold cross validation
plt.rc('axes', axisbelow=True)                                # plot all grids below the plot elements
if ignore_warnings == True:                                   
    import warnings
    warnings.filterwarnings('ignore')
cmap = plt.cm.inferno                                         # color map
seed = 42                                                     # random number seed 
```

## å£°æ˜å‡½æ•°

æˆ‘è¿˜æ·»åŠ äº†ä¸€ä¸ªæ–¹ä¾¿çš„å‡½æ•°æ¥æ·»åŠ ä¸»ç½‘æ ¼çº¿å’Œå‰¯ç½‘æ ¼çº¿ï¼Œä»¥æé«˜ç»˜å›¾çš„å¯è§£é‡Šæ€§ã€‚

```py
def add_grid():
    plt.gca().grid(True, which='major',linewidth = 1.0); plt.gca().grid(True, which='minor',linewidth = 0.2) # add y grids
    plt.gca().tick_params(which='major',length=7); plt.gca().tick_params(which='minor', length=4)
    plt.gca().xaxis.set_minor_locator(AutoMinorLocator()); plt.gca().yaxis.set_minor_locator(AutoMinorLocator()) # turn on minor ticks 
```

## å°†æ•°æ®åŠ è½½åˆ°æ¼”ç¤ºäº¤å‰éªŒè¯æ–¹æ³•

è®©æˆ‘ä»¬åŠ è½½ä¸€ä¸ªç©ºé—´æ•°æ®é›†å¹¶é€‰æ‹© 2 ä¸ªé¢„æµ‹ç‰¹å¾æ¥å¯è§†åŒ–äº¤å‰éªŒè¯æ–¹æ³•ã€‚

+   æˆ‘ä»¬å°†å…³æ³¨æ•°æ®æ‹†åˆ†ï¼Œè€Œä¸æ˜¯å®é™…çš„æ¨¡å‹è®­ç»ƒå’Œè°ƒæ•´ã€‚ç¨åå½“æˆ‘ä»¬ä»‹ç»é¢„æµ‹æœºå™¨å­¦ä¹ æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å°†æ·»åŠ å·¥ä½œæµç¨‹ä¸­çš„æ¨¡å‹ç»„ä»¶ã€‚

```py
df = pd.read_csv('https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/unconv_MV_v4.csv') # load data from Dr. Pyrcz's GitHub repository 

response = 'Prod'                                             # specify the response feature
X = df.iloc[:,[1,3]]                                          # make predictor and response DataFrames
y = df.loc[:,response]

Xname = X.columns.values.tolist()                             # store the names of the features
yname = y.name

Xmin = [6.0,1.0]; Xmax = [24.0,5.0]                           # set the minimum and maximum values for plotting
ymin = 500.0; ymax = 9000.0

Xlabel = ['Porosity','Acoustic Impedance']
ylabel = 'Normalized Initial Production (MCFPD)'

Xtitle = ['Porosity','Acoustic Impedance']
ytitle = 'Normalized Initial Production'

Xunit = ['%',r'$kg/mÂ³ x m/s x 10Â³$']; yunit = 'MCFPD'
Xlabelunit = [Xlabel[0] + ' (' + Xunit[0] + ')',Xlabel[1] + ' (' + Xunit[1] + ')']
ylabelunit = ylabel + ' (' + yunit + ')'

m = len(pred) + 1
mpred = len(pred) 
```

```py
---------------------------------------------------------------------------
NameError  Traceback (most recent call last)
Cell In[3], line 23
  20 Xlabelunit = [Xlabel[0] + ' (' + Xunit[0] + ')',Xlabel[1] + ' (' + Xunit[1] + ')']
  21 ylabelunit = ylabel + ' (' + yunit + ')'
---> 23 m = len(pred) + 1
  24 mpred = len(pred)

NameError: name 'pred' is not defined 
```

## å¯è§†åŒ–è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ä¿ç•™çš„äº¤å‰éªŒè¯

è®©æˆ‘ä»¬æ¯”è¾ƒè®­ç»ƒå’Œæµ‹è¯•æ•°æ®ä¸è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•æ•°æ®ä¿ç•™çš„æ‹†åˆ†ã€‚

+   é¦–å…ˆï¼Œæˆ‘ä»¬ç»˜åˆ¶è®­ç»ƒå’Œæµ‹è¯•æ•°æ®æ‹†åˆ†ï¼Œç„¶åæ˜¯è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•æ‹†åˆ†ã€‚

```py
test_prop = 0.15                                              # set the proportion of test data to withhold
X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=test_prop,random_state=73073) # train and test split
df_train = pd.concat([X_train,y_train],axis=1)                # make one train DataFrame with both X and y (remove all other features)
df_test = pd.concat([X_test,y_test],axis=1)                   # make one testin DataFrame with both X and y (remove all other features)

nbins = 20                                                    # number of histogram bins

plt.subplot(221)                                              # predictor feature #1 histogram
freq1,_,_ = plt.hist(x=df_train[Xname[0]],weights=None,bins=np.linspace(Xmin[0],Xmax[0],nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_test[Xname[0]],weights=None,bins=np.linspace(Xmin[0],Xmax[0],nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10)
plt.xlabel(Xlabelunit[0]); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(Xtitle[0]); add_grid()  
plt.xlim([Xmin[0],Xmax[0]]); plt.legend(loc='upper right')   

plt.subplot(222)                                              # predictor feature #2 histogram
freq1,_,_ = plt.hist(x=df_train[Xname[1]],weights=None,bins=np.linspace(Xmin[1],Xmax[1],nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_test[Xname[1]],weights=None,bins=np.linspace(Xmin[1],Xmax[1],nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10)
plt.xlabel(Xlabelunit[1]); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(Xtitle[1]); add_grid()  
plt.xlim([Xmin[1],Xmax[1]]); plt.legend(loc='upper right')   

plt.subplot(223)                                              # predictor feature #2 histogram
freq1,_,_ = plt.hist(x=df_train[yname],weights=None,bins=np.linspace(ymin,ymax,nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_test[yname],weights=None,bins=np.linspace(ymin,ymax,nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10)
plt.xlabel(ylabelunit); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(ytitle); add_grid()  
plt.xlim([ymin,ymax]); plt.legend(loc='upper right')   

plt.subplot(224)                                              # predictor features #1 and #2 scatter plot
plt.scatter(df_train[Xname[0]],df_train[Xname[1]],s=40,marker='o',color = 'darkorange',alpha = 0.8,edgecolor = 'black',zorder=10,label='Train')
plt.scatter(df_test[Xname[0]],df_test[Xname[1]],s=40,marker='o',color = 'red',alpha = 0.8,edgecolor = 'black',zorder=10,label='Test')
plt.title(Xlabel[0] + ' vs ' +  Xlabel[1])
plt.xlabel(Xlabelunit[0]); plt.ylabel(Xlabelunit[1])
plt.legend(); add_grid(); plt.xlim([Xmin[0],Xmax[0]]); plt.ylim([Xmin[1],Xmax[1]])

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=2.1, wspace=0.3, hspace=0.2)
#plt.savefig('Test.pdf', dpi=600, bbox_inches = 'tight',format='pdf') 
plt.show() 
```

![_images/f0f58efa21786c689ea72d45aad30f90c3dd3c383729660c4fd8a44bd077385e.png](img/a54bde3cc01f9083714572540a961fb0.png)

å¯è§†åŒ–è®­ç»ƒå’Œæµ‹è¯•æ‹†åˆ†æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œ

+   å¯¹äºæ¯ä¸ªé¢„æµ‹ç‰¹å¾å’Œå“åº”ç‰¹å¾ç»˜åˆ¶ç›´æ–¹å›¾ï¼Œä»¥ç¡®ä¿è®­ç»ƒå’Œæµ‹è¯•è¦†ç›–äº†å¯èƒ½çš„èŒƒå›´å¹¶ä¸”æ˜¯å¹³è¡¡çš„

+   å¦‚æœé¢„æµ‹ç‰¹å¾çš„æ•°é‡æ˜¯ 2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥ç»˜åˆ¶é¢„æµ‹ç‰¹å¾ç©ºé—´æ¥æ£€æŸ¥è®­ç»ƒå’Œæµ‹è¯•æ•°æ®æ‹†åˆ†çš„è¦†ç›–ç‡å’Œå¹³è¡¡æ€§

ç°åœ¨æˆ‘ä»¬é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œé’ˆå¯¹è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•æ•°æ®æ‹†åˆ†ã€‚

```py
val_prop = 0.15; test_prop = 0.15                             # set the proportion of test data to withhold
nbins = 20                                                    # number of histogram bins

X_train, X_temp, y_train, y_temp = train_test_split(X, y, test_size=val_prop + test_prop, random_state=42)
X_val, X_test, y_val, y_test = train_test_split(X_temp, y_temp, test_size=test_prop/(val_prop + test_prop), random_state=42)

df_train = pd.concat([X_train,y_train],axis=1); df_val = pd.concat([X_val,y_val],axis=1); df_test = pd.concat([X_test,y_test],axis=1) 

plt.subplot(221)                                              # predictor feature #1 histogram
freq1,_,_ = plt.hist(x=df_train[Xname[0]],weights=None,bins=np.linspace(Xmin[0],Xmax[0],nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_val[Xname[0]],weights=None,bins=np.linspace(Xmin[0],Xmax[0],nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Validate')
freq3,_,_ = plt.hist(x=df_test[Xname[0]],weights=None,bins=np.linspace(Xmin[0],Xmax[0],nbins),alpha = 0.6,
                     edgecolor='black',color='blue',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10,freq3.max()*1.10)
plt.xlabel(Xlabelunit[0]); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(Xtitle[0]); add_grid()  
plt.xlim([Xmin[0],Xmax[0]]); plt.legend(loc='upper right')   

plt.subplot(222)                                              # predictor feature #2 histogram
freq1,_,_ = plt.hist(x=df_train[Xname[1]],weights=None,bins=np.linspace(Xmin[1],Xmax[1],nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_val[Xname[1]],weights=None,bins=np.linspace(Xmin[1],Xmax[1],nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Validate')
freq3,_,_ = plt.hist(x=df_test[Xname[1]],weights=None,bins=np.linspace(Xmin[1],Xmax[1],nbins),alpha = 0.6,
                     edgecolor='black',color='blue',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10,freq3.max()*1.10)
plt.xlabel(Xlabelunit[1]); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(Xtitle[1]); add_grid()  
plt.xlim([Xmin[1],Xmax[1]]); plt.legend(loc='upper right')   

plt.subplot(223)                                              # predictor feature #2 histogram
freq1,_,_ = plt.hist(x=df_train[yname],weights=None,bins=np.linspace(ymin,ymax,nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_val[yname],weights=None,bins=np.linspace(ymin,ymax,nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Validate')
freq2,_,_ = plt.hist(x=df_test[yname],weights=None,bins=np.linspace(ymin,ymax,nbins),alpha = 0.6,
                     edgecolor='black',color='blue',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10,freq3.max()*1.10)
plt.xlabel(ylabelunit); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(ytitle); add_grid()  
plt.xlim([ymin,ymax]); plt.legend(loc='upper right')   

plt.subplot(224)                                              # predictor features #1 and #2 scatter plot
plt.scatter(df_train[Xname[0]],df_train[Xname[1]],s=40,marker='o',color = 'darkorange',alpha = 0.8,edgecolor = 'black',zorder=10,label='Train')
plt.scatter(df_val[Xname[0]],df_val[Xname[1]],s=40,marker='o',color = 'blue',alpha = 0.8,edgecolor = 'black',zorder=10,label='Test')
plt.scatter(df_test[Xname[0]],df_test[Xname[1]],s=40,marker='o',color = 'red',alpha = 0.8,edgecolor = 'black',zorder=10,label='Test')
plt.title(Xlabel[0] + ' vs ' +  Xlabel[1])
plt.xlabel(Xlabelunit[0]); plt.ylabel(Xlabelunit[1])
plt.legend(); add_grid(); plt.xlim([Xmin[0],Xmax[0]]); plt.ylim([Xmin[1],Xmax[1]])

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=2.1, wspace=0.3, hspace=0.2)
#plt.savefig('Test.pdf', dpi=600, bbox_inches = 'tight',format='pdf') 
plt.show() 
```

![_images/79b0ada345bb17fe9e2e5450cdd37a1c3881bfd2ae3882674678aab8cad6597d.png](img/8537d6caff0c1936ede31daca961765a.png)

å†æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥å¯è§†åŒ–æ‹†åˆ†ï¼Œç°åœ¨åŒ…æ‹¬è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•ï¼Œ

+   å¯¹äºæ¯ä¸ªé¢„æµ‹ç‰¹å¾å’Œå“åº”ç‰¹å¾ç»˜åˆ¶ç›´æ–¹å›¾ï¼Œä»¥ç¡®ä¿è®­ç»ƒå’Œæµ‹è¯•è¦†ç›–äº†å¯èƒ½çš„èŒƒå›´å¹¶ä¸”æ˜¯å¹³è¡¡çš„

+   å¦‚æœé¢„æµ‹ç‰¹å¾çš„æ•°é‡æ˜¯ 2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥ç»˜åˆ¶é¢„æµ‹ç‰¹å¾ç©ºé—´æ¥æ£€æŸ¥è®­ç»ƒå’Œæµ‹è¯•æ•°æ®æ‹†åˆ†çš„è¦†ç›–ç‡å’Œå¹³è¡¡æ€§

## ç•™ä¸€æ³•äº¤å‰éªŒè¯ (LOO CV)

ç•™ä¸€æ³•äº¤å‰éªŒè¯æ˜¯ä¸€ç§è¯¦å°½çš„äº¤å‰éªŒè¯æ–¹æ³•ï¼Œå³é€šè¿‡éå†æ‰€æœ‰æ•°æ®æ¥æµ‹è¯•æ‰€æœ‰æ•°æ®ã€‚

+   æˆ‘ä»¬è®­ç»ƒå’Œè°ƒæ•´ $n$ ä¸ªæ¨¡å‹ï¼Œå¯¹äºæ¯ä¸ªæ¨¡å‹ï¼Œä¸€ä¸ªæ•°æ®ç‚¹è¢«ä¿ç•™ä½œä¸ºæµ‹è¯•ï¼Œè€Œ $n-1$ ä¸ªæ•°æ®è¢«åˆ†é…ä¸ºè®­ç»ƒæ•°æ®

+   æˆ‘ä»¬å°†è®¡ç®— $n$ ä¸ªè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ï¼Œè¿™äº›è¯¯å·®å°†åœ¨æ‰€æœ‰ $n$ ä¸ªæ¨¡å‹ä¸Šæ±‡æ€»ï¼Œä¾‹å¦‚ï¼Œå‡æ–¹è¯¯å·®çš„å¹³å‡å€¼ã€‚

åœ¨ç•™ä¸€æ³•äº¤å‰éªŒè¯çš„æƒ…å†µä¸‹ï¼Œ

+   æˆ‘ä»¬åªæµ‹è¯•ä¸€ä¸ªæ•°æ®ç‚¹ï¼Œå› æ­¤æµ‹è¯•è¯¯å·®åªæ˜¯å•ä¸ªä¿ç•™æ•°æ®ç‚¹çš„å•ä¸ªé”™è¯¯ï¼Œæ‰€ä»¥æˆ‘ä»¬åªä½¿ç”¨æ ‡å‡†å‡æ–¹è¯¯å·®æ¥è¯„ä¼° $n$ ä¸ªæ¨¡å‹

$$ \text{æµ‹è¯•å‡æ–¹è¯¯å·®æ€»å’Œ} = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} (y_i - \hat{y}_i)Â² = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} (\Delta y_i)Â² $$

+   ä½†æ˜¯ï¼Œå¯¹äºæ¯ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬æœ‰ $n-1$ ä¸ªè®­ç»ƒæ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡å¹³å‡æ¯ä¸ªæ¨¡å‹çš„å‡æ–¹è¯¯å·®æ¥æ±‡æ€»ï¼Œ

$$ \text{Train MSE Aggregate} = \frac{1}{n} \sum_{i=1}^{n} \frac{1}{n-1} \sum_{i=1}^{n-1} (y_i - \hat{y}_i)Â² = \frac{1}{n} \sum_{i=1}^{n} \text{Train MSE}_i $$

è¿™é‡Œæ˜¯ç•™ä¸€æ³•äº¤å‰éªŒè¯çš„æ­¥éª¤ï¼Œ

1.  éå†æ‰€æœ‰ $n$ ä¸ªæ•°æ®ï¼Œå¹¶ä¿ç•™è¯¥æ•°æ®

1.  åœ¨å‰©ä½™çš„ $nâˆ’1$ ä¸ªæ•°æ®ä¸Šè®­ç»ƒï¼Œå¹¶åœ¨ä¿ç•™çš„å•ä¸ªæ•°æ®ä¸Šæµ‹è¯•

1.  è®¡ç®—æ¨¡å‹è‰¯å¥½åº¦æŒ‡æ ‡ï¼Œå•ä¸ªæµ‹è¯•æ•°æ®çš„å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰æ˜¯å¹³æ–¹è¯¯å·®

1.  è½¬åˆ° 1

1.  å¯¹æ‰€æœ‰æ•°æ®èšåˆæ¨¡å‹è‰¯å¥½åº¦æŒ‡æ ‡ï¼Œ$n$

é€šå¸¸ï¼Œç•™ä¸€æ³•äº¤å‰éªŒè¯é¢„æµ‹é—®é¢˜è¿‡äºç®€å•ï¼›å› æ­¤ï¼Œå®ƒä¸å¸¸è¢«ä½¿ç”¨ï¼Œ

+   ä½†å®ƒå¼•å…¥äº†å…¨é¢äº¤å‰éªŒè¯çš„æ¦‚å¿µï¼Œå³æ‰€æœ‰æ•°æ®éƒ½è¿›è¡Œäº†æµ‹è¯•ï¼

ç•™ä¸€æ³•äº¤å‰éªŒè¯åœ¨æ¢ç´¢ $n$ ä¸ªæ•°æ®ä¸­é€‰æ‹© $p$ çš„å®Œæ•´ç»„åˆæ–¹é¢ä¹Ÿæ˜¯å…¨é¢çš„ï¼Œå…¶ä¸­ $p=1$ï¼Œ

$$ \binom{n}{p} = \frac{n!}{p!(n - p)!} = \frac{n!}{1!(n - 1)!} = \frac{n!}{(n - 1)!} = n $$

å…¶ä¸­ï¼Œå®Œæ•´çš„ç»„åˆæ˜¯ä¸Šé¢æ„å»ºçš„ $n$ ä¸ªæ¨¡å‹ï¼

## K æŠ˜äº¤å‰éªŒè¯ï¼ˆk-fold CVï¼‰

K æŠ˜æ˜¯ä¸€ç§æ›´é€šç”¨ã€é«˜æ•ˆä¸”ç¨³å¥çš„æ–¹æ³•ã€‚

+   ä¸€ç§å…¨é¢äº¤å‰éªŒè¯æ–¹æ³•ï¼ˆæ‰€æœ‰æ•°æ®éƒ½è¿›è¡Œæµ‹è¯•ï¼‰ï¼Œä½†å®ƒåªé‡‡æ ·äº†é¢„æµ‹é—®é¢˜å¯èƒ½ç»„åˆçš„æœ‰é™é›†ï¼Œä¸ç•™ä¸€æ³•äº¤å‰éªŒè¯ä¸åŒï¼Œåœ¨ç•™ä¸€æ³•äº¤å‰éªŒè¯ä¸­ï¼Œæˆ‘ä»¬å°è¯•å¯¹ä¿ç•™ç”¨äºæµ‹è¯•çš„æ•°æ®çš„æ¯ä¸€ç§å¯èƒ½æƒ…å†µè¿›è¡Œæµ‹è¯•

+   å¯¹äº K æŠ˜äº¤å‰éªŒè¯ï¼Œæˆ‘ä»¬åˆ†é…ä¸€ç»„ K ä¸ªå¤§å°ç›¸ç­‰çš„åˆ†å‰²ï¼Œå¹¶éå†è¿™äº›åˆ†å‰²ï¼Œä¿ç•™ $k$ ä¸ªåˆ†å‰²ä½œä¸ºæµ‹è¯•æ•°æ®ï¼Œå¹¶ä½¿ç”¨åˆ†å‰²å¤–çš„æ•°æ®ä½œä¸ºè®­ç»ƒæ•°æ®

+   æµ‹è¯•æ¯”ä¾‹æ˜¯ $\frac{1}{K}$ï¼Œä¾‹å¦‚ï¼Œå¯¹äº $K=3$ï¼Œ33.3% è¢«ä¿ç•™ç”¨äºæµ‹è¯•ï¼Œå¯¹äº $K=4$ï¼Œ25% è¢«ä¿ç•™ç”¨äºæµ‹è¯•ï¼Œå¯¹äº $K=5$ï¼Œ20% è¢«ä¿ç•™ç”¨äºæµ‹è¯•

æˆ‘ä»¬ç§°ä¹‹ä¸º K æŠ˜äº¤å‰éªŒè¯ï¼Œå› ä¸ºæ¯ä¸ªåˆ†å‰²éƒ½è¢«ç§°ä¸ºä¸€ä¸ªæŠ˜ã€‚ä»¥ä¸‹æ˜¯ K æŠ˜äº¤å‰éªŒè¯çš„æ­¥éª¤ï¼Œ

1.  é€‰æ‹© $K$ï¼Œæ•´æ•°ä¸ªæŠ˜

1.  å°†æ•°æ®åˆ†æˆ $K$ ä¸ªå¤§å°ç›¸ç­‰çš„æŠ˜

1.  éå†æ¯ä¸ª $k = 1,\ldots,K$ æŠ˜

1.  å°† $k$ æŠ˜å¤–çš„æ•°æ®åˆ†é…ä¸ºè®­ç»ƒæ•°æ®ï¼Œå¹¶å°† $k$ æŠ˜å†…çš„æ•°æ®åˆ†é…ä¸ºæµ‹è¯•æ•°æ®

1.  è®­ç»ƒå’Œæµ‹è¯•é¢„æµ‹æ¨¡å‹ï¼Œå¹¶è®¡ç®—æµ‹è¯•æ¨¡å‹æŒ‡æ ‡

1.  è½¬åˆ° 3

1.  å¯¹æ‰€æœ‰ K æŠ˜è¿›è¡Œèšåˆæµ‹è¯•æ¨¡å‹æŒ‡æ ‡

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œk æŠ˜äº¤å‰éªŒè¯æ˜¯å…¨é¢çš„ï¼Œå› ä¸ºæ‰€æœ‰æ•°æ®éƒ½è¿›è¡Œäº†æµ‹è¯•ï¼Œå³ä½œä¸ºæµ‹è¯•æ•°æ®è¢«ä¿ç•™ï¼Œä½†è¿™ç§æ–¹æ³•å¹¶ä¸æ˜¯å…¨é¢çš„ï¼Œå› ä¸ºå¹¶æ²¡æœ‰è€ƒè™‘æ‰€æœ‰å¯èƒ½çš„ $\frac{n}{K}$ ä¸ªæ•°æ®å­é›†ã€‚

ä¸ºäº†è®¡ç®—å…¨é¢ K æŠ˜çš„ç»„åˆï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å¤šé¡¹å¼ç³»æ•°ï¼Œ

$$ \frac{n!}{\left( \frac{n}{K}! \right)^K \cdot K!} $$

ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ $n=100$ ä¸ªæ•°æ®å’Œ $K=4$ ä¸ªæŠ˜ï¼Œé‚£ä¹ˆæœ‰ $6.72 \times 10âµâµ$ ç§å¯èƒ½çš„ç»„åˆã€‚æˆ‘å»ºè®®æˆ‘ä»¬åšæŒä½¿ç”¨å¸¸è§„çš„ K æŠ˜äº¤å‰éªŒè¯ã€‚

è®©æˆ‘ä»¬å¯è§†åŒ– K æŠ˜äº¤å‰éªŒè¯çš„åˆ†å‰²ï¼Œä»¥ $K=4$ ä¸ºä¾‹ã€‚

```py
K = 4
kf = KFold(n_splits=K, shuffle=True, random_state=seed)

df['Fold'] = -1
for fold_number, (train_index, test_index) in enumerate(kf.split(df)):
    df.loc[test_index, 'Fold'] = fold_number  # Assign fold number to test set

for k in range(0,K):
    df_in = df[df['Fold'] == k]; df_out = df[df['Fold'] != k]
    plt.subplot(2,2,k+1)
    plt.scatter(df_in[Xname[0]],df_in[Xname[1]],color='red',edgecolor='black',label='Test')
    plt.scatter(df_out[Xname[0]],df_out[Xname[1]],color='white',edgecolor='black',label='Train'); add_grid()
    plt.title('K-fold #' + str(k) + ', ' + Xlabel[0] + ' vs ' +  Xlabel[1])
    plt.xlabel(Xlabelunit[0]); plt.ylabel(Xlabelunit[1])
    plt.legend(); add_grid(); plt.xlim([Xmin[0],Xmax[0]]); plt.ylim([Xmin[1],Xmax[1]])

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=2.1, wspace=0.2, hspace=0.2); plt.show() 
```

![å›¾ç‰‡](img/dd257beaa821a963fc15b3318a7bd9f2.png)

## ç•™å‡º $p$ ä¸ªæ ·æœ¬äº¤å‰éªŒè¯ï¼ˆLpO-CVï¼‰

è¿™æ˜¯ K æŠ˜äº¤å‰éªŒè¯çš„ä¸€ç§å˜ä½“ï¼Œå®ƒå½»åº•é‡‡æ ·äº†ä¿ç•™ $p$ ä¸ªæµ‹è¯•æ•°æ®çš„å…¨éƒ¨ç»„åˆã€‚

1.  é€‰æ‹© $p$ï¼Œä¿ç•™æµ‹è¯•æ•°æ®çš„æ•´æ•°æ•°é‡

1.  å¯¹äºæ‰€æœ‰å¯èƒ½çš„ $p$ ä¸ª $n$ çš„å­é›†ï¼Œ

1.  å°† $p$ ä»¥å¤–çš„æ•°æ®åˆ†é…ä¸ºè®­ç»ƒæ•°æ®ï¼Œå°† $p$ ä»¥å†…çš„æ•°æ®åˆ†é…ä¸ºæµ‹è¯•æ•°æ®

1.  è®­ç»ƒå’Œæµ‹è¯•é¢„æµ‹æ¨¡å‹å¹¶è®¡ç®—æµ‹è¯•æ¨¡å‹åº¦é‡

1.  è½¬åˆ° 2

1.  åœ¨ç»„åˆä¸Šèšåˆæµ‹è¯•æ¨¡å‹åº¦é‡

å¯¹äºè¿™ç§æƒ…å†µï¼Œæ¡ˆä¾‹çš„ç»„åˆæ˜¯ï¼Œä» $n$ ä¸­é€‰æ‹© $p$ï¼Œ

$$ \binom{n}{p} = \frac{n!}{p!(n - p)!} $$

å¯¹äº $n=100$ å’Œ $p=20$ï¼Œæˆ‘ä»¬æœ‰ $5.36 \times 10^{20}$ ç§ç»„åˆéœ€è¦æ£€æŸ¥ï¼

## äº¤å‰éªŒè¯çš„é™åˆ¶

è¿™é‡Œæœ‰ä¸€äº›å…³äºæ¨¡å‹äº¤å‰éªŒè¯æ–¹æ³•çš„ä¸€èˆ¬é—®é¢˜ï¼Œ

+   **å·çœ‹ï¼Œä¿¡æ¯æ³„éœ²**â€”â€”ä¸€äº›ä¿¡æ¯ä»ä¿ç•™æ•°æ®ä¼ è¾“åˆ°æ¨¡å‹ä¸­ï¼Œä¸€äº›æ¨¡å‹å†³ç­–ï¼ˆä»¬ï¼‰ä½¿ç”¨æ‰€æœ‰æ•°æ®ã€‚ç®¡é“å’ŒåŒ…è£…å™¨æœ‰åŠ©äºè§£å†³è¿™ä¸ªé—®é¢˜ã€‚

+   **é»‘å¤©é¹… / é™æ€æ€§**â€”â€”æ¨¡å‹æ— æ³•æµ‹è¯•æ•°æ®ä¸­ä¸å¯ç”¨çš„äº‹ä»¶ã€‚è¿™ä¹Ÿè¢«ç§°ä¸ºæœºå™¨å­¦ä¹ ä¸­çš„â€œæ— å…è´¹åˆé¤å®šç†â€

è€ƒè™‘ä¼‘è°Ÿçš„è¯ï¼Œ

â€œå³ä½¿è§‚å¯Ÿåˆ°äº†é¢‘ç¹æˆ–æ’å®šçš„å¯¹è±¡è”åˆï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰ç†ç”±å¯¹ä»»ä½•è¶…å‡ºæˆ‘ä»¬ç»éªŒèŒƒå›´çš„å¯¹è±¡åšå‡ºä»»ä½•æ¨è®ºâ€â€”â€”ä¼‘è°Ÿ (1739â€“1740)

+   æˆ‘ä»¬æ— æ³•é¢„æµ‹æˆ‘ä»¬åœ¨æ•°æ®ä¸­ä»æœªè§è¿‡çš„äº‹ç‰©ï¼

è¿™é‡Œæ˜¯ä»è‘—åçš„ Oreskes ç­‰äºº (1994) å…³äºåœ°ä¸‹éªŒè¯å’ŒéªŒè¯çš„è®ºæ–‡ä¸­æ‘˜å½•çš„ä¸€å¥è¯ï¼Œ

â€œéªŒè¯å’ŒéªŒè¯è‡ªç„¶ç³»ç»Ÿçš„æ•°å€¼æ¨¡å‹æ˜¯ä¸å¯èƒ½çš„ã€‚è¿™æ˜¯å› ä¸ºè‡ªç„¶ç³»ç»Ÿæ°¸è¿œä¸ä¼šå°é—­ï¼Œå› ä¸ºæ¨¡å‹ç»“æœæ€»æ˜¯éå”¯ä¸€çš„ã€‚æ¨¡å‹å¯ä»¥é€šè¿‡è§‚å¯Ÿå’Œé¢„æµ‹ä¹‹é—´çš„ä¸€è‡´æ€§æ¥è¯å®ï¼Œä½†è¯å®æœ¬è´¨ä¸Šæ˜¯ä¸å®Œå…¨çš„ã€‚ç”±äºè‚¯å®šåä»¶çš„è°¬è¯¯å’Œè‡ªç„¶ç°è±¡çš„ä¸å®Œå…¨è®¿é—®ï¼Œå®Œå…¨è¯å®åœ¨é€»è¾‘ä¸Šæ˜¯ä¸å¯èƒ½çš„ã€‚æ¨¡å‹åªèƒ½ç›¸å¯¹è¯„ä¼°ï¼Œå®ƒä»¬çš„é¢„æµ‹ä»·å€¼æ€»æ˜¯å€¼å¾—æ€€ç–‘ã€‚æ¨¡å‹çš„ä¸»è¦ä»·å€¼æ˜¯å¯å‘æ€§çš„ã€‚â€

+   Oreskes ç­‰äºº (1994)

æ‰€æœ‰è¿™äº›éƒ½å¾ˆå¥½åœ°æ€»ç»“ä¸ºï¼Œ

â€œæ‰€æœ‰æ¨¡å‹éƒ½æ˜¯é”™è¯¯çš„ï¼Œä½†æœ‰äº›æ˜¯æœ‰ç”¨çš„â€â€”â€”ä¹”æ²»Â·åšå…‹æ–¯

å¹¶æé†’ï¼Œ

**ç®€çº¦æ€§**â€”â€”ç”±äºæ‰€æœ‰æ¨¡å‹éƒ½æ˜¯é”™è¯¯çš„ï¼Œå› æ­¤å¯¹ç³»ç»Ÿçš„ç»æµæè¿°ã€‚å¥¥å¡å§†å‰ƒåˆ€

ä»è€Œå½¢æˆäº†ä¸€ç§å®ç”¨æ–¹æ³•ï¼Œ

**é€‰æ‹©æ€§æ‹…å¿§**â€”â€”ç”±äºæ‰€æœ‰æ¨¡å‹éƒ½æ˜¯é”™è¯¯çš„ï¼Œæ‰¾å‡ºæœ€é‡è¦çš„é”™è¯¯æ˜¯ä»€ä¹ˆã€‚

æœ€åï¼Œæˆ‘åŠ å…¥äº†è‡ªå·±çš„è§‚ç‚¹ï¼Œ

â€œè°¦é€Šï¼Œåœ°çƒä¼šç»™ä½ æƒŠå–œï¼â€â€”â€”è¿ˆå…‹å°”Â·çš®å°”å¥‡

## è¯„è®º

è¿™æ˜¯å¯¹æœºå™¨å­¦ä¹ æ¦‚å¿µçš„åŸºæœ¬æè¿°ã€‚å¯ä»¥åšå’Œè®¨è®ºçš„è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘æœ‰å¾ˆå¤šæ›´å¤šçš„èµ„æºã€‚æŸ¥çœ‹æˆ‘çš„ [å…±äº«èµ„æºæ¸…å•](https://michaelpyrcz.com/my-resources) ä»¥åŠæœ¬ç« å¼€å¤´å¸¦æœ‰èµ„æºé“¾æ¥çš„è§†é¢‘è®²åº§é“¾æ¥ã€‚

å¸Œæœ›è¿™æœ‰æ‰€å¸®åŠ©ï¼Œ

*è¿ˆå…‹å°”*

## å…³äºä½œè€…

![å›¾ç‰‡](img/eb709b2c0a0c715da01ae0165efdf3b2.png)

è¿ˆå…‹å°”Â·çš®å°”å¥‡å…¹æ•™æˆåœ¨å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ 40 è‹±äº©æ ¡å›­çš„åŠå…¬å®¤ã€‚

è¿ˆå…‹å°”Â·çš®å°”å¥‡å…¹æ˜¯å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡[ç§‘å…‹é›·å°”å·¥ç¨‹å­¦é™¢](https://cockrell.utexas.edu/faculty-directory/alphabetical/p)å’Œ[æ°å…‹é€Šåœ°çƒç§‘å­¦å­¦é™¢](https://www.jsg.utexas.edu/researcher/michael_pyrcz/)çš„æ•™æˆï¼Œåœ¨é‚£é‡Œä»–ç ”ç©¶å¹¶æ•™æˆåœ°ä¸‹ã€ç©ºé—´æ•°æ®åˆ†æã€åœ°ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ã€‚è¿ˆå…‹å°”è¿˜æ˜¯ï¼Œ

+   [èƒ½æºåˆ†æ](https://fri.cns.utexas.edu/energy-analytics)æ–°ç”Ÿç ”ç©¶é¡¹ç›®çš„è´Ÿè´£äººï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡è‡ªç„¶ç§‘å­¦é™¢æœºå™¨å­¦ä¹ å®éªŒå®¤çš„æ ¸å¿ƒæ•™å‘˜ã€‚

+   [è®¡ç®—æœºä¸åœ°çƒç§‘å­¦](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board)çš„å‰¯ç¼–è¾‘ï¼Œä»¥åŠå›½é™…æ•°å­¦åœ°çƒç§‘å­¦åä¼š[æ•°å­¦åœ°çƒç§‘å­¦](https://link.springer.com/journal/11004/editorial-board)çš„è‘£äº‹ä¼šæˆå‘˜ã€‚

è¿ˆå…‹å°”å·²ç»æ’°å†™äº† 70 å¤šç¯‡[åŒè¡Œè¯„å®¡çš„å‡ºç‰ˆç‰©](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en)ï¼Œä¸€ä¸ªç”¨äºç©ºé—´æ•°æ®åˆ†æçš„[Python åŒ…](https://pypi.org/project/geostatspy/)ï¼Œåˆè‘—äº†ä¸€æœ¬å…³äºç©ºé—´æ•°æ®åˆ†æçš„æ•™ç§‘ä¹¦ã€ŠGeostatistical Reservoir Modelingã€‹ï¼ˆ[äºšé©¬é€Šé“¾æ¥](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)ï¼‰ï¼Œå¹¶ä¸”æ˜¯ä¸¤æœ¬æœ€è¿‘å‘å¸ƒçš„ç”µå­ä¹¦çš„ä½œè€…ï¼Œåˆ†åˆ«æ˜¯ã€ŠApplied Geostatistics in Python: a Hands-on Guide with GeostatsPyã€‹ï¼ˆ[GitHub é“¾æ¥](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)ï¼‰å’Œã€ŠApplied Machine Learning in Python: a Hands-on Guide with Codeã€‹ï¼ˆ[GitHub é“¾æ¥](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html)ï¼‰ã€‚

è¿ˆå…‹å°”çš„æ‰€æœ‰å¤§å­¦è®²åº§éƒ½å¯ä»¥åœ¨ä»–çš„[YouTube é¢‘é“](https://www.youtube.com/@GeostatsGuyLectures)ä¸Šæ‰¾åˆ°ï¼Œå…¶ä¸­åŒ…å« 100 å¤šä¸ª Python äº¤äº’å¼ä»ªè¡¨æ¿å’Œ 40 å¤šä¸ª GitHub è´¦æˆ·ä¸Šçš„è¯¦ç»†æ–‡æ¡£å·¥ä½œæµç¨‹ï¼Œè¿™äº›å·¥ä½œæµç¨‹åˆ†å¸ƒåœ¨ 40 å¤šä¸ªå­˜å‚¨åº“ä¸­ï¼Œæ—¨åœ¨æ”¯æŒä»»ä½•æ„Ÿå…´è¶£çš„å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«ï¼Œæä¾›å¸¸é’å†…å®¹ã€‚æƒ³äº†è§£æ›´å¤šå…³äºè¿ˆå…‹å°”çš„å·¥ä½œå’Œå…±äº«æ•™è‚²èµ„æºï¼Œè¯·è®¿é—®ä»–çš„ç½‘ç«™ã€‚

## æƒ³ä¸€èµ·å·¥ä½œå—ï¼Ÿ

æˆ‘å¸Œæœ›è¿™äº›å†…å®¹å¯¹é‚£äº›æƒ³äº†è§£æ›´å¤šå…³äºåœ°ä¸‹å»ºæ¨¡ã€æ•°æ®åˆ†æå’Œå­¦ä¹ æœºå™¨çš„äººæ¥è¯´æœ‰å¸®åŠ©ã€‚å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«éƒ½æ¬¢è¿å‚åŠ ã€‚

+   æƒ³é‚€è¯·æˆ‘åˆ°è´µå…¬å¸è¿›è¡ŒåŸ¹è®­ã€è¾…å¯¼ã€é¡¹ç›®å®¡æŸ¥ã€å·¥ä½œæµç¨‹è®¾è®¡å’Œ/æˆ–å’¨è¯¢å—ï¼Ÿæˆ‘å¾ˆä¹æ„æ‹œè®¿å¹¶ä¸æ‚¨åˆä½œï¼

+   æ„Ÿå…´è¶£åˆä½œï¼Œæ”¯æŒæˆ‘çš„ç ”ç©¶ç”Ÿç ”ç©¶æˆ–æˆ‘çš„åœ°ä¸‹æ•°æ®åˆ†æä¸æœºå™¨å­¦ä¹ è”ç›Ÿï¼ˆå…±åŒè´Ÿè´£äººåŒ…æ‹¬ Foster æ•™æˆã€Torres-Verdin æ•™æˆå’Œ van Oort æ•™æˆï¼‰ï¼Ÿæˆ‘çš„ç ”ç©¶ç»“åˆæ•°æ®åˆ†æã€éšæœºå»ºæ¨¡å’Œæœºå™¨å­¦ä¹ ç†è®ºä¸å®è·µï¼Œä»¥å¼€å‘æ–°çš„æ–¹æ³•å’Œå·¥ä½œæµç¨‹ï¼Œå¢åŠ ä»·å€¼ã€‚æˆ‘ä»¬æ­£åœ¨è§£å†³å…·æœ‰æŒ‘æˆ˜æ€§çš„åœ°ä¸‹é—®é¢˜ï¼

+   æˆ‘å¯ä»¥é€šè¿‡ mpyrcz@austin.utexas.edu è”ç³»åˆ°ã€‚

æˆ‘æ€»æ˜¯å¾ˆé«˜å…´è®¨è®ºï¼Œ

*è¿ˆå…‹å°”*

è¿ˆå…‹å°”Â·çš®å°”èŒ¨ï¼Œåšå£«ï¼Œå·¥ç¨‹å¸ˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ Cockrell å·¥ç¨‹å­¦é™¢å’Œ Jackson åœ°çƒç§‘å­¦å­¦é™¢æ•™æˆ

æ›´å¤šèµ„æºå¯åœ¨ä»¥ä¸‹é“¾æ¥è·å–ï¼š[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy) | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao) | [åœ°ç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446) | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python ä¸­åº”ç”¨åœ°ç»Ÿè®¡å­¦ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)

## è®­ç»ƒå’Œè°ƒæ•´é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹

åœ¨é¢„æµ‹æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬éµå¾ªæ ‡å‡†çš„æ¨¡å‹è®­ç»ƒå’Œæµ‹è¯•å·¥ä½œæµç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹ç¡®ä¿æˆ‘ä»¬çš„æ¨¡å‹èƒ½å¤Ÿå¾ˆå¥½åœ°æ¨å¹¿åˆ°æ–°æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯å®Œç¾åœ°æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚

![](img/31abfecc21c246ba7144dfb847ab4378.png)

æ ‡å‡†é¢„æµ‹æœºå™¨å­¦ä¹ å»ºæ¨¡å·¥ä½œæµç¨‹ã€‚

è®©æˆ‘ä»¬é€ä¸€äº†è§£å…³é”®æ­¥éª¤ï¼Œ

1.  **è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²** - å°†å¯ç”¨çš„æ•°æ®åˆ’åˆ†ä¸ºäº’æ–¥çš„ã€ç©·å°½çš„å­é›†ï¼šè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚

+   é€šå¸¸ï¼Œ15%â€“30%çš„æ•°æ®è¢«ä¿ç•™ç”¨äºæµ‹è¯•

+   å‰©ä½™çš„ 70%â€“85%ç”¨äºè®­ç»ƒæ¨¡å‹

1.  **å®šä¹‰è¦æ¢ç´¢çš„è¶…å‚æ•°å€¼èŒƒå›´**ï¼ŒèŒƒå›´ä»ï¼Œ

+   ç®€å•æ¨¡å‹ï¼Œçµæ´»æ€§ä½

+   åˆ°å¤æ‚æ¨¡å‹ï¼Œçµæ´»æ€§é«˜

$\quad$ æ­¤æ­¥éª¤å¯èƒ½æ¶‰åŠè°ƒæ•´å¤šä¸ªè¶…å‚æ•°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸ä½¿ç”¨é«˜æ•ˆçš„é‡‡æ ·æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œç½‘æ ¼æœç´¢ã€éšæœºæœç´¢æˆ–è´å¶æ–¯ä¼˜åŒ–ï¼‰ã€‚

1.  **ä¸ºæ¯ä¸ªè¶…å‚æ•°è®¾ç½®è®­ç»ƒæ¨¡å‹å‚æ•°** - å¯¹äºæ¯ç»„è¶…å‚æ•°ï¼Œåœ¨è®­ç»ƒæ•°æ®ä¸Šè®­ç»ƒä¸€ä¸ªæ¨¡å‹ã€‚è¿™ä¼šäº§ç”Ÿï¼š

+   ä¸€ç³»åˆ—ç»è¿‡è®­ç»ƒçš„æ¨¡å‹ï¼Œæ¯ä¸ªæ¨¡å‹å…·æœ‰ä¸åŒçš„å¤æ‚åº¦

+   æ¯ä¸ªæ¨¡å‹éƒ½æœ‰å‚æ•°ä¼˜åŒ–ä»¥æœ€å°åŒ–è®­ç»ƒæ•°æ®ä¸Šçš„è¯¯å·®

1.  **åœ¨ä¿ç•™çš„æµ‹è¯•æ•°æ®ä¸Šè¯„ä¼°æ¯ä¸ªæ¨¡å‹** - ä½¿ç”¨æµ‹è¯•æ•°æ®ï¼Œ

+   è¯„ä¼°æ¯ä¸ªè®­ç»ƒæ¨¡å‹åœ¨æœªè§æ•°æ®ä¸Šçš„è¡¨ç°

+   æ€»ç»“æ¯ä¸ªæ¨¡å‹çš„é¢„æµ‹è¯¯å·®ï¼ˆä¾‹å¦‚ï¼Œå‡æ–¹æ ¹è¯¯å·®ï¼ˆRMSEï¼‰ã€å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆMAEï¼‰ã€åˆ†ç±»å‡†ç¡®ç‡ï¼‰

1.  **é€‰æ‹©æœ€å°åŒ–æµ‹è¯•é”™è¯¯çš„è¶…å‚æ•°** - è¿™æ˜¯è¶…å‚æ•°è°ƒæ•´æ­¥éª¤ï¼š

+   é€‰æ‹©åœ¨æµ‹è¯•æ•°æ®ä¸Šè¡¨ç°æœ€å¥½çš„æ¨¡å‹è¶…å‚æ•°

+   è¿™äº›å°±æ˜¯ä½ çš„è°ƒæ•´åçš„è¶…å‚æ•°

1.  **ä½¿ç”¨è°ƒæ•´åçš„è¶…å‚æ•°åœ¨æ‰€æœ‰æ•°æ®ä¸Šé‡æ–°è®­ç»ƒæœ€ç»ˆæ¨¡å‹** - ç°åœ¨å·²ç»ç¡®å®šäº†æœ€ä½³æ¨¡å‹å¤æ‚æ€§ï¼Œ

+   ä½¿ç”¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†é‡æ–°è®­ç»ƒæ¨¡å‹

+   è¿™æœ€å¤§åŒ–äº†ç”¨äºæœ€ç»ˆæ¨¡å‹å‚æ•°ä¼°è®¡çš„æ•°æ®é‡

+   ç»“æœæ¨¡å‹æ˜¯ä½ åœ¨ç°å®ä¸–ç•Œåº”ç”¨ä¸­éƒ¨ç½²çš„æ¨¡å‹

## å…³äºæ¨¡å‹è®­ç»ƒå’Œè°ƒæ•´å·¥ä½œæµç¨‹çš„å¸¸è§é—®é¢˜

ä½œä¸ºä¸€åæ•™æˆï¼Œæˆ‘åœ¨ä»‹ç»ä¸Šè¿°æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒå’Œè°ƒæ•´å·¥ä½œæµç¨‹æ—¶ï¼Œç»å¸¸å¬åˆ°è¿™äº›é—®é¢˜ã€‚

+   **æ­¥éª¤ 1â€“5 çš„ä¸»è¦ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ** - å”¯ä¸€å¯é çš„è¾“å‡ºæ˜¯è°ƒæ•´åçš„è¶…å‚æ•°ã€‚

$\quad$ æˆ‘ä»¬ä¸ç›´æ¥ä½¿ç”¨æ­¥éª¤ 3 æˆ– 4 ä¸­è®­ç»ƒçš„æ¨¡å‹ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨æ— æ³•è®¿é—®æ‰€æœ‰å¯ç”¨æ•°æ®çš„æƒ…å†µä¸‹è®­ç»ƒçš„ã€‚ç›¸åï¼Œæˆ‘ä»¬ä½¿ç”¨æ‰€æœ‰æ•°æ®å’Œé€‰å®šçš„è¶…å‚æ•°é‡æ–°è®­ç»ƒæœ€ç»ˆæ¨¡å‹ã€‚

+   **ä¸ºä»€ä¹ˆä¸€å¼€å§‹ä¸åœ¨æ‰€æœ‰æ•°æ®ä¸Šè®­ç»ƒæ¨¡å‹ï¼Ÿ** - å› ä¸ºå¦‚æœæˆ‘ä»¬é‚£æ ·åšï¼Œæˆ‘ä»¬å°±æ²¡æœ‰ç‹¬ç«‹çš„æ–¹å¼æ¥è¯„ä¼°æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚ä¸€ä¸ªéå¸¸å¤æ‚çš„æ¨¡å‹å¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆâ€”â€”å®Œç¾åœ°æ‹Ÿåˆè®­ç»ƒæ•°æ®ï¼Œä½†åœ¨æ–°çš„ã€æœªè§è¿‡çš„æ•°æ®ä¸Šè¡¨ç°ä¸ä½³ã€‚

$\quad$ å½“æ¨¡å‹çµæ´»æ€§è¿‡é«˜æ—¶ä¼šå‘ç”Ÿè¿‡æ‹Ÿåˆâ€”â€”å®ƒæ•æ‰äº†å™ªå£°è€Œä¸æ˜¯æ½œåœ¨çš„æ¨¡å¼ã€‚å¦‚æœæ²¡æœ‰ä¿ç•™çš„æµ‹è¯•é›†ï¼Œæˆ‘ä»¬æ— æ³•æ£€æµ‹åˆ°è¿™ä¸€ç‚¹ã€‚

è¿™ä¸ªç”¨äºè®­ç»ƒå’Œè°ƒæ•´é¢„æµ‹æ€§æœºå™¨å­¦ä¹ æ¨¡å‹çš„å·¥ä½œæµç¨‹æ˜¯ï¼Œ

+   ä¸€ç§åŸºäºç»éªŒã€äº¤å‰éªŒè¯çš„è¿‡ç¨‹

+   å¯¹ç°å®ä¸–ç•Œæ¨¡å‹ä½¿ç”¨çš„å®é™…æ¨¡æ‹Ÿ

+   ä¸€ç§è¯†åˆ«æœ€ä½³æ¨¡å‹å¤æ‚åº¦çš„æ–¹æ³•ï¼Œä»¥å¹³è¡¡æ‹Ÿåˆå’Œæ³›åŒ–

æˆ‘å·²ç»å¤šæ¬¡æåˆ°æ¨¡å‹å‚æ•°å’Œæ¨¡å‹è¶…å‚æ•°ï¼Œæ‰€ä»¥æˆ‘æœ‰è´£ä»»ç»™å‡ºå®ƒä»¬çš„å®šä¹‰ã€‚

## æ¨¡å‹å‚æ•°å’Œæ¨¡å‹è¶…å‚æ•°

**æ¨¡å‹å‚æ•°**åœ¨è®­ç»ƒé˜¶æ®µè¿›è¡Œè°ƒæ•´ä»¥æœ€å°åŒ–è®­ç»ƒæ•°æ®çš„è¯¯å·®ï¼Œå³æ¨¡å‹å‚æ•°é€šè¿‡è®­ç»ƒæ•°æ®è®­ç»ƒï¼Œå¹¶æ§åˆ¶æ¨¡å‹å¯¹æ•°æ®çš„æ‹Ÿåˆã€‚ä¾‹å¦‚ï¼Œ

+   å¯¹äºä¸Šè¿°æœºå™¨å­¦ä¹ å·¥ä½œæµç¨‹ç¤ºä¾‹ä¸­çš„å¤šé¡¹å¼é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œæ¨¡å‹å‚æ•°æ˜¯å¤šé¡¹å¼ç³»æ•°ï¼Œä¾‹å¦‚ï¼Œå¯¹äºä¸‰æ¬¡å¤šé¡¹å¼æ¨¡å‹ï¼Œ$b_3$ã€$b_2$ã€$b_1$ å’Œ $c$ï¼ˆé€šå¸¸ç§°ä¸º $b_0$ï¼‰ã€‚

![](img/85cce1589249c12a11ff52ea10e6c893.png)

æ¨¡å‹å‚æ•°è¢«è°ƒæ•´ä»¥æ‹Ÿåˆæ¨¡å‹å¯¹æ•°æ®çš„æ‹Ÿåˆï¼Œå³æ¨¡å‹å‚æ•°è¢«è®­ç»ƒä»¥æœ€å°åŒ–è®­ç»ƒæ•°æ®ï¼ˆx æ ‡è®°ï¼‰ä¸Šçš„è¯¯å·®ã€‚

**æ¨¡å‹è¶…å‚æ•°**éå¸¸ä¸åŒã€‚å®ƒä»¬å¹¶ä¸ç›´æ¥çº¦æŸæ¨¡å‹å¯¹æ•°æ®çš„æ‹Ÿåˆï¼Œè€Œæ˜¯çº¦æŸæ¨¡å‹å¤æ‚åº¦ã€‚æ¨¡å‹è¶…å‚æ•°è¢«é€‰æ‹©ï¼ˆç§°ä¸ºè°ƒæ•´ï¼‰ä»¥æœ€å°åŒ–ä¿ç•™çš„æµ‹è¯•æ•°æ®çš„è¯¯å·®ã€‚å›åˆ°æˆ‘ä»¬å¤šé¡¹å¼é¢„æµ‹æœºå™¨å­¦ä¹ ç¤ºä¾‹ï¼Œå¤šé¡¹å¼é˜¶æ•°çš„é€‰æ‹©æ˜¯æ¨¡å‹è¶…å‚æ•°ã€‚

![](img/aef7a81bd36cd7f2b25e1574784b4932.png)

æ¨¡å‹è¶…å‚æ•°è¢«è°ƒæ•´ä»¥æ”¹å˜æ¨¡å‹å¤æ‚åº¦/çµæ´»æ€§ï¼Œå³æ¨¡å‹è¶…å‚æ•°è¢«è°ƒæ•´ä»¥æœ€å°åŒ–ä¿ç•™æµ‹è¯•æ•°æ®ï¼ˆå®å¿ƒåœ†ï¼‰ä¸Šçš„é”™è¯¯ã€‚

æ¨¡å‹å‚æ•°ä¸æ¨¡å‹è¶…å‚æ•°

æ¨¡å‹å‚æ•°æ§åˆ¶æ¨¡å‹æ‹Ÿåˆï¼Œå¹¶ä½¿ç”¨è®­ç»ƒæ•°æ®è¿›è¡Œè®­ç»ƒã€‚æ¨¡å‹è¶…å‚æ•°æ§åˆ¶æ¨¡å‹å¤æ‚åº¦ï¼Œå¹¶ä½¿ç”¨æµ‹è¯•æ•°æ®è¿›è¡Œè°ƒæ•´ã€‚

## å›å½’å’Œåˆ†ç±»

åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å›å½’å’Œåˆ†ç±»ã€‚

+   **å›å½’** - ä¸€ä¸ªé¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå…¶ä¸­å“åº”ç‰¹å¾æ˜¯è¿ç»­çš„ã€‚

+   **åˆ†ç±»** - ä¸€ä¸ªé¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå…¶ä¸­å“åº”ç‰¹å¾æ˜¯åˆ†ç±»çš„ã€‚

ç»“æœè¡¨æ˜ï¼Œå¯¹äºè¿™äº›ä¸­çš„æ¯ä¸€ä¸ªï¼Œæˆ‘ä»¬éƒ½éœ€è¦æ„å»ºä¸åŒçš„æ¨¡å‹å¹¶ä½¿ç”¨ä¸åŒçš„æ–¹æ³•æ¥è¯„ä¼°è¿™äº›æ¨¡å‹ã€‚

+   åœ¨æœ¬è®¨è®ºçš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä¸“æ³¨äºå›å½’ï¼Œä½†åœ¨åé¢çš„ç« èŠ‚ä¸­æˆ‘ä»¬ä¹Ÿä¼šä»‹ç»åˆ†ç±»æ¨¡å‹ã€‚

ç°åœ¨ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹è°ƒæ•´ï¼Œå³è°ƒæ•´æ¨¡å‹å¤æ‚åº¦ä»¥æœ€å°åŒ–æµ‹è¯•é”™è¯¯çš„ç»éªŒæ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£æµ‹è¯•é”™è¯¯çš„æ¥æºã€‚

+   æˆ‘ä»¬è¯•å›¾æœ€å°åŒ–çš„ä¸œè¥¿çš„åŸå› ï¼

## åŸ¹è®­å’Œæµ‹è¯•æ•°æ®

ä¸ºäº†æ¸…æ™°èµ·è§ï¼Œè€ƒè™‘è¿™æ˜¯é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹å‚æ•°è®­ç»ƒå’Œè¶…å‚æ•°è°ƒæ•´å·¥ä½œæµç¨‹ä¸­åŸ¹è®­å’Œæµ‹è¯•æ•°æ®æµåŠ¨çš„ç¤ºæ„å›¾ï¼Œ

![](img/454aec4a3d657f072406100f036592b6.png)

é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹å‚æ•°è®­ç»ƒå’Œè¶…å‚æ•°è°ƒæ•´å·¥ä½œæµç¨‹ä¸­åŸ¹è®­å’Œæµ‹è¯•æ•°æ®çš„æµåŠ¨ã€‚

**è®­ç»ƒæ•°æ®**ï¼Œ

+   è®­ç»ƒæ¨¡å‹å‚æ•°

+   è®­ç»ƒç”¨äºå®é™…åº”ç”¨çš„æœ€ç»ˆæ¨¡å‹

**æµ‹è¯•æ•°æ®**ï¼Œ

+   ä»è®­ç»ƒä¸­ä¿ç•™æ¨¡å‹å‚æ•°ä»¥é¿å…æ¨¡å‹è¿‡æ‹Ÿåˆ

+   è°ƒæ•´æ¨¡å‹è¶…å‚æ•°

+   è¿”å›ä»¥è®­ç»ƒæœ€ç»ˆè°ƒæ•´æ¨¡å‹ä»¥éƒ¨ç½²

## åº”è¯¥ä¿ç•™å¤šå°‘æ•°æ®ç”¨äºæµ‹è¯•ï¼Ÿ

æµ‹è¯•çš„æ¯”ä¾‹ç”±å„ç§æ¥æºæ¨èï¼Œä»æ€»æ•°æ®é›†çš„ 15%åˆ° 30%ã€‚è¿™æ˜¯ä¸€ä¸ªæŠ˜è¡·æ–¹æ¡ˆï¼Œ

+   ä¿ç•™ç”¨äºæµ‹è¯•çš„æ•°æ®å‡å°‘äº†å¯ç”¨äºè®­ç»ƒçš„æ•°æ®ï¼›å› æ­¤ï¼Œé™ä½äº†æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚

+   ä¿ç•™ç”¨äºæµ‹è¯•çš„æ•°æ®æé«˜äº†å¯¹æ¨¡å‹æ€§èƒ½è¯„ä¼°çš„å‡†ç¡®æ€§ã€‚

ä¸åŒçš„ä½œè€…åœ¨å„ç§å„æ ·çš„åŸ¹è®­å’Œæµ‹è¯•æ¯”ä¾‹ä¸Šè¿›è¡Œäº†å®éªŒï¼Œå¹¶ä¸ºå…¶åº”ç”¨æ¨èäº†åˆ†å‰²ã€‚

+   åŸ¹è®­å’Œæµ‹è¯•åˆ†å‰²çš„æœ€ä½³æ¯”ä¾‹å–å†³äºé—®é¢˜è®¾ç½®

ä¸ºäº†ç¡®å®šæµ‹è¯•æ•°æ®ä¿ç•™çš„æ¯”ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ¨¡å‹å‚æ•°è®­ç»ƒçš„éš¾åº¦ï¼ˆä¾‹å¦‚ï¼Œæ¨¡å‹å‚æ•°çš„æ•°é‡ï¼‰å’Œæ¨¡å‹è¶…å‚æ•°è°ƒæ•´çš„éš¾åº¦ï¼ˆä¾‹å¦‚ï¼Œè¶…å‚æ•°çš„æ•°é‡ï¼Œå“åº”ç‰¹å¾ç»“æœçš„èŒƒå›´ï¼‰ã€‚

## å…¬å¹³çš„åŸ¹è®­å’Œæµ‹è¯•æ•°æ®åˆ†å‰²

æœ±åˆ©å®‰Â·è¨æ‹‰æ‰åšå£«å»ºè®®ï¼Œå¯¹äºç©ºé—´é¢„æµ‹é—®é¢˜ï¼ŒéšæœºåŸ¹è®­å’Œæµ‹è¯•æ•°æ®åˆ†å‰²å¯èƒ½å¹¶ä¸å…¬å¹³ã€‚

+   æå‡ºäº†ä¸€ç§[å…¬å¹³è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²æ–¹æ³•](https://www.sciencedirect.com/science/article/pii/S0920410521015023)ï¼Œç”¨äºç©ºé—´é¢„æµ‹æ¨¡å‹ï¼Œè¯¥æ–¹æ³•æ ¹æ®æ¨¡å‹è®¡åˆ’ç”¨é€”çš„éš¾åº¦æ¥åˆ†å‰²æ•°æ®ã€‚

+   é¢„æµ‹éš¾åº¦ä¸å…‹é‡Œé‡‘æ–¹å·®ç›¸å…³ï¼Œå…‹é‡Œé‡‘æ–¹å·®è€ƒè™‘äº†ç©ºé—´è¿ç»­æ€§å’Œè·ç¦»åç§»ï¼Œå³ä¼°è®¡çš„éš¾åº¦ã€‚

+   æµ‹è¯•åˆ†å‰²è¢«è¿­ä»£ä»¥åŒ¹é…æ¨¡å‹è®¡åˆ’å®é™…åº”ç”¨çš„å…‹é‡Œé‡‘æ–¹å·®åˆ†å¸ƒ

ä¸ºäº†è¯´æ˜é¢„æµ‹éš¾åº¦è¿™ä¸€æ¦‚å¿µï¼Œè€ƒè™‘ä»¥ä¸‹ä¸€ç»„äº•æ—¥å¿—ï¼Œå…¶ä¸­æ—¢åŒ…å«äº†æµ‹è¯•æ•°æ®çš„éšæœºåˆ†é…ï¼Œåˆä¿ç•™äº†ä¸€ä¸ªè¿ç»­çš„æ•´ä¸ªäº•æ—¥å¿—åŒºåŸŸä½œä¸ºæµ‹è¯•æ•°æ®ã€‚

+   **å®¹æ˜“é¢„æµ‹çš„é—®é¢˜** - å¯¹äºéšæœºåˆ†é…ï¼Œé€šå¸¸è®­ç»ƒæ•°æ®éå¸¸æ¥è¿‘ä¸”ä¸ä¿ç•™çš„æµ‹è¯•æ•°æ®éå¸¸ç›¸ä¼¼

+   **éš¾ä»¥é¢„æµ‹çš„é—®é¢˜** - å¯¹äºç§»é™¤è¿ç»­åŒºåŸŸï¼Œæ²¡æœ‰ä¸ä¿ç•™çš„æµ‹è¯•æ•°æ®ç›¸ä¼¼æˆ–æ¥è¿‘çš„è®­ç»ƒæ•°æ®

![å›¾ç‰‡](img/5aa194417f3fa3435f02717796814e62.png)

è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²çš„ä¸¤ç§æƒ…å†µï¼Œéšæœºï¼ˆå·¦ï¼‰å’ŒæŒ‰åŒºåŸŸï¼ˆå³ï¼‰ã€‚

è€ƒè™‘ä»¥ä¸‹é¢„æµ‹æ¡ˆä¾‹ï¼Œå³æ¨¡å‹çš„è®¡åˆ’å®é™…åº”ç”¨ï¼Œä»¥åŠä¸€äº›å…³äºå…¬å¹³è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²çš„å®é™…å»ºè®®ã€‚

1.  å¦‚æœæ¨¡å‹å°†ç”¨äºä½¿ç”¨å¯ç”¨æ•°æ®ä¸­çš„å°åç§»æ¥æ’è¡¥æ•°æ®ï¼Œåˆ™æ„å»ºä¸€ä¸ªè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®åˆ†å‰²ï¼Œå…¶ä¸­è®­ç»ƒæ•°æ®é è¿‘æµ‹è¯•æ•°æ® - éšæœºåˆ†é…ä¿ç•™çš„æµ‹è¯•æ•°æ®å¯èƒ½æ˜¯è¶³å¤Ÿçš„ã€‚

1.  å¦‚æœæ¨¡å‹å°†ç”¨äºé¢„æµ‹å¤§è·ç¦»åç§»ï¼Œåˆ™è¿›è¡Œåˆ†å‰²ï¼Œç»“æœæ˜¯åœ¨è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ä¹‹é—´å­˜åœ¨å¤§åç§» - ä¿ç•™æ•´ä¸ªäº•ã€é’»å­”æˆ–ç©ºé—´åŒºåŸŸã€‚

+   æ³¨æ„ï¼Œåœ¨å…¬å¹³çš„è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²ä¸‹ï¼Œè°ƒæ•´åçš„æ¨¡å‹å¯èƒ½æ ¹æ®æ¨¡å‹çš„è®¡åˆ’ç”¨é€”è€Œæœ‰æ‰€ä¸åŒã€‚

å¯¹äºé¢„é’»é¢„æµ‹æ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨ä¿ç•™æ•´ä¸ªäº•çš„ç®€å•æ–¹æ³•ï¼Œæˆ–è€…ä½¿ç”¨ Salazar åšå£«çš„å·¥ä½œæµç¨‹ï¼Œä½†ä¸è¦å¿½ç•¥è¿™ä¸ªé—®é¢˜ï¼Œè€Œé»˜è®¤ä½¿ç”¨éšæœºé€‰æ‹©ã€‚

+   æ‰¿è®¤ï¼Œåœ¨æ•´ä¸ªç”µå­ä¹¦ä¸­ï¼Œä¸ºäº†æ¼”ç¤ºå·¥ä½œæµç¨‹çš„ç®€æ´æ€§å’Œæ¸…æ™°æ€§ï¼Œæˆ‘ä»…ä»…ä½¿ç”¨äº†éšæœºçš„è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†é…ã€‚

## æ¨¡å‹æŒ‡æ ‡

ç”±äºæˆ‘ä»¬å·²ç»æ¶µç›–äº†è®­ç»ƒå’Œè°ƒæ•´çš„å·¥ä½œæµç¨‹ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æŒ‡å®šåº”ç”¨è¿™äº›æ¨¡å‹æŒ‡æ ‡çš„æƒ…å†µï¼Œ

+   è®­ç»ƒæ¨¡å‹å‚æ•°

+   è°ƒæ•´æ¨¡å‹è¶…å‚æ•°

+   æ¨¡å‹æ£€æŸ¥å’Œæ¯”è¾ƒ

è¿™é‡Œæœ‰ä¸€ä¸ªæµç¨‹å›¾ï¼Œè¯´æ˜äº†è¿™äº›æŒ‡æ ‡å¦‚ä½•é€‚åº”æœºå™¨å­¦ä¹ å»ºæ¨¡å·¥ä½œæµç¨‹ã€‚

![å›¾ç‰‡](img/d311f90f3b59dd6738b0ce7a12614995.png)

æ¨¡å‹æŒ‡æ ‡åœ¨æœºå™¨å­¦ä¹ å»ºæ¨¡å·¥ä½œæµç¨‹ä¸­çš„å„ç§åº”ç”¨ã€‚

æ¨¡å‹æŒ‡æ ‡çš„é€‰æ‹©ä¸»è¦å–å†³äºé¢„æµ‹é—®é¢˜çš„ä¸Šä¸‹æ–‡ï¼Œ

+   åˆ†ç±»ä¸å›å½’

+   å•ä¸ªä¼°è®¡å€¼ä¸ç©ºé—´ï¼ˆå›¾åƒï¼‰æˆ–æ—¶é—´ï¼ˆä¿¡å·ï¼‰ä¸­çš„æ•´ä¸ªå­é›†

+   ä¼°è®¡ä¸ä¸ç¡®å®šæ€§

æœ‰å…¶ä»–è€ƒè™‘å› ç´ ï¼Œä¾‹å¦‚ï¼Œ

+   $LÂ¹$ ä¸ $LÂ²$ èŒƒæ•°åŠå…¶å·®å¼‚ï¼Œä¾‹å¦‚ï¼Œåœ¨å¼‚å¸¸å€¼é²æ£’æ€§ã€è§£çš„ç¨³å®šæ€§å’Œè§£çš„ç¨€ç–æ€§æ–¹é¢

+   ä¸æ¨¡å‹å‡è®¾çš„ä¸€è‡´æ€§ï¼Œä¾‹å¦‚ï¼Œ$rÂ²$ åªå¯¹çº¿æ€§æ¨¡å‹æœ‰æ•ˆ

è®©æˆ‘ä»¬å›é¡¾ä¸€äº›å›å½’æ¨¡å‹çš„å¸¸è§æ¨¡å‹åº¦é‡ï¼Œç„¶åæ˜¯åˆ†ç±»æ¨¡å‹ã€‚

## å‡æ–¹è¯¯å·® (MSE)

å¯¹å¼‚å¸¸å€¼æ•æ„Ÿï¼Œä½†è¿ç»­å¯å¾®ï¼Œå¯¼è‡´æ¨¡å‹è®­ç»ƒçš„é—­å¼è¡¨è¾¾å¼ã€‚ç”±äºè¯¯å·®æ˜¯å¹³æ–¹çš„ï¼Œè¯¯å·®å•ä½ä¹Ÿæ˜¯å¹³æ–¹çš„ï¼Œè¿™å¯èƒ½å¯¼è‡´è§£é‡Šæ€§è¾ƒå·®ï¼Œä¾‹å¦‚ï¼Œå‡æ–¹è¯¯å·®ä¸º 23,543 $mDÂ²$ã€‚è¯¥æ–¹ç¨‹æ˜¯ï¼Œ

$$ \text{æµ‹è¯•å‡æ–¹è¯¯å·®} = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} (y_i - \hat{y}_i)Â² = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} (\Delta y_i)Â² $$

## å‡å€¼ç»å¯¹è¯¯å·® (MAE)

åœ¨å¼‚å¸¸å€¼å­˜åœ¨çš„æƒ…å†µä¸‹ç¨³å¥ï¼Œä½†ä¸å¯è¿ç»­å¾®åˆ†ï¼›å› æ­¤ï¼Œæ²¡æœ‰æ¨¡å‹è®­ç»ƒçš„é—­å¼è¡¨è¾¾å¼ï¼Œè®­ç»ƒé€šå¸¸é€šè¿‡è¿­ä»£ä¼˜åŒ–å®Œæˆã€‚æ–¹ç¨‹æ˜¯ï¼Œ

$$ \text{æµ‹è¯• MAE} = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} |y_i - \hat{y}_i| = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} |\Delta y_i| $$

## è§£é‡Šæ–¹å·®

æ¨¡å‹æ•è·çš„å“åº”ç‰¹å¾æ–¹å·®çš„æ¯”ç‡ã€‚å‡è®¾æ–¹å·®å¯åŠ æ€§ï¼›å› æ­¤ï¼Œæˆ‘ä»¬åªå¯¹çº¿æ€§æ¨¡å‹ä½¿ç”¨æ­¤æ¨¡å‹åº¦é‡ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬è®¡ç®—æ¨¡å‹è§£é‡Šçš„æ–¹å·®ï¼Œç®€å•åœ°è¯´å°±æ˜¯æ¨¡å‹é¢„æµ‹çš„æ–¹å·®ï¼Œ

$$ \sigma_{\text{explained}}Â² = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} ( \hat{y}_i - \bar{y} )Â² $$

ç„¶åï¼Œæˆ‘ä»¬è®¡ç®—æ¨¡å‹æœªè§£é‡Šçš„æ–¹å·®ä½œä¸ºè¯¯å·®æ–¹å·®çš„æ–¹å·®ï¼Œ

$$ \sigma_{\text{not explained}}Â² = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} (y_i - \hat{y}_i)Â² $$

ç„¶ååœ¨æ–¹å·®å¯åŠ æ€§çš„å‡è®¾ä¸‹ï¼Œæˆ‘ä»¬è®¡ç®—è§£é‡Šæ–¹å·®ä¸æ€»æ–¹å·®çš„æ¯”ç‡ï¼Œè§£é‡Šæ–¹å·®åŠ ä¸Šæœªè§£é‡Šçš„æ–¹å·®ï¼Œ

$$ rÂ² = \frac{\sigma_{\text{explained}}Â²}{\sigma_{\text{explained}}Â² + \sigma_{\text{not explained}}Â²} = \frac{\sigma_{\text{explained}}Â²}{\sigma_{\text{total}}Â²} $$

å¯¹äºçº¿æ€§å›å½’ï¼Œå›å¿† $rÂ² = \left( \rho_(X,y) \right)Â²$ï¼›å› æ­¤ï¼Œåƒç›¸å…³ç³»æ•°ä¸€æ ·ï¼Œ$rÂ²$ï¼Œ

+   ä¸ç›¸å…³ç³»æ•°åœ¨å¼‚å¸¸å€¼å’Œæ··åˆå¤šä¸ªæ€»ä½“æ–¹é¢æœ‰ç±»ä¼¼é—®é¢˜ï¼Œä¾‹å¦‚ï¼Œè¾›æ™®æ£®æ‚–è®º

+   å¯¹äºéçº¿æ€§æ¨¡å‹ï¼Œè€ƒè™‘ä¼ªå†³å®šç³»æ•°æ–¹æ³•

æ­¤å¤–ï¼Œå³ä½¿çº¿æ€§æ¨¡å‹ä¹Ÿå¯èƒ½æœ‰è´Ÿçš„ $rÂ²$ï¼Œå¦‚æœæ¨¡å‹è¶‹åŠ¿ä¸æ•°æ®è¶‹åŠ¿ç›¸çŸ›ç›¾ï¼Œä¾‹å¦‚ï¼Œå¦‚æœä½ ç”¨æ­£æ–œç‡çš„çº¿æ€§æ¨¡å‹æ‹Ÿåˆè´Ÿæ–œç‡çš„æ•°æ®ï¼

## å†…ç‚¹æ¯”ç‡

è®¡ç®—ä¸ºæ¨¡å‹ $\hat{y}_i$ åœ¨ä¸€ä¸ªè¾¹é™… $\epsilon$ å†…çš„æµ‹è¯•æ•°æ® $y_i$ çš„æ¯”ä¾‹ï¼Œ

$$ I_R = \frac{1}{n_{\text{test}}} \sum_{i=1}^{n_{\text{test}}} I(y_i, \hat{y}_i) $$

å…¶ä¸­ï¼ŒæŒ‡ç¤ºå˜æ¢ $I_R$ å®šä¹‰ä¸ºï¼Œ

$$\begin{split} I(y_i, \hat{y}_i) = \begin{cases} 1, & \text{if } |y_i - \hat{y}_i| \leq \epsilon \\ 0, & \text{otherwise} \end{cases} \end{split}$$

è¿™æ˜¯å¯¹å†…ç‚¹æ¯”ä¾‹æ¨¡å‹æŒ‡æ ‡ $I_R$ çš„ä¸€ä¸ªè¯´æ˜ï¼Œ

![](img/3ddaa66ff3998a59b318297be09c60b8.png)

æµ‹è¯•æ•°æ®ï¼Œæ¨¡å‹å¸¦æœ‰è¾¹ç•Œï¼Œ$\epsilon$ï¼Œä»¥åŠè¯†åˆ«å‡ºçš„å¼‚å¸¸å€¼ï¼ˆç™½è‰²ï¼‰å’Œå†…ç‚¹ï¼ˆçº¢è‰²ï¼‰ï¼Œ25 ä¸ªæ•°æ®æ ·æœ¬ä¸­æœ‰ 16 ä¸ªå†…ç‚¹ï¼Œ$ğ¼ğ‘… = 0.64$ã€‚

è™½ç„¶è¿™ä¸ªå›¾ç¤ºæ˜¯çº¿æ€§æ¨¡å‹ï¼Œä½†è¿™ä¸ªæŒ‡æ ‡å¯ä»¥åº”ç”¨äºä»»ä½•æ¨¡å‹ã€‚å°½ç®¡å†…ç‚¹æ¯”ä¾‹æ¨¡å‹æŒ‡æ ‡å­˜åœ¨ä¸€äº›ä¸»è§‚æ€§ï¼Œ

+   ä»€ä¹ˆæ˜¯æœ€ä¼˜çš„è¾¹ç•Œé€‰æ‹©ï¼Œ$\epsilon$ï¼Ÿ

## å¸¸è§åˆ†ç±»æ¨¡å‹æŒ‡æ ‡

è®©æˆ‘ä»¬å›é¡¾ä¸€äº›å¸¸è§çš„åˆ†ç±»æ¨¡å‹æŒ‡æ ‡ã€‚åˆ†ç±»å¯èƒ½æ¯”å›å½’æ›´å¤æ‚ï¼Œå› ä¸ºæˆ‘ä»¬å®é™…ä¸Šè®¡ç®—çš„æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ··æ·†çŸ©é˜µï¼Œ

+   ä¸€ä¸ª $K \times K$ çš„çŸ©é˜µï¼Œè¡¨ç¤ºé¢„æµ‹ï¼ˆx è½´ï¼‰ä¸å®é™…ï¼ˆy è½´ï¼‰ç±»åˆ«é¢‘ç‡ï¼Œç”¨äºå¯è§†åŒ–åˆ†ç±»æ¨¡å‹çš„æ€§èƒ½ï¼Œå…¶ä¸­ $K$ æ˜¯å“åº”ç‰¹å¾çš„åŸºæ•°ï¼Œå³å¯èƒ½ç±»åˆ«çš„æ•°é‡

+   ä½¿ç”¨åˆ†ç±»æ¨¡å‹å¯è§†åŒ–å¹¶è¯Šæ–­æ‰€æœ‰æ­£ç¡®å’Œé”™è¯¯åˆ†ç±»çš„ç»„åˆï¼Œä¾‹å¦‚ï¼Œç±»åˆ« 1 å¸¸å¸¸è¢«é”™è¯¯åœ°åˆ†ç±»ä¸ºç±»åˆ« 3ï¼Œ

![](img/0c2a856f882f5bcc7e9df675ea5afb21.png)

åˆ†ç±»æ¨¡å‹çš„ç¤ºä¾‹æ··æ·†çŸ©é˜µï¼Œä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œè¡¨ç¤ºæ‰€æœ‰çœŸå®å’Œé¢„æµ‹ç±»åˆ«çš„é¢‘ç‡ã€‚

+   å®Œç¾å‡†ç¡®åº¦æ˜¯æ¯ä¸ªç±»åˆ«çš„æ•°é‡ï¼Œ$n_1, n_2, \ldots, n_K$ åœ¨å¯¹è§’çº¿ä¸Šï¼Œå³ç±»åˆ« 1 æ€»æ˜¯é¢„æµ‹ä¸ºç±»åˆ« 1ï¼Œç­‰ç­‰ã€‚

![](img/34df964c246951e764fc3a7e8fecbf96.png)

å®Œç¾å‡†ç¡®åº¦çš„ç¤ºä¾‹æ··æ·†çŸ©é˜µã€‚

+   æ··æ·†çŸ©é˜µåº”ç”¨äºè®¡ç®—å•ä¸ªåˆ†ç±»å‡†ç¡®åº¦çš„æ‘˜è¦ï¼Œä¾‹å¦‚ï¼Œç²¾ç¡®åº¦ã€å¬å›ç‡ç­‰ã€‚

+   æ¨¡å‹æŒ‡æ ‡ç‰¹å®šäºç‰¹å®šç±»åˆ«ï¼Œå¹¶ä¸”å¯èƒ½åœ¨ç±»åˆ«ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ï¼Œå³æˆ‘ä»¬å¯èƒ½å¯¹ç±»åˆ« $k=1$ é¢„æµ‹å¾—å¾ˆå¥½ï¼Œä½†å¯¹ç±»åˆ« $k=3$ åˆ™ä¸ç„¶ã€‚

## ç²¾ç¡®åº¦

å¯¹äºç±»åˆ« $ğ‘˜$ï¼Œç²¾ç¡®åº¦æ˜¯æ‰€æœ‰æ­£ä¾‹ä¸­çœŸæ­£ä¾‹çš„æ¯”ä¾‹ï¼Œ

$$ \text{Precision}_k = \frac{n_{k \text{ true positive}}}{n_{k \text{ true positive}} + n_{k \text{ false positive}}} = \frac{\text{true positive}}{\text{all positives}} $$

æˆ‘ä»¬å¯ä»¥ç›´è§‚åœ°æè¿°ç²¾ç¡®åº¦ä¸ºæ¡ä»¶æ¦‚ç‡ï¼Œ

$$ \text{Precision}_k = P \left(k \text{ is happening} \mid \text{model says } k \text{ is happening}\right) $$![](img/020824af3f57f97af1ee2ba6ca6de684.png)

ç¤ºä¾‹æ··æ·†çŸ©é˜µï¼Œå±•ç¤ºäº†æ¯ä¸ªç±»åˆ« $k$ çš„ç²¾ç¡®åº¦æ¨¡å‹æŒ‡æ ‡ã€‚

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¯ä¸ªç±»åˆ«çš„ç²¾ç¡®åº¦ï¼Œ

+   ç±»åˆ« k=1

$$ \text{Precision}_{k=1} = \frac{15}{15 + (5 + 7)} = \frac{15}{27} = 0.56 $$

+   ç±»åˆ« k = 2,

$$ \text{Precision}_{k=2} = \frac{22}{22 + (15 + 15)} = \frac{22}{52} = 0.42 $$

+   ç±»åˆ« k = 3,

$$ \text{Precision}_{k=3} = \frac{4}{4 + (2 + 9)} = \frac{4}{15} = 0.27 $$

## å¬å›ç‡ï¼ˆåœ¨åŒ»å­¦ä¸­ç§°ä¸ºæ•æ„Ÿæ€§ï¼‰

å¯¹äºç»„ $ğ‘˜$ çš„å¬å›ç‡æ˜¯çœŸæ­£ä¾‹ä¸ $ğ‘˜$ çš„æ‰€æœ‰æ¡ˆä¾‹çš„æ¯”ä¾‹ã€‚

$$ \text{Recall}_k = \frac{n_{k \text{ true positive}}}{n_{k \text{ true positive}} + n_{k \text{ false negative}}} $$

æˆ‘ä»¬å¯ä»¥ç›´è§‚åœ°æè¿°å¬å›ç‡ï¼Œå³æˆ‘ä»¬æ•è·äº†ç»„ $k$ ä¸­çš„å¤šå°‘ä¸ªï¼Ÿ

+   æ³¨æ„ï¼Œå¬å›ç‡ä¸è€ƒè™‘å‡é˜³æ€§ã€‚

![](img/94f40c5cd8c775dabd2e31e85c21a9cf.png)

ç¤ºä¾‹æ··æ·†çŸ©é˜µï¼Œå±•ç¤ºäº†æ¯ä¸ªç±»åˆ« $k$ çš„å¬å›æ¨¡å‹æŒ‡æ ‡ï¼Œ

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¯ä¸ªç±»åˆ«çš„å¬å›ç‡å¦‚ä¸‹ï¼Œ

+   ç±»åˆ« $k=1$

$$ \text{Recall}_{k=1} = \frac{15}{15 + (15 + 2)} = \frac{15}{32} = 0.47 $$

+   ç±»åˆ« $k = 2$ï¼Œ

$$ \text{Recall}_{k=2} = \frac{22}{22 + (5 + 9)} = \frac{22}{36} = 0.61 $$

+   ç±»åˆ« $k = 3$ï¼Œ

$$ \text{Recall}_{k=3} = \frac{4}{4 + (7 + 15)} = \frac{4}{26} = 0.15 $$

## ç‰¹å¼‚æ€§

ç»„ $ğ‘˜$ çš„ç‰¹å¼‚æ€§æ˜¯çœŸå®è´Ÿä¾‹ä¸æ‰€æœ‰é $k$ è´Ÿä¾‹çš„æ¯”ç‡ã€‚

$$ \text{Specificity}_k = \frac{n_{k \text{ true negative}}}{n_{\neq k} \, n_{k \text{ true negative}} + n_{k \text{ false positive}}} $$

æˆ‘ä»¬å¯ä»¥ç›´è§‚åœ°æè¿°ç‰¹å¼‚æ€§ï¼Œå³æˆ‘ä»¬æ•è·äº†éç»„ $k$ ä¸­çš„å¤šå°‘ä¸ªï¼Ÿ

+   æ³¨æ„ï¼Œå¬å›ç‡ä¸è€ƒè™‘çœŸé˜³æ€§ã€‚

![](img/22a61637f89b9d1f446385497e2e9b65.png)

ç¤ºä¾‹æ··æ·†çŸ©é˜µï¼Œå±•ç¤ºäº†æ¯ä¸ªç±»åˆ« $k$ çš„å¬å›æ¨¡å‹æŒ‡æ ‡ï¼Œ

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¯ä¸ªç±»åˆ«çš„å¬å›ç‡å¦‚ä¸‹ï¼Œ

+   ç±»åˆ« $k=1$

$$ \text{Specificity}_{k=1} = \frac{22 + 9 + 15 + 4}{(22 + 9 + 15 + 4) + (5 + 7)} = \frac{50}{62} = 0.81 $$

+   ç±»åˆ« $k = 2$ï¼Œ

$$ \text{Specificity}_{k=2} = \frac{15 + 2 + 7 + 4}{(15 + 2 + 7 + 4) + (15 + 15)} = \frac{28}{58} = 0.48 $$

+   ç±»åˆ« $k = 3$ï¼Œ

$$ \text{Specificity}_{k=3} = \frac{15 + 15 + 5 + 22}{(15 + 15 + 5 + 22) + (2 + 9)} = \frac{57}{68} = 0.84 $$

## f1-score

f1-score æ˜¯æ¯ä¸ª $k$ ç±»åˆ«çš„ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡å€¼ï¼Œ

$$ \text{F1-Score}_k = \frac{2}{\frac{1}{\text{Precision}_k} + \frac{1}{\text{Recall}_k}} $$

ç†å¿µæ˜¯å°†ç²¾ç¡®ç‡å’Œå¬å›ç‡åˆå¹¶æˆä¸€ä¸ªå•ä¸€æŒ‡æ ‡ï¼Œå› ä¸ºå®ƒä»¬éƒ½çœ‹åˆ°äº†åˆ†ç±»æ¨¡å‹å‡†ç¡®æ€§çš„ä¸åŒæ–¹é¢ã€‚

+   è°ƒå’Œå¹³å‡å€¼å¯¹æœ€ä½åˆ†æ•°æ•æ„Ÿï¼›å› æ­¤ï¼Œä¸€ä¸ªåˆ†æ•°çš„è‰¯å¥½è¡¨ç°ä¸èƒ½å¹³å‡æˆ–å¼¥è¡¥å¦ä¸€ä¸ªåˆ†æ•°çš„å·®åŠ£è¡¨ç°

## è®­ç»ƒå’Œæµ‹è¯•ç•™å‡ºäº¤å‰éªŒè¯

å¦‚æœåªåº”ç”¨ä¸€ä¸ªè®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²æ¥è°ƒæ•´æˆ‘ä»¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹è¶…å‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ­£åœ¨åº”ç”¨ç•™å‡ºäº¤å‰éªŒè¯æ–¹æ³•ã€‚

+   æˆ‘ä»¬å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ï¼Œè¿™äº›æ˜¯è¯¦å°½ä¸”äº’æ–¥çš„ç»„ã€‚

+   ä½†è¿™ç§äº¤å‰éªŒè¯æ–¹æ³•å¹¶ä¸å…¨é¢ï¼Œæˆ‘ä»¬åªè€ƒè™‘ä¸€ä¸ªç”¨äºæµ‹è¯•çš„åˆ†å‰²ï¼Œå¤§éƒ¨åˆ†æ•°æ®éƒ½æ²¡æœ‰è¢«æµ‹è¯•ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰æ¢ç´¢æ‰€æœ‰å¯èƒ½çš„åˆ†å‰²ç»„åˆï¼ˆæ›´å¤šå…³äºè¿™ä¸€ç‚¹ï¼Œå½“æˆ‘ä»¬ä¸å…¶ä»–äº¤å‰éªŒè¯æ–¹æ³•è¿›è¡Œæ¯”è¾ƒæ—¶ï¼‰

![](img/ada2e0334323368c40690e596e78d464.png)

è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®é‡‡ç”¨ç•™å‡ºäº¤å‰éªŒè¯ã€‚

å·¥ä½œæµç¨‹æ˜¯ï¼Œ

1.  åœ¨æ¨¡å‹è®­ç»ƒä¸­ä¿ç•™æµ‹è¯•æ•°æ®å­é›†

1.  ä½¿ç”¨å‰©ä½™çš„è®­ç»ƒæ•°æ®ä»¥åŠä»£è¡¨ç®€å•åˆ°å¤æ‚æ¨¡å‹çš„å¤šç§è¶…å‚æ•°æ¥è®­ç»ƒæ¨¡å‹

1.  ç„¶åä½¿ç”¨ä¿ç•™çš„æµ‹è¯•æ•°æ®æµ‹è¯•ä»ç®€å•åˆ°å¤æ‚çš„è®­ç»ƒæ¨¡å‹å¥—ä»¶

1.  é€‰æ‹©å…·æœ‰æœ€ä½æµ‹è¯•é”™è¯¯çš„æ¨¡å‹è¶…å‚æ•°ï¼ˆå¤æ‚åº¦ï¼‰

1.  ä½¿ç”¨è°ƒæ•´åçš„è¶…å‚æ•°å’Œæ‰€æœ‰æ•°æ®é‡æ–°è®­ç»ƒæ¨¡å‹ä»¥è¿›è¡Œéƒ¨ç½²

è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°è¯„ä¼°è®­ç»ƒå’Œæµ‹è¯•æ•°æ®æ‹†åˆ†ã€‚

+   ç”±äºåªæœ‰ä¸€ä¸ªæ‹†åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å¯è§†åŒ–å’Œè¯„ä¼°è®­ç»ƒå’Œæµ‹è¯•æ•°æ®æ¡ˆä¾‹ã€è¦†ç›–ç‡å’Œå¹³è¡¡æ€§

è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯å®ƒå¯èƒ½å¯¹æµ‹è¯•æ•°æ®çš„ç‰¹å®šé€‰æ‹©æ•æ„Ÿ

+   å› æ­¤ï¼Œä¿ç•™æ ·æœ¬äº¤å‰éªŒè¯å¯èƒ½ä¼šå¯¼è‡´æµ‹è¯•é”™è¯¯ä¸è¶…å‚æ•°çš„å™ªå£°å›¾

## è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•ä¿ç•™æ ·æœ¬äº¤å‰éªŒè¯

å¸¸ç”¨çš„æ›´å®Œæ•´çš„ä¿ç•™æ ·æœ¬äº¤å‰éªŒè¯å·¥ä½œæµç¨‹ï¼Œ

1.  **ä½¿ç”¨è®­ç»ƒæ•°æ®æ‹†åˆ†è¿›è¡Œè®­ç»ƒ** - æ¨¡å‹é€šè¿‡æ­¤æ•°æ®å­¦ä¹ å’Œè®­ç»ƒæ¨¡å‹å‚æ•°ã€‚

1.  **ä½¿ç”¨éªŒè¯æ•°æ®æ‹†åˆ†è¿›è¡ŒéªŒè¯** - è¯„ä¼°æ¨¡å‹å¤æ‚åº¦ä¸å‡†ç¡®åº¦ï¼Œæ•°æ®æœªç”¨äºæ¨¡å‹å‚æ•°è®­ç»ƒä»¥è°ƒæ•´æ¨¡å‹è¶…å‚æ•°ã€‚ä¸è®­ç»ƒå’Œæµ‹è¯•å·¥ä½œæµç¨‹ä¸­çš„æµ‹è¯•æ•°æ®ç›¸åŒã€‚

1.  **ä½¿ç”¨æµ‹è¯•æ•°æ®æµ‹è¯•æ¨¡å‹æ€§èƒ½** - æ•°æ®ä¿ç•™ç›´åˆ°æ¨¡å‹å®Œæˆï¼Œä»¥æä¾›æ¨¡å‹æ€§èƒ½çš„æœ€ç»ˆè¯„ä¼°ã€‚è¿™äº›æ•°æ®åœ¨æ„å»ºæ¨¡å‹æ—¶æ²¡æœ‰å‘æŒ¥ä½œç”¨ï¼Œé€šå¸¸ç”¨äºæ¯”è¾ƒå¤šä¸ªç«äº‰æ¨¡å‹ã€‚

![](img/e1cf2df3d7bb949f562eecd4af03f6c0.png)

è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•ä¿ç•™æ ·æœ¬äº¤å‰éªŒè¯ã€‚

æˆ‘ç†è§£è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•äº¤å‰éªŒè¯å·¥ä½œæµç¨‹çš„åŠ¨æœºã€‚è¿™æ˜¯å°è¯•ç”¨å®¢è§‚çš„æ–¹å¼æ£€æŸ¥æˆ‘ä»¬çš„æ¨¡å‹ï¼Œè¿™äº›æ¡ˆä¾‹ï¼Œ

+   æˆ‘ä»¬çŸ¥é“çœŸç›¸å¹¶èƒ½å‡†ç¡®è®¿é—®å‡†ç¡®æ€§

+   ä¸æ¨¡å‹æ„å»ºã€è®­ç»ƒæ¨¡å‹å‚æ•°æˆ–è°ƒæ•´æ¨¡å‹è¶…å‚æ•°æ— å…³

æˆ‘å¯¹æ­¤è¡¨ç¤ºèµèµï¼Œä½†æˆ‘æœ‰ä¸€äº›é¡¾è™‘ï¼Œ

1.  æˆ‘ä»¬æ­£åœ¨è¿›ä¸€æ­¥å‡å°‘å¯ç”¨äºè®­ç»ƒæ¨¡å‹å‚æ•°å’Œè°ƒæ•´æ¨¡å‹è¶…å‚æ•°çš„æ ·æœ¬æ•°é‡ã€‚

1.  æœ€ç»ˆï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ‰€æœ‰æ•°æ®é‡æ–°è®­ç»ƒè°ƒæ•´åçš„æ¨¡å‹ï¼Œå› æ­¤æˆ‘ä»¬æµ‹è¯•çš„æ¨¡å‹å®é™…ä¸Šå¹¶ä¸æ˜¯æœ€ç»ˆéƒ¨ç½²çš„æ¨¡å‹ã€‚

1.  å¦‚æœæµ‹è¯•æ•°æ®é¢„æµ‹ä¸å‡†ç¡®ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬æ˜¯å¦åŒ…æ‹¬å¦ä¸€è½®æµ‹è¯•ï¼Œä½¿ç”¨æ•°æ®çš„ä¸€ä¸ªå¦ä¸€ä¸ªä¿ç•™å­é›†ï¼Ÿæ— ç©·æ— å°½ï¼Ÿ

## åŠ è½½æ‰€éœ€çš„åº“

ä»¥ä¸‹ä»£ç åŠ è½½æ‰€éœ€çš„åº“ã€‚è¿™äº›åº“åº”è¯¥å·²ç»ä¸ Anaconda 3 ä¸€èµ·å®‰è£…ã€‚

```py
ignore_warnings = True
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.ticker import (MultipleLocator, AutoMinorLocator) # control of axes ticks
from sklearn.model_selection import cross_val_score           # multi-processor K-fold crossvalidation
from sklearn.model_selection import train_test_split          # train and test split
from sklearn.model_selection import KFold                     # K-fold cross validation
plt.rc('axes', axisbelow=True)                                # plot all grids below the plot elements
if ignore_warnings == True:                                   
    import warnings
    warnings.filterwarnings('ignore')
cmap = plt.cm.inferno                                         # color map
seed = 42                                                     # random number seed 
```

## å£°æ˜å‡½æ•°

æˆ‘è¿˜æ·»åŠ äº†ä¸€ä¸ªæ–¹ä¾¿çš„å‡½æ•°æ¥æ·»åŠ ä¸»ç½‘æ ¼çº¿å’Œå‰¯ç½‘æ ¼çº¿ï¼Œä»¥æé«˜ç»˜å›¾çš„å¯è§£é‡Šæ€§ã€‚

```py
def add_grid():
    plt.gca().grid(True, which='major',linewidth = 1.0); plt.gca().grid(True, which='minor',linewidth = 0.2) # add y grids
    plt.gca().tick_params(which='major',length=7); plt.gca().tick_params(which='minor', length=4)
    plt.gca().xaxis.set_minor_locator(AutoMinorLocator()); plt.gca().yaxis.set_minor_locator(AutoMinorLocator()) # turn on minor ticks 
```

## åŠ è½½æ•°æ®åˆ°æ¼”ç¤ºäº¤å‰éªŒè¯æ–¹æ³•

è®©æˆ‘ä»¬åŠ è½½ä¸€ä¸ªç©ºé—´æ•°æ®é›†å¹¶é€‰æ‹© 2 ä¸ªé¢„æµ‹ç‰¹å¾æ¥å¯è§†åŒ–äº¤å‰éªŒè¯æ–¹æ³•ã€‚

+   æˆ‘ä»¬å°†å…³æ³¨æ•°æ®æ‹†åˆ†ï¼Œè€Œä¸æ˜¯å®é™…çš„æ¨¡å‹è®­ç»ƒå’Œè°ƒæ•´ã€‚ç¨åå½“æˆ‘ä»¬ä»‹ç»é¢„æµ‹æœºå™¨å­¦ä¹ æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å°†æ·»åŠ å·¥ä½œæµç¨‹ä¸­çš„æ¨¡å‹ç»„ä»¶ã€‚

```py
df = pd.read_csv('https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/unconv_MV_v4.csv') # load data from Dr. Pyrcz's GitHub repository 

response = 'Prod'                                             # specify the response feature
X = df.iloc[:,[1,3]]                                          # make predictor and response DataFrames
y = df.loc[:,response]

Xname = X.columns.values.tolist()                             # store the names of the features
yname = y.name

Xmin = [6.0,1.0]; Xmax = [24.0,5.0]                           # set the minimum and maximum values for plotting
ymin = 500.0; ymax = 9000.0

Xlabel = ['Porosity','Acoustic Impedance']
ylabel = 'Normalized Initial Production (MCFPD)'

Xtitle = ['Porosity','Acoustic Impedance']
ytitle = 'Normalized Initial Production'

Xunit = ['%',r'$kg/mÂ³ x m/s x 10Â³$']; yunit = 'MCFPD'
Xlabelunit = [Xlabel[0] + ' (' + Xunit[0] + ')',Xlabel[1] + ' (' + Xunit[1] + ')']
ylabelunit = ylabel + ' (' + yunit + ')'

m = len(pred) + 1
mpred = len(pred) 
```

```py
---------------------------------------------------------------------------
NameError  Traceback (most recent call last)
Cell In[3], line 23
  20 Xlabelunit = [Xlabel[0] + ' (' + Xunit[0] + ')',Xlabel[1] + ' (' + Xunit[1] + ')']
  21 ylabelunit = ylabel + ' (' + yunit + ')'
---> 23 m = len(pred) + 1
  24 mpred = len(pred)

NameError: name 'pred' is not defined 
```

## å¯è§†åŒ–è®­ç»ƒå’Œæµ‹è¯•ä¿ç•™äº¤å‰éªŒè¯

è®©æˆ‘ä»¬æ¯”è¾ƒè®­ç»ƒå’Œæµ‹è¯•ä¸è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•ä¿ç•™æ•°æ®åˆ†å‰²ã€‚

+   é¦–å…ˆï¼Œæˆ‘ä»¬ç»˜åˆ¶è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²ï¼Œç„¶åæ˜¯è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•åˆ†å‰²ã€‚

```py
test_prop = 0.15                                              # set the proportion of test data to withhold
X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=test_prop,random_state=73073) # train and test split
df_train = pd.concat([X_train,y_train],axis=1)                # make one train DataFrame with both X and y (remove all other features)
df_test = pd.concat([X_test,y_test],axis=1)                   # make one testin DataFrame with both X and y (remove all other features)

nbins = 20                                                    # number of histogram bins

plt.subplot(221)                                              # predictor feature #1 histogram
freq1,_,_ = plt.hist(x=df_train[Xname[0]],weights=None,bins=np.linspace(Xmin[0],Xmax[0],nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_test[Xname[0]],weights=None,bins=np.linspace(Xmin[0],Xmax[0],nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10)
plt.xlabel(Xlabelunit[0]); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(Xtitle[0]); add_grid()  
plt.xlim([Xmin[0],Xmax[0]]); plt.legend(loc='upper right')   

plt.subplot(222)                                              # predictor feature #2 histogram
freq1,_,_ = plt.hist(x=df_train[Xname[1]],weights=None,bins=np.linspace(Xmin[1],Xmax[1],nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_test[Xname[1]],weights=None,bins=np.linspace(Xmin[1],Xmax[1],nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10)
plt.xlabel(Xlabelunit[1]); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(Xtitle[1]); add_grid()  
plt.xlim([Xmin[1],Xmax[1]]); plt.legend(loc='upper right')   

plt.subplot(223)                                              # predictor feature #2 histogram
freq1,_,_ = plt.hist(x=df_train[yname],weights=None,bins=np.linspace(ymin,ymax,nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_test[yname],weights=None,bins=np.linspace(ymin,ymax,nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10)
plt.xlabel(ylabelunit); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(ytitle); add_grid()  
plt.xlim([ymin,ymax]); plt.legend(loc='upper right')   

plt.subplot(224)                                              # predictor features #1 and #2 scatter plot
plt.scatter(df_train[Xname[0]],df_train[Xname[1]],s=40,marker='o',color = 'darkorange',alpha = 0.8,edgecolor = 'black',zorder=10,label='Train')
plt.scatter(df_test[Xname[0]],df_test[Xname[1]],s=40,marker='o',color = 'red',alpha = 0.8,edgecolor = 'black',zorder=10,label='Test')
plt.title(Xlabel[0] + ' vs ' +  Xlabel[1])
plt.xlabel(Xlabelunit[0]); plt.ylabel(Xlabelunit[1])
plt.legend(); add_grid(); plt.xlim([Xmin[0],Xmax[0]]); plt.ylim([Xmin[1],Xmax[1]])

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=2.1, wspace=0.3, hspace=0.2)
#plt.savefig('Test.pdf', dpi=600, bbox_inches = 'tight',format='pdf') 
plt.show() 
```

![å›¾ç‰‡](img/a54bde3cc01f9083714572540a961fb0.png)

å¯è§†åŒ–è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œ

+   ä¸ºç¡®ä¿è®­ç»ƒå’Œæµ‹è¯•è¦†ç›–æ‰€æœ‰å¯èƒ½çš„è¾“å‡ºèŒƒå›´å¹¶ä¿æŒå¹³è¡¡ï¼Œä¸ºæ¯ä¸ªé¢„æµ‹ç‰¹å¾å’Œå“åº”ç‰¹å¾ç»˜åˆ¶ç›´æ–¹å›¾

+   å¦‚æœé¢„æµ‹ç‰¹å¾çš„æ•°é‡æ˜¯ 2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥ç»˜åˆ¶é¢„æµ‹ç‰¹å¾ç©ºé—´æ¥æ£€æŸ¥è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²çš„è¦†ç›–ç‡å’Œå¹³è¡¡æ€§

ç°åœ¨æˆ‘ä»¬é‡å¤è¿™ä¸ªæ­¥éª¤ï¼Œé’ˆå¯¹è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•æ•°æ®åˆ†å‰²ã€‚

```py
val_prop = 0.15; test_prop = 0.15                             # set the proportion of test data to withhold
nbins = 20                                                    # number of histogram bins

X_train, X_temp, y_train, y_temp = train_test_split(X, y, test_size=val_prop + test_prop, random_state=42)
X_val, X_test, y_val, y_test = train_test_split(X_temp, y_temp, test_size=test_prop/(val_prop + test_prop), random_state=42)

df_train = pd.concat([X_train,y_train],axis=1); df_val = pd.concat([X_val,y_val],axis=1); df_test = pd.concat([X_test,y_test],axis=1) 

plt.subplot(221)                                              # predictor feature #1 histogram
freq1,_,_ = plt.hist(x=df_train[Xname[0]],weights=None,bins=np.linspace(Xmin[0],Xmax[0],nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_val[Xname[0]],weights=None,bins=np.linspace(Xmin[0],Xmax[0],nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Validate')
freq3,_,_ = plt.hist(x=df_test[Xname[0]],weights=None,bins=np.linspace(Xmin[0],Xmax[0],nbins),alpha = 0.6,
                     edgecolor='black',color='blue',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10,freq3.max()*1.10)
plt.xlabel(Xlabelunit[0]); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(Xtitle[0]); add_grid()  
plt.xlim([Xmin[0],Xmax[0]]); plt.legend(loc='upper right')   

plt.subplot(222)                                              # predictor feature #2 histogram
freq1,_,_ = plt.hist(x=df_train[Xname[1]],weights=None,bins=np.linspace(Xmin[1],Xmax[1],nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_val[Xname[1]],weights=None,bins=np.linspace(Xmin[1],Xmax[1],nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Validate')
freq3,_,_ = plt.hist(x=df_test[Xname[1]],weights=None,bins=np.linspace(Xmin[1],Xmax[1],nbins),alpha = 0.6,
                     edgecolor='black',color='blue',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10,freq3.max()*1.10)
plt.xlabel(Xlabelunit[1]); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(Xtitle[1]); add_grid()  
plt.xlim([Xmin[1],Xmax[1]]); plt.legend(loc='upper right')   

plt.subplot(223)                                              # predictor feature #2 histogram
freq1,_,_ = plt.hist(x=df_train[yname],weights=None,bins=np.linspace(ymin,ymax,nbins),alpha = 0.6,
                     edgecolor='black',color='darkorange',density=False,label='Train')
freq2,_,_ = plt.hist(x=df_val[yname],weights=None,bins=np.linspace(ymin,ymax,nbins),alpha = 0.6,
                     edgecolor='black',color='red',density=False,label='Validate')
freq2,_,_ = plt.hist(x=df_test[yname],weights=None,bins=np.linspace(ymin,ymax,nbins),alpha = 0.6,
                     edgecolor='black',color='blue',density=False,label='Test')
max_freq = max(freq1.max()*1.10,freq2.max()*1.10,freq3.max()*1.10)
plt.xlabel(ylabelunit); plt.ylabel('Frequency'); plt.ylim([0.0,max_freq]); plt.title(ytitle); add_grid()  
plt.xlim([ymin,ymax]); plt.legend(loc='upper right')   

plt.subplot(224)                                              # predictor features #1 and #2 scatter plot
plt.scatter(df_train[Xname[0]],df_train[Xname[1]],s=40,marker='o',color = 'darkorange',alpha = 0.8,edgecolor = 'black',zorder=10,label='Train')
plt.scatter(df_val[Xname[0]],df_val[Xname[1]],s=40,marker='o',color = 'blue',alpha = 0.8,edgecolor = 'black',zorder=10,label='Test')
plt.scatter(df_test[Xname[0]],df_test[Xname[1]],s=40,marker='o',color = 'red',alpha = 0.8,edgecolor = 'black',zorder=10,label='Test')
plt.title(Xlabel[0] + ' vs ' +  Xlabel[1])
plt.xlabel(Xlabelunit[0]); plt.ylabel(Xlabelunit[1])
plt.legend(); add_grid(); plt.xlim([Xmin[0],Xmax[0]]); plt.ylim([Xmin[1],Xmax[1]])

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=2.1, wspace=0.3, hspace=0.2)
#plt.savefig('Test.pdf', dpi=600, bbox_inches = 'tight',format='pdf') 
plt.show() 
```

![å›¾ç‰‡](img/8537d6caff0c1936ede31daca961765a.png)

å†æ¬¡å¯è§†åŒ–åˆ†å‰²ï¼Œç°åœ¨åŒ…æ‹¬è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•ï¼Œ

+   ä¸ºç¡®ä¿è®­ç»ƒå’Œæµ‹è¯•è¦†ç›–æ‰€æœ‰å¯èƒ½çš„è¾“å‡ºèŒƒå›´å¹¶ä¿æŒå¹³è¡¡ï¼Œä¸ºæ¯ä¸ªé¢„æµ‹ç‰¹å¾å’Œå“åº”ç‰¹å¾ç»˜åˆ¶ç›´æ–¹å›¾

+   å¦‚æœé¢„æµ‹ç‰¹å¾çš„æ•°é‡æ˜¯ 2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥ç»˜åˆ¶é¢„æµ‹ç‰¹å¾ç©ºé—´æ¥æ£€æŸ¥è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²çš„è¦†ç›–ç‡å’Œå¹³è¡¡æ€§

## ç•™ä¸€æ³•äº¤å‰éªŒè¯ (LOO CV)

ç•™ä¸€æ³•äº¤å‰éªŒè¯æ˜¯ä¸€ç§ç©·ä¸¾äº¤å‰éªŒè¯æ–¹æ³•ï¼Œå³é€šè¿‡éå†æ‰€æœ‰æ•°æ®æ¥æµ‹è¯•æ‰€æœ‰æ•°æ®ã€‚

+   æˆ‘ä»¬è®­ç»ƒå’Œè°ƒæ•´ $n$ ä¸ªæ¨¡å‹ï¼Œå¯¹äºæ¯ä¸ªæ¨¡å‹ï¼Œä¸€ä¸ªæ•°æ®ç‚¹è¢«ä¿ç•™ä½œä¸ºæµ‹è¯•ï¼Œè€Œ $n-1$ ä¸ªæ•°æ®ç‚¹è¢«åˆ†é…ä¸ºè®­ç»ƒæ•°æ®

+   æˆ‘ä»¬å°†è®¡ç®— $n$ ä¸ªè®­ç»ƒå’Œæµ‹è¯•é”™è¯¯ï¼Œè¿™äº›é”™è¯¯å°†æ±‡æ€»åˆ°æ‰€æœ‰ $n$ ä¸ªæ¨¡å‹ä¸­ï¼Œä¾‹å¦‚ï¼Œå‡æ–¹è¯¯å·®çš„å¹³å‡å€¼ã€‚

åœ¨ç•™ä¸€æ³•äº¤å‰éªŒè¯çš„æƒ…å†µä¸‹ï¼Œ

+   æˆ‘ä»¬åªåœ¨å•ä¸ªæ•°æ®ç‚¹ä¸Šæµ‹è¯•ï¼Œå› æ­¤æµ‹è¯•è¯¯å·®åªæ˜¯å•ä¸ªä¿ç•™æ•°æ®ç‚¹çš„å•ä¸ªè¯¯å·®ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€åœ¨ $n$ ä¸ªæ¨¡å‹ä¸Šä½¿ç”¨æ ‡å‡† MSE

$$ \text{æµ‹è¯• MSE æ€»å’Œ} = \frac{1}{n_{\text{æµ‹è¯•}}} \sum_{i=1}^{n_{\text{æµ‹è¯•}}} (y_i - \hat{y}_i)Â² = \frac{1}{n_{\text{æµ‹è¯•}}} \sum_{i=1}^{n_{\text{æµ‹è¯•}}} (\Delta y_i)Â² $$

+   ä½†æ˜¯ï¼Œå¯¹äºæ¯ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬æœ‰ $n-1$ ä¸ªè®­ç»ƒæ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡å¹³å‡æ¯ä¸ªæ¨¡å‹çš„å‡æ–¹è¯¯å·®æ¥æ±‡æ€»ï¼Œ

$$ \text{è®­ç»ƒ MSE æ€»å’Œ} = \frac{1}{n} \sum_{i=1}^{n} \frac{1}{n-1} \sum_{i=1}^{n-1} (y_i - \hat{y}_i)Â² = \frac{1}{n} \sum_{i=1}^{n} \text{Train MSE}_i $$

è¿™é‡Œæ˜¯ç•™ä¸€æ³•äº¤å‰éªŒè¯çš„æ­¥éª¤ï¼Œ

1.  éå†æ‰€æœ‰ $n$ ä¸ªæ•°æ®ï¼Œå¹¶ä¿ç•™è¯¥æ•°æ®

1.  åœ¨å‰©ä½™çš„ $nâˆ’1$ ä¸ªæ•°æ®ä¸Šè®­ç»ƒï¼Œå¹¶åœ¨ä¿ç•™çš„å•ä¸ªæ•°æ®ä¸Šæµ‹è¯•

1.  è®¡ç®—æ¨¡å‹è‰¯å¥½åº¦æŒ‡æ ‡ï¼Œå•ä¸ªæµ‹è¯•æ•°æ®çš„å‡æ–¹è¯¯å·®æ˜¯å¹³æ–¹è¯¯å·®

1.  è½¬åˆ° 1

1.  åœ¨æ‰€æœ‰æ•°æ®ä¸Šæ±‡æ€»æ¨¡å‹è‰¯å¥½åº¦æŒ‡æ ‡ï¼Œ$n$

é€šå¸¸ï¼Œç•™ä¸€æ³•äº¤å‰éªŒè¯æ˜¯ä¸€ä¸ªå¤ªç®€å•çš„é¢„æµ‹é—®é¢˜ï¼›å› æ­¤ï¼Œå®ƒä¸å¤ªå¸¸ç”¨ï¼Œ

+   ä½†å®ƒå¼•å…¥äº†ç©·ä¸¾äº¤å‰éªŒè¯çš„æ¦‚å¿µï¼Œå³æ‰€æœ‰æ•°æ®éƒ½å¾—åˆ°æµ‹è¯•ï¼

ç•™ä¸€æ³•äº¤å‰éªŒè¯åœ¨æŸç§æ„ä¹‰ä¸Šä¹Ÿæ˜¯å…¨é¢çš„ï¼Œå› ä¸ºå®ƒæ¢ç´¢äº† $n$ ä¸ªæ•°æ®ä¸­é€‰æ‹© $p$ï¼ˆå…¶ä¸­ $p=1$ï¼‰çš„å®Œæ•´æ’åˆ—ç»„åˆï¼Œ

$$ \binom{n}{p} = \frac{n!}{p!(n - p)!} = \frac{n!}{1!(n - 1)!} = \frac{n!}{(n - 1)!} = n $$

å…¶ä¸­ï¼Œå®Œæ•´çš„æ’åˆ—ç»„åˆæ˜¯æˆ‘ä»¬ä¸Šé¢æ„å»ºçš„ $n$ ä¸ªæ¨¡å‹ï¼

## K æŠ˜äº¤å‰éªŒè¯ï¼ˆk-fold CVï¼‰

K æŠ˜æ˜¯ä¸€ç§æ›´é€šç”¨ã€é«˜æ•ˆä¸”ç¨³å¥çš„æ–¹æ³•ã€‚

+   ä¸€ç§å…¨é¢äº¤å‰éªŒè¯çš„æ–¹æ³•ï¼ˆæ‰€æœ‰æ•°æ®éƒ½è¿›è¡Œæµ‹è¯•ï¼‰ï¼Œä½†å®ƒåªé‡‡æ ·äº†å¯èƒ½çš„é¢„æµ‹é—®é¢˜æ’åˆ—ç»„åˆçš„æœ‰é™é›†ï¼Œä¸ç•™ä¸€æ³•äº¤å‰éªŒè¯ä¸åŒï¼Œåœ¨ç•™ä¸€æ³•äº¤å‰éªŒè¯ä¸­ï¼Œæˆ‘ä»¬å°è¯•å¯¹ä¿ç•™ç”¨äºæµ‹è¯•çš„æ•°æ®çš„æ¯ä¸€ç§å¯èƒ½æƒ…å†µè¿›è¡Œæµ‹è¯•

+   å¯¹äº K æŠ˜äº¤å‰éªŒè¯ï¼Œæˆ‘ä»¬åˆ†é…ä¸€ç»„ K ä¸ªå¤§å°ç›¸ç­‰çš„åˆ†å‰²ï¼Œå¹¶å¾ªç¯éå†è¿™äº›åˆ†å‰²ï¼Œä¿ç•™ $k$ ä¸ªåˆ†å‰²ä½œä¸ºæµ‹è¯•æ•°æ®ï¼Œå¹¶ä½¿ç”¨åˆ†å‰²ä¹‹å¤–çš„æ•°æ®è¿›è¡Œè®­ç»ƒ

+   æµ‹è¯•æ¯”ä¾‹æ˜¯ $\frac{1}{K}$ï¼Œä¾‹å¦‚ï¼Œå¯¹äº $K=3$ï¼Œ33.3% è¢«ä¿ç•™ç”¨äºæµ‹è¯•ï¼Œå¯¹äº $K=4$ï¼Œ25% è¢«ä¿ç•™ç”¨äºæµ‹è¯•ï¼Œå¯¹äº $K=5$ï¼Œ20% è¢«ä¿ç•™ç”¨äºæµ‹è¯•

æˆ‘ä»¬ç§°ä¹‹ä¸º K æŠ˜äº¤å‰éªŒè¯ï¼Œå› ä¸ºæ¯ä¸ªåˆ†å‰²éƒ½è¢«ç§°ä¸ºä¸€ä¸ªæŠ˜ã€‚ä»¥ä¸‹æ˜¯ K æŠ˜äº¤å‰éªŒè¯çš„æ­¥éª¤ï¼Œ

1.  é€‰æ‹© $K$ï¼Œæ•´æ•°ä¸ªæŠ˜æ•°

1.  å°†æ•°æ®åˆ†å‰²æˆ $K$ ä¸ªå¤§å°ç›¸ç­‰çš„æŠ˜

1.  éå†æ¯ä¸ª $k = 1,\ldots,K$ æŠ˜

1.  å°† $k$ æŠ˜ä»¥å¤–çš„æ•°æ®ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œå°† $k$ æŠ˜ä»¥å†…çš„æ•°æ®ä½œä¸ºæµ‹è¯•æ•°æ®

1.  è®­ç»ƒå’Œæµ‹è¯•é¢„æµ‹æ¨¡å‹ï¼Œå¹¶è®¡ç®—æµ‹è¯•æ¨¡å‹æŒ‡æ ‡

1.  è½¬åˆ° 3

1.  åœ¨æ‰€æœ‰ K æŠ˜ä¸Šæ±‡æ€»æµ‹è¯•æ¨¡å‹æŒ‡æ ‡

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œk æŠ˜äº¤å‰éªŒè¯æ˜¯å…¨é¢çš„ï¼Œå› ä¸ºæ‰€æœ‰æ•°æ®éƒ½è¿›è¡Œäº†æµ‹è¯•ï¼Œå³ä½œä¸ºæµ‹è¯•æ•°æ®è¢«ä¿ç•™ï¼Œä½†è¿™ç§æ–¹æ³•ä¸æ˜¯å…¨é¢çš„ï¼Œå› ä¸ºå¹¶æ²¡æœ‰è€ƒè™‘æ‰€æœ‰å¯èƒ½çš„ $\frac{n}{K}$ ä¸ªæ•°æ®å­é›†ã€‚

ä¸ºäº†è®¡ç®—å…¨é¢ K æŠ˜çš„æ’åˆ—ç»„åˆï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å¤šé¡¹å¼ç³»æ•°ï¼Œ

$$ \frac{n!}{\left( \frac{n}{K}! \right)^K \cdot K!} $$

ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ $n=100$ ä¸ªæ•°æ®å’Œ $K=4$ ä¸ªæŠ˜ï¼Œæœ‰ $6.72 \times 10âµâµ$ ç§å¯èƒ½çš„ç»„åˆã€‚æˆ‘å»ºè®®æˆ‘ä»¬åšæŒä½¿ç”¨å¸¸è§„çš„ K æŠ˜äº¤å‰éªŒè¯ã€‚

è®©æˆ‘ä»¬å¯è§†åŒ– $K$ æŠ˜äº¤å‰éªŒè¯çš„åˆ†å‰²ï¼Œä»¥ $K=4$ ä¸ºä¾‹ã€‚

```py
K = 4
kf = KFold(n_splits=K, shuffle=True, random_state=seed)

df['Fold'] = -1
for fold_number, (train_index, test_index) in enumerate(kf.split(df)):
    df.loc[test_index, 'Fold'] = fold_number  # Assign fold number to test set

for k in range(0,K):
    df_in = df[df['Fold'] == k]; df_out = df[df['Fold'] != k]
    plt.subplot(2,2,k+1)
    plt.scatter(df_in[Xname[0]],df_in[Xname[1]],color='red',edgecolor='black',label='Test')
    plt.scatter(df_out[Xname[0]],df_out[Xname[1]],color='white',edgecolor='black',label='Train'); add_grid()
    plt.title('K-fold #' + str(k) + ', ' + Xlabel[0] + ' vs ' +  Xlabel[1])
    plt.xlabel(Xlabelunit[0]); plt.ylabel(Xlabelunit[1])
    plt.legend(); add_grid(); plt.xlim([Xmin[0],Xmax[0]]); plt.ylim([Xmin[1],Xmax[1]])

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=2.1, wspace=0.2, hspace=0.2); plt.show() 
```

![å›¾ç‰‡](img/dd257beaa821a963fc15b3318a7bd9f2.png)

## ç•™å‡º $p$ ä¸ªæ•°æ®äº¤å‰éªŒè¯ï¼ˆLpO-CVï¼‰

è¿™æ˜¯ K æŠ˜äº¤å‰éªŒè¯çš„ä¸€ç§å˜ä½“ï¼Œå®ƒå…¨é¢é‡‡æ ·äº†ä¿ç•™ $p$ ä¸ªæµ‹è¯•æ•°æ®çš„å…¨éƒ¨æ’åˆ—ç»„åˆã€‚

1.  é€‰æ‹© $p$ï¼Œæ•´æ•°ä¸ªè¦ä¿ç•™çš„æµ‹è¯•æ•°æ®

1.  å¯¹äºæ‰€æœ‰å¯èƒ½çš„ $n$ çš„ $p$ ä¸ªå­é›†ï¼Œ

1.  å°† $p$ ä»¥å¤–çš„æ•°æ®ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œå°† $p$ ä»¥å†…çš„æ•°æ®ä½œä¸ºæµ‹è¯•æ•°æ®

1.  è®­ç»ƒå’Œæµ‹è¯•é¢„æµ‹æ¨¡å‹ï¼Œå¹¶è®¡ç®—æµ‹è¯•æ¨¡å‹æŒ‡æ ‡

1.  è½¬åˆ° 2

1.  åœ¨ç»„åˆä¸Šæ±‡æ€»æµ‹è¯•æ¨¡å‹æŒ‡æ ‡

å¯¹äºè¿™ç§æƒ…å†µï¼Œæ¡ˆä¾‹çš„æ’åˆ—ç»„åˆæ˜¯ï¼Œ$n$ é€‰ $p$ï¼Œ

$$ \binom{n}{p} = \frac{n!}{p!(n - p)!} $$

å¯¹äº $n=100$ å’Œ $p=20$ï¼Œæˆ‘ä»¬æœ‰ $5.36 \times 10^{20}$ ç§ç»„åˆéœ€è¦æ£€æŸ¥ï¼

## äº¤å‰éªŒè¯çš„å±€é™æ€§

ä¸‹é¢æ˜¯ä¸€äº›å…³äºæ¨¡å‹äº¤å‰éªŒè¯æ–¹æ³•çš„ä¸€èˆ¬é—®é¢˜ï¼Œ

+   **çª¥è§†ï¼Œä¿¡æ¯æ³„éœ²** â€“ ä¸€äº›ä¿¡æ¯ä»ä¿ç•™çš„æ•°æ®ä¸­ä¼ é€’åˆ°æ¨¡å‹ä¸­ï¼Œä¸€äº›æ¨¡å‹å†³ç­–ï¼ˆsï¼‰ä½¿ç”¨æ‰€æœ‰æ•°æ®ã€‚ç®¡é“å’ŒåŒ…è£…å™¨æœ‰åŠ©äºè§£å†³è¿™ä¸ªé—®é¢˜ã€‚

+   **é»‘å¤©é¹…/å¹³ç¨³æ€§** â€“ æ¨¡å‹æ— æ³•å¯¹æ•°æ®ä¸­ä¸å¯ç”¨çš„äº‹ä»¶è¿›è¡Œæµ‹è¯•ã€‚è¿™ä¹Ÿè¢«ç§°ä¸ºæœºå™¨å­¦ä¹ ä¸­çš„â€œæ— å…è´¹åˆé¤å®šç†â€

è€ƒè™‘ä¸€ä¸‹ä¼‘è°Ÿçš„è¯ï¼Œ

â€œå³ä½¿è§‚å¯Ÿåˆ°äº†é¢‘ç¹æˆ–æ’å®šçš„å¯¹è±¡è”åˆï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰ç†ç”±å¯¹ä»»ä½•è¶…å‡ºæˆ‘ä»¬ç»éªŒèŒƒå›´çš„å¯¹è±¡åšå‡ºä»»ä½•æ¨è®ºâ€ - èµ«å°”ï¼ˆ1739-1740ï¼‰

+   æˆ‘ä»¬æ— æ³•é¢„æµ‹æˆ‘ä»¬åœ¨æ•°æ®ä¸­ä»æœªè§è¿‡çš„äº‹æƒ…ï¼

ä¸‹é¢æ˜¯ä»è‘—åçš„ Oreskes ç­‰äººï¼ˆ1994ï¼‰å…³äºåœ°ä¸‹éªŒè¯å’ŒéªŒè¯çš„è®ºæ–‡ä¸­å¼•ç”¨çš„ä¸€å¥è¯ï¼Œ

â€œè‡ªç„¶ç³»ç»Ÿæ•°å€¼æ¨¡å‹çš„éªŒè¯å’ŒéªŒè¯æ˜¯ä¸å¯èƒ½çš„ã€‚è¿™æ˜¯å› ä¸ºè‡ªç„¶ç³»ç»Ÿæ°¸è¿œä¸ä¼šå°é—­ï¼Œå› ä¸ºæ¨¡å‹ç»“æœæ€»æ˜¯éå”¯ä¸€çš„ã€‚æ¨¡å‹å¯ä»¥é€šè¿‡è§‚å¯Ÿå’Œé¢„æµ‹ä¹‹é—´çš„ä¸€è‡´æ€§æ¥è¯å®ï¼Œä½†è¯å®æœ¬è´¨ä¸Šæ˜¯ä¸å®Œå…¨çš„ã€‚ç”±äºè‚¯å®šåä»¶çš„è°¬è¯¯å’Œè‡ªç„¶ç°è±¡çš„ä¸å®Œå…¨è®¿é—®ï¼Œå®Œå…¨è¯å®åœ¨é€»è¾‘ä¸Šæ˜¯ä¸å¯èƒ½çš„ã€‚æ¨¡å‹åªèƒ½ç›¸å¯¹è¯„ä¼°ï¼Œå®ƒä»¬çš„é¢„æµ‹ä»·å€¼æ€»æ˜¯å—åˆ°è´¨ç–‘ã€‚æ¨¡å‹çš„ä¸»è¦ä»·å€¼æ˜¯å¯å‘æ€§çš„ã€‚â€

+   Oreskes ç­‰äººï¼ˆ1994ï¼‰

æ‰€æœ‰è¿™äº›éƒ½å¾ˆå¥½åœ°æ€»ç»“ä¸ºï¼Œ

â€œæ‰€æœ‰æ¨¡å‹éƒ½æ˜¯é”™è¯¯çš„ï¼Œä½†æœ‰äº›æ˜¯æœ‰ç”¨çš„â€ â€“ ä¹”æ²»Â·åšå…‹æ–¯

ä»¥åŠæé†’ï¼Œ

**ç®€çº¦æ€§** â€“ æ—¢ç„¶æ‰€æœ‰æ¨¡å‹éƒ½æ˜¯é”™è¯¯çš„ï¼Œå¯¹ç³»ç»Ÿçš„ç»æµæè¿°ã€‚å¥¥å¡å§†å‰ƒåˆ€

å¯¼è‡´äº†ä¸€ç§å®ç”¨ä¸»ä¹‰çš„æ–¹æ³•ï¼Œ

**é€‰æ‹©æ€§æ‹…å¿§** â€“ æ—¢ç„¶æ‰€æœ‰æ¨¡å‹éƒ½æ˜¯é”™è¯¯çš„ï¼Œæ‰¾å‡ºæœ€é‡è¦çš„é”™è¯¯æ˜¯ä»€ä¹ˆã€‚

æœ€åï¼Œæˆ‘åŠ ä¸Šè‡ªå·±çš„è¯ï¼Œ

â€œä¿æŒè°¦é€Šï¼Œåœ°çƒä¼šç»™ä½ æƒŠå–œï¼â€ â€“ è¿ˆå…‹å°”Â·çš®å°”èŒ¨

## è¯„è®º

è¿™æ˜¯å¯¹æœºå™¨å­¦ä¹ æ¦‚å¿µçš„åˆæ­¥æè¿°ã€‚å¯ä»¥åšå’Œè®¨è®ºçš„è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘æœ‰å¾ˆå¤šèµ„æºã€‚æŸ¥çœ‹æˆ‘çš„[å…±äº«èµ„æºæ¸…å•](https://michaelpyrcz.com/my-resources)ä»¥åŠæœ¬ç« å¼€å¤´å¸¦æœ‰èµ„æºé“¾æ¥çš„è§†é¢‘è®²åº§ YouTube é“¾æ¥ã€‚

æˆ‘å¸Œæœ›è¿™æœ‰æ‰€å¸®åŠ©ï¼Œ

*è¿ˆå…‹å°”*

## å…³äºä½œè€…

![å›¾ç‰‡](img/eb709b2c0a0c715da01ae0165efdf3b2.png)

è¿ˆå…‹å°”Â·çš®å°”èŒ¨æ•™æˆåœ¨å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ 40 è‹±äº©æ ¡å›­çš„åŠå…¬å®¤ã€‚

è¿ˆå…‹å°”Â·çš®å°”èŒ¨æ˜¯å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡[Cockrell å·¥ç¨‹å­¦é™¢](https://cockrell.utexas.edu/faculty-directory/alphabetical/p)å’Œ[Jackson åœ°çƒç§‘å­¦å­¦é™¢](https://www.jsg.utexas.edu/researcher/michael_pyrcz/)çš„æ•™æˆï¼Œåœ¨é‚£é‡Œä»–ç ”ç©¶å¹¶æ•™æˆåœ°ä¸‹ã€ç©ºé—´æ•°æ®åˆ†æã€åœ°ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ã€‚è¿ˆå…‹å°”è¿˜æ˜¯ï¼Œ

+   [Energy Analytics](https://fri.cns.utexas.edu/energy-analytics)æ–°ç”Ÿç ”ç©¶é¡¹ç›®çš„é¦–å¸­ç ”ç©¶å‘˜ï¼Œä»¥åŠå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡è‡ªç„¶ç§‘å­¦é™¢æœºå™¨å­¦ä¹ å®éªŒå®¤çš„æ ¸å¿ƒæ•™å‘˜ã€‚

+   [Computers and Geosciences](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board)çš„å‰¯ç¼–è¾‘ï¼Œä»¥åŠå›½é™…æ•°å­¦åœ°çƒç§‘å­¦åä¼š[Mathematical Geosciences](https://link.springer.com/journal/11004/editorial-board)çš„è‘£äº‹ä¼šæˆå‘˜ã€‚

è¿ˆå…‹å°”å·²ç»æ’°å†™äº† 70 å¤šç¯‡[åŒè¡Œè¯„å®¡å‡ºç‰ˆç‰©](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en)ï¼Œä¸€ä¸ªç”¨äºç©ºé—´æ•°æ®åˆ†æçš„[Python åŒ…](https://pypi.org/project/geostatspy/)ï¼Œåˆè‘—äº†ä¸€æœ¬å…³äºç©ºé—´æ•°æ®åˆ†æçš„æ•™ç§‘ä¹¦[Geostatistical Reservoir Modeling](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)ï¼Œå¹¶ä¸”æ˜¯ä¸¤æœ¬æœ€è¿‘å‘å¸ƒçš„ç”µå­ä¹¦çš„ä½œè€…ï¼Œåˆ†åˆ«æ˜¯[Applied Geostatistics in Python: a Hands-on Guide with GeostatsPy](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)å’Œ[Applied Machine Learning in Python: a Hands-on Guide with Code](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html)ã€‚

è¿ˆå…‹å°”çš„æ‰€æœ‰å¤§å­¦è®²åº§éƒ½å¯ä»¥åœ¨ä»–çš„[YouTube é¢‘é“](https://www.youtube.com/@GeostatsGuyLectures)ä¸Šæ‰¾åˆ°ï¼Œå…¶ä¸­åŒ…å« 100 å¤šä¸ª Python äº¤äº’å¼ä»ªè¡¨æ¿å’Œ 40 å¤šä¸ªå­˜å‚¨åº“ä¸­çš„è¯¦ç»†å·¥ä½œæµç¨‹é“¾æ¥ï¼Œè¿™äº›å­˜å‚¨åº“ä½äºä»–çš„[GitHub è´¦æˆ·](https://github.com/GeostatsGuy)ï¼Œä»¥æ”¯æŒä»»ä½•æ„Ÿå…´è¶£çš„å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«ï¼Œæä¾›å¸¸é’å†…å®¹ã€‚äº†è§£æ›´å¤šå…³äºè¿ˆå…‹å°”çš„å·¥ä½œå’Œå…±äº«æ•™è‚²èµ„æºï¼Œè¯·è®¿é—®ä»–çš„ç½‘ç«™ã€‚

## æƒ³ä¸€èµ·å·¥ä½œå—ï¼Ÿ

æˆ‘å¸Œæœ›è¿™ä¸ªå†…å®¹å¯¹é‚£äº›æƒ³äº†è§£æ›´å¤šå…³äºåœ°ä¸‹å»ºæ¨¡ã€æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ çš„äººæœ‰æ‰€å¸®åŠ©ã€‚å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«æ¬¢è¿å‚åŠ ã€‚

+   æƒ³é‚€è¯·æˆ‘åˆ°è´µå…¬å¸è¿›è¡ŒåŸ¹è®­ã€è¾…å¯¼ã€é¡¹ç›®å®¡æŸ¥ã€å·¥ä½œæµç¨‹è®¾è®¡å’Œ/æˆ–å’¨è¯¢å—ï¼Ÿæˆ‘å¾ˆä¹æ„æ‹œè®¿å¹¶ä¸æ‚¨åˆä½œï¼

+   æ„Ÿå…´è¶£äºåˆä½œï¼Œæ”¯æŒæˆ‘çš„ç ”ç©¶ç”Ÿç ”ç©¶æˆ–æˆ‘çš„åœ°ä¸‹æ•°æ®åˆ†æä¸æœºå™¨å­¦ä¹ è”ç›Ÿï¼ˆå…±åŒè´Ÿè´£äººåŒ…æ‹¬ Foster æ•™æˆã€Torres-Verdin æ•™æˆå’Œ van Oort æ•™æˆï¼‰å—ï¼Ÿæˆ‘çš„ç ”ç©¶å°†æ•°æ®åˆ†æã€éšæœºå»ºæ¨¡å’Œæœºå™¨å­¦ä¹ ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œä»¥å¼€å‘æ–°çš„æ–¹æ³•å’Œå·¥ä½œæµç¨‹æ¥å¢åŠ ä»·å€¼ã€‚æˆ‘ä»¬æ­£åœ¨è§£å†³å…·æœ‰æŒ‘æˆ˜æ€§çš„åœ°ä¸‹é—®é¢˜ï¼

+   æˆ‘å¯ä»¥é€šè¿‡ mpyrcz@austin.utexas.edu è”ç³»åˆ°ã€‚

æˆ‘æ€»æ˜¯å¾ˆé«˜å…´è®¨è®ºï¼Œ

*è¿ˆå…‹å°”*

è¿ˆå…‹å°”Â·çš®å°”èŒ¨ï¼Œåšå£«ï¼ŒP.Eng. æ•™æˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ Cockrell å·¥ç¨‹å­¦é™¢å’Œ Jackson åœ°çƒç§‘å­¦å­¦é™¢

æ›´å¤šèµ„æºå¯åœ¨ä»¥ä¸‹é“¾æ¥æ‰¾åˆ°ï¼š[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy) | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao) | [åœ°ç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446) | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python ä¸­åº”ç”¨åœ°ç»Ÿè®¡å­¦ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)
