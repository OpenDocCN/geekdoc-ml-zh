# å·ç§¯ç¥ç»ç½‘ç»œ

> åŸæ–‡ï¼š[`geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_CNN.html`](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_CNN.html)

Michael J. Pyrczï¼Œæ•™æˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡

[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy) | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao) | [åœ°ç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446) | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python ä¸­åº”ç”¨åœ°ç»Ÿè®¡å­¦ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)

ç”µå­ä¹¦â€œPython ä¸­çš„åº”ç”¨æœºå™¨å­¦ä¹ ï¼šå¸¦ä»£ç çš„æ‰‹åŠ¨æŒ‡å—â€çš„ç« èŠ‚ã€‚

å°†æ­¤ç”µå­ä¹¦å¼•ç”¨å¦‚ä¸‹ï¼š

Pyrcz, M.J., 2024, *Python ä¸­çš„åº”ç”¨æœºå™¨å­¦ä¹ ï¼šå¸¦ä»£ç çš„æ‰‹åŠ¨æŒ‡å—* [ç”µå­ä¹¦]. Zenodo. doi:10.5281/zenodo.15169138 ![DOI](https://doi.org/10.5281/zenodo.15169138)

æœ¬ä¹¦ä¸­çš„å·¥ä½œæµç¨‹ä»¥åŠæ›´å¤šå†…å®¹å¯åœ¨ä»¥ä¸‹é“¾æ¥æ‰¾åˆ°ï¼š

å°† MachineLearningDemos GitHub ä»“åº“å¼•ç”¨å¦‚ä¸‹ï¼š

Pyrcz, M.J., 2024, *MachineLearningDemos: Python æœºå™¨å­¦ä¹ æ¼”ç¤ºå·¥ä½œæµç¨‹ä»“åº“* (0.0.3) [è½¯ä»¶]. Zenodo. DOI: 10.5281/zenodo.13835312\. GitHub ä»“åº“ï¼š[GeostatsGuy/MachineLearningDemos](https://github.com/GeostatsGuy/MachineLearningDemos) ![DOI](https://zenodo.org/doi/10.5281/zenodo.13835312)

ä½œè€…ï¼šMichael J. Pyrcz

Â© ç‰ˆæƒæ‰€æœ‰ 2024ã€‚

æœ¬ç« æ˜¯å…³äº/æ¼”ç¤º**å·ç§¯ç¥ç»ç½‘ç»œ**çš„æ•™ç¨‹ã€‚

**YouTube è®²åº§**ï¼šæŸ¥çœ‹æˆ‘å…³äºä»¥ä¸‹å†…å®¹çš„è®²åº§ï¼š

+   [äººå·¥ç¥ç»ç½‘ç»œ](https://youtu.be/A9PiCMY_6nM?si=NxWSU_5RgQ4w55EL)

+   [å·ç§¯ç¥ç»ç½‘ç»œ](https://youtu.be/za2my_XDoOs?si=LeHU6p2_fc9dX4Yt)

è¿™äº›è®²åº§éƒ½æ˜¯æˆ‘ YouTube ä¸Šçš„ [æœºå™¨å­¦ä¹ è¯¾ç¨‹](https://youtube.com/playlist?list=PLG19vXLQHvSC2ZKFIkgVpI9fCjkN38kwf&si=XonjO2wHdXffMpeI) çš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸­åŒ…å«æœ‰è‰¯å¥½æ–‡æ¡£è®°å½•çš„ Python å·¥ä½œæµç¨‹å’Œäº¤äº’å¼ä»ªè¡¨æ¿ã€‚æˆ‘çš„ç›®æ ‡æ˜¯åˆ†äº«æ˜“äºç†è§£ã€å¯æ“ä½œå’Œå¯é‡å¤çš„æ•™è‚²å†…å®¹ã€‚å¦‚æœä½ æƒ³çŸ¥é“æˆ‘çš„åŠ¨æœºï¼Œè¯·æŸ¥çœ‹ [Michael çš„æ•…äº‹](https://michaelpyrcz.com/my-story)ã€‚

## åŠ¨æœº

å·ç§¯ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„ã€å—è‡ªç„¶å¯å‘çš„åŸºäºè§†è§‰çš®å±‚ç±»æ¯”çš„è®¡ç®—æ·±åº¦å­¦ä¹ æ–¹æ³•ï¼Œå®ƒæ‰©å±•äº†æˆ‘ä»¬äººå·¥ç¥ç»ç½‘ç»œçš„å›¾åƒå¤„ç†èƒ½åŠ›ã€‚

è‡ªç„¶å¯å‘çš„è®¡ç®—æ­£åœ¨å¯»æ‰¾è‡ªç„¶ç•Œçš„çµæ„Ÿæ¥å¼€å‘æ–°çš„é—®é¢˜è§£å†³æ–¹æ³•ï¼Œ

+   **äººå·¥ç¥ç»ç½‘ç»œ**å—ç”Ÿç‰©ç¥ç»ç½‘ç»œçš„å¯å‘

+   **èŠ‚ç‚¹**åœ¨æˆ‘ä»¬çš„æ¨¡å‹ä¸­æ˜¯äººå·¥ç¥ç»å…ƒï¼Œç®€å•çš„å¤„ç†å™¨

+   **èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥**æ˜¯äººå·¥çªè§¦ã€‚

+   **æ„ŸçŸ¥åœº**æ­£åˆ™åŒ–ä»¥æé«˜æ³›åŒ–èƒ½åŠ›å’Œæ•ˆç‡ã€‚

æ™ºèƒ½æ˜¯ä»è®¸å¤šè¿æ¥çš„ç®€å•å¤„ç†å™¨ä¸­äº§ç”Ÿçš„ã€‚åœ¨æœ¬ç« çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘å°†ä½¿ç”¨èŠ‚ç‚¹å’Œè¿æ¥æœ¯è¯­æ¥æè¿°æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œã€‚

## ä¸äººå·¥ç¥ç»ç½‘ç»œå…±æœ‰çš„æ¦‚å¿µã€‚

è¿™é‡Œæœ‰ä¸€äº›äººå·¥ç¥ç»ç½‘ç»œï¼ˆANNsï¼‰çš„å…³é”®æ–¹é¢ï¼Œ

**åŸºæœ¬è®¾è®¡** - *â€œâ€¦â€¦ä¸€ä¸ªç”±è®¸å¤šç®€å•ã€é«˜åº¦äº’è”çš„å¤„ç†å…ƒç´ ç»„æˆçš„è®¡ç®—ç³»ç»Ÿï¼Œå®ƒä»¬é€šè¿‡å¯¹å¤–éƒ¨è¾“å…¥çš„åŠ¨æ€çŠ¶æ€å“åº”æ¥å¤„ç†ä¿¡æ¯ã€‚â€* Caudill (1989)ã€‚

**ä»ç„¶æ˜¯ä¸€ä¸ªé¢„æµ‹æ¨¡å‹** - è™½ç„¶è¿™äº›æ¨¡å‹å¯èƒ½éå¸¸å¤æ‚ï¼Œç”šè‡³æœ‰æ•°ç™¾ä¸‡ä¸ªå¯è®­ç»ƒæ¨¡å‹å‚æ•°ã€æƒé‡å’Œåå·®ï¼Œä½†å®ƒä»¬ä»ç„¶æ˜¯ä¸€ä¸ªå°†é¢„æµ‹ç‰¹å¾æ˜ å°„åˆ°å“åº”ç‰¹å¾çš„å‡½æ•°ï¼Œ

$$ Y=f(X)+\epsilon $$

**ç›‘ç£å­¦ä¹ ** â€“ æˆ‘ä»¬æä¾›å¸¦æœ‰é¢„æµ‹ç‰¹å¾$X_1,\ldots,ğ‘‹_ğ‘š$å’Œå“åº”ç‰¹å¾ï¼ˆ$ğ‘Œ_1,\ldots,ğ‘Œ_K$ï¼‰çš„è®­ç»ƒæ•°æ®ï¼ŒæœŸæœ›æŸç§æ¨¡å‹é¢„æµ‹è¯¯å·®$\epsilon$ã€‚

**éçº¿æ€§** - é€šè¿‡åº”ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°æ¥æ¨¡å‹éçº¿æ€§å…³ç³»ï¼Œå°†éçº¿æ€§å¼•å…¥åˆ°ç³»ç»Ÿä¸­ã€‚

**é€šç”¨å‡½æ•°é€¼è¿‘å™¨ï¼ˆé€šç”¨é€¼è¿‘å®šç†ï¼‰** - äººå·¥ç¥ç»ç½‘ç»œå…·æœ‰é€šè¿‡ Cybenko (1989)æå‡ºçš„ä»»æ„å®½ï¼ˆå•éšè—å±‚ï¼‰å’Œ Lu ç­‰äººï¼ˆ2017ï¼‰æå‡ºçš„ä»»æ„æ·±åº¦å­¦ä¹ åŒºé—´å†…ä»»ä½•å¯èƒ½çš„å‡½æ•°å½¢çŠ¶$f$çš„èƒ½åŠ›ã€‚

ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘å°†ä¸ä¼šé‡å¤äººå·¥ç¥ç»ç½‘ç»œç« èŠ‚çš„æ‰€æœ‰åŸºæœ¬æ¦‚å¿µã€‚

+   åœ¨å¼€å§‹è¿™ä¸€ç« ä¹‹å‰å›é¡¾é‚£ç« å¯èƒ½æ˜¯ä¸ªå¥½ä¸»æ„ã€‚

## å·ç§¯ç¥ç»ç½‘ç»œæ¦‚å¿µã€‚

**æ­£åˆ™åŒ–** - äººå·¥ç¥ç»ç½‘ç»œå®¹æ˜“è¿‡æ‹Ÿåˆï¼›å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ­£åˆ™åŒ–å½¢å¼æ¥é˜²æ­¢è¿™ç§æƒ…å†µã€‚

+   ä¾‹å¦‚ï¼Œå²­å›å½’å’Œ LASSO é€šè¿‡æ”¶ç¼©é¡¹å°†æ­£åˆ™åŒ–é›†æˆåˆ°æŸå¤±å‡½æ•°ä¸­ï¼Œä»¥å‡å°‘è¿‡æ‹Ÿåˆã€‚

åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬é‡‡å–äº†ä¸åŒçš„æ­£åˆ™åŒ–æ–¹æ³•ï¼Œ

+   ä½¿ç”¨å›¾åƒæ•°æ®æ—¶ï¼Œæˆ‘ä»¬æœ‰éšå«çš„å±‚æ¬¡/é‚»è¿‘æ€§å’Œåƒç´ çš„ç›¸å¯¹ä½ç½®ï¼Œå°†æˆ‘ä»¬çš„äºŒç»´å›¾åƒå±•å¹³ä¸º 1D å‘é‡ä»¥é€šè¿‡å¤šä¸ªå…¨è¿æ¥äººå·¥ç¥ç»ç½‘ç»œå±‚ä¼šç ´åè¿™äº›ä¿¡æ¯ã€‚

+   å› æ­¤ï¼Œæˆ‘ä»¬ç§»é™¤ï¼Œæ­£åˆ™åŒ–åˆ° 0.0ï¼Œæ‰€æœ‰æ„ŸçŸ¥åœºå¤–çš„è¿æ¥ï¼Œä»¥ä¿æŒåƒç´ ä¿¡æ¯ä¹‹é—´çš„é‚»è¿‘æ€§å’Œç›¸å¯¹ä½ç½®ï¼ŒåŒæ—¶é¿å…è¿‡æ‹Ÿåˆã€‚

+   è¿™äº›æ„ŸçŸ¥åœºé€šè¿‡ä»å›¾åƒä¸­æå–è¾ƒå°çš„åƒç´ å­é›†å’Œæ›´ç®€å•çš„æ¨¡å¼æ¥è¿›è¡Œæ­£åˆ™åŒ–ã€‚

æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜åŒ…æ‹¬ dropoutï¼ˆéšæœºç§»é™¤è¿æ¥ï¼‰ä½œä¸ºå¦ä¸€ç§æ­£åˆ™åŒ–çš„å½¢å¼ã€‚

## ä½¿ç”¨äººå·¥ç¥ç»ç½‘ç»œçš„å›¾åƒæ•°æ®ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å›¾åƒæ•°æ®ä¸æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œã€‚

![](img/a7d555024d6a9f3a61c7fd816bd8bf6a.png)

äººå·¥ç¥ç»ç½‘ç»œåˆ†ç±»å›¾åƒçš„ç¤ºæ„å›¾ã€‚

è¿™ç§æ–¹æ³•æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ

1.  **æ¨¡å‹å‚æ•°æ•°é‡å·¨å¤§** - æ¨¡å‹å¯èƒ½éš¾ä»¥è®­ç»ƒä¸”å®¹æ˜“è¿‡æ‹Ÿåˆã€‚

1.  **å¯¹ä½ç½®éå¸¸æ•æ„Ÿ** - æˆ‘ä»¬å¸Œæœ›ä»å…·æœ‰ä½ç½®ä¸å˜æ€§çš„å›¾åƒä¸­å­¦ä¹ ï¼Œå³ï¼Œå¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œé€šé“çš„ä½ç½®ä¸åº”é‡è¦ã€‚

1.  **å°†å›¾åƒå±•å¹³ä¸ºå‘é‡** - è¿™æ˜¯äººå·¥ç¥ç»ç½‘ç»œæ‰€å¿…éœ€çš„ï¼Œä½†å¦‚æœæˆ‘ä»¬é¦–å…ˆå°†å›¾åƒå±•å¹³ä¸ºå‘é‡ï¼Œæˆ‘ä»¬å°±ä¼šä¸¢å¤±å…³äºåƒç´ æ¨¡å¼ã€é¡ºåºã€ç›¸é‚»æ€§ç­‰é‡è¦ä¿¡æ¯ã€‚

æ€»ç»“æ¥è¯´ï¼Œäººå·¥ç¥ç»ç½‘ç»œåœ¨å›¾åƒå¤„ç†ä¸Šéå¸¸ä½æ•ˆï¼Œå®¹æ˜“è¿‡æ‹Ÿåˆä¸”æ³›åŒ–èƒ½åŠ›å·®ï¼ç›¸åï¼Œè®©æˆ‘ä»¬ä»æˆ‘ä»¬çš„è§†è§‰çš®å±‚ä¸­æ±²å–çµæ„Ÿï¼Œæˆ‘ä»¬çš„è§†è§‰ä¸ä¼šæ„ŸçŸ¥åˆ°æ‰€æœ‰â€˜åƒç´ â€™ï¼Œè€Œæ˜¯å°†è§†é‡åˆ†å‰²æˆæ„Ÿå—é‡ã€‚

+   æˆ‘ä»¬ä»é‡å çš„æ„Ÿå—é‡ä¸­æå–æ„Ÿå…´è¶£çš„ç‰¹å¾ï¼Œåœ¨å±‚æ¬¡ç»“æ„ï¼ˆæœªæ˜¾ç¤ºï¼‰ä¸­é‡ç»„æ•´ä¸ªå›¾åƒï¼Œæˆ‘ä»¬çš„æ„ŸçŸ¥ã€‚

+   æˆ‘ä»¬ä¸ä¼šæ„ŸçŸ¥åˆ°æ‰€æœ‰â€˜åƒç´ â€™ï¼Œè¿™å¯¹æˆ‘ä»¬çš„å¤§è„‘æ¥è¯´ä¼šéå¸¸ç´¯ï¼Œç›¸åï¼Œæˆ‘ä»¬çš„è§†è§‰çš®å±‚ä¼šè§£é‡Šå’Œæ€»ç»“æ¨¡å¼ã€‚

![å›¾ç‰‡](img/57787e99367cbd5272ad8414cd3bfe82.png)

å°†é‡å çš„æ„Ÿå—é‡ç”¨äºåˆ†å‰²è§†é‡ï¼Œæ€»ç»“æ¯ä¸€éƒ¨åˆ†å¹¶é‡æ–°ç»„åˆæˆæˆ‘ä»¬çš„æ„ŸçŸ¥ã€‚

ç°åœ¨è®©æˆ‘ä»¬ç”¨æ„Ÿå—é‡çš„æ¦‚å¿µæ¥æ¯”è¾ƒäººå·¥ç¥ç»ç½‘ç»œå’Œå·ç§¯ç¥ç»ç½‘ç»œã€‚

å…¨è¿æ¥ã€å‰é¦ˆäººå·¥ç¥ç»ç½‘ç»œ

+   ä¸‹ä¸€å±‚çš„èŠ‚ç‚¹è¿æ¥åˆ°å‰ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹

+   ç©ºé—´ä¿¡æ¯ä¸¢å¤±ï¼Œå›¾åƒæ•°æ®ç«‹å³å±•å¹³ä¸º 1D å‘é‡ï¼Œç›¸é‚»æ€§å’Œé¡ºåºä¿¡æ¯ä¸¢å¤±

ä½¿ç”¨æ„Ÿå—é‡å·ç§¯ç¥ç»ç½‘ç»œè¿›è¡Œæ­£åˆ™åŒ–

+   ä¸‹ä¸€å±‚çš„èŠ‚ç‚¹æ˜ å°„åˆ°å‰ä¸€å±‚ç‰¹å®šçš„åŒºåŸŸï¼Œå³å›¾åƒæˆ–ç‰¹å¾å›¾

+   ç©ºé—´ä¿¡æ¯å¾—åˆ°ä¿ç•™ï¼Œæ•°æ®åœ¨æ¯ä¸ªå±‚ä¸­ä¿ç•™äº†åŸå§‹å›¾åƒçš„ 2D æˆ– 3D ç»´åº¦æ€§ï¼Œç§°ä¸ºç‰¹å¾å›¾ã€‚

![å›¾ç‰‡](img/b56850a29d24dbccae1cabcfbdc9e7e7.png)

å°†é‡å çš„æ„Ÿå—é‡ç”¨äºåˆ†å‰²è§†é‡ï¼Œæ€»ç»“æ¯ä¸€éƒ¨åˆ†å¹¶é‡æ–°ç»„åˆæˆæˆ‘ä»¬çš„æ„ŸçŸ¥ã€‚

## CNN çš„æ­£åˆ™åŒ–

è®©æˆ‘ä»¬å¿«é€Ÿå›é¡¾ä¸€ä¸‹é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­æ­£åˆ™åŒ–çš„æ¦‚å¿µï¼Œ

**æ­£åˆ™åŒ–** - ä¸€ç§çº¦æŸï¼Œä»¥å‡å°‘æ¨¡å‹å¯¹æ•°æ®çš„æ•æ„Ÿæ€§ï¼Œå³ï¼Œå‡å°‘æ¨¡å‹æ–¹å·®

**ä½¿ç”¨æ„Ÿå—é‡è¿›è¡Œæ­£åˆ™åŒ–** - æ„Ÿå—é‡çš„ä½¿ç”¨æ˜¯ä¸€ç§æ­£åˆ™åŒ–å½¢å¼ï¼Œå¯¼è‡´ï¼Œ

+   è¿æ¥ã€æƒé‡/æ¨¡å‹å‚æ•°çš„å¤§é‡å‡å°‘

+   æœ‰æ•ˆåœ°å°†è¿™äº›æ½œåœ¨æƒé‡ç¼©å°åˆ°é›¶

åŒæ—¶æ•´åˆ/å…³æ³¨åƒç´ æ¨¡å¼ï¼

**ä½¿ç”¨ Dropout è¿›è¡Œæ­£åˆ™åŒ–** - åœ¨è®­ç»ƒå‘¨æœŸä¸­ï¼Œéšæœºå¿½ç•¥æˆ–â€œä¸¢å¼ƒâ€ä¸€éƒ¨åˆ†èŠ‚ç‚¹ã€‚æ¯ä¸ªè®­ç»ƒå‘¨æœŸéƒ½ä¼šçœ‹åˆ°ç½‘ç»œçš„ä¸åŒç‰ˆæœ¬/å­é›†

+   CNN çš„ä¸€ç§é¢å¤–æ­£åˆ™åŒ–å½¢å¼ï¼Œä»¥é˜²æ­¢ç‰¹å®šèŠ‚ç‚¹ä¸»å¯¼æ¨¡å‹

+   æ¨¡æ‹Ÿè®­ç»ƒå¤šä¸ªæ¨¡å‹å¹¶å¹³å‡ï¼Œç±»ä¼¼äºé›†æˆå­¦ä¹ ã€‚æ³¨æ„ï¼Œé€šå¸¸ä¸å¯è¡Œå¹¶è¡Œè®­ç»ƒå¤šä¸ªç½‘ç»œä»¥åº”ç”¨é›†æˆæ¥è®¡ç®—é¢„æµ‹ï¼ˆå¦‚éšæœºæ£®æ—ï¼‰ï¼Œå¹¶ä¸”åœ¨è®­ç»ƒåæ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«ä½¿ç”¨ã€‚

![](img/2078f41aac92afeb57f8fdc28528b873.png)

ä»æ„Ÿå—é‡åˆ°ç‰¹å¾å›¾ä¸­çš„èŠ‚ç‚¹çš„éšæœºè¿æ¥çš„ dropout ç¤ºæ„å›¾ã€‚

**æ‰¹é‡å½’ä¸€åŒ–** - åœ¨å±‚ä¸Šæ ‡å‡†åŒ–èŠ‚ç‚¹çš„è¾“å…¥/æƒé‡ï¼Œä»¥ä¸­å¿ƒåŒ–å’Œç¼©æ”¾ï¼ˆå‡å€¼ä¸º 0ï¼Œæ–¹å·®ä¸º 1ï¼‰ï¼Œä»¥ä¼˜åŒ–æ¿€æ´»å‡½æ•°çš„æ•æ„Ÿæ€§å’Œæ¨¡å‹å‚æ•°è®­ç»ƒã€‚

$$ \hat{x}_i \leftarrow \frac{x_i - \mu_B}{\sqrt{\sigma_BÂ² + \epsilon}} $$

ç„¶åæˆ‘ä»¬æ·»åŠ  2 ä¸ªæ¨¡å‹å‚æ•°ï¼Œå±‚æ ‡å‡†å·®ï¼Œ$\gamma$ï¼Œå’Œå‡å€¼ï¼Œ$\beta$ï¼Œä»¥å¢åŠ æ§åˆ¶ï¼Œæé«˜ä¸‹ä¸€å±‚è®­ç»ƒå•ä¸ªæƒé‡çš„æœ€ä¼˜æ€§ã€‚

$$ y_i \leftarrow \gamma \hat{x}_i + \beta $$

## CNN çš„æ„å»ºæ¨¡å—

æˆ‘ä»¬æœ‰å„ç§ç®—å­å¯ä»¥åœ¨æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œä¸­ä»ä¸€å±‚ç§»åŠ¨åˆ°å¦ä¸€å±‚ï¼ˆç‰¹å¾å›¾åˆ°ç‰¹å¾å›¾ï¼‰ã€‚å¸¸è§çš„ç®—å­åŒ…æ‹¬ï¼Œ

+   **å·ç§¯** â€“ ä¸€ä¸ªåŠ æƒçª—å£ï¼Œæ ¸/æ»¤æ³¢å™¨ï¼Œç”¨äºæå–ç©ºé—´ä¿¡æ¯

+   **æ± åŒ–** â€“ ç»´åº¦é™ä½ï¼Œå¢åŠ å±€éƒ¨å¹³ç§»ä¸å˜æ€§

+   **æ·±åº¦æ± åŒ–ï¼Œä¸‹é‡‡æ ·** â€“ 1x1 æ»¤æ³¢å™¨ï¼Œå°†é€šé“/ç‰¹å¾å›¾ç»„åˆèµ·æ¥ï¼Œä»¥åœ¨å¤šä¸ªæ ¸ä¸Šå­¦ä¹ 

+   **æ¿€æ´»** â€“ ä½¿ç”¨æ¿€æ´»å‡½æ•°å¯¹ç³»ç»Ÿåº”ç”¨éçº¿æ€§å˜æ¢ï¼Œä»¥èµ‹äºˆç³»ç»Ÿéçº¿æ€§ï¼Œå¹¶é˜²æ­¢ç³»ç»Ÿç®€åŒ–ä¸ºç®€å•çš„çº¿æ€§æ¨¡å‹

+   **å…¨è¿æ¥ï¼Œå‰é¦ˆ** â€“ å‚è§ä¹‹å‰å…³äºäººå·¥ç¥ç»ç½‘ç»œçš„è®²åº§

ç°åœ¨æˆ‘ä»¬å°†æè¿°ã€è§£é‡Šå’Œæ¼”ç¤ºè¿™äº›ç®—å­ã€‚

## å·ç§¯

å·ç§¯æ˜¯ä¸¤ä¸ªå‡½æ•°çš„ç§¯åˆ†ä¹˜ç§¯ï¼Œå…¶ä¸­ä¸€ä¸ªå‡½æ•°è¢«åè½¬å¹¶æ²¿ $\Delta$ å¹³ç§»ã€‚

+   ä¸€ç§è§£é‡Šæ˜¯ä½¿ç”¨åŠ æƒå‡½æ•°ï¼Œ$ğ‘“(\Delta)$ï¼Œå¯¹å‡½æ•°è¿›è¡Œå¹³æ»‘ï¼Œä»¥è®¡ç®—å‡½æ•°ï¼Œ$ğ‘”(x)$ï¼Œçš„åŠ æƒå¹³å‡å€¼ï¼Œ

$$ (f * g)(x) = \int_{-\infty}^{\infty} f(\Delta) g(x - \Delta) \, d\Delta $$

è¿™å¾ˆå®¹æ˜“æ‰©å±•åˆ°ä»»ä½•ç»´åº¦ï¼Œä¾‹å¦‚ 2D ç”¨äºå›¾åƒï¼Œ

$$ (f * g)(x, y) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} f(\Delta_x, \Delta_y) g(x - \Delta_x, y - \Delta_y) \, d\Delta_x \, d\Delta_y $$

åœ¨ç§¯åˆ†ä¹‹å‰é€‰æ‹©å“ªä¸ªå‡½æ•°å…ˆå¹³ç§»ï¼Œä¸ä¼šæ”¹å˜ç»“æœï¼Œå·ç§¯ç®—å­å…·æœ‰äº¤æ¢æ€§ï¼Œ

$$ (f * g)(x) = \int_{-\infty}^{\infty} f(\Delta) g(x - \Delta) \, d\Delta $$$$ (f * g)(x) = \int_{-\infty}^{\infty} f(x - \Delta) g(\Delta) \, d\Delta $$

+   å¦‚æœä»»ä¸€å‡½æ•°è¢«åå°„ï¼Œå·ç§¯å°±ç­‰åŒäºäº¤å‰ç›¸å…³ï¼Œå®ƒæ˜¯ä¸¤ä¸ªä¿¡å·ä½œä¸ºä½ç§»å‡½æ•°ç›¸ä¼¼åº¦çš„åº¦é‡ã€‚

ä¸ºäº†æ¼”ç¤ºä½¿ç”¨è¯¦å°½çš„ $g(x)$ å’Œç¨€ç–é‡‡æ ·çš„ $g(x)$ çš„å·ç§¯ï¼Œæˆ‘æ„å»ºäº†ä¸€ä¸ª[äº¤äº’å¼ Python å·ç§¯ä»ªè¡¨æ¿](https://github.com/GeostatsGuy/DataScienceInteractivePython/blob/main/Interactive_Convolution_kNearest.ipynb)ï¼Œ

![å›¾ç‰‡](img/f55c37e0f7da98a233affd5fbd5ba38c.png)

äº¤äº’å¼ Python ä»ªè¡¨æ¿ç”¨äºæ¼”ç¤ºå·ç§¯ã€‚

åœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå­¦ä¹ ä¸€ä¸ªå¯è®­ç»ƒçš„åŠ æƒå‡½æ•° $g(\Tau)$ ç”¨äºå·ç§¯æ“ä½œã€‚

**æ»¤æ³¢å™¨/æ ¸** â€“ åœ¨å·ç§¯çª—å£ä¸­åˆ†é…çš„æƒé‡ï¼Œç”¨äºè®¡ç®—ä¸‹ä¸€ä¸ªç‰¹å¾å›¾ã€‚é€šè¿‡è®­ç»ƒæƒé‡ï¼Œæ»¤æ³¢å™¨å¯ä»¥æå–ç‰¹å®šçš„ç©ºé—´ç‰¹å¾ã€‚

![å›¾ç‰‡](img/1955083a83351548602c54c6f2f6d86b.png)

å·ç§¯è®¡ç®—çš„ä¸¤ç§ç¤ºä¾‹ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç‰¹å®šçš„æ ¸å½¢å¼ï¼Œå³æ¨¡ç³Šæ»¤æ³¢å™¨ã€‚

+   ä¸‹ä¸€ä¸ªç‰¹å¾å›¾æ¥æ”¶å…ˆå‰ç‰¹å¾å›¾æˆ–å›¾åƒä¸Šçš„å±€éƒ¨å¹³å‡å€¼ã€‚

![å›¾ç‰‡](img/f41a6a56aa0cf6c53667cad2b0ae52c8.png)

ç¤ºä¾‹æ»¤æ³¢å™¨ï¼Œæ¨¡ç³Š/å±€éƒ¨å¹³å‡æ»¤æ³¢å™¨ã€‚

å…³äºæ»¤æ³¢å™¨çš„ä¸€äº›è§‚å¯Ÿï¼Œ

+   æ»¤æ³¢å™¨çš„å¤§å°ä¸æˆ‘ä»¬æå–çš„ç‰¹å¾çš„å°ºåº¦ç›¸å…³

+   è¾ƒå¤§çš„æ ¸å¢åŠ äº†è¿æ¥æ•°ã€æ¨¡å‹æƒé‡ï¼Œæœ€ç»ˆå¢åŠ äº†è®¡ç®—å¤æ‚åº¦

+   å¯¹äºæ ¸å¤§å°ä½¿ç”¨å¥‡æ•°ä»¥é¿å…æ‰­æ›²ï¼Œå¯èƒ½ä½¿ç”¨éå¯¹ç§°æ ¸

+   æ±‚å’Œä¸º 1 å¯ä»¥é˜²æ­¢åå·®ï¼ˆä»ä¸€å¹…å›¾åƒæˆ–ç‰¹å¾å›¾åˆ°å¦ä¸€å¹…ç‰¹å¾å›¾çš„å‡å€¼åç§»ï¼‰

**å¡«å……** - æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªç‰¹å¾å›¾åœ¨æ‰€æœ‰è¾¹ç¼˜ä¸Šå‡å°‘äº† 1ï¼Œä»¥é¿å…ç‰¹å¾å›¾å¤–éƒ¨çš„é‡å ï¼Œå³æ— å¡«å……ï¼Œè€Œå¡«å……å°†æ‰©å±•åˆ°ç‰¹å¾å›¾æˆ–å›¾åƒå¤–éƒ¨ï¼Œé˜²æ­¢ä¸‹ä¸€ä¸ªç‰¹å¾å›¾å¤§å°çš„å‡å°‘ã€‚

+   å­˜åœ¨å¤šç§å¡«å……æ–¹æ³•ï¼ŒåŒ…æ‹¬å‡è®¾é›¶ã€å¸¸æ•°å€¼å’Œç‰¹å¾å›¾ä¸­çš„æœ€è¿‘å€¼ã€‚

![å›¾ç‰‡](img/58368b8a8cebacdde3ae4116d6462f35.png)

æ— å¡«å……çš„å·ç§¯å¯¼è‡´ç‰¹å¾å›¾å¤§å°å‡å°‘ï¼ˆä¸Šæ–¹ï¼‰å’Œæœ‰å¡«å……çš„å·ç§¯ï¼ˆå‡è®¾ç‰¹å¾å›¾å¤–éƒ¨ä¸º 0ï¼‰ä»¥é¿å…ç‰¹å¾å›¾å¤–éƒ¨çš„é‡å ï¼Œå³æ— å¡«å……ï¼Œè€Œå¡«å……å°†æ‰©å±•åˆ°ç‰¹å¾å›¾æˆ–å›¾åƒå¤–éƒ¨ï¼Œé˜²æ­¢ä¸‹ä¸€ä¸ªç‰¹å¾å›¾å¤§å°çš„å‡å°‘ã€‚

**æ­¥é•¿** - å·ç§¯æ»¤æ³¢å™¨/æ ¸åœ¨å…ˆå‰ç‰¹å¾å›¾ä¸Šçš„æ­¥è¿›ã€‚

+   å¯¹äºæ­¥é•¿ä¸º 1ï¼Œç‰¹å¾å›¾å¤§å°æ²¡æœ‰éšå¼å‡å°‘ã€‚

+   å¯¹äºæ­¥é•¿å¤§äº 2ï¼Œç‰¹å¾å›¾å¤§å°ä¼šå‡å°‘ã€‚

![å›¾ç‰‡](img/58300f18f8744327620c90fcc1cc392f.png)

æ­¥é•¿ä¸º 1 çš„å·ç§¯ï¼ˆä¸Šæ–¹ï¼‰å’Œæ­¥é•¿ä¸º 2 çš„å·ç§¯ï¼ˆä¸‹æ–¹ï¼‰å¯¼è‡´ç‰¹å¾å›¾å¤§å°å‡å°‘ã€‚

**ä¸‹ä¸€ä¸ªç‰¹å¾å›¾çš„å¤§å°** - ä¸‹ä¸€ä¸ªç‰¹å¾å›¾çš„å¤§å°ç”±è¶…å‚æ•°ã€å…ˆå‰ç‰¹å¾å›¾å¤§å° $n_{in}$ã€å·ç§¯æ ¸å¤§å° $k$ã€å·ç§¯å¡«å……å¤§å° $p$ å’Œå·ç§¯æ­¥é•¿å¤§å° $s$ å†³å®šï¼Œé€šè¿‡æ­¤æ–¹ç¨‹ï¼Œ

$$ n_{\text{out}} = \left\lfloor \frac{n_{\text{in}} + 2p - k}{s} \right\rfloor + 1 $$

ä¾‹å¦‚ï¼Œ

+   $n_{in} = 4$

+   $k = 2$

+   $p = 0$

+   $s = 1$

ç„¶åæˆ‘ä»¬å¯ä»¥å°†æ­¤ä»£å…¥æ–¹ç¨‹ä¸­ï¼Œ

$$ n_{\text{out}} = \left\lfloor \frac{4 + 2(0) - 2}{1} \right\rfloor + 1 = 3 $$

ç°åœ¨å°†æ­¤ä¸è¯¥ç¤ºä¾‹çš„è§†è§‰è¡¨ç¤ºè¿›è¡Œæ¯”è¾ƒï¼Œ

![å›¾ç‰‡](img/ad9c65a10c9c4afb28b77bd7cbfc6017.png)

ä¸Šè¿°ç¤ºä¾‹çš„ç¤ºä¾‹æ ¸ã€è¾“å…¥å’Œè¾“å‡ºç‰¹å¾å›¾ã€‚

æˆ‘ä»¬è®¡ç®—ä¸‹ä¸€ä¸ªç‰¹å¾å›¾å¤§å°å¦‚ä¸‹ï¼š

$$ n_{\text{out}} = \left\lfloor \frac{4 + 2(0) - 2}{1} \right\rfloor + 1 = 3 $$

**æ»¤æ³¢å™¨/æ ¸è®¾è®¡** â€“ é€šè¿‡è®­ç»ƒæƒé‡ï¼Œæ»¤æ³¢å™¨å¯ä»¥æå–ç‰¹å®šçš„ç‰¹å¾ã€‚è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹æ»¤æ³¢å™¨ç±»å‹ï¼Œä»¥åŠè¾“å…¥å’Œè¾“å‡ºç‰¹å¾â€˜å›¾â€™çš„ç®€å• 1D ç¤ºä¾‹ã€‚

![](img/363089e3910cc726998fcf261fba68ef.png)

æ»¤æ³¢å™¨ï¼ˆä¸Šé¢ï¼Œä»¥åŠå·ç§¯çš„ 1D ç¤ºæ„å›¾ï¼ŒåŸå§‹å‡½æ•°ï¼ˆé»‘è‰²ï¼‰å’Œå·ç§¯ï¼ˆçº¢è‰²ï¼‰ä¸‹é¢ï¼‰ã€‚

**å¤šä¸ªæ»¤æ³¢å™¨/æ ¸** - é€šå¸¸åœ¨æ¯ä¸ªå·ç§¯å±‚ä¸Šè®­ç»ƒå¤šä¸ªæ»¤æ³¢å™¨ï¼Œ$n_k$ï¼Œä»¥ä»å›¾åƒä¸­æå–ä¸åŒçš„ç»“æ„ã€‚

+   è¿™å¢åŠ äº†ç‰¹å¾å›¾çš„æ·±åº¦æˆ–é€šé“æ•°ï¼Œ$n_k$

![](img/401b5ed57a2efd08be6f224d335f76da.png)

ç”±äºåº”ç”¨äº†å¤šä¸ªæ»¤æ³¢å™¨åˆ°å‰ä¸€ä¸ªå›¾åƒæˆ–ç‰¹å¾å›¾ï¼Œç‰¹å¾å›¾å…·æœ‰æ·±åº¦ï¼Œä¹Ÿç§°ä¸ºé€šé“æ•°ï¼Œ$n_k$ã€‚

+   æ³¨æ„ï¼ŒåŸå§‹å›¾åƒå¯èƒ½å…·æœ‰å¤šä¸ªé€šé“ï¼Œæ·±åº¦>1ï¼Œä¾‹å¦‚ï¼Œå…·æœ‰ 3 ä¸ªé€šé“çš„ RGB å›¾åƒï¼Œæ¯ä¸ªé€šé“åˆ†åˆ«å¯¹åº”çº¢è‰²ã€è“è‰²å’Œç»¿è‰²ã€‚

æœ€åï¼Œè¿™é‡Œæœ‰ä¸€äº›å·ç§¯æ»¤æ³¢å™¨åº”ç”¨äºå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡çš„ç –å¢™å›¾åƒçš„ç¤ºä¾‹ï¼Œä»£ç å¯åœ¨[SubsurfaceDataAnalytics_Convolution_Operators.ipynb.](https://github.com/GeostatsGuy/PythonNumericalDemos/blob/master/SubsurfaceDataAnalytics_Convolution_Operators.ipynb)æ‰¾åˆ°ã€‚

![](img/48b85ce0016245754f632d2d7034335d.png)

æ¥è‡ªå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡æ ¡å›­ä¸­ç –å¢™çš„å·ç§¯ç¤ºä¾‹ã€‚

## æ¿€æ´»å‡½æ•°

è¯·å‚é˜…äººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œä½†ä¸ºäº†æé†’é€‰æ‹©æ¿€æ´»å‡½æ•°çš„è€ƒè™‘å› ç´ ï¼Œ

+   **éçº¿æ€§** â€“ å°†éçº¿æ€§å¼ºåŠ åˆ°é¢„æµ‹å™¨ä¸­ã€‚å¦‚æœè‡³å°‘æœ‰ 1 ä¸ªéšè—å±‚ï¼ˆCybenkoï¼Œ1989 å¹´ï¼‰ï¼Œå·²è¢«è¯æ˜æ˜¯é€šç”¨çš„å‡½æ•°é€¼è¿‘å™¨ã€‚

+   **èŒƒå›´** â€“ å¯¹äºæ›´ç¨³å®šçš„åŸºäºæ¢¯åº¦çš„å­¦ä¹ æ˜¯æœ‰é™çš„ï¼Œå¯¹äºæ›´æœ‰æ•ˆçš„è®­ç»ƒæ˜¯æ— é™çš„ï¼ˆä½†éœ€è¦è¾ƒæ…¢çš„å­¦ä¹ ç‡ï¼‰

+   **è¿ç»­å¯å¾®** â€“ å¯¹äºç¨³å®šçš„åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–æ˜¯å¿…éœ€çš„

+   **å…·æœ‰å•è°ƒå¯¼æ•°çš„å¹³æ»‘å‡½æ•°** â€“ å¯èƒ½å…·æœ‰æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›

+   **å•è°ƒ** â€“ ä¿è¯å•å±‚æ¨¡å‹è¯¯å·®è¡¨é¢çš„å‡¸æ€§ï¼ˆæŸå¤±å‡½æ•°çš„å…¨å±€æœ€å°å€¼ï¼‰

+   **åœ¨åŸç‚¹è¿‘ä¼¼æ’ç­‰** â€“ ä½¿ç”¨å°éšæœºå€¼åˆå§‹åŒ–æƒé‡æ—¶ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å­¦ä¹ 

![](img/cb1d19a7978ea9f1f58b12b229835dcc.png)

æ¥è‡ªå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡æ ¡å›­ä¸­ç –å¢™çš„å·ç§¯ç¤ºä¾‹ã€‚

## æ± åŒ–

å¯¹å•ä¸ªå€¼è¿›è¡Œæ»¤æ³¢å™¨/æ ¸çš„æ±‡æ€»ã€‚æ± åŒ–çš„å½±å“åŒ…æ‹¬ï¼Œ

+   ä¸‹é‡‡æ ·ç‰¹å¾å›¾ä¸­ç‰¹å¾æ£€æµ‹

+   å‡å°‘äº†ç‰¹å¾å›¾çš„ç»´åº¦

+   æ•´åˆå¹³ç§»ä¸å˜æ€§ï¼Œå¯¹ä½ç½®ä¸æ•æ„Ÿçš„æ¨¡å¼æ£€æµ‹

ä¸¤ç§å¸¸è§çš„æ± åŒ–æ–¹æ³•æ˜¯å¹³å‡æ± åŒ–å’Œæœ€å¤§æ± åŒ–ã€‚

![](img/4b2fd11462cbb82e0cb09ac3e2d938ff.png)

æ± åŒ–æ“ä½œçš„ç¤ºæ„å›¾ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨ 2x2 æ»¤æ³¢å™¨å’Œæ­¥é•¿ä¸º 2 çš„æ± åŒ–ç¤ºä¾‹ã€‚

![](img/81532b0b04b5a5af52f9b81557967b34.png)

æ± åŒ–æ“ä½œçš„ç¤ºä¾‹ï¼Œç”¨äºå‡å°‘ç‰¹å¾å›¾çš„å°ºå¯¸ã€‚

+   ä½¿ç”¨ 2 x 2 æ»¤æ³¢å™¨ï¼Œæ­¥é•¿ä¸º 2ï¼Œæ¯ä¸ªè½´çš„ç»´åº¦å‡å°‘ä¸€åŠï¼Œå¯¹äº 2D å›¾åƒä¸ºå››åˆ†ä¹‹ä¸€ã€‚

+   ä¾‹å¦‚ï¼Œ16 çš„å€¼åœ¨æ»¤æ³¢å™¨å†…æ˜¯ä½ç½®æ— å…³çš„ã€‚è¿™å¼•å…¥äº†å¹³ç§»ä¸å˜æ€§ã€‚

![å›¾ç‰‡](img/a3f5e46b161a0d2f7e0f99574f3db593.png)

æ¥è‡ªå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡æ ¡å›­ç –å¢™çš„æœ€å¤§æ± åŒ–å’Œå¹³å‡æ± åŒ–ç¤ºä¾‹ã€‚

## æ·±åº¦æ± åŒ–

ä½¿ç”¨å•ä¸ªå€¼å¯¹ç‰¹å¾å›¾è¿›è¡Œæ€»ç»“ã€‚

+   åœ¨ç‰¹å¾å›¾ä¸Šå¯¹æ£€æµ‹è¿›è¡Œä¸‹é‡‡æ ·

+   ç»“åˆæ¥è‡ªå¤šä¸ªæ ¸çš„ä¿¡æ¯

+   å‡å°‘äº†ç‰¹å¾å›¾çš„æ·±åº¦ï¼Œä¸‹ä¸€å±‚

ä¸¤ç§å¸¸è§çš„æ± åŒ–æ–¹æ³•æ˜¯å¹³å‡æ± åŒ–å’Œæœ€å¤§æ± åŒ–ã€‚

![å›¾ç‰‡](img/1786e9cb04c2dac2297ddc607d4b0649.png)

æ·±åº¦æ± åŒ–æ“ä½œçš„ç¤ºæ„å›¾ã€‚

## å¸¸è§çš„ CNN æ¶æ„

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œçš„å¸¸è§å·¥ä½œæµç¨‹ï¼Œ

![å›¾ç‰‡](img/fcb53216a4534c9da9053f990e48aa90.png)

å¸¸è§çš„ CNN å·¥ä½œæµç¨‹ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨å¸¸è§æ¶æ„çš„ç¤ºæ„å›¾æ¥è¡¨ç¤ºè¿™ä¸ªå¸¸è§çš„å·¥ä½œæµç¨‹ã€‚

![å›¾ç‰‡](img/618c123a572e16a0e12819e75b283099.png)

å¸¸è§çš„ CNN æ¶æ„ã€‚

## æ‰‹å·¥å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„

å°±åƒäººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ä¸€æ ·ï¼Œæˆ‘é€šè¿‡æ‰‹å·¥åˆ¶ä½œäº†ä¸€ä¸ªç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œã€‚

ä¸ºäº†ç®€æ´å’Œç®€æ´ï¼Œæˆ‘åšå‡ºäº†ä»¥ä¸‹æ¶æ„é€‰æ‹©ï¼Œ

+   é«˜åº¦ä¸º 5 çš„ 1D å›¾åƒ

+   1 ä¸ªå·ç§¯å±‚ï¼Œå¤§å°ä¸º 3 çš„ 1 ä¸ªæ ¸

+   ä½¿ç”¨ sigmoid æ¿€æ´»

+   æ­¥é•¿ä¸º 1 ä¸”æ— å¡«å……ï¼Œå› æ­¤ç‰¹å¾å›¾çš„å¤§å°ä¸º 3

+   ä»ç‰¹å¾å›¾ç›´æ¥åˆ°è¾“å‡ºèŠ‚ç‚¹ï¼Œå…·æœ‰çº¿æ€§æ¿€æ´»çš„äººå·¥ç¥ç»ç½‘ç»œ

è¿™ç§ç®€çº¦æ¶æ„å±•ç¤ºäº†å·ç§¯ç¥ç»ç½‘ç»œä¸­çš„è®¸å¤šæ˜¾è‘—æ¦‚å¿µï¼ŒåŒæ—¶éå¸¸æ˜“äºå¯è§†åŒ–ä¸”è®­ç»ƒé€Ÿåº¦å¿«ã€‚

![å›¾ç‰‡](img/c18c0d3da8b925d617dbd7cad6b9d1fa.png)

æˆ‘ä»¬æ‰‹å·¥åˆ¶ä½œçš„å·ç§¯ç¥ç»ç½‘ç»œçš„ç¤ºæ„å›¾ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å°†æˆ‘ä»¬æ‰‹å·¥åˆ¶ä½œçš„å·ç§¯ç¥ç»ç½‘ç»œçš„ç¤ºæ„å›¾è½¬æ¢ä¸ºå®é™…èŠ‚ç‚¹çš„å›¾ã€‚

![å›¾ç‰‡](img/aaaec452d8f375bf00b4df41c281e46c.png)

æˆ‘ä»¬æ‰‹å·¥åˆ¶ä½œçš„å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„ã€‚

ä¸ºäº†å±•ç¤ºä½¿ç”¨æ­¤æ¶æ„çš„å®ç”¨æ€§ï¼Œè®©æˆ‘ä»¬æ·»åŠ æ¨¡å‹å‚æ•°çš„æ ‡ç­¾ï¼Œ

+   æ ¸æƒé‡ï¼Œ$\lambda_6$ï¼Œ$\lambda_7$ï¼Œå’Œ $\lambda_8$

+   æ ¸åç½®ï¼Œ$b_{conv}$

+   äººå·¥ç¥ç»ç½‘ç»œæƒé‡ï¼Œ$\lambda_{9,12}$ï¼Œ$\lambda_{10,12}$ï¼Œå’Œ $\lambda_{11,12}$

+   äººå·¥ç¥ç»ç½‘ç»œåå·®ï¼Œ$b_{12}$

![å›¾ç‰‡](img/11f0651d909bf7e40e4ebdeca86bab61.png)

åŒ…å«æ‰€æœ‰å¯è®­ç»ƒæ¨¡å‹å‚æ•°çš„æˆ‘ä»¬æ‰‹å·¥åˆ¶ä½œçš„å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„ã€‚æ³¨æ„ï¼Œä»…æ˜¾ç¤ºäº†ç¬¬ä¸€ä¸ªæ ¸ä½ç½®ä¸­çš„æ ¸æƒé‡ä»¥é¿å…æ‚ä¹±ã€‚

## è®­ç»ƒæ¨¡å‹å‚æ•°

è®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œé€šè¿‡ä»¥ä¸‹æ­¥éª¤è¿­ä»£è¿›è¡Œï¼Œä¸äººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ä¸­è®¨è®ºçš„ç›¸åŒã€‚

![å›¾ç‰‡](img/c3a5bc8956f8ceda05ddf9b582cd141d.png)

è®­ç»ƒäººå·¥ç¥ç»ç½‘ç»œé€šè¿‡è¿­ä»£è¿›è¡Œï¼Œ1. å‰å‘ä¼ æ’­è¿›è¡Œé¢„æµ‹ï¼Œ2. æ ¹æ®è®­ç»ƒæ•°æ®ä¸­çš„é¢„æµ‹å’ŒçœŸå®å€¼è®¡ç®—è¯¯å·®å¯¼æ•°ï¼Œ3. é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œåå‘ä¼ æ’­è¯¯å·®å¯¼æ•°ä»¥è®¡ç®—æ‰€æœ‰æ¨¡å‹æƒé‡å’Œåç½®å‚æ•°çš„è¯¯å·®å¯¼æ•°ï¼Œ4. æ ¹æ®å¯¼æ•°å’Œå­¦ä¹ ç‡æ›´æ–°æ¨¡å‹å‚æ•°ï¼Œ5. é‡å¤ç›´åˆ°æ”¶æ•›ã€‚

è¿™é‡Œæ˜¯æ¯ä¸ªæ­¥éª¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œé‡ç‚¹å…³æ³¨ä¸äººå·¥ç¥ç»ç½‘ç»œçš„å·®å¼‚ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚é˜…äººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ã€‚

1.  **åˆå§‹åŒ–æ¨¡å‹å‚æ•°** - é€šå¸¸ä½¿ç”¨æ¥è¿‘é›¶çš„å°éšæœºå€¼åˆå§‹åŒ–æ‰€æœ‰æ¨¡å‹å‚æ•°ã€‚è¿™é‡Œæœ‰ä¸€äº›å¸¸è§çš„æ–¹æ³•ï¼Œ

+   **Xavier Glorot å‡åŒ€åˆå§‹åŒ–** - å¯¹äº Tanh å’Œ sigmoid æ¿€æ´»å‡½æ•°ï¼Œä»ç”± $U[\text{min}, \text{max}]$ æŒ‡å®šçš„å‡åŒ€åˆ†å¸ƒä¸­éšæœºå–å€¼ï¼Œ

$$ \lambda_i = F_U\left[-\sqrt{\frac{6}{n_{\text{in}} + n_{\text{out}}}},\ \sqrt{\frac{6}{n_{\text{in}} + n_{\text{out}}}}\right]^{-1}(p^\ell) $$

+   å…¶ä¸­ $F^{-1}_U$ æ˜¯ç´¯ç§¯åˆ†å¸ƒå‡½æ•°çš„é€†ï¼Œ$p$ æ˜¯è¾“å…¥æ•°é‡ï¼Œ$p^{\ell}$ æ˜¯ä»å‡åŒ€åˆ†å¸ƒ $U[0,1]$ ä¸­æŠ½å–çš„éšæœºç´¯ç§¯æ¦‚ç‡å€¼ã€‚

ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ªè¾“å…¥é€šé“ä¸º 1ï¼Œè¾“å‡ºé€šé“ä¸º 9 çš„ $3 \times 3$ å·ç§¯æ ¸ï¼Œ

$$ n_{in} = k \times k \times C = 3 \times 3 \times 1 $$$$ n_out = k \times k \times C = 3 \times 3 \times 9 $$

+   **He Kaiming æƒé‡åˆå§‹åŒ–** - å¯¹äº ReLU å’Œ leaky ReLU æ¿€æ´»å‡½æ•°ï¼Œä»ç”± $U[\text{min}, \text{max}]$ æŒ‡å®šçš„å‡åŒ€åˆ†å¸ƒä¸­éšæœºå–å€¼ï¼Œ

$$ \lambda_i = F_U\left[-\sqrt{\frac{6}{n_{\text{in}}}},\ \sqrt{\frac{6}{n_{\text{in}}}}\right]^{-1}(p^\ell) $$

+   å…¶ä¸­ $F^{-1}_U$ æ˜¯ç´¯ç§¯åˆ†å¸ƒå‡½æ•°çš„é€†ï¼Œ$p$ æ˜¯è¾“å…¥æ•°é‡ï¼Œ$k$ æ˜¯è¾“å‡ºæ•°é‡ï¼Œ$p^{\ell}$ æ˜¯ä»å‡åŒ€åˆ†å¸ƒ $U[0,1]$ ä¸­æŠ½å–çš„éšæœºç´¯ç§¯æ¦‚ç‡å€¼ã€‚

1.  **å‰å‘ä¼ æ’­** - è¿›è¡Œé¢„æµ‹ï¼Œ$\hat{y}$ã€‚åˆå§‹é¢„æµ‹åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£å°†æ˜¯éšæœºçš„ï¼Œä½†ä¼šæ”¹è¿›ã€‚

![](img/08556ecbd47d143019d0163dc95761cf.png)

ä½¿ç”¨éšæœºåˆå§‹åŒ–çš„æ¨¡å‹å‚æ•°ã€æƒé‡å’Œåç½®çš„äººå·¥ç¥ç»ç½‘ç»œè¿›è¡Œé¢„æµ‹ã€‚

1.  **è®¡ç®—è¯¯å·®å¯¼æ•°** - ç»™å®šæŸå¤± $P = \frac{1}{2} \left(\hat{y} - y \right)Â²$ï¼Œè¯¯å·®å¯¼æ•°ï¼Œå³è¯¯å·®éšæ¨¡å‹ä¼°è®¡å˜åŒ–çš„å˜åŒ–ç‡æ˜¯ $\frac{\partial P}{\partial \hat{y}} = \hat{Y} - Y$ã€‚

+   ç›®å‰ï¼Œæˆ‘ä»¬åªè€ƒè™‘å•ä¸ªä¼°è®¡å€¼ï¼Œç¨åæˆ‘ä»¬å°†è®¨è®ºè¶…è¿‡ 1 ä¸ªè®­ç»ƒæ•°æ®ã€‚

1.  **åå‘ä¼ æ’­è¯¯å·®å¯¼æ•°** - æˆ‘ä»¬é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œåå‘ä¼ æ’­ä»¥è®¡ç®—æ‰€æœ‰æ¨¡å‹æƒé‡å’Œåç½®å‚æ•°çš„è¯¯å·®å¯¼æ•°ï¼Œä¸ºæ­¤æˆ‘ä»¬ä½¿ç”¨é“¾å¼æ³•åˆ™ï¼Œ

$$ \frac{\partial}{\partial x} f(g(h(x))) = \frac{\partial f}{\partial g} \cdot \frac{\partial g}{\partial h} \cdot \frac{\partial h}{\partial x} $$

1.  **æ›´æ–°æ¨¡å‹å‚æ•°** - åŸºäºå¯¼æ•°ï¼Œ$\frac{\partial P}{\partial \lambda_{i,j}}$ å’Œå­¦ä¹ ç‡ï¼Œ$\eta$ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ

$$ \lambda_{i,j}^{\ell} = \lambda_{i,j}^{\ell - 1} + \eta \cdot \frac{\partial P}{\partial \lambda_{i,j}} $$

1.  **é‡å¤ç›´åˆ°æ”¶æ•›** - è¿”å›æ­¥éª¤ 1ï¼Œç›´åˆ°è¯¯å·®ï¼Œ$P$ï¼Œé™ä½åˆ°å¯æ¥å—çš„æ°´å¹³ï¼Œå³æ¨¡å‹æ”¶æ•›æ˜¯åœæ­¢è¿­ä»£çš„æ¡ä»¶

## åå‘ä¼ æ’­

ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘å»ºè®®æ‚¨å‚è€ƒäººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ï¼Œäº†è§£é€šè¿‡ç¥ç»ç½‘ç»œåå‘ä¼ æ’­è¯¯å·®æ¢¯åº¦çš„è¿‡ç¨‹ã€‚

## æ›´æ–°æ¨¡å‹å‚æ•°

æ¯ä¸ªæ¨¡å‹å‚æ•°çš„å¯¼æ•°æ˜¯è¯¯å·®æ¢¯åº¦ï¼Œå› æ­¤æˆ‘ä»¬å‡†å¤‡å¥½ä½¿ç”¨æ¢¯åº¦ä¸‹é™ä¼˜åŒ–ï¼Œå¹¶æ·»åŠ ï¼Œ

+   **å­¦ä¹ ç‡** - ä¸ºäº†ç¼©æ”¾æ¨¡å‹æ›´æ–°çš„å˜åŒ–ç‡ï¼Œæˆ‘ä»¬åˆ†é…ä¸€ä¸ªå­¦ä¹ ç‡ï¼Œ$\eta$ã€‚å¯¹äºæˆ‘ä»¬ä¸Šé¢çš„æ¨¡å‹å‚æ•°ç¤ºä¾‹ï¼Œ

$$ \lambda_{9,12}^{\ell} = \lambda_{9,12}^{\ell - 1} - \eta \cdot \frac{\partial P}{\partial \lambda_{9,12}} $$$$ \lambda_{10,12}^{\ell} = \lambda_{10,12}^{\ell - 1} - \eta \cdot \frac{\partial P}{\partial \lambda_{10,12}} $$$$ b_{12}^{\ell} = b_{12}^{\ell - 1} + \eta \cdot \frac{\partial P}{\partial b_{12}} $$

+   å›æƒ³ä¸€ä¸‹ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æ¢¯åº¦è®¡ç®—å’Œæ¨¡å‹å‚æ•°ã€æƒé‡å’Œåç½®çš„æ›´æ–°ï¼Œè¿­ä»£å¹¶è¢«ç§°ä¸ºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–ã€‚

+   ç›®æ ‡æ˜¯æ¢ç´¢æŸå¤±è¶…æ›²é¢ï¼Œé¿å…å¹¶é€ƒç¦»å±€éƒ¨æœ€å°å€¼ï¼Œæœ€ç»ˆæ‰¾åˆ°å…¨å±€æœ€å°å€¼ã€‚

+   å­¦ä¹ ç‡ï¼Œä¹Ÿç§°ä¸ºæ­¥é•¿ï¼Œé€šå¸¸è®¾ç½®åœ¨ 0.0 åˆ° 1.0 ä¹‹é—´ï¼Œæ³¨æ„åœ¨ TensorFlow çš„ Keras æ¨¡å—ä¸­é»˜è®¤ä¸º 0.01

+   **ä½å­¦ä¹ ç‡** â€“ æ›´ç¨³å®šï¼Œä½†è§£çš„é€Ÿåº¦è¾ƒæ…¢ï¼Œå¯èƒ½ä¼šé™·å…¥å±€éƒ¨æœ€å°å€¼

+   **é«˜å­¦ä¹ ç‡** â€“ å¯èƒ½ä¸ç¨³å®šï¼Œä½†å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¿«çš„è§£å†³æ–¹æ¡ˆï¼Œå¯èƒ½ä¼šå‘æ•£åˆ°å…¨å±€æœ€å°å€¼ä¹‹å¤–

ä¸€ç§ç­–ç•¥æ˜¯ä»ä¸€ä¸ªé«˜çš„å­¦ä¹ ç‡å¼€å§‹ï¼Œç„¶ååœ¨è¿­ä»£è¿‡ç¨‹ä¸­é€æ¸é™ä½å­¦ä¹ ç‡

+   **å­¦ä¹ ç‡è¡°å‡** - è®¾ç½®ä¸º> 0 ä»¥é¿å…å‡è½»æŒ¯è¡ï¼Œ

## è®­ç»ƒå‘¨æœŸ

ç°åœ¨æ˜¯è®¨è®ºéšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–çš„å¥½æ—¶æœºï¼Œé¦–å…ˆè®©æˆ‘ä»¬å®šä¹‰ä¸€äº›å¸¸è§æœ¯è¯­ï¼Œ

+   **æ‰¹é‡æ¢¯åº¦ä¸‹é™** - åœ¨é€šè¿‡æ‰€æœ‰æ•°æ®åæ›´æ–°æ¨¡å‹å‚æ•°

+   **éšæœºæ¢¯åº¦ä¸‹é™** - åœ¨æ¯ä¸ªæ ·æœ¬æ•°æ®ä¸Šæ›´æ–°æ¨¡å‹å‚æ•°

+   **å°æ‰¹é‡æ¢¯åº¦ä¸‹é™** - åœ¨é€šè¿‡å•ä¸ªæ‰¹æ¬¡åæ›´æ–°æ¨¡å‹å‚æ•°

åœ¨å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ä¸­ï¼Œé€šè¿‡ä½¿ç”¨æ•°æ®å­é›†ï¼Œç§°ä¸ºæ‰¹æ¬¡ï¼Œå¼•å…¥äº†éšæœºæ€§ï¼Œ

+   ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæˆ‘ä»¬çš„ 100 ä¸ªæ ·æœ¬åˆ†æˆ 4 ä¸ªæ‰¹æ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ†åˆ«è¿­ä»£æ¯ä¸ªæ‰¹æ¬¡

+   æˆ‘ä»¬åŠ å¿«äº†å•ä¸ªæ›´æ–°çš„é€Ÿåº¦ï¼Œæ•°æ®æ›´å°‘ï¼Œè®¡ç®—æ›´å¿«ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¼•å…¥äº†æ›´å¤šçš„è¯¯å·®

+   è¿™é€šå¸¸æœ‰åŠ©äºè®­ç»ƒæ¢ç´¢å…¨å±€æœ€å°å€¼ï¼Œå¹¶é¿å…é™·å…¥å±€éƒ¨æœ€å°å€¼å’ŒæŸå¤±è¶…æ›²é¢ä¸Šçš„è„Š

æœ€åï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå®šä¹‰çš„æœ€åä¸€ä¸ªæœ¯è¯­ï¼Œ

+   **epoch** - æ˜¯éå†æ‰€æœ‰æ•°æ®çš„ä¸€æ¬¡ï¼Œå› æ­¤å¦‚æœæœ‰ 4 ä¸ª mini-batchesï¼Œé‚£ä¹ˆæ¨¡å‹å‚æ•°çš„æ›´æ–°å°†ä¼šè¿›è¡Œ 4 æ¬¡è¿­ä»£ã€‚

è¿˜æœ‰è®¸å¤šå…¶ä»–è€ƒè™‘å› ç´ ï¼Œæˆ‘å°†åœ¨ä»¥åæ·»åŠ ï¼ŒåŒ…æ‹¬ï¼Œ

+   åŠ¨é‡

+   è‡ªé€‚åº”ä¼˜åŒ–

ç°åœ¨è®©æˆ‘ä»¬æ‰‹åŠ¨æ„å»ºä¸Šè¿°äººå·¥ç¥ç»ç½‘ç»œå¹¶å¯è§†åŒ–è§£å†³æ–¹æ¡ˆï¼

+   è¿™æ˜¯æ‰‹åŠ¨æ“ä½œï¼Œè¿™æ ·ä½ å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªè®¡ç®—ã€‚æˆ‘æ•…æ„é¿å…ä½¿ç”¨ TensorFlow æˆ– PyTorchã€‚

## ä½¿ç”¨å¤šä¸ªè®­ç»ƒå›¾åƒè¿›è¡Œè®­ç»ƒ

åå‘ä¼ æ’­åŸºäºå•ä¸ªæ ·æœ¬ï¼Œå³è®­ç»ƒå›¾åƒå’Œé…å¯¹çš„å“åº”ç‰¹å¾å€¼ï¼›å› æ­¤ï¼Œè¦è®­ç»ƒå¤šä¸ªå›¾åƒï¼Œæˆ‘ä»¬å¿…é¡»å¾ªç¯éå†å®ƒä»¬ï¼Œ

+   å‰å‘ä¼ æ’­

+   è®¡ç®—è¯¯å·®å¯¼æ•°

+   åå‘ä¼ æ’­

![](img/911e3eed1fd228a0da4716b460c82d38.png)

æ‰¹é‡è®­ç»ƒè¿‡ç¨‹ã€‚

å¯¹äºæ¯ä¸ªå›¾åƒï¼Œå­˜å‚¨æƒé‡å’Œåç½®çš„æ¢¯åº¦ã€‚ç„¶åï¼Œåœ¨æ‰¹æ¬¡çš„å›¾åƒä¸Šå¯¹æ¢¯åº¦è¿›è¡Œæ±‚å’Œï¼Œå¹¶å°†è¿™ä¸ªå’Œä¸å­¦ä¹ ç‡ä¸€èµ·åº”ç”¨ä»¥æ›´æ–°æƒé‡å’Œåç½®ã€‚

## å‰å‘ä¼ æ’­

ä¸ºäº†æ¸…æ™°èµ·è§ï¼Œè®©æˆ‘ä»¬ä»å›¾åƒè¾“å…¥å¼€å§‹éå†å·ç§¯ç¥ç»ç½‘ç»œã€‚

è¾“å…¥èŠ‚ç‚¹æ¥æ”¶ä»å›¾åƒåˆ°å·ç§¯å±‚çš„è¾“å…¥ï¼Œ

+   ä¿ç•™èŠ‚ç‚¹é¡ºåºä»¥ä¿ç•™ä»å›¾åƒä¸­è·å–çš„ç©ºé—´ã€ä½ç½®ä¿¡æ¯ã€‚

å¯¹äºè¿ç»­ç‰¹å¾å›¾åƒï¼Œ

+   è¿ç»­é¢„æµ‹ç‰¹å¾å€¼è¢«å½’ä¸€åŒ–åˆ° [0,1] æˆ– [-1,1]ï¼Œä»¥æ”¹å–„ç‰¹å®šæ¿€æ´»å‡½æ•°çš„çµæ•åº¦ã€‚

+   å¯¹äºå½©è‰²å›¾åƒï¼ŒRGB é€šé“å¯èƒ½æ¯ä¸ªéƒ½è¢«å½’ä¸€åŒ–å¹¶ä½œä¸º 3 ä¸ªè¾“å…¥é€šé“åŒ…å«åœ¨å†…ã€‚

å¯¹äºåˆ†ç±»ç‰¹å¾å›¾åƒï¼Œ

+   å¯¹äºäºŒå…ƒï¼ŒåŸºæ•°ä¸º 2 çš„æƒ…å†µï¼Œå€¼å¯ä»¥é€šè¿‡æŒ‡ç¤ºå˜æ¢é‡æ–°åˆ†é…ä¸º 0 æˆ– 1

+   å¯¹äºåŸºæ•°å¤§äº 2 çš„æƒ…å†µï¼Œå¯èƒ½åº”ç”¨ one-hot-encodingï¼Œä»è€Œäº§ç”Ÿ $k$ ä¸ªè¾“å…¥é€šé“ã€‚

æœ‰å…³è¿™äº›å˜æ¢çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ç‰¹å¾å˜æ¢ç« èŠ‚ã€‚

ç°åœ¨æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå·ç§¯å±‚ï¼ŒåŒ…æ‹¬å·ç§¯å’Œæ¿€æ´»ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„ç‰¹å¾å›¾ã€‚

![](img/02745c4fdecaad32e59683bafa3d0820.png)

é€šè¿‡æ‰‹åŠ¨å·ç§¯ç¥ç»ç½‘ç»œï¼ˆconvolutional neural networkï¼‰çš„éå†ï¼Œé€šè¿‡å·ç§¯å±‚ã€‚

+   æ ¹æ®è¾“å…¥å›¾åƒæˆ–å‰ä¸€ä¸ªç‰¹å¾å›¾çš„æ ¸ï¼ˆkernelï¼‰è¿›è¡Œçº¿æ€§åŠ æƒçš„ç»„åˆï¼Œæ·»åŠ ä¸€ä¸ªåç½®é¡¹ï¼Œç„¶åå¯¹ç»“æœè¿›è¡Œéçº¿æ€§å˜æ¢ï¼Œè¿™ç§å˜æ¢ç§°ä¸ºæ¿€æ´»å‡½æ•°ï¼Œ$\alpha$ã€‚

$$ C_{j_{\text{in}}} = \sum_{i=1}^{n} \left( K_{i+5} \cdot I_{j-8} \right) + b_{conv} $$

å…¶ä¸­ï¼Œ$K_6$ã€$K_7$ å’Œ $K_8$ æ˜¯æ ¸æƒé‡ï¼Œ$b_{conv}$ æ˜¯æ ¸åç½®ï¼Œ$I$ æ˜¯è¾“å…¥èŠ‚ç‚¹ã€‚

è¯·åŸè°…æ–¹ç¨‹ä¸­çš„å¥‡æ€ªç´¢å¼•ï¼Œæˆ‘å–œæ¬¢ä¸ºæ¯ä¸ªèŠ‚ç‚¹ä½¿ç”¨å”¯ä¸€çš„èŠ‚ç‚¹æ•´æ•°ï¼Œä»¥é¿å…åœ¨ç¬”è®°å’Œä»£ç ä¸­æ··æ·†èŠ‚ç‚¹ï¼Œä½†è¿™ç¡®å®ä½¿ç´¢å¼•åˆ†é…å¤æ‚åŒ–ã€‚

$$ C_{9_{\text{in}}} = I_1 \cdot K_6 + I_2 \cdot K_7 + I_3 \cdot K_8 + b_{\text{conv}} $$$$ C_{10_{\text{in}}} = I_2 \cdot K_6 + I_3 \cdot K_7 + I_4 \cdot K_8 + b_{\text{conv}} $$$$ C_{11_{\text{in}}} = I_3 \cdot K_6 + I_4 \cdot K_7 + I_5 \cdot K_8 + b_{\text{conv}} $$

ç„¶åå¯¹æ¯ä¸ªèŠ‚ç‚¹åº”ç”¨éçº¿æ€§æ¿€æ´»ï¼Œ

$$ C_j = \alpha \left( C_{j_{in}} \right) \quad j = 9, \ldots 11 $$

ç°åœ¨æˆ‘ä»¬ä»ç‰¹å¾å›¾é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œåˆ°è¾“å‡ºã€‚

è¿™åªæ˜¯ä¸€ä¸ªæ ‡å‡†çš„å…·æœ‰å±•å¹³ç‰¹å¾å›¾å¹¶å°†å…¶ç§»åŠ¨åˆ°è¾“å‡ºçš„ç®€å•äººå·¥ç¥ç»ç½‘ç»œã€‚

+   åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬å±•ç¤ºäº†æœ€ç®€å•çš„å¯èƒ½çš„äººå·¥ç¥ç»ç½‘ç»œï¼Œå³ç‰¹å¾å›¾ä¹‹åçš„ä¸‹ä¸€å±‚æ˜¯è¾“å‡ºã€‚æ›´å¤æ‚çš„å…·æœ‰éšè—å±‚çš„æ¶æ„é€šå¸¸è¢«åº”ç”¨ã€‚

+   æ­¤å¤–ï¼Œç”±äºæˆ‘ä»¬çš„å›¾åƒæ˜¯ 1D çš„ï¼Œæˆ‘ä»¬ä¸éœ€è¦è¿›è¡Œå±•å¹³æ­¥éª¤

è¾“å‡ºèŠ‚ç‚¹æ˜¯äººå·¥ç¥ç»ç½‘ç»œçš„æ ‡å‡†è¾“å‡ºèŠ‚ç‚¹ï¼Œ

+   è¾“å…¥æ˜¯å‰ä¸€å±‚èŠ‚ç‚¹çš„çº¿æ€§ç»„åˆï¼Œå¹¶æ·»åŠ äº†ä¸€ä¸ªåç½®é¡¹ã€‚

$$ O_{j_{\text{in}}} = \sum_{j=1}^{m} \left( \lambda_{i,j} \cdot H_i \right) + b_j $$

ç„¶ååº”ç”¨ä¸€ä¸ªæ¿€æ´»å‡½æ•°ï¼Œ

$$ O_j = \alpha \left( O_{j_{in}} \right) $$

å¯¹äºå›å½’æ¨¡å‹çš„æƒ…å†µï¼Œå…·æœ‰è¿ç»­å“åº”ç‰¹å¾ï¼Œåº”ç”¨çº¿æ€§æˆ–æ’ç­‰æ¿€æ´»å‡½æ•°ï¼Œ

$$ O_j = \alpha \left( O_{j_{in}} \right) = O_{j_{in}} $$![](img/3becddf21de74c01ec2c585108079e0e.png)

æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œçš„æ‰‹åŠ¨å®ç°è¿‡ç¨‹ï¼Œä»ç‰¹å¾å›¾åˆ°è¾“å‡ºï¼Œç”¨äºè¿ç»­è¾“å‡ºã€‚

å¯¹äºåˆ†ç±»æ¨¡å‹çš„æƒ…å†µï¼Œå…·æœ‰åˆ†ç±»å“åº”ç‰¹å¾ï¼Œåœ¨ç­‰äºå“åº”ç‰¹å¾åŸºæ•°$K$çš„èŠ‚ç‚¹ä¸Šåº”ç”¨ softmax æ¿€æ´»å‡½æ•°ã€‚

+   è¾“å‡ºæ˜¯æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œç¬¦åˆéè´Ÿæ€§å’Œé—­åˆçº¦æŸ

![](img/439615adbac8db26678e58e258f9105f.png)

æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œçš„æ‰‹åŠ¨å®ç°è¿‡ç¨‹ï¼Œä»ç‰¹å¾å›¾åˆ°è¾“å‡ºï¼Œç”¨äºåˆ†ç±»è¾“å‡ºã€‚

$$ O_j = g_k(O_{j_{\text{in}}}) = \frac{e^{O_{j_{\text{in}}}}}{\sum_{\iota=1}^{K} e^{O_{\iota_{\text{in}}}}} $$

## å¯¼å…¥æ‰€éœ€çš„åŒ…

æˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›æ ‡å‡†åŒ…ã€‚è¿™äº›åº”è¯¥å·²ç»ä¸ Anaconda 3 ä¸€èµ·å®‰è£…ã€‚

+   è®°ä½æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰‹åŠ¨æ„å»ºä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œï¼Œåªä½¿ç”¨åŸºæœ¬çš„æ•°å­¦å’Œæ•°ç»„æ“ä½œï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦ NumPy ä»¥åŠ matplotlib è¿›è¡Œç»˜å›¾ã€‚

```py
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from matplotlib.ticker import (MultipleLocator, AutoMinorLocator, AutoLocator) # control of axes ticks
plt.rc('axes', axisbelow=True)                            # set axes and grids in the background for all plots
import math
seed = 13 
```

å¦‚æœæ‚¨é‡åˆ°åŒ…å¯¼å…¥é”™è¯¯ï¼Œæ‚¨å¯èƒ½éœ€è¦é¦–å…ˆå®‰è£…è¿™äº›åŒ…ä¸­çš„ä¸€äº›ã€‚è¿™é€šå¸¸å¯ä»¥é€šè¿‡åœ¨ Windows ä¸Šæ‰“å¼€å‘½ä»¤çª—å£ç„¶åè¾“å…¥â€˜python -m pip install [package-name]â€™æ¥å®Œæˆã€‚æ›´å¤šå¸®åŠ©å¯ä»¥åœ¨ç›¸åº”åŒ…çš„æ–‡æ¡£ä¸­æ‰¾åˆ°ã€‚

## å£°æ˜å‡½æ•°

è¿™é‡Œæ˜¯åˆ›å»ºã€è®­ç»ƒå’Œå¯è§†åŒ–æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œçš„å‡½æ•°ã€‚

```py
def add_grid():
    plt.gca().grid(True, which='major',linewidth = 1.0); plt.gca().grid(True, which='minor',linewidth = 0.2) # add y grids
    plt.gca().tick_params(which='major',length=7); plt.gca().tick_params(which='minor', length=4)
    plt.gca().xaxis.set_minor_locator(AutoMinorLocator()); plt.gca().yaxis.set_minor_locator(AutoMinorLocator()) # turn on minor ticks 

def calculate_angle_rads(x1, y1, x2, y2):
    dx = x2 - x1     # Calculate the differences
    dy = y2 - y1
    angle_rads = math.atan2(dy, dx)    # Calculate the angle in radians
    #angle_degrees = math.degrees(angle_radians)    # Convert the angle to degrees
    return angle_rads

def offset(pto, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = pto[0] + distance * math.cos(angle_rads) # Calculate the new coordinates
    y_new = pto[1] + distance * math.sin(angle_rads)
    return np.array((x_new, y_new))

def offsetx(xo, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates
    return np.array((xo, x_new))

def offset_arrx(xo, distance, angle_deg,size): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates
    x_arr = x_new + size * math.cos(angle_rads+2.48) # Calculate the new coordinates
    return np.array((x_new, x_arr))

def offsety(yo, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates
    return np.array((yo, y_new))

def offset_arry(yo, distance, angle_deg,size): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates
    y_arr = y_new + size * math.sin(angle_rads+2.48) # Calculate the new coordinates
    return np.array((y_new, y_arr))

def lint(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    x = x1 + t * (x2 - x1)
    y = y1 + t * (y2 - y1)
    return np.array((x, y))

def lintx(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    x = x1 + t * (x2 - x1)
    return x

def linty(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    y = y1 + t * (y2 - y1)
    return y

def lint_intx(x1, y1, x2, y2, ts, te):
    # Calculate the interpolated coordinates
    xs = x1 + ts * (x2 - x1)
    xe = x1 + te * (x2 - x1)
    return np.array((xs,xe))

def lint_inty(x1, y1, x2, y2, ts, te):
    # Calculate the interpolated coordinates
    ys = y1 + ts * (y2 - y1)
    ye = y1 + te * (y2 - y1)
    return np.array((ys,ye))

def lint_int_arrx(x1, y1, x2, y2, ts, te, size):
    # Calculate the interpolated coordinates
    xe = x1 + te * (x2 - x1)
    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)
    x_arr = xe + size * math.cos(line_angle_rads+2.48) # Calculate the new coordinates
    return np.array((xe,x_arr))

def lint_int_arry(x1, y1, x2, y2, ts, te, size):
    # Calculate the interpolated coordinates
    ye = y1 + te * (y2 - y1)
    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)
    y_arr = ye + size * math.sin(line_angle_rads+2.48) # Calculate the new coordinates
    return np.array((ye,y_arr))

def as_si(x, ndp): # from xnx on StackOverflow https://stackoverflow.com/questions/31453422/displaying-numbers-with-x-instead-of-e-scientific-notation-in-matplotlib 
    s = '{x:0.{ndp:d}e}'.format(x=x, ndp=ndp)
    m, e = s.split('e')
    return r'{m:s}\times 10^{{{e:d}}}'.format(m=m, e=int(e)) 
```

## ç®€å•çš„æ‰‹åŠ¨ CNN

æˆ‘ç¼–å†™äº†è¿™æ®µä»£ç æ¥æŒ‡å®šä¸€ä¸ªç®€å•çš„ CNNï¼Œ

+   äº”ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œ1 ä¸ªå…·æœ‰ 3 ä¸ªæ ¸çš„å·ç§¯å±‚ï¼Œåœ¨ç‰¹å¾å›¾ä¸­äº§ç”Ÿ 3 ä¸ªèŠ‚ç‚¹å’Œ 1 ä¸ªè¾“å‡ºèŠ‚ç‚¹

å¹¶é€šè¿‡è¿­ä»£æ‰§è¡Œå‰å‘è®¡ç®—å’Œåå‘ä¼ æ’­æ¥è®­ç»ƒ CNNã€‚æˆ‘è®¡ç®—ï¼š

+   ç„¶åä¼ æ’­é”™è¯¯åˆ°æ¯ä¸ªèŠ‚ç‚¹

+   æ±‚è§£è¯¯å·®ç›¸å¯¹äºæ¯ä¸ªæƒé‡å’Œåç½®çš„åå¯¼æ•°

æ‰€æœ‰æƒé‡ã€åç½®å’Œæ‰€æœ‰ epoch çš„åå¯¼æ•°éƒ½è®°å½•åœ¨å‘é‡ä¸­ä»¥ä¾¿ç»˜å›¾

```py
# initial CNN trains on one sample
x1 = 0.1; x2 = 0.2; x3 = 0.3; x4 = 0.4; x5 = 0.5; y = 0.1 # training data
lr = 0.2 # learning rate

np.random.seed(seed=seed)

nepoch = 1000

w6 = np.zeros(nepoch); w7 = np.zeros(nepoch); w8 = np.zeros(nepoch)
w9 = np.zeros(nepoch); w10 = np.zeros(nepoch); w11 = np.zeros(nepoch)
bconv = np.zeros(nepoch); b12 = np.zeros(nepoch)

k6i1 = np.zeros(nepoch); k6i2 = np.zeros(nepoch); k6i3 = np.zeros(nepoch)
k7i2 = np.zeros(nepoch); k7i3 = np.zeros(nepoch); k7i4 = np.zeros(nepoch)
k8i3 = np.zeros(nepoch); k8i4 = np.zeros(nepoch); k8i5 = np.zeros(nepoch)

dk6i1 = np.zeros(nepoch); dk6i2 = np.zeros(nepoch); dk6i3 = np.zeros(nepoch)
dk7i2 = np.zeros(nepoch); dk7i3 = np.zeros(nepoch); dk7i4 = np.zeros(nepoch)
dk8i3 = np.zeros(nepoch); dk8i4 = np.zeros(nepoch); dk8i5 = np.zeros(nepoch)

c9 = np.zeros(nepoch); c10 = np.zeros(nepoch); c11 = np.zeros(nepoch)
d9 = np.zeros(nepoch); d10 = np.zeros(nepoch); d11 = np.zeros(nepoch)

o12 = np.zeros(nepoch)

dw6 = np.zeros(nepoch); dw7 = np.zeros(nepoch); dw8 = np.zeros(nepoch)
dw9 = np.zeros(nepoch); dw10 = np.zeros(nepoch); dw11 = np.zeros(nepoch)
dbconv = np.zeros(nepoch); db12 = np.zeros(nepoch)

d6 = np.zeros(nepoch); d7 = np.zeros(nepoch); d8 = np.zeros(nepoch); 
d19 = np.zeros(nepoch); d10 = np.zeros(nepoch); d11 = np.zeros(nepoch); d12 = np.zeros(nepoch); 

# initialize the weights - Xavier Weight Initialization 
lower, upper = -(1.0 / np.sqrt(3.0)), (1.0 / np.sqrt(3.0)) # lower and upper bound for the weights, uses inputs to node
#lower, upper = -(sqrt(6.0) / sqrt(3.0 + 2.0)), (sqrt(6.0) / sqrt(3.0 + 2.0)) # Normalized Xavier weights, integrates ouputs also
w6[0] = lower + np.random.random() * (upper - lower); 
w7[0] = lower + np.random.random() * (upper - lower); 
w8[0] = lower + np.random.random() * (upper - lower);

lower, upper = -(1.0 / np.sqrt(2.0)), (1.0 / np.sqrt(2.0))
#lower, upper = -(sqrt(6.0) / sqrt(2.0 + 1.0)), (sqrt(6.0) / sqrt(2.0 + 1.0)) # Normalized Xavier weights, integrates ouputs also

w9[0] = lower + np.random.random() * (upper - lower); 
w10[0] = lower + np.random.random() * (upper - lower);     
w11[0] = lower + np.random.random() * (upper - lower);     

#b4[0] = np.random.random(); b5[0] = np.random.random(); b6[0] = np.random.random()
bconv[0] = (np.random.random()-0.5)*0.5
b12[0] = (np.random.random()-0.5)*0.5; # small random value 

for i in range(0,nepoch):

# forward pass of model
    c9[i] = w6[i]*x1 + w7[i]*x2 + w8[i]*x3 + bconv[i]; 
    c9[i] = 1.0/(1 + math.exp(-1*c9[i]))

    c10[i] = w6[i]*x2 + w7[i]*x3 + w8[i]*x4 + bconv[i]; 
    c10[i] = 1.0/(1 + math.exp(-1*c10[i]))

    c11[i] = w6[i]*x3 + w7[i]*x4 + w8[i]*x5 + bconv[i]; 
    c11[i] = 1.0/(1 + math.exp(-1*c11[i]))

    o12[i] = w9[i]*c9[i] + w10[i]*c10[i] + w11[i]*c11[i] + b12[i]

# back propagate the error through the nodes
    d12[i] = (o12[i]-y) # identity activation o at o12 - switched substraction on May 27, 2025
    d9[i] =  c9[i]*(1-c9[i])*w9[i]*d12[i]   # propagate to the front feature map layer
    d10[i] = c10[i]*(1-c10[i])*w10[i]*d12[i]
    d11[i] = c11[i]*(1-c11[i])*w11[i]*d12[i]

    dk6i1 = x1*d9[i]; dk7i2 = x2*d9[i]; dk8i3 = x3*d9[i] 
    dk6i2 = x2*d10[i]; dk7i3 = x3*d10[i]; dk8i4 = x4*d10[i] 
    dk6i3 = x3*d11[i]; dk7i4 = x4*d11[i]; dk8i5 = x5*d11[i] 

    d6[i] = dk6i1 + dk6i2 + dk6i3
    d7[i] = dk7i2 + dk7i3 + dk7i4
    d8[i] = dk8i3 + dk8i4 + dk8i5

# calculate the change in weights
    if i < nepoch - 1:
        dw6[i] = lr*d6[i]; dw7[i] = lr*d7[i]; dw8[i] = lr*d8[i]
        dw9[i] = lr*c9[i]*d12[i]; dw10[i] = lr*c10[i]*d12[i]; dw11[i] = lr*c11[i]*d12[i];
        dbconv[i] = lr*(d9[i] + d10[i] + d11[i]); db12[i] = lr*d12[i]

        w6[i+1] = w6[i] - dw6[i]; w7[i+1] = w7[i] - dw7[i]; w8[i+1] = w8[i] - dw8[i]
        w9[i+1] = w9[i] - dw9[i]; w10[i+1] = w10[i] - dw10[i]; w11[i+1] = w11[i] - dw11[i]
        bconv[i+1] = bconv[i] - dbconv[i]; b12[i+1] = b12[i] - db12[i] 
```

## æ‰‹åŠ¨å¯è§†åŒ– CNN

è®©æˆ‘ä»¬å¯è§†åŒ–æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œã€‚

+   æ³¨æ„ï¼Œæˆ‘å°†åœ¨ä»¥åä½¿ç”¨æ­¤ä»£ç åˆ¶ä½œäº¤äº’å¼ä»ªè¡¨æ¿ã€‚

```py
xin = 0.1; yin_range = 0.7
nin = 5

kcolors = ['red','blue','green']
xin = np.array([0.1,0.2,0.3,0.4,0.5])
yout = np.array([y])
cin = np.array([0.1,0.2,0.3])
kx = 0.6

plt.subplot(111)
#plt.gca().set_axis_off()

for i, (xi) in enumerate(zip(xin), start=1):
    eq1 = r"$X_{{{}}}$".format(i)
    eq2 = r"$X_{{{}}} = {}$".format(i, xi[0])
    eq3 = r"$I_{{{}}}$".format(i)
    xpos = 0.4; ypos = yin_range - ((i-1)/nin) * yin_range 
    circle_i1 = plt.Circle((xpos,ypos), 0.015, fill=False, edgecolor = 'black',lw=1,zorder=100); 
    circle_i1b = plt.Circle((xpos,ypos), 0.025, fill=True, facecolor = 'white',edgecolor = None,lw=0.5,zorder=10);
    plt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)
    plt.annotate(eq1, (xpos-0.2, ypos), textcoords="offset points", xytext=(-12, -3), ha='center',size=15)
    plt.annotate(eq2, (xpos, ypos), textcoords="offset points", xytext=(-70, 9), ha='center')
    plt.plot([xpos-0.2,xpos],[ypos,ypos],color='black',lw=2); plt.plot([xpos-0.2,xpos-0.07],[ypos+0.01,ypos+0.01],color='black',lw=2)
    plt.plot([xpos-0.07,xpos-0.08],[ypos+0.01,ypos+0.02],color='black',lw=2)
    plt.annotate(eq3, (xpos,ypos), textcoords="offset points", xytext=(-15, 15), ha='center',size = 15)

for iconv in range(0,3):  
    xpos = kx+iconv*0.2;
    ytop = yin_range - (iconv/nin)*yin_range - ((1-1)/nin) * yin_range
    ybot = yin_range - (iconv/nin)*yin_range - ((3-1)/nin) * yin_range  
    plt.plot([xpos+0.12,xpos+0.12],[ytop+0.005,ybot+0.005],color='red',lw=1,ls='--',zorder=80)
    for ik, (ki) in enumerate(zip(np.arange(1,4,1)), start=1):
        eq4 = r"$K_{{{}}}$".format(ik+5)
        ypos = yin_range - (iconv/nin)*yin_range - ((ik-1)/nin) * yin_range
        circle_i1 = plt.Circle((xpos,ypos), 0.015, fill=True, facecolor = kcolors[ik-1],edgecolor = 'black',lw=1,zorder=200);
        circle_i1b = plt.Circle((xpos,ypos), 0.025, fill=True, facecolor='white',edgecolor = None,lw=0.5,zorder=190);
        plt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)
        plt.annotate(eq4, (xpos,ypos), textcoords="offset points", xytext=(-15, 15), ha='center',size = 15)
        plt.plot([0.4,xpos],[ypos,ypos],color='black',lw=1,zorder=1)
        plt.plot([xpos,xpos+0.12],[ypos+0.005,ypos+0.005],color='red',lw=1,ls='--',zorder=80)
        eq8 = r"$I_{{{}}} \cdot K_{{{}}}$".format((iconv)+ik,ik+5)        
        plt.annotate(eq8, (xpos+0.12, ypos), textcoords="offset points", xytext=(-25, 5), ha='center',size = 10)

for ic, (ci) in enumerate(zip(np.arange(1,4,1)), start=1):
    eq5 = r"$C_{{{}}}$".format(ic+8)
    xpos = 1.2; ypos = yin_range - ((ic-1)/4) * yin_range - 0.07
    circle_i1 = plt.Circle((xpos,ypos), 0.015, fill=True, facecolor = 'gold',edgecolor = 'black',lw=1,zorder=200);
    circle_i1b = plt.Circle((xpos,ypos), 0.025, fill=True, facecolor='white',edgecolor = None,lw=0.5,zorder=190);
    plt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)
    plt.annotate(eq5, (xpos,ypos), textcoords="offset points", xytext=(-15, 15), ha='center',size = 15)
    #plt.plot([0.4,x],[y,y],color='black',lw=1,zorder=1)
    plt.plot([xpos,1.5],[ypos,yin_range - ((2-1)/4) * yin_range - 0.07],color='black',lw=1)
    plt.plot([kx+(ic-1)*0.2+0.12,xpos],[ypos,ypos],color='red',lw=1,ls='--',zorder=80)

eq6 = r"$O_{{{}}}$".format(12)
eq7 = r"$Y_{{{}}} = {}$".format(i, np.round(yout[0],2))
xpos = 1.5; ypos = yin_range - ((2-1)/4) * yin_range - 0.07
circle_i1 = plt.Circle((xpos,ypos), 0.015, fill=True, facecolor = 'gold',edgecolor = 'black',lw=1,zorder=200);
circle_i1b = plt.Circle((xpos,ypos), 0.025, fill=True, facecolor='white',edgecolor = None,lw=0.5,zorder=190);
plt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)
plt.annotate(eq6, (xpos, ypos), textcoords="offset points", xytext=(-15, 15), ha='center',size = 15)
plt.annotate(eq7, (xpos, ypos), textcoords="offset points", xytext=(130,-4), ha='center',size = 15)
plt.plot([xpos,xpos+0.2],[ypos,ypos],color='black',lw=2); plt.plot([xpos,xpos+0.13],[ypos+0.01,ypos+0.01],color='black',lw=2)
plt.plot([xpos+0.13,xpos+0.12],[ypos+0.01,ypos+0.02],color='black',lw=2)
plt.annotate(eq6, (xpos, ypos), textcoords="offset points", xytext=(20, 10), ha='center')

plt.xlim([0.,2.]); plt.ylim([0,1])

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=1.3, wspace=0.2, hspace=0.2); plt.show() 
```

![_images/bd6f0d76fef9a0c1d4062d2fed4028a098a6ba3f59c0dff50e67370b90502ba7.png](img/0b3e6b1109144cd7a0b01bc9d699e751.png)

ç°åœ¨æˆ‘ä»¬å¯ä»¥å¯è§†åŒ–æ¨¡å‹è®­ç»ƒç»“æœï¼ŒåŒ…æ‹¬ï¼Œ

+   æƒé‡å’Œåå·®ä¸è®­ç»ƒè½®æ•°

+   CNN é¢„æµ‹ä¸è®­ç»ƒè½®æ•°

```py
plt.subplot(221)
plt.plot(np.arange(1,nepoch+1,1),o12,color='red',label=r'$\hat{y}$'); plt.xlim([1,nepoch]); plt.ylim([0,1])
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - Prediction')
plt.plot([1,nepoch],[y,y],color='black',ls='--'); plt.vlines(400,-1.5,1.5,color='black')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(222)
plt.plot(np.arange(1,nepoch+1,1),w6,color='lightcoral',label = r'$k_6$') 
plt.plot(np.arange(1,nepoch+1,1),w7,color='red',label = r'$k_7$') 
plt.plot(np.arange(1,nepoch+1,1),w8,color='darkred',label = r'$k_8$') 
plt.plot(np.arange(1,nepoch+1,1),bconv,color='dodgerblue',label = r'$b_0$') 
# plt.plot(np.arange(1,nepoch+1,1),w25,color='blue',label = r'$\lambda_{2,5}$') 
# plt.plot(np.arange(1,nepoch+1,1),w35,color='darkblue',label = r'$\lambda_{3,5}$')
# plt.plot(np.arange(1,nepoch+1,1),w46,color='orange',label = r'$\lambda_{4,6}$')
# plt.plot(np.arange(1,nepoch+1,1),w56,color='darkorange',label = r'$\lambda_{5,6}$')
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - Kernel')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(223)
plt.plot(np.arange(1,nepoch+1,1),w9,color='lightgreen',label = r'$\lambda_{9}$') 
plt.plot(np.arange(1,nepoch+1,1),w10,color='green',label = r'$\lambda_{10}$') 
plt.plot(np.arange(1,nepoch+1,1),w11,color='darkgreen',label = r'$\lambda_{11}$') 
plt.plot(np.arange(1,nepoch+1,1),b12,color='darkgreen',label = r'$b_{12}$') 
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - ANN Weights')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=2.1, wspace=0.2, hspace=0.2); plt.show() 
```

![_images/4cea6b946d67f8e2cb6605415803c148ac63ebfb43f8034a7285880405bb88d3.png](img/7dcc0007f13a7312fec3085ca24fbf79.png)

å½“ç„¶ï¼Œä¸Šè¿°ç»“æœå¹¶ä¸éå¸¸å®ç”¨ï¼Œå®é™…ä¸Šæˆ‘ä»¬éœ€è¦æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œé€šè¿‡å­¦ä¹ è®¸å¤šå›¾åƒæ¥æ³›åŒ–ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸Šé¢æ¼”ç¤ºçš„ 1 ä¸ªã€‚è®©æˆ‘ä»¬ï¼Œ

+   åˆ¶ä½œä¸€ç³»åˆ—å¸¦æœ‰æ ‡ç­¾çš„åˆæˆå›¾åƒæ•°æ®

+   å°†æ‰¹é‡è®­ç»ƒæ–¹æ³•åº”ç”¨äºè®­ç»ƒè¿™ä¸ªè®­ç»ƒå›¾åƒé›†åˆã€‚

## åˆ¶ä½œå¸¦æœ‰æ ‡ç­¾çš„åˆæˆè®­ç»ƒå›¾åƒ

ä»¥ä¸‹ä»£ç ç”Ÿæˆå…·æœ‰å¯å˜æ–œç‡å’ŒåŠ æ€§å™ªå£°çš„ 5 ä¸ªç‚¹çš„éšæœºé…ç½®ï¼Œç„¶åä¿ç•™æ•°æ®çš„æ–œç‡çº¿æ€§å›å½’æ¨¡å‹ä½œä¸ºæ ‡ç­¾ã€‚

å·¥ä½œæµç¨‹åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼Œ

1.  ç”»ä¸€ä¸ªéšæœºæ–œç‡ï¼Œ$m^{\ell} \sim U\left[-2.0,2.0\right]$

1.  åœ¨å€¼çš„ä¸­é—´é‡‡æ · 5 ä¸ªå€¼

$$ Z^{\ell} = \left(x-2.5\right)*m^{\ell} $$

1.  å‘å€¼æ·»åŠ éšæœºè¯¯å·®ï¼Œ$\epsilon \sim U\left[-\Delta,\Delta\right]$

\ Z_{\epsilon}^{\ell} = \left(x-2.5\right)*m^{\ell} + U^{-1}\left[-\Delta,\Delta\right \]

1.  è®¡ç®—çº¿æ€§å›å½’æ¨¡å‹æ–œç‡ä»¥ä¿ç•™ä½œä¸ºå“åº”ç‰¹å¾

$$ m = \frac{<Z_{\epsilon}^{\ell} \cdot x>}{<x \cdot x>} $$

```py
np.random.seed(seed = seed+1)
nsample = 10; nnodes = 5; delta = 0.3
ymat = np.zeros(nsample); x = np.arange(1,nnodes+1,1); Xmat = np.zeros([nsample,nnodes])
for isample in range(0,nsample):
    m = np.random.uniform(low = -2.0, high = 2.0)
    Xmat[isample] = (x-3.0)*m+ np.random.uniform(low=-delta,high=delta,size=nnodes)
    ymat[isample] = np.dot(x, Xmat[isample]) / np.dot(x, x)

isample = 9
plt.subplot(111)
for isample in range(0,nsample):
    plt.scatter(x,Xmat[isample],edgecolor='black',lw=1,zorder=10)
    plt.plot(x,Xmat[isample],lw=1,zorder=1)
    custom_positions = [1,2,3,4,5,5.2]
    custom_labels = ['1','2','3','4','5','Y']
    plt.annotate(np.round(ymat[isample],2),[5.2,Xmat[isample][-1]],size=8,color='black',ha='left')
    plt.gca().set_xticks(custom_positions); plt.gca().set_xticklabels(custom_labels)
    plt.xlim([0.5,5.5]); plt.ylim([-4.5,4.5]); plt.xlabel('index'); plt.ylabel('z'); add_grid(); plt.title('Synthetic 1D Images and Labels')

plt.subplots_adjust(left=0.0, bottom=0.0, right=1.0, top=1.1, wspace=0.2, hspace=0.2); plt.show() 
```

![_images/60bea9aeec98af43e38abc10f6ce1302ee8c10ff095a8bfdef8fb4231fc1be32.png](img/e763c68a0e61054a9b3854f895c7ec02.png)

## åœ¨è®¸å¤šè®­ç»ƒå›¾åƒä¸Šè®­ç»ƒç®€å•çš„ CNN

æˆ‘ä¿®æ”¹äº†ä¸Šé¢çš„ä»£ç ï¼Œä½¿å…¶åœ¨è®­ç»ƒå›¾åƒæ‰¹æ¬¡ä¸Šå¾ªç¯ï¼Œç´¯åŠ è¯¯å·®æ¢¯åº¦ï¼Œå¹¶åœ¨æ¯ä¸ªè®­ç»ƒè½®æ•°æ›´æ–°æ‰€æœ‰æƒé‡å’Œåå·®ã€‚

```py
np.random.seed(seed=seed)                                     # CNN trains over multiple samples

lr = 0.2                                                 # learning rate
nepoch = 1000                                    # number of training epochs

w6 = np.zeros(nepoch); w7 = np.zeros(nepoch); w8 = np.zeros(nepoch)  # initialize the CNN weights
w9 = np.zeros(nepoch); w10 = np.zeros(nepoch); w11 = np.zeros(nepoch)
bconv = np.zeros(nepoch); b12 = np.zeros(nepoch)

k6i1 = np.zeros(nepoch); k6i2 = np.zeros(nepoch); k6i3 = np.zeros(nepoch)
k7i2 = np.zeros(nepoch); k7i3 = np.zeros(nepoch); k7i4 = np.zeros(nepoch)
k8i3 = np.zeros(nepoch); k8i4 = np.zeros(nepoch); k8i5 = np.zeros(nepoch)

dk6i1 = np.zeros(nepoch); dk6i2 = np.zeros(nepoch); dk6i3 = np.zeros(nepoch)
dk7i2 = np.zeros(nepoch); dk7i3 = np.zeros(nepoch); dk7i4 = np.zeros(nepoch)
dk8i3 = np.zeros(nepoch); dk8i4 = np.zeros(nepoch); dk8i5 = np.zeros(nepoch)

c9 = np.zeros(nepoch); c10 = np.zeros(nepoch); c11 = np.zeros(nepoch)
d9 = np.zeros(nepoch); d10 = np.zeros(nepoch); d11 = np.zeros(nepoch)

o12 = np.zeros(nepoch); yhat = np.zeros((nepoch,nsample))

dw6 = np.zeros((nepoch,nsample)); dw7 = np.zeros((nepoch,nsample)); dw8 = np.zeros((nepoch,nsample))
dw9 = np.zeros((nepoch,nsample)); dw10 = np.zeros((nepoch,nsample)); dw11 = np.zeros((nepoch,nsample))
dbconv = np.zeros((nepoch,nsample)); db12 = np.zeros((nepoch,nsample))

d6 = np.zeros(nepoch); d7 = np.zeros(nepoch); d8 = np.zeros(nepoch); 
d19 = np.zeros(nepoch); d10 = np.zeros(nepoch); d11 = np.zeros(nepoch); d12 = np.zeros(nepoch); 

# initialize the weights - Xavier Weight Initialization 
lower, upper = -(1.0 / np.sqrt(3.0)), (1.0 / np.sqrt(3.0)) # lower and upper bound for the weights, uses inputs to node
#lower, upper = -(sqrt(6.0) / sqrt(3.0 + 2.0)), (sqrt(6.0) / sqrt(3.0 + 2.0)) # Normalized Xavier weights, integrates ouputs also
w6[0] = lower + np.random.random() * (upper - lower); 
w7[0] = lower + np.random.random() * (upper - lower); 
w8[0] = lower + np.random.random() * (upper - lower);

lower, upper = -(1.0 / np.sqrt(2.0)), (1.0 / np.sqrt(2.0))
#lower, upper = -(sqrt(6.0) / sqrt(2.0 + 1.0)), (sqrt(6.0) / sqrt(2.0 + 1.0)) # Normalized Xavier weights, integrates ouputs also

w9[0] = lower + np.random.random() * (upper - lower); 
w10[0] = lower + np.random.random() * (upper - lower);     
w11[0] = lower + np.random.random() * (upper - lower);     

#b4[0] = np.random.random(); b5[0] = np.random.random(); b6[0] = np.random.random()
bconv[0] = (np.random.random()-0.5)*0.5
b12[0] = (np.random.random()-0.5)*0.5; # small random value 

for i in range(0,nepoch):
    for isample in range(0,nsample):
        x1, x2, x3, x4, x5 = Xmat[isample]; y = ymat[isample]

        # forward pass of model
        c9[i] = w6[i]*x1 + w7[i]*x2 + w8[i]*x3 + bconv[i]; 
        c9[i] = 1.0/(1 + math.exp(-1*c9[i]))

        c10[i] = w6[i]*x2 + w7[i]*x3 + w8[i]*x4 + bconv[i]; 
        c10[i] = 1.0/(1 + math.exp(-1*c10[i]))

        c11[i] = w6[i]*x3 + w7[i]*x4 + w8[i]*x5 + bconv[i]; 
        c11[i] = 1.0/(1 + math.exp(-1*c11[i]))

        o12[i] = w9[i]*c9[i] + w10[i]*c10[i] + w11[i]*c11[i] + b12[i]
        yhat[i,isample] = o12[i]

# back propagate the error through the nodes
        d12[i] = (o12[i]-y) # identity activation o at o12 - switched substraction on May 27, 2025
        d9[i] =  c9[i]*(1-c9[i])*w9[i]*d12[i]   # propagate to the front feature map layer
        d10[i] = c10[i]*(1-c10[i])*w10[i]*d12[i]
        d11[i] = c11[i]*(1-c11[i])*w11[i]*d12[i]

        dk6i1 = x1*d9[i]; dk7i2 = x2*d9[i]; dk8i3 = x3*d9[i] 
        dk6i2 = x2*d10[i]; dk7i3 = x3*d10[i]; dk8i4 = x4*d10[i] 
        dk6i3 = x3*d11[i]; dk7i4 = x4*d11[i]; dk8i5 = x5*d11[i] 

        d6[i] = dk6i1 + dk6i2 + dk6i3
        d7[i] = dk7i2 + dk7i3 + dk7i4
        d8[i] = dk8i3 + dk8i4 + dk8i5

# calculate the change in weights
        if i < nepoch - 1:
            dw6[i,isample] = lr*d6[i]; dw7[i,isample] = lr*d7[i]; dw8[i,isample] = lr*d8[i]
            dw9[i,isample] = lr*c9[i]*d12[i]; dw10[i,isample] = lr*c10[i]*d12[i]; dw11[i,isample] = lr*c11[i]*d12[i];
            dbconv[i,isample] = lr*(d9[i] + d10[i] + d11[i]); db12[i,isample] = lr*d12[i]
    if i < nepoch - 1:
        w6[i+1] = w6[i] - np.average(dw6[i]); w7[i+1] = w7[i] - np.average(dw7[i]); w8[i+1] = w8[i] - np.average(dw8[i])
        w9[i+1] = w9[i] - np.average(dw9[i]); w10[i+1] = w10[i] - np.average(dw10[i]); w11[i+1] = w11[i] - np.average(dw11[i])
        bconv[i+1] = bconv[i] - np.average(dbconv[i]); b12[i+1] = b12[i] - np.average(db12[i]) 
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥å†æ¬¡å¯è§†åŒ–æ¨¡å‹æ€§èƒ½ï¼Œ

+   æ‰€æœ‰è®­ç»ƒå›¾åƒçš„é¢„æµ‹ä¸è®­ç»ƒè½®æ•°

+   æ¨¡å‹æƒé‡å’Œåå·®ä¸è®­ç»ƒè½®æ•°

```py
plt.subplot(221)
for isample in range(0,nsample):
    plt.plot(np.arange(1,nepoch+1,1),yhat[:,isample],color=plt.cm.inferno(isample/nsample),label=r'y' + str(isample))
    plt.plot([0,nepoch],[ymat[isample],ymat[isample]],color=plt.cm.inferno(isample/nsample),ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1,1])
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - Prediction')
plt.vlines(400,-1.5,1.5,color='black')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(222)
plt.plot(np.arange(1,nepoch+1,1),w6,color='lightcoral',label = r'$k_6$') 
plt.plot(np.arange(1,nepoch+1,1),w7,color='red',label = r'$k_7$') 
plt.plot(np.arange(1,nepoch+1,1),w8,color='darkred',label = r'$k_8$') 
plt.plot(np.arange(1,nepoch+1,1),bconv,color='dodgerblue',label = r'$b_0$') 
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - Kernel')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(223)
plt.plot(np.arange(1,nepoch+1,1),w9,color='lightgreen',label = r'$\lambda_{9}$') 
plt.plot(np.arange(1,nepoch+1,1),w10,color='green',label = r'$\lambda_{10}$') 
plt.plot(np.arange(1,nepoch+1,1),w11,color='darkgreen',label = r'$\lambda_{11}$') 
plt.plot(np.arange(1,nepoch+1,1),b12,color='darkgreen',label = r'$b_{12}$') 
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - ANN Weights')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=2.1, wspace=0.2, hspace=0.2); plt.show() 
```

![_images/ba623428124e0113a09fcf1b71bb1dacaf21bee4f296116c527e30bf0e957edb.png](img/e175db3feac32085e697870180f28aab.png)

## æ³¨é‡Š

è¿™æ˜¯å¯¹å·ç§¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬å¤„ç†ã€‚å¯ä»¥åšå’Œè®¨è®ºçš„è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘æœ‰å¾ˆå¤šæ›´å¤šçš„èµ„æºã€‚æŸ¥çœ‹æˆ‘çš„[å…±äº«èµ„æºæ¸…å•](https://michaelpyrcz.com/my-resources)ä»¥åŠæœ¬ç« å¼€å¤´çš„ YouTube è®²åº§é“¾æ¥ï¼Œè§†é¢‘æè¿°ä¸­åŒ…å«èµ„æºé“¾æ¥ã€‚

æˆ‘å¸Œæœ›è¿™æœ‰æ‰€å¸®åŠ©ï¼Œ

*è¿ˆå…‹å°”*

## å…³äºä½œè€…

![](img/eb709b2c0a0c715da01ae0165efdf3b2.png)

å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ 40 è‹±äº©æ ¡å›­å†…è¿ˆå…‹å°”Â·çš®å°”èŒ¨æ•™æˆçš„åŠå…¬å®¤ã€‚

è¿ˆå…‹å°”Â·çš®å°”å¥‡å…¹æ˜¯[å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡çš„ Cockrell å·¥ç¨‹å­¦é™¢](https://cockrell.utexas.edu/faculty-directory/alphabetical/p)å’Œ[æ°å…‹é€Šåœ°çƒç§‘å­¦å­¦é™¢](https://www.jsg.utexas.edu/researcher/michael_pyrcz/)çš„æ•™æˆï¼Œä»–åœ¨[å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡](https://www.utexas.edu/)ç ”ç©¶å¹¶æ•™æˆåœ°ä¸‹ã€ç©ºé—´æ•°æ®åˆ†æã€åœ°ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ã€‚è¿ˆå…‹å°”è¿˜æ˜¯ï¼Œ

+   [èƒ½æºåˆ†æ](https://fri.cns.utexas.edu/energy-analytics)æ–°ç”Ÿç ”ç©¶é¡¹ç›®çš„é¦–å¸­ç ”ç©¶å‘˜ï¼Œä»¥åŠå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡è‡ªç„¶ç§‘å­¦é™¢æœºå™¨å­¦ä¹ å®éªŒå®¤çš„æ ¸å¿ƒæ•™å‘˜ã€‚

+   [ã€Šè®¡ç®—æœºä¸åœ°çƒç§‘å­¦ã€‹](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board)çš„å‰¯ç¼–è¾‘ï¼Œä»¥åŠå›½é™…æ•°å­¦åœ°çƒç§‘å­¦åä¼š[ã€Šæ•°å­¦åœ°çƒç§‘å­¦ã€‹](https://link.springer.com/journal/11004/editorial-board)çš„è‘£äº‹ä¼šæˆå‘˜ã€‚

è¿ˆå…‹å°”å·²ç»æ’°å†™äº†è¶…è¿‡ 70 ç¯‡[åŒè¡Œè¯„å®¡çš„å‡ºç‰ˆç‰©](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en)ï¼Œä¸€ä¸ªç”¨äºç©ºé—´æ•°æ®åˆ†æçš„[Python åŒ…](https://pypi.org/project/geostatspy/)ï¼Œåˆè‘—äº†ä¸€æœ¬å…³äºç©ºé—´æ•°æ®åˆ†æçš„æ•™ç§‘ä¹¦ã€Š[åœ°ç»Ÿè®¡å­¦å‚¨å±‚å»ºæ¨¡](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)ã€‹ï¼Œå¹¶ä¸”æ˜¯ä¸¤æœ¬è¿‘æœŸå‘å¸ƒçš„ç”µå­ä¹¦çš„ä½œè€…ï¼Œåˆ†åˆ«æ˜¯ã€Š[Python åº”ç”¨åœ°ç»Ÿè®¡å­¦ï¼šGeostatsPy å®è·µæŒ‡å—](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)ã€‹å’Œã€Š[Python åº”ç”¨æœºå™¨å­¦ä¹ ï¼šä»£ç å®è·µæŒ‡å—](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html)ã€‹ã€‚

è¿ˆå…‹å°”çš„æ‰€æœ‰å¤§å­¦è®²åº§éƒ½å¯ä»¥åœ¨ä»–çš„[YouTube é¢‘é“](https://www.youtube.com/@GeostatsGuyLectures)ä¸Šæ‰¾åˆ°ï¼Œé™„æœ‰ 100 å¤šä¸ª Python äº¤äº’å¼ä»ªè¡¨æ¿å’Œ 40 å¤šä¸ªå­˜å‚¨åº“ä¸­çš„è¯¦ç»†è®°å½•å·¥ä½œæµç¨‹çš„é“¾æ¥ï¼Œè¿™äº›å­˜å‚¨åº“ä½äºä»–çš„[GitHub è´¦æˆ·](https://github.com/GeostatsGuy)ï¼Œä»¥æ”¯æŒä»»ä½•æ„Ÿå…´è¶£çš„å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«ã€‚è¦äº†è§£æ›´å¤šå…³äºè¿ˆå…‹å°”çš„å·¥ä½œå’Œå…±äº«æ•™è‚²èµ„æºï¼Œè¯·è®¿é—®ä»–çš„ç½‘ç«™ã€‚

## æƒ³è¦ä¸€èµ·å·¥ä½œå—ï¼Ÿ

æˆ‘å¸Œæœ›è¿™äº›å†…å®¹å¯¹é‚£äº›æƒ³è¦äº†è§£æ›´å¤šå…³äºåœ°ä¸‹å»ºæ¨¡ã€æ•°æ®åˆ†æå’Œå­¦ä¹ æœºå™¨å­¦ä¹ çš„äººæ¥è¯´æ˜¯æœ‰å¸®åŠ©çš„ã€‚å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«éƒ½æ¬¢è¿å‚åŠ ã€‚

+   æƒ³é‚€è¯·æˆ‘åˆ°è´µå…¬å¸è¿›è¡ŒåŸ¹è®­ã€è¾…å¯¼ã€é¡¹ç›®å®¡æŸ¥ã€å·¥ä½œæµç¨‹è®¾è®¡å’Œ/æˆ–å’¨è¯¢ï¼Ÿæˆ‘å¾ˆä¹æ„æ‹œè®¿å¹¶ä¸æ‚¨åˆä½œï¼

+   æ„Ÿå…´è¶£åˆä½œã€æ”¯æŒæˆ‘çš„ç ”ç©¶ç”Ÿç ”ç©¶æˆ–æˆ‘çš„åœ°ä¸‹æ•°æ®åˆ†æä¸æœºå™¨å­¦ä¹ è”ç›Ÿï¼ˆå…±åŒè´Ÿè´£äººæ˜¯çº¦ç¿°Â·ç¦æ–¯ç‰¹æ•™æˆï¼‰å—ï¼Ÿæˆ‘çš„ç ”ç©¶å°†æ•°æ®åˆ†æã€éšæœºå»ºæ¨¡å’Œæœºå™¨å­¦ä¹ ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œä»¥å¼€å‘æ–°çš„æ–¹æ³•å’Œå·¥ä½œæµç¨‹ï¼Œå¢åŠ ä»·å€¼ã€‚æˆ‘ä»¬æ­£åœ¨è§£å†³å…·æœ‰æŒ‘æˆ˜æ€§çš„åœ°ä¸‹é—®é¢˜ï¼

+   æˆ‘å¯ä»¥é€šè¿‡ mpyrcz@austin.utexas.edu è”ç³»åˆ°æˆ‘ã€‚

æˆ‘æ€»æ˜¯å¾ˆé«˜å…´è®¨è®ºï¼Œ

*è¿ˆå…‹å°”*

Michael Pyrczï¼Œåšå£«ï¼ŒP.Eng. æ•™æˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ Cockrell å·¥ç¨‹å­¦é™¢å’Œ Jackson åœ°çƒç§‘å­¦å­¦é™¢

æ›´å¤šèµ„æºå¯åœ¨ä»¥ä¸‹é“¾æ¥è·å–ï¼š[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy) | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao) | [åœ°çƒç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446) | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python ä¸­åº”ç”¨åœ°çƒç»Ÿè®¡å­¦ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)

## åŠ¨æœº

å·ç§¯ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„åŸºäºè§†è§‰çš®å±‚ç±»æ¯”çš„è‡ªç„¶å¯å‘è®¡ç®—æ·±åº¦å­¦ä¹ æ–¹æ³•ï¼Œå®ƒæ‰©å±•äº†æˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œåœ¨å¤„ç†å›¾åƒæ–¹é¢çš„èƒ½åŠ›ã€‚

è‡ªç„¶å¯å‘è®¡ç®—æ­£åœ¨å¯»æ‰¾è‡ªç„¶ç•Œçš„çµæ„Ÿæ¥å¼€å‘æ–°çš„é—®é¢˜è§£å†³æ–¹æ³•ï¼Œ

+   **äººå·¥ç¥ç»ç½‘ç»œ**å—åˆ°ç”Ÿç‰©ç¥ç»ç½‘ç»œçš„å¯å‘

+   **èŠ‚ç‚¹**åœ¨æˆ‘ä»¬çš„æ¨¡å‹ä¸­æ˜¯äººå·¥ç¥ç»å…ƒï¼Œç®€å•çš„å¤„ç†å™¨

+   **èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥æ˜¯äººå·¥çªè§¦**

+   **æ„ŸçŸ¥åŸŸæ­£åˆ™åŒ–**ç”¨äºæé«˜æ³›åŒ–èƒ½åŠ›å’Œæ•ˆç‡

æ™ºèƒ½æ˜¯ä»è®¸å¤šç›¸äº’è¿æ¥çš„ç®€å•å¤„ç†å™¨ä¸­äº§ç”Ÿçš„ã€‚åœ¨æœ¬ç« çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘å°†ä½¿ç”¨èŠ‚ç‚¹å’Œè¿æ¥è¿™ä¸¤ä¸ªæœ¯è¯­æ¥æè¿°æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œã€‚

## ä¸äººå·¥ç¥ç»ç½‘ç»œå…±æœ‰çš„æ¦‚å¿µ

è¿™é‡Œæœ‰ä¸€äº›äººå·¥ç¥ç»ç½‘ç»œï¼ˆANNsï¼‰çš„å…³é”®æ–¹é¢ï¼Œ

**åŸºæœ¬è®¾è®¡** - *â€œâ€¦â€¦ä¸€ä¸ªç”±è®¸å¤šç®€å•ã€é«˜åº¦äº’è¿çš„å¤„ç†å…ƒç´ ç»„æˆçš„è®¡ç®—ç³»ç»Ÿï¼Œè¿™äº›å¤„ç†å…ƒç´ é€šè¿‡å…¶å¯¹å¤–éƒ¨è¾“å…¥çš„åŠ¨æ€çŠ¶æ€å“åº”æ¥å¤„ç†ä¿¡æ¯ã€‚â€* Caudill (1989)ã€‚

**ä»ç„¶æ˜¯ä¸€ä¸ªé¢„æµ‹æ¨¡å‹** - è™½ç„¶è¿™äº›æ¨¡å‹å¯èƒ½éå¸¸å¤æ‚ï¼Œç”šè‡³æœ‰æ•°ç™¾ä¸‡ä¸ªå¯è®­ç»ƒçš„æ¨¡å‹å‚æ•°ã€æƒé‡å’Œåå·®ï¼Œä½†å®ƒä»¬ä»ç„¶æ˜¯ä¸€ä¸ªä»é¢„æµ‹ç‰¹å¾æ˜ å°„åˆ°å“åº”ç‰¹å¾çš„å‡½æ•°ï¼Œ

$$ Y=f(X)+\epsilon $$

**ç›‘ç£å­¦ä¹ ** â€“ æˆ‘ä»¬æä¾›å¸¦æœ‰é¢„æµ‹ç‰¹å¾ $X_1,\ldots,ğ‘‹_ğ‘š$ å’Œå“åº”ç‰¹å¾ $ğ‘Œ_1,\ldots,ğ‘Œ_K$ çš„è®­ç»ƒæ•°æ®ï¼ŒæœŸæœ›æ¨¡å‹é¢„æµ‹è¯¯å·® $\epsilon$ã€‚

**éçº¿æ€§** - é€šè¿‡åº”ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°æ¥æ¨¡å‹éçº¿æ€§å…³ç³»ï¼Œå°†éçº¿æ€§å¼•å…¥åˆ°ç³»ç»Ÿä¸­

**é€šç”¨å‡½æ•°é€¼è¿‘å™¨ï¼ˆé€šç”¨é€¼è¿‘å®šç†ï¼‰** - äººå·¥ç¥ç»ç½‘ç»œå…·æœ‰å­¦ä¹  $f$ åœ¨ä»»æ„å®½ï¼ˆå•éšè—å±‚ï¼‰åŒºé—´å†…ä»»ä½•å¯èƒ½å‡½æ•°å½¢çŠ¶çš„èƒ½åŠ›ï¼Œç”± Cybenko (1989) æå‡ºï¼Œå¹¶ç”± Lu å’Œå…¶ä»–äºº (2017) æå‡ºä»»æ„æ·±åº¦

ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘å°†ä¸ä¼šé‡å¤äººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ä¸­çš„æ‰€æœ‰åŸºæœ¬æ¦‚å¿µã€‚

+   åœ¨å¼€å§‹è¿™ä¸€ç« ä¹‹å‰å›é¡¾ä¸€ä¸‹é‚£ä¸€ç« å¯èƒ½æ˜¯ä¸ªå¥½ä¸»æ„ã€‚

## å·ç§¯ç¥ç»ç½‘ç»œæ¦‚å¿µ

**æ­£åˆ™åŒ–** - äººå·¥ç¥ç»ç½‘ç»œå®¹æ˜“è¿‡æ‹Ÿåˆï¼›å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ­£åˆ™åŒ–å½¢å¼æ¥é˜²æ­¢è¿™ç§æƒ…å†µã€‚

+   ä¾‹å¦‚ï¼Œå²­å›å½’å’Œ LASSO é€šè¿‡æ”¶ç¼©é¡¹å°†æ­£åˆ™åŒ–é›†æˆåˆ°æŸå¤±å‡½æ•°ä¸­ï¼Œä»¥å‡å°‘è¿‡æ‹Ÿåˆã€‚

ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬å¯¹æ­£åˆ™åŒ–é‡‡å–äº†ä¸åŒçš„æ–¹æ³•ã€‚

+   ä½¿ç”¨å›¾åƒæ•°æ®æ—¶ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåƒç´ çš„éšå¼å±‚æ¬¡/é‚»è¿‘æ€§å’Œç›¸å¯¹ä½ç½®ï¼Œå°†æˆ‘ä»¬çš„äºŒç»´å›¾åƒå±•å¹³æˆä¸€ç»´å‘é‡ä»¥é€šè¿‡å¤šä¸ªå…¨è¿æ¥äººå·¥ç¥ç»ç½‘ç»œå±‚ä¼šç ´åè¿™äº›ä¿¡æ¯ã€‚

+   å› æ­¤ï¼Œæˆ‘ä»¬ç§»é™¤ï¼Œæ­£åˆ™åŒ–åˆ° 0.0ï¼Œæ„ŸçŸ¥åŸŸä¹‹å¤–çš„æ‰€æœ‰è¿æ¥ï¼Œä»¥ä¿ç•™åƒç´ çš„é‚»è¿‘æ€§å’Œç›¸å¯¹ä½ç½®ä¿¡æ¯ï¼ŒåŒæ—¶é¿å…è¿‡æ‹Ÿåˆã€‚

+   è¿™äº›æ„ŸçŸ¥åŸŸæ˜¯é€šè¿‡ä»å›¾åƒä¸­æå–è¾ƒå°çš„åƒç´ å­é›†å’Œæ›´ç®€å•çš„æ¨¡å¼æ¥è¿›è¡Œæ­£åˆ™åŒ–çš„ã€‚

æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜åŒ…æ‹¬ dropoutï¼ˆéšæœºç§»é™¤è¿æ¥ï¼‰ï¼Œä½œä¸ºå¦ä¸€ç§æ­£åˆ™åŒ–å½¢å¼ã€‚

## ä½¿ç”¨äººå·¥ç¥ç»ç½‘ç»œå¤„ç†å›¾åƒæ•°æ®

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å›¾åƒæ•°æ®æ¥è®­ç»ƒæˆ‘ä»¬çš„äººå·¥ç¥ç»ç½‘ç»œã€‚

![](img/a7d555024d6a9f3a61c7fd816bd8bf6a.png)

äººå·¥ç¥ç»ç½‘ç»œç”¨äºåˆ†ç±»å›¾åƒçš„ç¤ºæ„å›¾ã€‚

è¿™ç§æ–¹æ³•æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ

1.  **å¤§é‡æ¨¡å‹å‚æ•°** - æ¨¡å‹å¯èƒ½éš¾ä»¥è®­ç»ƒå¹¶ä¸”å®¹æ˜“è¿‡æ‹Ÿåˆã€‚

1.  **å¯¹ä½ç½®éå¸¸æ•æ„Ÿ** - æˆ‘ä»¬å¸Œæœ›ä»å…·æœ‰ä½ç½®ä¸å˜æ€§çš„å›¾åƒä¸­å­¦ä¹ ï¼Œå³å¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œé€šé“çš„ä½ç½®ä¸åº”å¾ˆé‡è¦ã€‚

1.  **å°†å›¾åƒå±•å¹³ä¸ºå‘é‡** - è¿™æ˜¯äººå·¥ç¥ç»ç½‘ç»œæ‰€å¿…éœ€çš„ï¼Œä½†å¦‚æœæˆ‘ä»¬é¦–å…ˆå°†å›¾åƒå±•å¹³ä¸ºå‘é‡ï¼Œæˆ‘ä»¬å°±ä¼šå¤±å»å…³äºåƒç´ æ¨¡å¼ã€é¡ºåºã€ç›¸é‚»æ€§ç­‰é‡è¦ä¿¡æ¯ã€‚

æ€»ç»“æ¥è¯´ï¼Œäººå·¥ç¥ç»ç½‘ç»œåœ¨å¤„ç†å›¾åƒæ—¶éå¸¸ä½æ•ˆï¼Œå®¹æ˜“è¿‡æ‹Ÿåˆï¼Œå¹¶ä¸”æ³›åŒ–èƒ½åŠ›ä¸å¥½ï¼ç›¸åï¼Œè®©æˆ‘ä»¬ä»æˆ‘ä»¬çš„è§†è§‰çš®å±‚ä¸­æ±²å–çµæ„Ÿï¼Œæˆ‘ä»¬çš„è§†è§‰å¹¶ä¸æ„ŸçŸ¥æ‰€æœ‰â€œåƒç´ â€ï¼Œè€Œæ˜¯å°†è§†é‡åˆ†å‰²æˆæ„ŸçŸ¥åŸŸã€‚

+   æˆ‘ä»¬ä»é‡å çš„æ„ŸçŸ¥åŸŸä¸­æå–æ„Ÿå…´è¶£çš„ç‰¹å¾ï¼Œåœ¨ä¸€ä¸ªå±‚æ¬¡ç»“æ„ï¼ˆæœªæ˜¾ç¤ºï¼‰ä¸­ï¼Œç„¶åé‡æ–°ç»„åˆæ•´ä¸ªå›¾åƒï¼Œå³æˆ‘ä»¬çš„æ„ŸçŸ¥ã€‚

+   æˆ‘ä»¬ä¸ä¼šæ„ŸçŸ¥æ‰€æœ‰â€œåƒç´ â€ï¼Œè¿™å¯¹æˆ‘ä»¬çš„å¤§è„‘æ¥è¯´ä¼šéå¸¸ç´¯ï¼Œç›¸åï¼Œæˆ‘ä»¬çš„è§†è§‰çš®å±‚è§£é‡Šå¹¶æ€»ç»“æ¨¡å¼ã€‚

![](img/57787e99367cbd5272ad8414cd3bfe82.png)

é‡å æ„ŸçŸ¥åŸŸçš„ç¤ºæ„å›¾ï¼Œç”¨äºåˆ†å‰²è§†é‡ï¼Œæ€»ç»“æ¯ä¸ªéƒ¨åˆ†ï¼Œç„¶åé‡æ–°ç»„åˆåˆ°æˆ‘ä»¬çš„æ„ŸçŸ¥ä¸­ã€‚

ç°åœ¨è®©æˆ‘ä»¬ç”¨è¿™ä¸ªæ„ŸçŸ¥åŸŸçš„æ¦‚å¿µæ¥æ¯”è¾ƒäººå·¥ç¥ç»ç½‘ç»œå’Œå·ç§¯ç¥ç»ç½‘ç»œã€‚

å…¨è¿æ¥ã€å‰é¦ˆäººå·¥ç¥ç»ç½‘ç»œ

+   ä¸‹ä¸€å±‚çš„èŠ‚ç‚¹è¿æ¥åˆ°å‰ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚

+   ç©ºé—´ä¿¡æ¯ä¸¢å¤±ï¼Œå›¾åƒæ•°æ®ç«‹å³å±•å¹³ä¸º 1D å‘é‡ï¼Œç›¸é‚»/é¡ºåºä¿¡æ¯ä¸¢å¤±ã€‚

åŸºäºæ„Ÿå—é‡æ­£åˆ™åŒ–çš„å·ç§¯ç¥ç»ç½‘ç»œ

+   ä¸‹ä¸€ä¸ªå±‚ä¸­çš„èŠ‚ç‚¹æ˜ å°„åˆ°å‰ä¸€ä¸ªå±‚çš„ç‰¹å®šåŒºåŸŸï¼Œä¸€ä¸ªå›¾åƒæˆ–ç‰¹å¾å›¾

+   ç©ºé—´ä¿¡æ¯å¾—åˆ°ä¿ç•™ï¼Œæ•°æ®åœ¨æ¯ä¸ªå±‚ä¸­ä¿ç•™äº†åŸå§‹å›¾åƒçš„ 2D æˆ– 3D ç»´æ•°ï¼Œç§°ä¸ºç‰¹å¾å›¾ã€‚

![](img/b56850a29d24dbccae1cabcfbdc9e7e7.png)

å±•ç¤ºäº†é‡å çš„æ„Ÿå—é‡æ¥åˆ†å‰²è§†é‡ï¼Œæ€»ç»“æ¯ä¸ªéƒ¨åˆ†å¹¶å°†å®ƒä»¬é‡æ–°ç»„åˆåˆ°æˆ‘ä»¬çš„æ„ŸçŸ¥ä¸­ã€‚

## CNN çš„æ­£åˆ™åŒ–

è®©æˆ‘ä»¬å¿«é€Ÿå›é¡¾ä¸€ä¸‹é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹æ­£åˆ™åŒ–çš„æ¦‚å¿µï¼Œ

**æ­£åˆ™åŒ–** - ä¸€ç§çº¦æŸï¼Œç”¨äºå‡å°‘æ¨¡å‹å¯¹æ•°æ®çš„æ•æ„Ÿæ€§ï¼Œå³å‡å°‘æ¨¡å‹æ–¹å·®

**åŸºäºæ„Ÿå—é‡çš„æ­£åˆ™åŒ–** - ä½¿ç”¨æ„Ÿå—é‡æ˜¯ä¸€ç§æ­£åˆ™åŒ–å½¢å¼ï¼Œå¯¼è‡´ï¼Œ

+   è¿æ¥ã€æƒé‡/æ¨¡å‹å‚æ•°çš„å¤§é‡å‡å°‘

+   æœ‰æ•ˆåœ°å°†è¿™äº›æ½œåœ¨æƒé‡ç¼©å°åˆ°é›¶

åŒæ—¶å…³æ³¨åƒç´ æ¨¡å¼ï¼

**åŸºäº dropout çš„æ­£åˆ™åŒ–** - åœ¨è®­ç»ƒå‘¨æœŸä¸­ï¼Œéšæœºå¿½ç•¥æˆ–â€œdropoutâ€ä¸€éƒ¨åˆ†èŠ‚ç‚¹ã€‚æ¯ä¸ªè®­ç»ƒå‘¨æœŸçœ‹åˆ°ç½‘ç»œçš„ä¸åŒç‰ˆæœ¬/å­é›†

+   CNN çš„å¦ä¸€ç§æ­£åˆ™åŒ–å½¢å¼ï¼Œç”¨äºé˜²æ­¢ç‰¹å®šèŠ‚ç‚¹ä¸»å¯¼æ¨¡å‹

+   æ¨¡æ‹Ÿè®­ç»ƒå¤šä¸ªæ¨¡å‹å¹¶å¹³å‡ï¼Œç±»ä¼¼äºé›†æˆå­¦ä¹ ã€‚æ³¨æ„ï¼Œé€šå¸¸ä¸å¯èƒ½å¹¶è¡Œè®­ç»ƒå¤šä¸ªç½‘ç»œä»¥åº”ç”¨é›†æˆæ¥è®¡ç®—é¢„æµ‹ï¼ˆå¦‚éšæœºæ£®æ—ï¼‰ï¼Œå¹¶ä¸”åœ¨è®­ç»ƒåæ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«ä½¿ç”¨ã€‚

![](img/2078f41aac92afeb57f8fdc28528b873.png)

å±•ç¤ºäº† dropout å¦‚ä½•ä»æ„Ÿå—é‡åˆ°ç‰¹å¾å›¾èŠ‚ç‚¹ä¸­ç§»é™¤éšæœºè¿æ¥ã€‚

**æ‰¹é‡å½’ä¸€åŒ–** - åœ¨å±‚ä¸Šæ ‡å‡†åŒ–èŠ‚ç‚¹çš„è¾“å…¥/æƒé‡ï¼Œä»¥å±…ä¸­å’Œç¼©æ”¾ï¼ˆå‡å€¼ä¸º 0ï¼Œæ–¹å·®ä¸º 1ï¼‰ï¼Œä»¥ä¼˜åŒ–æ¿€æ´»å‡½æ•°çš„æ•æ„Ÿæ€§å’Œæ¨¡å‹å‚æ•°è®­ç»ƒã€‚

$$ \hat{x}_i \leftarrow \frac{x_i - \mu_B}{\sqrt{\sigma_BÂ² + \epsilon}} $$

ç„¶åæˆ‘ä»¬æ·»åŠ  2 ä¸ªæ¨¡å‹å‚æ•°ï¼Œå±‚æ ‡å‡†å·®ï¼Œ$\gamma$ï¼Œå’Œå‡å€¼ï¼Œ$\beta$ï¼Œä»¥å¢åŠ æ§åˆ¶ï¼Œæé«˜ä¸‹ä¸€å±‚è®­ç»ƒå•ä¸ªæƒé‡çš„æœ€ä¼˜æ€§ã€‚

$$ y_i \leftarrow \gamma \hat{x}_i + \beta $$

## CNN çš„æ„å»ºæ¨¡å—

æˆ‘ä»¬æœ‰å¤šç§ç®—å­å¯ä»¥åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ä»ä¸€å±‚ç§»åŠ¨åˆ°å¦ä¸€å±‚ï¼ˆç‰¹å¾å›¾åˆ°ç‰¹å¾å›¾ï¼‰ã€‚å¸¸è§çš„ç®—å­åŒ…æ‹¬ï¼Œ

+   **å·ç§¯** â€“ ä¸€ä¸ªåŠ æƒçª—å£ï¼Œæ ¸/æ»¤æ³¢å™¨ï¼Œç”¨äºæå–ç©ºé—´ä¿¡æ¯

+   **æ± åŒ–** â€“ ç»´åº¦å‡å°‘ï¼Œå¢åŠ å±€éƒ¨å¹³ç§»ä¸å˜æ€§

+   **æ·±åº¦æ± åŒ–ï¼Œä¸‹é‡‡æ ·** â€“ 1x1 æ»¤æ³¢å™¨ï¼Œå°†é€šé“/ç‰¹å¾å›¾ç»„åˆåˆ°å¤šä¸ªæ ¸ä¸Šå­¦ä¹ 

+   **æ¿€æ´»** â€“ ä½¿ç”¨æ¿€æ´»å‡½æ•°å¯¹ç³»ç»Ÿåº”ç”¨éçº¿æ€§å˜æ¢ï¼Œèµ‹äºˆç³»ç»Ÿéçº¿æ€§ï¼Œå¹¶é˜²æ­¢ç³»ç»Ÿç®€åŒ–ä¸ºç®€å•çš„çº¿æ€§æ¨¡å‹

+   **å…¨è¿æ¥ï¼Œå‰é¦ˆ** â€“ å‚è§ä¹‹å‰å…³äºäººå·¥ç¥ç»ç½‘ç»œçš„è®²åº§

ç°åœ¨æˆ‘ä»¬å°†æè¿°ã€è§£é‡Šå¹¶æ¼”ç¤ºè¿™äº›ç®—å­ã€‚

## å·ç§¯

å·ç§¯æ˜¯ä¸¤ä¸ªå‡½æ•°çš„ç§¯åˆ†ä¹˜ç§¯ï¼Œå…¶ä¸­ä¸€ä¸ªå‡½æ•°è¢«åè½¬å¹¶å¹³ç§» $\Delta$ã€‚

+   ä¸€ç§è§£é‡Šæ˜¯å°†åŠ æƒå‡½æ•° $ğ‘“(\Delta)$ åº”ç”¨äºå¹³æ»‘å‡½æ•°ï¼Œä»¥è®¡ç®—å‡½æ•° $ğ‘”(x)$ çš„åŠ æƒå¹³å‡å€¼ï¼Œ

$$ (f * g)(x) = \int_{-\infty}^{\infty} f(\Delta) g(x - \Delta) \, d\Delta $$

è¿™å¾ˆå®¹æ˜“æ‰©å±•åˆ°ä»»ä½•ç»´åº¦ï¼Œä¾‹å¦‚å¯¹äºå›¾åƒæ˜¯ 2Dï¼Œ

$$ (f * g)(x, y) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} f(\Delta_x, \Delta_y) g(x - \Delta_x, y - \Delta_y) \, d\Delta_x \, d\Delta_y $$

åœ¨ç§¯åˆ†ä¹‹å‰é€‰æ‹©å“ªä¸ªå‡½æ•°è¢«å¹³ç§»ï¼Œä¸ä¼šæ”¹å˜ç»“æœï¼Œå·ç§¯ç®—å­å…·æœ‰äº¤æ¢æ€§ï¼Œ

$$ (f * g)(x) = \int_{-\infty}^{\infty} f(\Delta) g(x - \Delta) \, d\Delta $$$$ (f * g)(x) = \int_{-\infty}^{\infty} f(x - \Delta) g(\Delta) \, d\Delta $$

+   å¦‚æœä»»ä¸€å‡½æ•°è¢«åå°„ï¼Œåˆ™å·ç§¯ç­‰åŒäºç›¸å…³å·ç§¯ï¼Œå®ƒæ˜¯ä¸¤ä¸ªä¿¡å·ç›¸ä¼¼åº¦çš„åº¦é‡ï¼Œä½œä¸ºä½ç§»çš„å‡½æ•°ã€‚

ä¸ºäº†æ¼”ç¤ºä½¿ç”¨è¯¦å°½ $g(x)$ å’Œç¨€ç–é‡‡æ · $g(x)$ çš„å·ç§¯ï¼Œæˆ‘æ„å»ºäº†ä¸€ä¸ª[äº¤äº’å¼ Python å·ç§¯ä»ªè¡¨æ¿](https://github.com/GeostatsGuy/DataScienceInteractivePython/blob/main/Interactive_Convolution_kNearest.ipynb)ï¼Œ

![](img/f55c37e0f7da98a233affd5fbd5ba38c.png)

äº¤äº’å¼ Python ä»ªè¡¨æ¿ç”¨äºæ¼”ç¤ºå·ç§¯ã€‚

å¯¹äºå·ç§¯æ“ä½œï¼Œåœ¨æ¨¡å‹è®­ç»ƒæœŸé—´å­¦ä¹ äº†ä¸€ä¸ªå¯è®­ç»ƒçš„åŠ æƒå‡½æ•° $g(\Tau)$ã€‚

**æ»¤æ³¢å™¨/æ ¸** â€“ åœ¨å·ç§¯çª—å£ä¸Šåˆ†é…çš„æƒé‡ï¼Œç”¨äºè®¡ç®—ä¸‹ä¸€ä¸ªç‰¹å¾å›¾ã€‚é€šè¿‡è®­ç»ƒè¿™äº›æƒé‡ï¼Œæ»¤æ³¢å™¨å¯ä»¥æå–ç‰¹å®šçš„ç©ºé—´ç‰¹å¾ã€‚

![](img/1955083a83351548602c54c6f2f6d86b.png)

ä¸¤ä¸ªå·ç§¯è®¡ç®—çš„ç¤ºä¾‹ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªç‰¹å®šçš„æ ¸å½¢å¼ï¼Œå³æ¨¡ç³Šæ»¤æ³¢å™¨ã€‚

+   ä¸‹ä¸€ä¸ªç‰¹å¾å›¾æ¥æ”¶å‰ä¸€ä¸ªç‰¹å¾å›¾æˆ–å›¾åƒä¸Šçš„å±€éƒ¨å¹³å‡å€¼ã€‚

![](img/f41a6a56aa0cf6c53667cad2b0ae52c8.png)

ç¤ºä¾‹æ»¤æ³¢å™¨ï¼Œæ¨¡ç³Š/å±€éƒ¨å¹³å‡æ»¤æ³¢å™¨ã€‚

å…³äºæ»¤æ³¢å™¨çš„ä¸€äº›è§‚å¯Ÿï¼Œ

+   æ»¤æ³¢å™¨çš„å¤§å°ä¸æˆ‘ä»¬æå–çš„ç‰¹å¾çš„å°ºåº¦ç›¸å…³

+   è¾ƒå¤§çš„æ ¸å¢åŠ äº†è¿æ¥æ•°ã€æ¨¡å‹æƒé‡ï¼Œæœ€ç»ˆå¢åŠ äº†è®¡ç®—å¤æ‚åº¦

+   æ ¸å¤§å°ä½¿ç”¨å¥‡æ•°ä»¥é¿å…å¤±çœŸï¼Œå¯èƒ½å­˜åœ¨éå¯¹ç§°æ ¸

+   ç´¯åŠ åˆ° 1 å¯ä»¥é˜²æ­¢åå·®ï¼ˆä»ä¸€å¹…å›¾åƒæˆ–ç‰¹å¾å›¾åˆ°å¦ä¸€å¹…ç‰¹å¾å›¾çš„å‡å€¼å¹³ç§»ï¼‰

**å¡«å……** - æˆ‘ä»¬ä¸‹ä¸€ä¸ªç‰¹å¾å›¾çš„æ‰€æœ‰è¾¹ç¼˜éƒ½å‡å°‘äº† 1 çš„å¤§å°ï¼Œä»¥é¿å…ç‰¹å¾å›¾å¤–çš„é‡å ï¼Œå³æ²¡æœ‰å¡«å……ï¼Œè€Œå¡«å……å°†è¶…å‡ºç‰¹å¾å›¾æˆ–å›¾åƒï¼Œé˜²æ­¢ä¸‹ä¸€ä¸ªç‰¹å¾å›¾çš„å¤§å°å‡å°‘ã€‚

+   å¡«å……æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼ŒåŒ…æ‹¬åœ¨ç‰¹å¾å›¾ä¸Šå‡è®¾é›¶å€¼ã€å¸¸æ•°å€¼å’Œæœ€è¿‘å€¼ã€‚

![](img/58368b8a8cebacdde3ae4116d6462f35.png)

æ— å¡«å……çš„å·ç§¯ï¼Œå¯¼è‡´ç‰¹å¾å›¾å¤§å°å‡å°ï¼ˆä¸Šæ–¹ï¼‰å’Œå¡«å……å·ç§¯ï¼ˆå‡è®¾ç‰¹å¾å›¾å¤–éƒ¨ä¸º 0ï¼‰ä»¥æ— ç‰¹å¾å›¾å¤§å°å‡å°ï¼ˆä¸‹æ–¹ï¼‰ã€‚

**æ­¥é•¿** - å·ç§¯æ»¤æ³¢å™¨/æ ¸é€šè¿‡å‰ä¸€ä¸ªç‰¹å¾å›¾çš„æ­¥æ•°ã€‚

+   å¯¹äºæ­¥é•¿ä¸º 1 çš„æƒ…å†µï¼Œæ²¡æœ‰éšå¼å‡å°‘ç‰¹å¾å›¾å¤§å°ã€‚

+   å¯¹äºæ­¥é•¿å¤§äº 2 çš„æƒ…å†µï¼Œç‰¹å¾å›¾å¤§å°ä¼šå‡å°ã€‚

![å›¾ç‰‡](img/58300f18f8744327620c90fcc1cc392f.png)

æ­¥é•¿ä¸º 1 çš„å·ç§¯ï¼ˆä¸Šæ–¹ï¼‰å’Œæ­¥é•¿ä¸º 2 çš„å·ç§¯ï¼ˆä¸‹æ–¹ï¼‰ä»¥åŠç‰¹å¾å›¾å¤§å°çš„å‡å°ã€‚

**ä¸‹ä¸€ä¸ªç‰¹å¾å›¾çš„å¤§å°** - ä¸‹ä¸€ä¸ªç‰¹å¾å›¾çš„å¤§å°ç”±è¶…å‚æ•°ã€å‰ä¸€ä¸ªç‰¹å¾å›¾å¤§å° $n_{in}$ã€å·ç§¯æ ¸å¤§å° $k$ã€å·ç§¯å¡«å……å¤§å° $p$ å’Œå·ç§¯æ­¥é•¿å¤§å° $s$ å†³å®šï¼Œé€šè¿‡æ­¤æ–¹ç¨‹ï¼Œ

$$ n_{\text{out}} = \left\lfloor \frac{n_{\text{in}} + 2p - k}{s} \right\rfloor + 1 $$

ä¾‹å¦‚ï¼Œå¦‚æœï¼Œ

+   $n_{in} = 4$

+   $k = 2$

+   $p = 0$

+   $s = 1$

ç„¶åæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬ä»£å…¥æ–¹ç¨‹ä¸­ï¼Œ

$$ n_{\text{out}} = \left\lfloor \frac{4 + 2(0) - 2}{1} \right\rfloor + 1 = 3 $$

ç°åœ¨å°†æ­¤ä¸è¯¥ç¤ºä¾‹çš„å¯è§†åŒ–è¿›è¡Œæ¯”è¾ƒï¼Œ

![å›¾ç‰‡](img/ad9c65a10c9c4afb28b77bd7cbfc6017.png)

ä¸Šè¿°ç¤ºä¾‹çš„ç¤ºä¾‹å†…æ ¸ã€è¾“å…¥å’Œè¾“å‡ºç‰¹å¾å›¾ã€‚

æˆ‘ä»¬è®¡ç®—ä¸‹ä¸€ä¸ªç‰¹å¾å›¾å¤§å°å¦‚ä¸‹ï¼š

$$ n_{\text{out}} = \left\lfloor \frac{4 + 2(0) - 2}{1} \right\rfloor + 1 = 3 $$

**æ»¤æ³¢å™¨/æ ¸è®¾è®¡** â€“ é€šè¿‡è®­ç»ƒæƒé‡ï¼Œæ»¤æ³¢å™¨å¯ä»¥æå–ç‰¹å®šçš„ç‰¹å¾ã€‚è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹æ»¤æ³¢å™¨ç±»å‹ï¼Œä»¥åŠè¾“å…¥å’Œè¾“å‡ºç‰¹å¾â€˜å›¾â€™çš„ç®€å• 1D ç¤ºä¾‹ã€‚

![å›¾ç‰‡](img/363089e3910cc726998fcf261fba68ef.png)

æ»¤æ³¢å™¨ï¼ˆä¸Šæ–¹ï¼Œä»¥åŠå·ç§¯çš„ 1D ç¤ºæ„å›¾ï¼ŒåŸå§‹å‡½æ•°ï¼ˆé»‘è‰²ï¼‰å’Œå·ç§¯ï¼ˆçº¢è‰²ï¼‰ï¼ˆä¸‹æ–¹ï¼‰ã€‚

**å¤šä¸ªæ»¤æ³¢å™¨/æ ¸** - é€šå¸¸åœ¨æ¯ä¸ªå·ç§¯å±‚ä¸Šè®­ç»ƒå¤šä¸ªæ»¤æ³¢å™¨ $n_k$ï¼Œä»¥ä»å›¾åƒä¸­æå–å„ç§ç»“æ„ã€‚

+   è¿™å¢åŠ äº†ç‰¹å¾å›¾æ·±åº¦æˆ–é€šé“æ•°ï¼Œ$n_k$

![å›¾ç‰‡](img/401b5ed57a2efd08be6f224d335f76da.png)

ç”±äºåº”ç”¨äº†å¤šä¸ªæ»¤æ³¢å™¨åˆ°å‰ä¸€ä¸ªå›¾åƒæˆ–ç‰¹å¾å›¾ï¼Œç‰¹å¾å›¾å…·æœ‰æ·±åº¦ï¼Œä¹Ÿç§°ä¸ºé€šé“æ•°ï¼Œ$n_k$ã€‚

+   æ³¨æ„ï¼ŒåŸå§‹å›¾åƒå¯èƒ½å…·æœ‰å¤šä¸ªé€šé“ï¼Œæ·±åº¦å¤§äº 1ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ª RGB å›¾åƒå…·æœ‰ 3 ä¸ªé€šé“ï¼Œæ¯ä¸ªé€šé“åˆ†åˆ«å¯¹åº”çº¢è‰²ã€è“è‰²å’Œç»¿è‰²ã€‚

æœ€åï¼Œè¿™é‡Œæœ‰ä¸€äº›å°†å·ç§¯æ»¤æ³¢å™¨åº”ç”¨äºå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡çš„ç –å¢™å›¾åƒçš„ç¤ºä¾‹ï¼Œä»£ç å¯åœ¨[SubsurfaceDataAnalytics_Convolution_Operators.ipynb](https://github.com/GeostatsGuy/PythonNumericalDemos/blob/master/SubsurfaceDataAnalytics_Convolution_Operators.ipynb)æ‰¾åˆ°ã€‚

![å›¾ç‰‡](img/48b85ce0016245754f632d2d7034335d.png)

æ¥è‡ªå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡æ ¡å›­ç –å¢™çš„å·ç§¯ç¤ºä¾‹ã€‚

## æ¿€æ´»å‡½æ•°

è¯·å‚é˜…äººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œä½†ä¸ºäº†æé†’é€‰æ‹©æ¿€æ´»å‡½æ•°çš„è€ƒè™‘å› ç´ ï¼Œ

+   **éçº¿æ€§** â€“ éœ€è¦å‘é¢„æµ‹å™¨æ–½åŠ éçº¿æ€§ã€‚å¦‚æœè‡³å°‘æœ‰ 1 ä¸ªéšè—å±‚ï¼ˆCybenkoï¼Œ1989 å¹´ï¼‰ï¼Œå·²è¢«è¯æ˜æ˜¯é€šç”¨çš„å‡½æ•°é€¼è¿‘å™¨ã€‚

+   **èŒƒå›´** â€“ å¯¹äºæ›´ç¨³å®šçš„åŸºäºæ¢¯åº¦çš„å­¦ä¹ æ˜¯æœ‰é™çš„ï¼Œå¯¹äºæ›´æœ‰æ•ˆçš„è®­ç»ƒæ˜¯æ— é™çš„ï¼ˆä½†éœ€è¦è¾ƒæ…¢çš„å­¦ä¹ ç‡ï¼‰

+   **è¿ç»­å¯å¾®** â€“ å¯¹äºåŸºäºæ¢¯åº¦çš„ä¼˜åŒ–æ˜¯å¿…éœ€çš„

+   **å…·æœ‰å•è°ƒå¯¼æ•°çš„å¹³æ»‘å‡½æ•°** â€“ å¯èƒ½å…·æœ‰æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›

+   **å•è°ƒæ€§** â€“ ä¿è¯å•å±‚æ¨¡å‹è¯¯å·®è¡¨é¢çš„å‡¸æ€§ï¼ˆæŸå¤±å‡½æ•°çš„å…¨å±€æœ€å°å€¼ï¼‰

+   **åœ¨åŸç‚¹è¿‘ä¼¼ä¸ºå•ä½çŸ©é˜µ** â€“ ä½¿ç”¨å°éšæœºå€¼åˆå§‹åŒ–æƒé‡å¯ä»¥æœ‰æ•ˆåœ°å­¦ä¹ 

![å›¾ç‰‡](img/cb1d19a7978ea9f1f58b12b229835dcc.png)

æ¥è‡ªå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡æ ¡å›­ç –å¢™çš„å·ç§¯ç¤ºä¾‹ã€‚

## æ± åŒ–

å¯¹å•ä¸ªå€¼è¿›è¡Œæ»¤æ³¢å™¨/æ ¸çš„æ±‡æ€»ã€‚æ± åŒ–çš„å½±å“åŒ…æ‹¬ï¼Œ

+   åœ¨ç‰¹å¾å›¾ä¸­å¯¹ç‰¹å¾æ£€æµ‹è¿›è¡Œä¸‹é‡‡æ ·

+   å‡å°‘äº†ç‰¹å¾å›¾çš„ç»´åº¦

+   æ•´åˆå¹³ç§»ä¸å˜æ€§ï¼Œå¯¹ä½ç½®ä¸æ•æ„Ÿçš„æ¨¡å¼æ£€æµ‹

ä¸¤ç§å¸¸è§çš„æ± åŒ–æ–¹æ³•æ˜¯å¹³å‡æ± åŒ–å’Œæœ€å¤§æ± åŒ–ã€‚

![å›¾ç‰‡](img/4b2fd11462cbb82e0cb09ac3e2d938ff.png)

æ± åŒ–æ“ä½œçš„ç¤ºæ„å›¾ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨ 2x2 æ»¤æ³¢å™¨å’Œæ­¥é•¿ä¸º 2 çš„æ± åŒ–ç¤ºä¾‹ã€‚

![å›¾ç‰‡](img/81532b0b04b5a5af52f9b81557967b34.png)

å‡å°‘ç‰¹å¾å›¾èŒƒå›´çš„æ± åŒ–æ“ä½œç¤ºä¾‹ã€‚

+   ä½¿ç”¨ 2x2 æ»¤æ³¢å™¨ï¼Œæ­¥é•¿ä¸º 2ï¼Œæ¯ä¸ªè½´çš„ç»´åº¦å‡å°‘ä¸€åŠï¼Œå¯¹äº 2D å›¾åƒä¸ºå››åˆ†ä¹‹ä¸€ã€‚

+   ä¾‹å¦‚ï¼Œ16 çš„å€¼åœ¨æ»¤æ³¢å™¨å†…æ˜¯ä½ç½®æ— å…³çš„ã€‚è¿™å¼•å…¥äº†å¹³ç§»ä¸å˜æ€§ã€‚

![å›¾ç‰‡](img/a3f5e46b161a0d2f7e0f99574f3db593.png)

æ¥è‡ªå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡æ ¡å›­ç –å¢™çš„æœ€å¤§æ± åŒ–å’Œå¹³å‡æ± åŒ–ç¤ºä¾‹ã€‚

## æ·±åº¦æ± åŒ–

ä½¿ç”¨å•ä¸ªå€¼å¯¹ç‰¹å¾å›¾è¿›è¡Œæ±‡æ€»ã€‚

+   åœ¨ç‰¹å¾å›¾ä¸Šå¯¹æ£€æµ‹è¿›è¡Œä¸‹é‡‡æ ·ã€‚

+   ç»“åˆä»å¤šä¸ªæ ¸å­¦ä¹ åˆ°çš„ä¿¡æ¯

+   å‡å°‘äº†ç‰¹å¾å›¾çš„æ·±åº¦ï¼Œä¸‹ä¸€å±‚ã€‚

ä¸¤ç§å¸¸è§çš„æ± åŒ–æ–¹æ³•æ˜¯å¹³å‡æ± åŒ–å’Œæœ€å¤§æ± åŒ–ã€‚

![å›¾ç‰‡](img/1786e9cb04c2dac2297ddc607d4b0649.png)

æ·±åº¦æ± åŒ–æ“ä½œçš„ç¤ºæ„å›¾ã€‚

## å¸¸è§çš„å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¸¸è§çš„å·ç§¯ç¥ç»ç½‘ç»œå·¥ä½œæµç¨‹ã€‚

![å›¾ç‰‡](img/fcb53216a4534c9da9053f990e48aa90.png)

å¸¸è§çš„å·ç§¯ç¥ç»ç½‘ç»œå·¥ä½œæµç¨‹ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡å¸¸è§æ¶æ„çš„ç¤ºæ„å›¾æ¥å±•ç¤ºè¿™ä¸ªå¸¸è§çš„å·¥ä½œæµç¨‹ã€‚

![å›¾ç‰‡](img/618c123a572e16a0e12819e75b283099.png)

å¸¸è§çš„å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„ã€‚

## æ‰‹åŠ¨æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œæ¶æ„

å°±åƒäººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ä¸€æ ·ï¼Œæˆ‘æ‰‹åŠ¨æ„å»ºäº†ä¸€ä¸ªç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œã€‚

ä¸ºäº†ç®€å•å’Œç®€æ´ï¼Œæˆ‘åšå‡ºäº†ä»¥ä¸‹æ¶æ„é€‰æ‹©ï¼Œ

+   é«˜åº¦ä¸º 5 çš„ä¸€ç»´å›¾åƒ

+   1 ä¸ªå·ç§¯å±‚ï¼Œ1 ä¸ªå¤§å°ä¸º 3 çš„æ ¸

+   ä½¿ç”¨ sigmoid æ¿€æ´»

+   æ­¥é•¿ä¸º 1 ä¸”æ²¡æœ‰å¡«å……ï¼Œå› æ­¤ç‰¹å¾å›¾çš„å¤§å°ä¸º 3ã€‚

+   ä»ç‰¹å¾å›¾ç›´æ¥åˆ°è¾“å‡ºèŠ‚ç‚¹çš„äººå·¥ç¥ç»ç½‘ç»œï¼Œå…·æœ‰çº¿æ€§æ¿€æ´»

è¿™ç§ç®€çº¦æ¶æ„å±•ç¤ºäº†å·ç§¯ç¥ç»ç½‘ç»œä¸­çš„è®¸å¤šå…³é”®æ¦‚å¿µï¼ŒåŒæ—¶éå¸¸æ˜“äºå¯è§†åŒ–ï¼Œä¸”è®­ç»ƒé€Ÿåº¦éå¸¸å¿«ã€‚

![](img/c18c0d3da8b925d617dbd7cad6b9d1fa.png)

æˆ‘ä»¬æ‰‹åŠ¨æ„å»ºçš„ CNN çš„ç¤ºæ„å›¾ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å°†æˆ‘ä»¬æ‰‹åŠ¨æ„å»ºçš„ CNN çš„ç¤ºæ„å›¾è½¬æ¢ä¸ºå®é™…èŠ‚ç‚¹çš„å›¾ã€‚

![](img/aaaec452d8f375bf00b4df41c281e46c.png)

æˆ‘ä»¬æ‰‹åŠ¨æ„å»ºçš„ CNN æ¶æ„ã€‚

ä¸ºäº†å±•ç¤ºä½¿ç”¨æ­¤æ¶æ„çš„å®ç”¨æ€§ï¼Œè®©æˆ‘ä»¬æ·»åŠ æ¨¡å‹å‚æ•°çš„æ ‡ç­¾ï¼Œ

+   æ ¸æƒé‡ï¼Œ$\lambda_6$ï¼Œ$\lambda_7$ï¼Œå’Œ $\lambda_8$

+   å·ç§¯æ ¸åç½®ï¼Œ$b_{conv}$

+   äººå·¥ç¥ç»ç½‘ç»œæƒé‡ï¼Œ$\lambda_{9,12}$ï¼Œ$\lambda_{10,12}$ï¼Œå’Œ $\lambda_{11,12}$

+   äººå·¥ç¥ç»ç½‘ç»œåç½®ï¼Œ$b_{12}$

![](img/11f0651d909bf7e40e4ebdeca86bab61.png)

æˆ‘ä»¬æ‰‹åŠ¨æ„å»ºçš„ CNN æ¶æ„ï¼ŒåŒ…å«æ‰€æœ‰å¯è®­ç»ƒçš„æ¨¡å‹å‚æ•°ã€‚æ³¨æ„ï¼Œæ ¸æƒé‡ä»…æ˜¾ç¤ºåœ¨ç¬¬ä¸€ä¸ªæ ¸ä½ç½®ï¼Œä»¥é¿å…æ··ä¹±ã€‚

## è®­ç»ƒæ¨¡å‹å‚æ•°

è®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œé€šè¿‡ä»¥ä¸‹æ­¥éª¤è¿­ä»£è¿›è¡Œï¼Œä¸äººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ä¸­è®¨è®ºçš„ç›¸åŒã€‚

![](img/c3a5bc8956f8ceda05ddf9b582cd141d.png)

è®­ç»ƒäººå·¥ç¥ç»ç½‘ç»œé€šè¿‡ä»¥ä¸‹æ­¥éª¤è¿­ä»£è¿›è¡Œï¼Œ1. å‰å‘ä¼ æ’­ä»¥è¿›è¡Œé¢„æµ‹ï¼Œ2. æ ¹æ®é¢„æµ‹å’Œè®­ç»ƒæ•°æ®ä¸­çš„çœŸå®å€¼è®¡ç®—è¯¯å·®å¯¼æ•°ï¼Œ3. é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œåå‘ä¼ æ’­è¯¯å·®å¯¼æ•°ï¼Œä»¥è®¡ç®—æ‰€æœ‰æ¨¡å‹æƒé‡å’Œåç½®å‚æ•°çš„è¯¯å·®å¯¼æ•°ï¼Œ4. æ ¹æ®å¯¼æ•°å’Œå­¦ä¹ ç‡æ›´æ–°æ¨¡å‹å‚æ•°ï¼Œ5. é‡å¤ç›´åˆ°æ”¶æ•›ã€‚

ä¸‹é¢æ˜¯æ¯ä¸ªæ­¥éª¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œé‡ç‚¹å…³æ³¨ä¸äººå·¥ç¥ç»ç½‘ç»œçš„å·®å¼‚ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚é˜…äººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ã€‚

1.  **åˆå§‹åŒ–æ¨¡å‹å‚æ•°** - é€šå¸¸ä½¿ç”¨æ¥è¿‘é›¶çš„å°éšæœºå€¼åˆå§‹åŒ–æ‰€æœ‰æ¨¡å‹å‚æ•°ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§æ–¹æ³•ï¼Œ

+   **Xavier Glorot å‡åŒ€åˆå§‹åŒ–** - å¯¹äº Tanh å’Œ sigmoid æ¿€æ´»å‡½æ•°ï¼Œä»ç”± $U[\text{min}, \text{max}]$ æŒ‡å®šçš„å‡åŒ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆï¼Œ

$$ \lambda_i = F_U\left[-\sqrt{\frac{6}{n_{\text{in}} + n_{\text{out}}}},\ \sqrt{\frac{6}{n_{\text{in}} + n_{\text{out}}}}\right]^{-1}(p^\ell) $$

+   å…¶ä¸­ $F^{-1}_U$ æ˜¯ CDF çš„é€†ï¼Œ$p$ æ˜¯è¾“å…¥æ•°é‡ï¼Œ$p^{\ell}$ æ˜¯ä»å‡åŒ€åˆ†å¸ƒ $U[0,1]$ ä¸­æŠ½å–çš„éšæœºç´¯ç§¯æ¦‚ç‡å€¼ã€‚

ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ªè¾“å…¥é€šé“ä¸º 1ï¼Œè¾“å‡ºé€šé“ä¸º 9 çš„ $3 \times 3$ å·ç§¯æ ¸ï¼Œ

$$ n_{in} = k \times k \times C = 3 \times 3 \times 1 $$$$ n_out = k \times k \times C = 3 \times 3 \times 9 $$

+   **He Kaiming æƒé‡åˆå§‹åŒ–** - å¯¹äº ReLU å’Œ leaky ReLU æ¿€æ´»å‡½æ•°ï¼Œä»ç”± $U[\text{min}, \text{max}]$ æŒ‡å®šçš„å‡åŒ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆï¼Œ

$$ \lambda_i = F_U\left[-\sqrt{\frac{6}{n_{\text{in}}}},\ \sqrt{\frac{6}{n_{\text{in}}}}\right]^{-1}(p^\ell) $$

+   å…¶ä¸­ $F^{-1}_U$ æ˜¯ç´¯ç§¯åˆ†å¸ƒå‡½æ•°çš„é€†ï¼Œ$p$ æ˜¯è¾“å…¥çš„æ•°é‡ï¼Œ$k$ æ˜¯è¾“å‡ºçš„æ•°é‡ï¼Œè€Œ $p^{\ell}$ æ˜¯ä»å‡åŒ€åˆ†å¸ƒ $U[0,1]$ ä¸­æŠ½å–çš„éšæœºç´¯ç§¯æ¦‚ç‡å€¼ã€‚

1.  **æ­£å‘ä¼ æ’­** - è¿›è¡Œé¢„æµ‹ï¼Œ$\hat{y}$ã€‚åˆå§‹é¢„æµ‹åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£å°†æ˜¯éšæœºçš„ï¼Œä½†ä¼šé€æ¸æ”¹è¿›ã€‚

![å›¾ç‰‡](img/08556ecbd47d143019d0163dc95761cf.png)

ä½¿ç”¨éšæœºåˆå§‹åŒ–çš„æ¨¡å‹å‚æ•°ã€æƒé‡å’Œåç½®çš„äººå·¥ç¥ç»ç½‘ç»œè¿›è¡Œé¢„æµ‹ã€‚

1.  **è®¡ç®—è¯¯å·®å¯¼æ•°** - ç»™å®šæŸå¤± $P = \frac{1}{2} \left(\hat{y} - y \right)Â²$ï¼Œè¯¯å·®å¯¼æ•°ï¼Œå³è¯¯å·®éšæ¨¡å‹ä¼°è®¡å˜åŒ–çš„å˜åŒ–ç‡æ˜¯ $\frac{\partial P}{\partial \hat{y}} = \hat{Y} - Y$ã€‚

+   ç°åœ¨ï¼Œè®©æˆ‘ä»¬åªè€ƒè™‘ä¸€ä¸ªä¼°è®¡å€¼ï¼Œç¨åæˆ‘ä»¬å°†è§£å†³è¶…è¿‡ 1 ä¸ªè®­ç»ƒæ•°æ®ã€‚

1.  **åå‘ä¼ æ’­è¯¯å·®å¯¼æ•°** - æˆ‘ä»¬é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œåå‘ç§»åŠ¨ä»¥è®¡ç®—æ‰€æœ‰æ¨¡å‹æƒé‡å’Œåç½®å‚æ•°çš„è¯¯å·®å¯¼æ•°ï¼Œä¸ºæ­¤æˆ‘ä»¬ä½¿ç”¨é“¾å¼æ³•åˆ™ï¼Œ

$$ \frac{\partial}{\partial x} f(g(h(x))) = \frac{\partial f}{\partial g} \cdot \frac{\partial g}{\partial h} \cdot \frac{\partial h}{\partial x} $$

1.  **æ›´æ–°æ¨¡å‹å‚æ•°** - æ ¹æ®å¯¼æ•°ï¼Œ$\frac{\partial P}{\partial \lambda_{i,j}}$ å’Œå­¦ä¹ ç‡ $\eta$ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ

$$ \lambda_{i,j}^{\ell} = \lambda_{i,j}^{\ell - 1} + \eta \cdot \frac{\partial P}{\partial \lambda_{i,j}} $$

1.  **é‡å¤ç›´åˆ°æ”¶æ•›** - è¿”å›æ­¥éª¤ 1ï¼Œç›´åˆ°è¯¯å·® $P$ é™ä½åˆ°å¯æ¥å—çš„æ°´å¹³ï¼Œå³æ¨¡å‹æ”¶æ•›æ˜¯åœæ­¢è¿­ä»£çš„æ¡ä»¶

## åå‘ä¼ æ’­

ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘å»ºè®®æ‚¨å‚è€ƒäººå·¥ç¥ç»ç½‘ç»œç« èŠ‚ï¼Œäº†è§£é€šè¿‡ç¥ç»ç½‘ç»œåå‘ä¼ æ’­è¯¯å·®æ¢¯åº¦çš„è¿‡ç¨‹ã€‚

## æ›´æ–°æ¨¡å‹å‚æ•°

æ¨¡å‹å‚æ•°çš„å¯¼æ•°æ˜¯è¯¯å·®æ¢¯åº¦ï¼Œå› æ­¤æˆ‘ä»¬å‡†å¤‡ä½¿ç”¨æ¢¯åº¦ä¸‹é™ä¼˜åŒ–ï¼Œå¹¶æ·»åŠ ï¼Œ

+   **å­¦ä¹ ç‡** - ä¸ºäº†ç¼©æ”¾æ¨¡å‹æ›´æ–°çš„å˜åŒ–ç‡ï¼Œæˆ‘ä»¬åˆ†é…ä¸€ä¸ªå­¦ä¹ ç‡ $\eta$ã€‚å¯¹äºä¸Šé¢æåˆ°çš„æ¨¡å‹å‚æ•°ç¤ºä¾‹ï¼Œ

$$ \lambda_{9,12}^{\ell} = \lambda_{9,12}^{\ell - 1} - \eta \cdot \frac{\partial P}{\partial \lambda_{9,12}} $$$$ \lambda_{10,12}^{\ell} = \lambda_{10,12}^{\ell - 1} - \eta \cdot \frac{\partial P}{\partial \lambda_{10,12}} $$$$ b_{12}^{\ell} = b_{12}^{\ell - 1} + \eta \cdot \frac{\partial P}{\partial b_{12}} $$

+   å›æƒ³ï¼Œè¿™ä¸ªæ¢¯åº¦è®¡ç®—å’Œæ¨¡å‹å‚æ•°ã€æƒé‡å’Œåç½®æ›´æ–°è¿‡ç¨‹æ˜¯è¿­ä»£çš„ï¼Œè¢«ç§°ä¸ºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–ã€‚

+   ç›®æ ‡æ˜¯æ¢ç´¢æŸå¤±è¶…æ›²é¢ï¼Œé¿å…å’Œé€ƒç¦»å±€éƒ¨æœ€å°å€¼ï¼Œæœ€ç»ˆæ‰¾åˆ°å…¨å±€æœ€å°å€¼ã€‚

+   å­¦ä¹ ç‡ï¼Œä¹Ÿç§°ä¸ºæ­¥é•¿ï¼Œé€šå¸¸è®¾ç½®åœ¨ 0.0 å’Œ 1.0 ä¹‹é—´ï¼Œæ³¨æ„åœ¨ TensorFlow çš„ Keras æ¨¡å—ä¸­é»˜è®¤å€¼ä¸º 0.01

+   **ä½å­¦ä¹ ç‡** â€“ æ›´ç¨³å®šï¼Œä½†è§£çš„é€Ÿåº¦è¾ƒæ…¢ï¼Œå¯èƒ½ä¼šé™·å…¥å±€éƒ¨æœ€å°å€¼

+   **é«˜å­¦ä¹ ç‡** â€“ å¯èƒ½ä¸ç¨³å®šï¼Œä½†å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¿«çš„è§£å†³æ–¹æ¡ˆï¼Œå¯èƒ½ä¼šåç¦»å…¨å±€æœ€å°å€¼

ä¸€ç§ç­–ç•¥æ˜¯å¼€å§‹ä½¿ç”¨é«˜å­¦ä¹ ç‡ï¼Œç„¶ååœ¨è¿­ä»£è¿‡ç¨‹ä¸­é€æ¸é™ä½å­¦ä¹ ç‡

+   **å­¦ä¹ ç‡è¡°å‡** - è®¾ç½®ä¸º>0 ä»¥é¿å…å‡è½»æŒ¯è¡ï¼Œ

## è®­ç»ƒ epoch

è¿™æ­£æ˜¯è®¨è®ºéšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–çš„å¥½æ—¶æœºï¼Œé¦–å…ˆè®©æˆ‘ä»¬å®šä¹‰ä¸€äº›å¸¸è§æœ¯è¯­ï¼Œ

+   **æ‰¹é‡æ¢¯åº¦ä¸‹é™** - åœ¨é€šè¿‡æ‰€æœ‰æ•°æ®åæ›´æ–°æ¨¡å‹å‚æ•°

+   **éšæœºæ¢¯åº¦ä¸‹é™** - åœ¨æ¯ä¸ªæ ·æœ¬æ•°æ®ä¸Šæ›´æ–°æ¨¡å‹å‚æ•°

+   **è¿·ä½ æ‰¹æ¬¡æ¢¯åº¦ä¸‹é™** - åœ¨é€šè¿‡å•ä¸ªæ‰¹æ¬¡åæ›´æ–°æ¨¡å‹å‚æ•°

ä½¿ç”¨è¿·ä½ æ‰¹æ¬¡æ¢¯åº¦ä¸‹é™ï¼Œé€šè¿‡ä½¿ç”¨æ•°æ®å­é›†ï¼ˆç§°ä¸ºæ‰¹æ¬¡ï¼‰å¼•å…¥äº†éšæœºæ€§ï¼Œ

+   ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å°†æˆ‘ä»¬çš„ 100 ä¸ªæ ·æœ¬åˆ†æˆ 4 ä¸ªæ‰¹æ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å•ç‹¬è¿­ä»£æ¯ä¸ªæ‰¹æ¬¡

+   æˆ‘ä»¬é€šè¿‡åŠ å¿«å•ä¸ªæ›´æ–°æ¥åŠ é€Ÿï¼Œè¾ƒå°‘çš„æ•°æ®è®¡ç®—å¾—æ›´å¿«ï¼Œä½†å¼•å…¥äº†æ›´å¤šçš„é”™è¯¯

+   è¿™é€šå¸¸æœ‰åŠ©äºè®­ç»ƒæ¢ç´¢å…¨å±€æœ€å°å€¼ï¼Œå¹¶é¿å…é™·å…¥å±€éƒ¨æœ€å°å€¼ä»¥åŠæŸå¤±è¶…æ›²é¢ä¸Šçš„è„Š

æœ€åï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå®šä¹‰æœ€åä¸€ä¸ªæœ¯è¯­ï¼Œ

+   **epoch** - æ˜¯å¯¹æ‰€æœ‰æ•°æ®çš„å•æ¬¡éå†ï¼Œå› æ­¤å¦‚æœæœ‰ 4 ä¸ªè¿·ä½ æ‰¹æ¬¡ï¼Œé‚£ä¹ˆå°†ä¼šæœ‰ 4 æ¬¡æ›´æ–°æ¨¡å‹å‚æ•°çš„è¿­ä»£

æˆ‘å°†åœ¨ä»¥åæ·»åŠ è®¸å¤šå…¶ä»–è€ƒè™‘å› ç´ ï¼ŒåŒ…æ‹¬ï¼Œ

+   åŠ¨é‡

+   è‡ªé€‚åº”ä¼˜åŒ–

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ‰‹åŠ¨æ„å»ºä¸Šè¿°äººå·¥ç¥ç»ç½‘ç»œå¹¶å¯è§†åŒ–è§£å†³æ–¹æ¡ˆï¼

+   è¿™æ˜¯ä¸ºäº†æ‰‹åŠ¨æ“ä½œï¼Œä»¥ä¾¿ä½ å¯ä»¥çœ‹åˆ°æ¯ä¸ªè®¡ç®—ã€‚æˆ‘æ•…æ„é¿å…äº†ä½¿ç”¨ TensorFlow æˆ– PyTorchã€‚

## ä½¿ç”¨å¤šä¸ªè®­ç»ƒå›¾åƒè¿›è¡Œè®­ç»ƒ

åå‘ä¼ æ’­åŸºäºå•ä¸ªæ ·æœ¬ï¼Œå³è®­ç»ƒå›¾åƒå’Œé…å¯¹çš„å“åº”ç‰¹å¾å€¼ï¼›å› æ­¤ï¼Œä¸ºäº†åœ¨å¤šä¸ªå›¾åƒä¸Šè®­ç»ƒï¼Œæˆ‘ä»¬å¿…é¡»å¾ªç¯éå†ï¼Œ

+   å‰å‘ä¼ æ’­

+   è®¡ç®—è¯¯å·®å¯¼æ•°

+   åå‘ä¼ æ’­

![](img/911e3eed1fd228a0da4716b460c82d38.png)

æ‰¹é‡è®­ç»ƒè¿‡ç¨‹ã€‚

å¯¹äºæ¯å¼ å›¾åƒï¼Œå­˜å‚¨æƒé‡å’Œåå·®æ¢¯åº¦ã€‚ç„¶åï¼Œå°†æ¢¯åº¦åœ¨æ‰¹æ¬¡ä¸­çš„å›¾åƒä¸Šæ±‚å’Œï¼Œå¹¶å°†æ­¤æ€»å’Œåº”ç”¨äºå­¦ä¹ ç‡ä»¥æ›´æ–°æƒé‡å’Œåå·®ã€‚

## å‰å‘ä¼ æ’­

ä¸ºäº†æ¸…æ™°èµ·è§ï¼Œè®©æˆ‘ä»¬ä»å›¾åƒè¾“å…¥å¼€å§‹ï¼Œé€æ­¥è®²è§£å·ç§¯ç¥ç»ç½‘ç»œã€‚

è¾“å…¥èŠ‚ç‚¹æ¥æ”¶å›¾åƒè¾“å…¥åˆ°å·ç§¯å±‚çš„è¾“å…¥ï¼Œ

+   ä¿ç•™èŠ‚ç‚¹é¡ºåºä»¥ä¿ç•™ä»å›¾åƒä¸­è·å–çš„ç©ºé—´ã€ä½ç½®ä¿¡æ¯

å¯¹äºè¿ç»­ç‰¹å¾å›¾åƒï¼Œ

+   è¿ç»­é¢„æµ‹å™¨çš„ç‰¹å¾å€¼è¢«å½’ä¸€åŒ–åˆ°[0,1]æˆ–[-1,1]çš„æœ€å°/æœ€å¤§å€¼ï¼Œä»¥æé«˜ç‰¹å®šæ¿€æ´»å‡½æ•°çš„æ•æ„Ÿæ€§

+   å¯¹äºå½©è‰²å›¾åƒï¼ŒRGB é€šé“å¯ä»¥åˆ†åˆ«å½’ä¸€åŒ–å¹¶ä½œä¸º 3 ä¸ªè¾“å…¥é€šé“åŒ…å«

å¯¹äºåˆ†ç±»ç‰¹å¾å›¾åƒï¼Œ

+   å¯¹äºäºŒè¿›åˆ¶ï¼ŒåŸºæ•° 2ï¼Œå€¼å¯ä»¥é€šè¿‡æŒ‡ç¤ºå˜æ¢é‡æ–°åˆ†é…ä¸º 0 æˆ– 1

+   å¯¹äºåŸºæ•°å¤§äº 2 çš„æƒ…å†µï¼Œå¯èƒ½åº”ç”¨ one-hot ç¼–ç ï¼Œä»è€Œäº§ç”Ÿ$k$ä¸ªè¾“å…¥é€šé“

æœ‰å…³è¿™äº›è½¬æ¢çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ç‰¹å¾è½¬æ¢ç« èŠ‚ã€‚

ç°åœ¨æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå·ç§¯å±‚ï¼ŒåŒ…å«å·ç§¯å’Œæ¿€æ´»æ“ä½œï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„ç‰¹å¾å›¾ã€‚

![](img/02745c4fdecaad32e59683bafa3d0820.png)

æˆ‘ä»¬æ‰‹åŠ¨å®ç°çš„å·ç§¯ç¥ç»ç½‘ç»œçš„è®²è§£ï¼Œé€šè¿‡å·ç§¯å±‚ã€‚

+   æ ¹æ®è¾“å…¥å›¾åƒæˆ–å‰ä¸€ä¸ªç‰¹å¾å›¾çš„æ ¸è¿›è¡Œçº¿æ€§åŠ æƒç»„åˆï¼Œæ·»åŠ ä¸€ä¸ªåç½®é¡¹ï¼Œç„¶åå¯¹ç»“æœè¿›è¡Œéçº¿æ€§å˜æ¢ï¼Œè¿™ç§å˜æ¢ç§°ä¸ºæ¿€æ´»å‡½æ•° $\alpha$ã€‚

$$ C_{j_{\text{in}}} = \sum_{i=1}^{n} \left( K_{i+5} \cdot I_{j-8} \right) + b_{conv} $$

å…¶ä¸­ï¼Œ$K_6$ã€$K_7$ å’Œ $K_8$ æ˜¯æ ¸æƒé‡ï¼Œ$b_{conv}$ æ˜¯æ ¸åç½®ï¼Œ$I$ æ˜¯è¾“å…¥èŠ‚ç‚¹ã€‚

è¯·åŸè°…æ–¹ç¨‹ä¸­å¥‡æ€ªçš„ç´¢å¼•ï¼Œæˆ‘å–œæ¬¢ä¸ºæ¯ä¸ªèŠ‚ç‚¹ä½¿ç”¨å”¯ä¸€çš„èŠ‚ç‚¹æ•´æ•°ï¼Œä»¥é¿å…åœ¨æˆ‘çš„ç¬”è®°å’Œä»£ç ä¸­æ··æ·†èŠ‚ç‚¹ï¼Œä½†è¿™ç¡®å®ä½¿ç´¢å¼•åˆ†é…å˜å¾—å¤æ‚ã€‚

$$ C_{9_{\text{in}}} = I_1 \cdot K_6 + I_2 \cdot K_7 + I_3 \cdot K_8 + b_{\text{conv}} $$$$ C_{10_{\text{in}}} = I_2 \cdot K_6 + I_3 \cdot K_7 + I_4 \cdot K_8 + b_{\text{conv}} $$$$ C_{11_{\text{in}}} = I_3 \cdot K_6 + I_4 \cdot K_7 + I_5 \cdot K_8 + b_{\text{conv}} $$

ç„¶åå¯¹æ¯ä¸ªåº”ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œ

$$ C_j = \alpha \left( C_{j_{in}} \right) \quad j = 9, \ldots 11 $$

ç°åœ¨æˆ‘ä»¬ä»ç‰¹å¾å›¾å¼€å§‹ï¼Œé€šè¿‡äººå·¥ç¥ç»ç½‘ç»œåˆ°è¾“å‡ºå±‚ã€‚

è¿™åªæ˜¯ä¸€ä¸ªæ ‡å‡†çš„äººå·¥ç¥ç»ç½‘ç»œï¼Œå®ƒå°†å±•å¹³çš„ç‰¹å¾å›¾ç§»åŠ¨åˆ°è¾“å‡ºå±‚ã€‚

+   åœ¨æœ¬ä¾‹ä¸­ä¸ºäº†ç®€æ´ï¼Œæˆ‘ä»¬å±•ç¤ºäº†æœ€ç®€å•çš„å¯èƒ½çš„äººå·¥ç¥ç»ç½‘ç»œï¼Œå³ç‰¹å¾å›¾ä¹‹åçš„ä¸‹ä¸€å±‚å°±æ˜¯è¾“å‡ºå±‚ã€‚æ›´å¤æ‚çš„æ¶æ„ï¼Œé€šå¸¸åŒ…å«éšè—å±‚ã€‚

+   æ­¤å¤–ï¼Œç”±äºæˆ‘ä»¬çš„å›¾åƒæ˜¯ 1 ç»´çš„ï¼Œæˆ‘ä»¬ä¸éœ€è¦è¿›è¡Œå±•å¹³æ­¥éª¤

è¾“å‡ºèŠ‚ç‚¹æ˜¯äººå·¥ç¥ç»ç½‘ç»œçš„æ ‡å‡†è¾“å‡ºèŠ‚ç‚¹ï¼Œ

+   è¾“å…¥æ˜¯å‰ä¸€å±‚èŠ‚ç‚¹çš„çº¿æ€§ç»„åˆï¼Œå¹¶æ·»åŠ ä¸€ä¸ªåç½®é¡¹ã€‚

$$ O_{j_{\text{in}}} = \sum_{j=1}^{m} \left( \lambda_{i,j} \cdot H_i \right) + b_j $$

ç„¶ååº”ç”¨æ¿€æ´»å‡½æ•°ï¼Œ

$$ O_j = \alpha \left( O_{j_{in}} \right) $$

å¯¹äºå›å½’æ¨¡å‹çš„æƒ…å†µï¼Œå…·æœ‰è¿ç»­å“åº”ç‰¹å¾ï¼Œåº”ç”¨çº¿æ€§æˆ–æ’ç­‰æ¿€æ´»å‡½æ•°ï¼Œ

$$ O_j = \alpha \left( O_{j_{in}} \right) = O_{j_{in}} $$![](img/3becddf21de74c01ec2c585108079e0e.png)

æˆ‘ä»¬æ‰‹åŠ¨å®ç°çš„å·ç§¯ç¥ç»ç½‘ç»œçš„è®²è§£ï¼Œä»ç‰¹å¾å›¾åˆ°è¿ç»­è¾“å‡ºçš„è¾“å‡ºå±‚ã€‚

å¯¹äºåˆ†ç±»æ¨¡å‹çš„æƒ…å†µï¼Œå…·æœ‰åˆ†ç±»å“åº”ç‰¹å¾ï¼Œåœ¨ç­‰äºå“åº”ç‰¹å¾åŸºæ•° $K$ çš„ $K$ ä¸ªèŠ‚ç‚¹ä¸Šåº”ç”¨ softmax æ¿€æ´»å‡½æ•°ï¼Œ

+   è¾“å‡ºæ˜¯æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œç¬¦åˆéè´Ÿæ€§å’Œé—­åˆçº¦æŸ

![](img/439615adbac8db26678e58e258f9105f.png)

æˆ‘ä»¬æ‰‹åŠ¨å®ç°çš„å·ç§¯ç¥ç»ç½‘ç»œçš„è®²è§£ï¼Œä»ç‰¹å¾å›¾åˆ°åˆ†ç±»è¾“å‡ºçš„è¾“å‡ºå±‚ã€‚

$$ O_j = g_k(O_{j_{\text{in}}}) = \frac{e^{O_{j_{\text{in}}}}}{\sum_{\iota=1}^{K} e^{O_{\iota_{\text{in}}}}} $$

## å¯¼å…¥æ‰€éœ€çš„åŒ…

æˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›æ ‡å‡†åŒ…ã€‚è¿™äº›åº”è¯¥å·²ç»ä¸ Anaconda 3 ä¸€èµ·å®‰è£…ã€‚

+   è®°ä½ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰‹åŠ¨æ„å»ºä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œï¼Œåªä½¿ç”¨åŸºæœ¬çš„æ•°å­¦å’Œæ•°ç»„è¿ç®—ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦ NumPy ä»¥åŠ matplotlib è¿›è¡Œç»˜å›¾ã€‚

```py
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from matplotlib.ticker import (MultipleLocator, AutoMinorLocator, AutoLocator) # control of axes ticks
plt.rc('axes', axisbelow=True)                            # set axes and grids in the background for all plots
import math
seed = 13 
```

å¦‚æœä½ é‡åˆ°åŒ…å¯¼å…¥é”™è¯¯ï¼Œä½ å¯èƒ½éœ€è¦é¦–å…ˆå®‰è£…è¿™äº›åŒ…ä¸­çš„æŸäº›ã€‚è¿™é€šå¸¸å¯ä»¥é€šè¿‡åœ¨ Windows ä¸Šæ‰“å¼€å‘½ä»¤çª—å£ç„¶åè¾“å…¥â€˜python -m pip install [package-name]â€™æ¥å®Œæˆã€‚æœ‰å…³ç›¸åº”åŒ…çš„æ–‡æ¡£å¯ä»¥æä¾›æ›´å¤šå¸®åŠ©ã€‚

## å£°æ˜å‡½æ•°

è¿™é‡Œæ˜¯åˆ›å»ºã€è®­ç»ƒå’Œå¯è§†åŒ–æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œçš„å‡½æ•°ã€‚

```py
def add_grid():
    plt.gca().grid(True, which='major',linewidth = 1.0); plt.gca().grid(True, which='minor',linewidth = 0.2) # add y grids
    plt.gca().tick_params(which='major',length=7); plt.gca().tick_params(which='minor', length=4)
    plt.gca().xaxis.set_minor_locator(AutoMinorLocator()); plt.gca().yaxis.set_minor_locator(AutoMinorLocator()) # turn on minor ticks 

def calculate_angle_rads(x1, y1, x2, y2):
    dx = x2 - x1     # Calculate the differences
    dy = y2 - y1
    angle_rads = math.atan2(dy, dx)    # Calculate the angle in radians
    #angle_degrees = math.degrees(angle_radians)    # Convert the angle to degrees
    return angle_rads

def offset(pto, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = pto[0] + distance * math.cos(angle_rads) # Calculate the new coordinates
    y_new = pto[1] + distance * math.sin(angle_rads)
    return np.array((x_new, y_new))

def offsetx(xo, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates
    return np.array((xo, x_new))

def offset_arrx(xo, distance, angle_deg,size): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates
    x_arr = x_new + size * math.cos(angle_rads+2.48) # Calculate the new coordinates
    return np.array((x_new, x_arr))

def offsety(yo, distance, angle_deg): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates
    return np.array((yo, y_new))

def offset_arry(yo, distance, angle_deg,size): # modified from ChatGPT 4.o generated
    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians
    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates
    y_arr = y_new + size * math.sin(angle_rads+2.48) # Calculate the new coordinates
    return np.array((y_new, y_arr))

def lint(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    x = x1 + t * (x2 - x1)
    y = y1 + t * (y2 - y1)
    return np.array((x, y))

def lintx(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    x = x1 + t * (x2 - x1)
    return x

def linty(x1, y1, x2, y2, t):
    # Calculate the interpolated coordinates
    y = y1 + t * (y2 - y1)
    return y

def lint_intx(x1, y1, x2, y2, ts, te):
    # Calculate the interpolated coordinates
    xs = x1 + ts * (x2 - x1)
    xe = x1 + te * (x2 - x1)
    return np.array((xs,xe))

def lint_inty(x1, y1, x2, y2, ts, te):
    # Calculate the interpolated coordinates
    ys = y1 + ts * (y2 - y1)
    ye = y1 + te * (y2 - y1)
    return np.array((ys,ye))

def lint_int_arrx(x1, y1, x2, y2, ts, te, size):
    # Calculate the interpolated coordinates
    xe = x1 + te * (x2 - x1)
    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)
    x_arr = xe + size * math.cos(line_angle_rads+2.48) # Calculate the new coordinates
    return np.array((xe,x_arr))

def lint_int_arry(x1, y1, x2, y2, ts, te, size):
    # Calculate the interpolated coordinates
    ye = y1 + te * (y2 - y1)
    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)
    y_arr = ye + size * math.sin(line_angle_rads+2.48) # Calculate the new coordinates
    return np.array((ye,y_arr))

def as_si(x, ndp): # from xnx on StackOverflow https://stackoverflow.com/questions/31453422/displaying-numbers-with-x-instead-of-e-scientific-notation-in-matplotlib 
    s = '{x:0.{ndp:d}e}'.format(x=x, ndp=ndp)
    m, e = s.split('e')
    return r'{m:s}\times 10^{{{e:d}}}'.format(m=m, e=int(e)) 
```

## ç®€å•çš„æ‰‹åŠ¨ CNN

æˆ‘ç¼–å†™äº†è¿™æ®µä»£ç æ¥æŒ‡å®šä¸€ä¸ªç®€å•çš„ CNNï¼Œ

+   äº”ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œ1 ä¸ªå…·æœ‰ 3 ä¸ªæ ¸çš„å·ç§¯å±‚ï¼Œåœ¨ç‰¹å¾å›¾ä¸­æœ‰ 3 ä¸ªèŠ‚ç‚¹ï¼Œ1 ä¸ªè¾“å‡ºèŠ‚ç‚¹

å¹¶ä¸”é€šè¿‡è¿­ä»£æ‰§è¡Œå‰å‘è®¡ç®—å’Œåå‘ä¼ æ’­æ¥è®­ç»ƒ CNNã€‚æˆ‘è®¡ç®—ï¼š

+   ç„¶åå°†å®ƒä¼ æ’­åˆ°æ¯ä¸ªèŠ‚ç‚¹

+   æ±‚è§£è¯¯å·®ç›¸å¯¹äºæ¯ä¸ªæƒé‡å’Œåå·®çš„åå¯¼æ•°

æ‰€æœ‰æƒé‡ã€åå·®å’Œæ‰€æœ‰ epoch çš„åå¯¼æ•°éƒ½è®°å½•åœ¨å‘é‡ä¸­ä»¥è¿›è¡Œç»˜å›¾ã€‚

```py
# initial CNN trains on one sample
x1 = 0.1; x2 = 0.2; x3 = 0.3; x4 = 0.4; x5 = 0.5; y = 0.1 # training data
lr = 0.2 # learning rate

np.random.seed(seed=seed)

nepoch = 1000

w6 = np.zeros(nepoch); w7 = np.zeros(nepoch); w8 = np.zeros(nepoch)
w9 = np.zeros(nepoch); w10 = np.zeros(nepoch); w11 = np.zeros(nepoch)
bconv = np.zeros(nepoch); b12 = np.zeros(nepoch)

k6i1 = np.zeros(nepoch); k6i2 = np.zeros(nepoch); k6i3 = np.zeros(nepoch)
k7i2 = np.zeros(nepoch); k7i3 = np.zeros(nepoch); k7i4 = np.zeros(nepoch)
k8i3 = np.zeros(nepoch); k8i4 = np.zeros(nepoch); k8i5 = np.zeros(nepoch)

dk6i1 = np.zeros(nepoch); dk6i2 = np.zeros(nepoch); dk6i3 = np.zeros(nepoch)
dk7i2 = np.zeros(nepoch); dk7i3 = np.zeros(nepoch); dk7i4 = np.zeros(nepoch)
dk8i3 = np.zeros(nepoch); dk8i4 = np.zeros(nepoch); dk8i5 = np.zeros(nepoch)

c9 = np.zeros(nepoch); c10 = np.zeros(nepoch); c11 = np.zeros(nepoch)
d9 = np.zeros(nepoch); d10 = np.zeros(nepoch); d11 = np.zeros(nepoch)

o12 = np.zeros(nepoch)

dw6 = np.zeros(nepoch); dw7 = np.zeros(nepoch); dw8 = np.zeros(nepoch)
dw9 = np.zeros(nepoch); dw10 = np.zeros(nepoch); dw11 = np.zeros(nepoch)
dbconv = np.zeros(nepoch); db12 = np.zeros(nepoch)

d6 = np.zeros(nepoch); d7 = np.zeros(nepoch); d8 = np.zeros(nepoch); 
d19 = np.zeros(nepoch); d10 = np.zeros(nepoch); d11 = np.zeros(nepoch); d12 = np.zeros(nepoch); 

# initialize the weights - Xavier Weight Initialization 
lower, upper = -(1.0 / np.sqrt(3.0)), (1.0 / np.sqrt(3.0)) # lower and upper bound for the weights, uses inputs to node
#lower, upper = -(sqrt(6.0) / sqrt(3.0 + 2.0)), (sqrt(6.0) / sqrt(3.0 + 2.0)) # Normalized Xavier weights, integrates ouputs also
w6[0] = lower + np.random.random() * (upper - lower); 
w7[0] = lower + np.random.random() * (upper - lower); 
w8[0] = lower + np.random.random() * (upper - lower);

lower, upper = -(1.0 / np.sqrt(2.0)), (1.0 / np.sqrt(2.0))
#lower, upper = -(sqrt(6.0) / sqrt(2.0 + 1.0)), (sqrt(6.0) / sqrt(2.0 + 1.0)) # Normalized Xavier weights, integrates ouputs also

w9[0] = lower + np.random.random() * (upper - lower); 
w10[0] = lower + np.random.random() * (upper - lower);     
w11[0] = lower + np.random.random() * (upper - lower);     

#b4[0] = np.random.random(); b5[0] = np.random.random(); b6[0] = np.random.random()
bconv[0] = (np.random.random()-0.5)*0.5
b12[0] = (np.random.random()-0.5)*0.5; # small random value 

for i in range(0,nepoch):

# forward pass of model
    c9[i] = w6[i]*x1 + w7[i]*x2 + w8[i]*x3 + bconv[i]; 
    c9[i] = 1.0/(1 + math.exp(-1*c9[i]))

    c10[i] = w6[i]*x2 + w7[i]*x3 + w8[i]*x4 + bconv[i]; 
    c10[i] = 1.0/(1 + math.exp(-1*c10[i]))

    c11[i] = w6[i]*x3 + w7[i]*x4 + w8[i]*x5 + bconv[i]; 
    c11[i] = 1.0/(1 + math.exp(-1*c11[i]))

    o12[i] = w9[i]*c9[i] + w10[i]*c10[i] + w11[i]*c11[i] + b12[i]

# back propagate the error through the nodes
    d12[i] = (o12[i]-y) # identity activation o at o12 - switched substraction on May 27, 2025
    d9[i] =  c9[i]*(1-c9[i])*w9[i]*d12[i]   # propagate to the front feature map layer
    d10[i] = c10[i]*(1-c10[i])*w10[i]*d12[i]
    d11[i] = c11[i]*(1-c11[i])*w11[i]*d12[i]

    dk6i1 = x1*d9[i]; dk7i2 = x2*d9[i]; dk8i3 = x3*d9[i] 
    dk6i2 = x2*d10[i]; dk7i3 = x3*d10[i]; dk8i4 = x4*d10[i] 
    dk6i3 = x3*d11[i]; dk7i4 = x4*d11[i]; dk8i5 = x5*d11[i] 

    d6[i] = dk6i1 + dk6i2 + dk6i3
    d7[i] = dk7i2 + dk7i3 + dk7i4
    d8[i] = dk8i3 + dk8i4 + dk8i5

# calculate the change in weights
    if i < nepoch - 1:
        dw6[i] = lr*d6[i]; dw7[i] = lr*d7[i]; dw8[i] = lr*d8[i]
        dw9[i] = lr*c9[i]*d12[i]; dw10[i] = lr*c10[i]*d12[i]; dw11[i] = lr*c11[i]*d12[i];
        dbconv[i] = lr*(d9[i] + d10[i] + d11[i]); db12[i] = lr*d12[i]

        w6[i+1] = w6[i] - dw6[i]; w7[i+1] = w7[i] - dw7[i]; w8[i+1] = w8[i] - dw8[i]
        w9[i+1] = w9[i] - dw9[i]; w10[i+1] = w10[i] - dw10[i]; w11[i+1] = w11[i] - dw11[i]
        bconv[i+1] = bconv[i] - dbconv[i]; b12[i+1] = b12[i] - db12[i] 
```

## æ‰‹åŠ¨å¯è§†åŒ– CNN

è®©æˆ‘ä»¬å¯è§†åŒ–æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œã€‚

+   æ³¨æ„ï¼Œæˆ‘å°†åœ¨ä»¥åä½¿ç”¨æ­¤ä»£ç åˆ›å»ºäº¤äº’å¼ä»ªè¡¨æ¿ã€‚

```py
xin = 0.1; yin_range = 0.7
nin = 5

kcolors = ['red','blue','green']
xin = np.array([0.1,0.2,0.3,0.4,0.5])
yout = np.array([y])
cin = np.array([0.1,0.2,0.3])
kx = 0.6

plt.subplot(111)
#plt.gca().set_axis_off()

for i, (xi) in enumerate(zip(xin), start=1):
    eq1 = r"$X_{{{}}}$".format(i)
    eq2 = r"$X_{{{}}} = {}$".format(i, xi[0])
    eq3 = r"$I_{{{}}}$".format(i)
    xpos = 0.4; ypos = yin_range - ((i-1)/nin) * yin_range 
    circle_i1 = plt.Circle((xpos,ypos), 0.015, fill=False, edgecolor = 'black',lw=1,zorder=100); 
    circle_i1b = plt.Circle((xpos,ypos), 0.025, fill=True, facecolor = 'white',edgecolor = None,lw=0.5,zorder=10);
    plt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)
    plt.annotate(eq1, (xpos-0.2, ypos), textcoords="offset points", xytext=(-12, -3), ha='center',size=15)
    plt.annotate(eq2, (xpos, ypos), textcoords="offset points", xytext=(-70, 9), ha='center')
    plt.plot([xpos-0.2,xpos],[ypos,ypos],color='black',lw=2); plt.plot([xpos-0.2,xpos-0.07],[ypos+0.01,ypos+0.01],color='black',lw=2)
    plt.plot([xpos-0.07,xpos-0.08],[ypos+0.01,ypos+0.02],color='black',lw=2)
    plt.annotate(eq3, (xpos,ypos), textcoords="offset points", xytext=(-15, 15), ha='center',size = 15)

for iconv in range(0,3):  
    xpos = kx+iconv*0.2;
    ytop = yin_range - (iconv/nin)*yin_range - ((1-1)/nin) * yin_range
    ybot = yin_range - (iconv/nin)*yin_range - ((3-1)/nin) * yin_range  
    plt.plot([xpos+0.12,xpos+0.12],[ytop+0.005,ybot+0.005],color='red',lw=1,ls='--',zorder=80)
    for ik, (ki) in enumerate(zip(np.arange(1,4,1)), start=1):
        eq4 = r"$K_{{{}}}$".format(ik+5)
        ypos = yin_range - (iconv/nin)*yin_range - ((ik-1)/nin) * yin_range
        circle_i1 = plt.Circle((xpos,ypos), 0.015, fill=True, facecolor = kcolors[ik-1],edgecolor = 'black',lw=1,zorder=200);
        circle_i1b = plt.Circle((xpos,ypos), 0.025, fill=True, facecolor='white',edgecolor = None,lw=0.5,zorder=190);
        plt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)
        plt.annotate(eq4, (xpos,ypos), textcoords="offset points", xytext=(-15, 15), ha='center',size = 15)
        plt.plot([0.4,xpos],[ypos,ypos],color='black',lw=1,zorder=1)
        plt.plot([xpos,xpos+0.12],[ypos+0.005,ypos+0.005],color='red',lw=1,ls='--',zorder=80)
        eq8 = r"$I_{{{}}} \cdot K_{{{}}}$".format((iconv)+ik,ik+5)        
        plt.annotate(eq8, (xpos+0.12, ypos), textcoords="offset points", xytext=(-25, 5), ha='center',size = 10)

for ic, (ci) in enumerate(zip(np.arange(1,4,1)), start=1):
    eq5 = r"$C_{{{}}}$".format(ic+8)
    xpos = 1.2; ypos = yin_range - ((ic-1)/4) * yin_range - 0.07
    circle_i1 = plt.Circle((xpos,ypos), 0.015, fill=True, facecolor = 'gold',edgecolor = 'black',lw=1,zorder=200);
    circle_i1b = plt.Circle((xpos,ypos), 0.025, fill=True, facecolor='white',edgecolor = None,lw=0.5,zorder=190);
    plt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)
    plt.annotate(eq5, (xpos,ypos), textcoords="offset points", xytext=(-15, 15), ha='center',size = 15)
    #plt.plot([0.4,x],[y,y],color='black',lw=1,zorder=1)
    plt.plot([xpos,1.5],[ypos,yin_range - ((2-1)/4) * yin_range - 0.07],color='black',lw=1)
    plt.plot([kx+(ic-1)*0.2+0.12,xpos],[ypos,ypos],color='red',lw=1,ls='--',zorder=80)

eq6 = r"$O_{{{}}}$".format(12)
eq7 = r"$Y_{{{}}} = {}$".format(i, np.round(yout[0],2))
xpos = 1.5; ypos = yin_range - ((2-1)/4) * yin_range - 0.07
circle_i1 = plt.Circle((xpos,ypos), 0.015, fill=True, facecolor = 'gold',edgecolor = 'black',lw=1,zorder=200);
circle_i1b = plt.Circle((xpos,ypos), 0.025, fill=True, facecolor='white',edgecolor = None,lw=0.5,zorder=190);
plt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)
plt.annotate(eq6, (xpos, ypos), textcoords="offset points", xytext=(-15, 15), ha='center',size = 15)
plt.annotate(eq7, (xpos, ypos), textcoords="offset points", xytext=(130,-4), ha='center',size = 15)
plt.plot([xpos,xpos+0.2],[ypos,ypos],color='black',lw=2); plt.plot([xpos,xpos+0.13],[ypos+0.01,ypos+0.01],color='black',lw=2)
plt.plot([xpos+0.13,xpos+0.12],[ypos+0.01,ypos+0.02],color='black',lw=2)
plt.annotate(eq6, (xpos, ypos), textcoords="offset points", xytext=(20, 10), ha='center')

plt.xlim([0.,2.]); plt.ylim([0,1])

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=1.3, wspace=0.2, hspace=0.2); plt.show() 
```

![å›¾ç‰‡](img/0b3e6b1109144cd7a0b01bc9d699e751.png)

ç°åœ¨æˆ‘ä»¬å¯ä»¥å¯è§†åŒ–æ¨¡å‹è®­ç»ƒç»“æœï¼ŒåŒ…æ‹¬ï¼Œ

+   æƒé‡å’Œåå·®ä¸è®­ç»ƒ epoch çš„å…³ç³»

+   CNN é¢„æµ‹ä¸è®­ç»ƒ epoch çš„å…³ç³»

```py
plt.subplot(221)
plt.plot(np.arange(1,nepoch+1,1),o12,color='red',label=r'$\hat{y}$'); plt.xlim([1,nepoch]); plt.ylim([0,1])
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - Prediction')
plt.plot([1,nepoch],[y,y],color='black',ls='--'); plt.vlines(400,-1.5,1.5,color='black')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(222)
plt.plot(np.arange(1,nepoch+1,1),w6,color='lightcoral',label = r'$k_6$') 
plt.plot(np.arange(1,nepoch+1,1),w7,color='red',label = r'$k_7$') 
plt.plot(np.arange(1,nepoch+1,1),w8,color='darkred',label = r'$k_8$') 
plt.plot(np.arange(1,nepoch+1,1),bconv,color='dodgerblue',label = r'$b_0$') 
# plt.plot(np.arange(1,nepoch+1,1),w25,color='blue',label = r'$\lambda_{2,5}$') 
# plt.plot(np.arange(1,nepoch+1,1),w35,color='darkblue',label = r'$\lambda_{3,5}$')
# plt.plot(np.arange(1,nepoch+1,1),w46,color='orange',label = r'$\lambda_{4,6}$')
# plt.plot(np.arange(1,nepoch+1,1),w56,color='darkorange',label = r'$\lambda_{5,6}$')
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - Kernel')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(223)
plt.plot(np.arange(1,nepoch+1,1),w9,color='lightgreen',label = r'$\lambda_{9}$') 
plt.plot(np.arange(1,nepoch+1,1),w10,color='green',label = r'$\lambda_{10}$') 
plt.plot(np.arange(1,nepoch+1,1),w11,color='darkgreen',label = r'$\lambda_{11}$') 
plt.plot(np.arange(1,nepoch+1,1),b12,color='darkgreen',label = r'$b_{12}$') 
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - ANN Weights')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=2.1, wspace=0.2, hspace=0.2); plt.show() 
```

![å›¾ç‰‡](img/7dcc0007f13a7312fec3085ca24fbf79.png)

å½“ç„¶ï¼Œä¸Šè¿°ç»“æœå¹¶ä¸éå¸¸å®ç”¨ï¼Œå®é™…ä¸Šæˆ‘ä»¬éœ€è¦æˆ‘ä»¬çš„å·ç§¯ç¥ç»ç½‘ç»œé€šè¿‡å­¦ä¹ è®¸å¤šå›¾åƒæ¥æ³›åŒ–ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸Šé¢æ¼”ç¤ºçš„ 1 ä¸ªã€‚è®©æˆ‘ä»¬ï¼Œ

+   åˆ›å»ºä¸€ä¸ªå¸¦æœ‰æ ‡ç­¾çš„åˆæˆå›¾åƒæ•°æ®é›†

+   å°†æ‰¹é‡è®­ç»ƒæ–¹æ³•åº”ç”¨äºè®­ç»ƒè¿™äº›è®­ç»ƒå›¾åƒé›†åˆã€‚

## åˆ›å»ºå¸¦æœ‰æ ‡ç­¾çš„åˆæˆè®­ç»ƒå›¾åƒ

ä»¥ä¸‹ä»£ç åˆ›å»ºå…·æœ‰å¯å˜æ–œç‡å’ŒåŠ æ€§å™ªå£°çš„ 5 ä¸ªç‚¹çš„éšæœºé…ç½®ï¼Œç„¶åä¿ç•™æ•°æ®çš„æ–œç‡çº¿æ€§å›å½’æ¨¡å‹ä½œä¸ºæ ‡ç­¾ã€‚

å·¥ä½œæµç¨‹åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼Œ

1.  ç»˜åˆ¶ä¸€ä¸ªéšæœºçš„æ–œç‡ï¼Œ$m^{\ell} \sim U\left[-2.0,2.0\right]$

1.  åœ¨æ­¤æ–œç‡çš„ä¸­é—´å€¼å¤„é‡‡æ · 5 ä¸ªå€¼

$$ Z^{\ell} = \left(x-2.5\right)*m^{\ell} $$

1.  åœ¨å€¼çš„ä¸­å€¼å¤„æ·»åŠ éšæœºè¯¯å·®ï¼Œ$\epsilon \sim U\left[-\Delta,\Delta\right]$

\ Z_{\epsilon}^{\ell} = \left(x-2.5\right)*m^{\ell} + U^{-1}\left[-\Delta,\Delta\right \]

1.  è®¡ç®—çº¿æ€§å›å½’æ¨¡å‹çš„æ–œç‡ï¼Œå°†å…¶ä½œä¸ºå“åº”ç‰¹å¾ä¿ç•™ã€‚

$$ m = \frac{<Z_{\epsilon}^{\ell} \cdot x>}{<x \cdot x>} $$

```py
np.random.seed(seed = seed+1)
nsample = 10; nnodes = 5; delta = 0.3
ymat = np.zeros(nsample); x = np.arange(1,nnodes+1,1); Xmat = np.zeros([nsample,nnodes])
for isample in range(0,nsample):
    m = np.random.uniform(low = -2.0, high = 2.0)
    Xmat[isample] = (x-3.0)*m+ np.random.uniform(low=-delta,high=delta,size=nnodes)
    ymat[isample] = np.dot(x, Xmat[isample]) / np.dot(x, x)

isample = 9
plt.subplot(111)
for isample in range(0,nsample):
    plt.scatter(x,Xmat[isample],edgecolor='black',lw=1,zorder=10)
    plt.plot(x,Xmat[isample],lw=1,zorder=1)
    custom_positions = [1,2,3,4,5,5.2]
    custom_labels = ['1','2','3','4','5','Y']
    plt.annotate(np.round(ymat[isample],2),[5.2,Xmat[isample][-1]],size=8,color='black',ha='left')
    plt.gca().set_xticks(custom_positions); plt.gca().set_xticklabels(custom_labels)
    plt.xlim([0.5,5.5]); plt.ylim([-4.5,4.5]); plt.xlabel('index'); plt.ylabel('z'); add_grid(); plt.title('Synthetic 1D Images and Labels')

plt.subplots_adjust(left=0.0, bottom=0.0, right=1.0, top=1.1, wspace=0.2, hspace=0.2); plt.show() 
```

![å›¾ç‰‡](img/e763c68a0e61054a9b3854f895c7ec02.png)

## åœ¨è®¸å¤šè®­ç»ƒå›¾åƒä¸Šè®­ç»ƒç®€å•çš„ CNN

æˆ‘ä¿®æ”¹äº†ä¸Šé¢çš„ä»£ç ï¼Œä½¿å…¶å¾ªç¯éå†è®­ç»ƒå›¾åƒæ‰¹æ¬¡ï¼Œç´¯åŠ è¯¯å·®æ¢¯åº¦ï¼Œå¹¶åœ¨æ¯ä¸ªè®­ç»ƒå‘¨æœŸæ›´æ–°æ‰€æœ‰æƒé‡å’Œåç½®ã€‚

```py
np.random.seed(seed=seed)                                     # CNN trains over multiple samples

lr = 0.2                                                 # learning rate
nepoch = 1000                                    # number of training epochs

w6 = np.zeros(nepoch); w7 = np.zeros(nepoch); w8 = np.zeros(nepoch)  # initialize the CNN weights
w9 = np.zeros(nepoch); w10 = np.zeros(nepoch); w11 = np.zeros(nepoch)
bconv = np.zeros(nepoch); b12 = np.zeros(nepoch)

k6i1 = np.zeros(nepoch); k6i2 = np.zeros(nepoch); k6i3 = np.zeros(nepoch)
k7i2 = np.zeros(nepoch); k7i3 = np.zeros(nepoch); k7i4 = np.zeros(nepoch)
k8i3 = np.zeros(nepoch); k8i4 = np.zeros(nepoch); k8i5 = np.zeros(nepoch)

dk6i1 = np.zeros(nepoch); dk6i2 = np.zeros(nepoch); dk6i3 = np.zeros(nepoch)
dk7i2 = np.zeros(nepoch); dk7i3 = np.zeros(nepoch); dk7i4 = np.zeros(nepoch)
dk8i3 = np.zeros(nepoch); dk8i4 = np.zeros(nepoch); dk8i5 = np.zeros(nepoch)

c9 = np.zeros(nepoch); c10 = np.zeros(nepoch); c11 = np.zeros(nepoch)
d9 = np.zeros(nepoch); d10 = np.zeros(nepoch); d11 = np.zeros(nepoch)

o12 = np.zeros(nepoch); yhat = np.zeros((nepoch,nsample))

dw6 = np.zeros((nepoch,nsample)); dw7 = np.zeros((nepoch,nsample)); dw8 = np.zeros((nepoch,nsample))
dw9 = np.zeros((nepoch,nsample)); dw10 = np.zeros((nepoch,nsample)); dw11 = np.zeros((nepoch,nsample))
dbconv = np.zeros((nepoch,nsample)); db12 = np.zeros((nepoch,nsample))

d6 = np.zeros(nepoch); d7 = np.zeros(nepoch); d8 = np.zeros(nepoch); 
d19 = np.zeros(nepoch); d10 = np.zeros(nepoch); d11 = np.zeros(nepoch); d12 = np.zeros(nepoch); 

# initialize the weights - Xavier Weight Initialization 
lower, upper = -(1.0 / np.sqrt(3.0)), (1.0 / np.sqrt(3.0)) # lower and upper bound for the weights, uses inputs to node
#lower, upper = -(sqrt(6.0) / sqrt(3.0 + 2.0)), (sqrt(6.0) / sqrt(3.0 + 2.0)) # Normalized Xavier weights, integrates ouputs also
w6[0] = lower + np.random.random() * (upper - lower); 
w7[0] = lower + np.random.random() * (upper - lower); 
w8[0] = lower + np.random.random() * (upper - lower);

lower, upper = -(1.0 / np.sqrt(2.0)), (1.0 / np.sqrt(2.0))
#lower, upper = -(sqrt(6.0) / sqrt(2.0 + 1.0)), (sqrt(6.0) / sqrt(2.0 + 1.0)) # Normalized Xavier weights, integrates ouputs also

w9[0] = lower + np.random.random() * (upper - lower); 
w10[0] = lower + np.random.random() * (upper - lower);     
w11[0] = lower + np.random.random() * (upper - lower);     

#b4[0] = np.random.random(); b5[0] = np.random.random(); b6[0] = np.random.random()
bconv[0] = (np.random.random()-0.5)*0.5
b12[0] = (np.random.random()-0.5)*0.5; # small random value 

for i in range(0,nepoch):
    for isample in range(0,nsample):
        x1, x2, x3, x4, x5 = Xmat[isample]; y = ymat[isample]

        # forward pass of model
        c9[i] = w6[i]*x1 + w7[i]*x2 + w8[i]*x3 + bconv[i]; 
        c9[i] = 1.0/(1 + math.exp(-1*c9[i]))

        c10[i] = w6[i]*x2 + w7[i]*x3 + w8[i]*x4 + bconv[i]; 
        c10[i] = 1.0/(1 + math.exp(-1*c10[i]))

        c11[i] = w6[i]*x3 + w7[i]*x4 + w8[i]*x5 + bconv[i]; 
        c11[i] = 1.0/(1 + math.exp(-1*c11[i]))

        o12[i] = w9[i]*c9[i] + w10[i]*c10[i] + w11[i]*c11[i] + b12[i]
        yhat[i,isample] = o12[i]

# back propagate the error through the nodes
        d12[i] = (o12[i]-y) # identity activation o at o12 - switched substraction on May 27, 2025
        d9[i] =  c9[i]*(1-c9[i])*w9[i]*d12[i]   # propagate to the front feature map layer
        d10[i] = c10[i]*(1-c10[i])*w10[i]*d12[i]
        d11[i] = c11[i]*(1-c11[i])*w11[i]*d12[i]

        dk6i1 = x1*d9[i]; dk7i2 = x2*d9[i]; dk8i3 = x3*d9[i] 
        dk6i2 = x2*d10[i]; dk7i3 = x3*d10[i]; dk8i4 = x4*d10[i] 
        dk6i3 = x3*d11[i]; dk7i4 = x4*d11[i]; dk8i5 = x5*d11[i] 

        d6[i] = dk6i1 + dk6i2 + dk6i3
        d7[i] = dk7i2 + dk7i3 + dk7i4
        d8[i] = dk8i3 + dk8i4 + dk8i5

# calculate the change in weights
        if i < nepoch - 1:
            dw6[i,isample] = lr*d6[i]; dw7[i,isample] = lr*d7[i]; dw8[i,isample] = lr*d8[i]
            dw9[i,isample] = lr*c9[i]*d12[i]; dw10[i,isample] = lr*c10[i]*d12[i]; dw11[i,isample] = lr*c11[i]*d12[i];
            dbconv[i,isample] = lr*(d9[i] + d10[i] + d11[i]); db12[i,isample] = lr*d12[i]
    if i < nepoch - 1:
        w6[i+1] = w6[i] - np.average(dw6[i]); w7[i+1] = w7[i] - np.average(dw7[i]); w8[i+1] = w8[i] - np.average(dw8[i])
        w9[i+1] = w9[i] - np.average(dw9[i]); w10[i+1] = w10[i] - np.average(dw10[i]); w11[i+1] = w11[i] - np.average(dw11[i])
        bconv[i+1] = bconv[i] - np.average(dbconv[i]); b12[i+1] = b12[i] - np.average(db12[i]) 
```

ç°åœ¨ï¼Œæˆ‘ä»¬å†æ¬¡å¯ä»¥å¯è§†åŒ–æ¨¡å‹æ€§èƒ½ï¼Œ

+   æ‰€æœ‰è®­ç»ƒå›¾åƒçš„é¢„æµ‹ä¸è®­ç»ƒå‘¨æœŸ

+   æ¨¡å‹æƒé‡å’Œåç½®ä¸è®­ç»ƒå‘¨æœŸ

```py
plt.subplot(221)
for isample in range(0,nsample):
    plt.plot(np.arange(1,nepoch+1,1),yhat[:,isample],color=plt.cm.inferno(isample/nsample),label=r'y' + str(isample))
    plt.plot([0,nepoch],[ymat[isample],ymat[isample]],color=plt.cm.inferno(isample/nsample),ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1,1])
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - Prediction')
plt.vlines(400,-1.5,1.5,color='black')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(222)
plt.plot(np.arange(1,nepoch+1,1),w6,color='lightcoral',label = r'$k_6$') 
plt.plot(np.arange(1,nepoch+1,1),w7,color='red',label = r'$k_7$') 
plt.plot(np.arange(1,nepoch+1,1),w8,color='darkred',label = r'$k_8$') 
plt.plot(np.arange(1,nepoch+1,1),bconv,color='dodgerblue',label = r'$b_0$') 
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - Kernel')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplot(223)
plt.plot(np.arange(1,nepoch+1,1),w9,color='lightgreen',label = r'$\lambda_{9}$') 
plt.plot(np.arange(1,nepoch+1,1),w10,color='green',label = r'$\lambda_{10}$') 
plt.plot(np.arange(1,nepoch+1,1),w11,color='darkgreen',label = r'$\lambda_{11}$') 
plt.plot(np.arange(1,nepoch+1,1),b12,color='darkgreen',label = r'$b_{12}$') 
plt.plot([1,nepoch],[0,0],color='black',ls='--')
plt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')
plt.xlabel('Epochs'); plt.ylabel(r'$\hat{y}$'); plt.title('CNN - ANN Weights')
add_grid(); plt.legend(loc='upper right'); plt.xscale('log')

plt.subplots_adjust(left=0.0, bottom=0.0, right=2.0, top=2.1, wspace=0.2, hspace=0.2); plt.show() 
```

![å›¾ç‰‡é“¾æ¥](img/e175db3feac32085e697870180f28aab.png)

## è¯„è®º

è¿™æ˜¯å¯¹å·ç§¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬å¤„ç†ã€‚å¯ä»¥åšå’Œè®¨è®ºçš„è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘æœ‰å¾ˆå¤šæ›´å¤šçš„èµ„æºã€‚æŸ¥çœ‹æˆ‘çš„[å…±äº«èµ„æºæ¸…å•](https://michaelpyrcz.com/my-resources)ä»¥åŠæœ¬ç« å¼€å¤´å¸¦æœ‰èµ„æºé“¾æ¥çš„ YouTube è®²åº§é“¾æ¥ï¼Œè§†é¢‘æè¿°ä¸­åŒ…å«èµ„æºé“¾æ¥ã€‚

å¸Œæœ›è¿™æœ‰æ‰€å¸®åŠ©ï¼Œ

*è¿ˆå…‹å°”*

## å…³äºä½œè€…

![å›¾ç‰‡é“¾æ¥](img/eb709b2c0a0c715da01ae0165efdf3b2.png)

åœ¨å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ 40 è‹±äº©æ ¡å›­å†…ï¼Œè¿ˆå…‹å°”Â·çš®å°”å¥‡æ•™æˆçš„åŠå…¬å®¤ã€‚

è¿ˆå…‹å°”Â·çš®å°”å¥‡æ˜¯å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡[ç§‘å…‹é›·å°”å·¥ç¨‹å­¦é™¢](https://cockrell.utexas.edu/faculty-directory/alphabetical/p)å’Œ[æ°å…‹é€Šåœ°çƒç§‘å­¦å­¦é™¢](https://www.jsg.utexas.edu/researcher/michael_pyrcz/)çš„æ•™æˆï¼Œä»–åœ¨é‚£é‡Œç ”ç©¶å¹¶æ•™æˆåœ°ä¸‹ã€ç©ºé—´æ•°æ®åˆ†æã€åœ°ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ã€‚è¿ˆå…‹å°”è¿˜æ˜¯ï¼Œ

+   [èƒ½æºåˆ†æ](https://fri.cns.utexas.edu/energy-analytics)æ–°ç”Ÿç ”ç©¶é¡¹ç›®çš„é¦–å¸­ç ”ç©¶å‘˜ï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡è‡ªç„¶ç§‘å­¦é™¢æœºå™¨å­¦ä¹ å®éªŒå®¤çš„æ ¸å¿ƒæ•™å‘˜ã€‚

+   [ã€Šè®¡ç®—æœºä¸åœ°çƒç§‘å­¦ã€‹](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board)çš„å‰¯ç¼–è¾‘ï¼Œä»¥åŠå›½é™…æ•°å­¦åœ°çƒç§‘å­¦åä¼š[ã€Šæ•°å­¦åœ°çƒç§‘å­¦ã€‹](https://link.springer.com/journal/11004/editorial-board)çš„è‘£äº‹ä¼šæˆå‘˜ã€‚

è¿ˆå…‹å°”å·²ç»æ’°å†™äº† 70 å¤šç¯‡[åŒè¡Œè¯„å®¡å‡ºç‰ˆç‰©](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en)ï¼Œä¸€ä¸ªç”¨äºç©ºé—´æ•°æ®åˆ†æçš„[Python åŒ…](https://pypi.org/project/geostatspy/)ï¼Œåˆè‘—äº†ä¸€æœ¬å…³äºç©ºé—´æ•°æ®åˆ†æçš„æ•™ç§‘ä¹¦[ã€Šåœ°ç»Ÿè®¡å­¦å‚¨å±‚å»ºæ¨¡ã€‹](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)ï¼Œå¹¶æ˜¯ä¸¤æœ¬æœ€è¿‘å‘å¸ƒçš„ç”µå­ä¹¦çš„ä½œè€…ï¼Œ[ã€ŠPython ä¸­çš„åº”ç”¨åœ°ç»Ÿè®¡å­¦ï¼šGeostatsPy å®è·µæŒ‡å—ã€‹](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)å’Œ[ã€ŠPython ä¸­çš„åº”ç”¨æœºå™¨å­¦ä¹ ï¼šå®è·µæŒ‡å—ä¸ä»£ç ã€‹](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html)ã€‚

è¿ˆå…‹å°”çš„æ‰€æœ‰å¤§å­¦è®²åº§éƒ½å¯ä»¥åœ¨ä»–çš„[YouTube é¢‘é“](https://www.youtube.com/@GeostatsGuyLectures)ä¸Šæ‰¾åˆ°ï¼Œå…¶ä¸­åŒ…å« 100 å¤šä¸ª Python äº¤äº’å¼ä»ªè¡¨æ¿å’Œ 40 å¤šä¸ªå­˜å‚¨åº“ä¸­çš„è¯¦ç»†å·¥ä½œæµç¨‹é“¾æ¥ï¼Œè¿™äº›å­˜å‚¨åº“ä½äºä»–çš„[GitHub è´¦æˆ·](https://github.com/GeostatsGuy)ï¼Œä»¥æ”¯æŒä»»ä½•æ„Ÿå…´è¶£çš„å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«ï¼Œæä¾›å¸¸é’å†…å®¹ã€‚è¦äº†è§£æ›´å¤šå…³äºè¿ˆå…‹å°”çš„å·¥ä½œå’Œå…±äº«æ•™è‚²èµ„æºï¼Œè¯·è®¿é—®ä»–çš„ç½‘ç«™ã€‚

## æƒ³ä¸€èµ·å·¥ä½œå—ï¼Ÿ

æˆ‘å¸Œæœ›è¿™äº›å†…å®¹å¯¹é‚£äº›æƒ³äº†è§£æ›´å¤šå…³äºåœ°ä¸‹å»ºæ¨¡ã€æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ çš„äººæœ‰æ‰€å¸®åŠ©ã€‚å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«æ¬¢è¿å‚åŠ ã€‚

+   æƒ³é‚€è¯·æˆ‘åˆ°è´µå…¬å¸è¿›è¡ŒåŸ¹è®­ã€è¾…å¯¼ã€é¡¹ç›®å®¡æŸ¥ã€å·¥ä½œæµç¨‹è®¾è®¡å’Œ/æˆ–å’¨è¯¢ï¼Ÿæˆ‘å¾ˆä¹æ„æ‹œè®¿å¹¶ä¸æ‚¨åˆä½œï¼

+   æ„Ÿå…´è¶£ä¸æˆ‘åˆä½œã€æ”¯æŒæˆ‘çš„ç ”ç©¶ç”Ÿç ”ç©¶æˆ–æˆ‘çš„åœ°ä¸‹æ•°æ®åˆ†æä¸æœºå™¨å­¦ä¹ è”ç›Ÿï¼ˆå…±åŒè´Ÿè´£äººæ˜¯çº¦ç¿°Â·ç¦æ–¯ç‰¹æ•™æˆï¼‰å—ï¼Ÿæˆ‘çš„ç ”ç©¶å°†æ•°æ®åˆ†æã€éšæœºå»ºæ¨¡å’Œæœºå™¨å­¦ä¹ ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œä»¥å¼€å‘æ–°çš„æ–¹æ³•å’Œå·¥ä½œæµç¨‹ï¼Œå¢åŠ ä»·å€¼ã€‚æˆ‘ä»¬æ­£åœ¨è§£å†³å…·æœ‰æŒ‘æˆ˜æ€§çš„åœ°ä¸‹é—®é¢˜ï¼

+   æ‚¨å¯ä»¥é€šè¿‡ mpyrcz@austin.utexas.edu è”ç³»åˆ°æˆ‘ã€‚

æˆ‘æ€»æ˜¯å¾ˆé«˜å…´è®¨è®ºï¼Œ

*è¿ˆå…‹å°”*

è¿ˆå…‹å°”Â·çš®å°”å¥‡ï¼Œåšå£«ï¼Œæ³¨å†Œå·¥ç¨‹å¸ˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ Cockrell å·¥ç¨‹å­¦é™¢å’Œ Jackson åœ°çƒç§‘å­¦å­¦é™¢æ•™æˆ

æ›´å¤šèµ„æºå¯åœ¨ä»¥ä¸‹ä½ç½®è·å–ï¼š[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy) | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao) | [åœ°çƒç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446) | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python ä¸­åº”ç”¨åœ°çƒç»Ÿè®¡å­¦ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)
