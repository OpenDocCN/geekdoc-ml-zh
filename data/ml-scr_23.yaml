- en: Implementation
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实现
- en: 原文：[https://dafriedman97.github.io/mlbook/content/c5/code.html](https://dafriedman97.github.io/mlbook/content/c5/code.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://dafriedman97.github.io/mlbook/content/c5/code.html](https://dafriedman97.github.io/mlbook/content/c5/code.html)
- en: This section demonstrates how to fit regression and decision trees with `scikit-learn`.
    We will again use the [tips](../appendix/data.html) dataset for the regression
    tree and the [penguins](../appendix/data.html) dataset for the classification
    tree.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本节演示了如何使用 `scikit-learn` 拟合回归和决策树。我们将再次使用 [tips](../appendix/data.html) 数据集来拟合回归树，以及
    [penguins](../appendix/data.html) 数据集来拟合分类树。
- en: '[PRE0]'
  id: totrans-3
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 1\. Regression Tree
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1. 回归树
- en: Let’s start by loading in the data. We’ll keep things as `pandas` dataframes
    rather than `numpy` arrays now.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们先加载数据。现在我们将保持为 `pandas` 数据框而不是 `numpy` 数组。
- en: '[PRE1]'
  id: totrans-6
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: We can then fit the regression tree with the `DecisionTreeRegressor` class.
    Unfortunately, `scikit-learn` does not currently support categorical predictors.
    Instead, we have to first convert these predictors to dummy variables. Note that
    this implies that splits of categorical variables can only separate one value
    from the rest. For instance, a variable with discrete values \(a, b, c,\) and
    \(d\) could not be split as \(\{a, b\}\) versus \(\{c, d\}\).
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用 `DecisionTreeRegressor` 类来拟合回归树。不幸的是，`scikit-learn` 目前不支持分类预测器。相反，我们首先必须将这些预测器转换为虚拟变量。请注意，这意味着分类变量的分割只能将一个值与其他值分开。例如，具有离散值
    \(a, b, c\) 和 \(d\) 的变量不能分割为 \(\{a, b\}\) 与 \(\{c, d\}\)。
- en: '[PRE2]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![../../_images/code_7_02.png](../Images/f1f8174dde1a3828250bd86b2bcf5906.png)'
  id: totrans-9
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/code_7_02.png](../Images/f1f8174dde1a3828250bd86b2bcf5906.png)'
- en: 2\. Classification Tree
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2. 分类树
- en: The classification tree implementation in `scikit-learn` is nearly identical.
    The corresponding code is provided below.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '`scikit-learn` 中的分类树实现几乎相同。相应的代码如下所示。'
- en: '[PRE3]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 1\. Regression Tree
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1. 回归树
- en: Let’s start by loading in the data. We’ll keep things as `pandas` dataframes
    rather than `numpy` arrays now.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们先加载数据。现在我们将保持为 `pandas` 数据框而不是 `numpy` 数组。
- en: '[PRE6]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: We can then fit the regression tree with the `DecisionTreeRegressor` class.
    Unfortunately, `scikit-learn` does not currently support categorical predictors.
    Instead, we have to first convert these predictors to dummy variables. Note that
    this implies that splits of categorical variables can only separate one value
    from the rest. For instance, a variable with discrete values \(a, b, c,\) and
    \(d\) could not be split as \(\{a, b\}\) versus \(\{c, d\}\).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们可以使用 `DecisionTreeRegressor` 类来拟合回归树。不幸的是，`scikit-learn` 目前不支持分类预测器。相反，我们首先必须将这些预测器转换为虚拟变量。请注意，这意味着分类变量的分割只能将一个值与其他值分开。例如，具有离散值
    \(a, b, c\) 和 \(d\) 的变量不能分割为 \(\{a, b\}\) 与 \(\{c, d\}\)。
- en: '[PRE7]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![../../_images/code_7_02.png](../Images/f1f8174dde1a3828250bd86b2bcf5906.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/code_7_02.png](../Images/f1f8174dde1a3828250bd86b2bcf5906.png)'
- en: 2\. Classification Tree
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2. 分类树
- en: The classification tree implementation in `scikit-learn` is nearly identical.
    The corresponding code is provided below.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '`scikit-learn` 中的分类树实现几乎相同。相应的代码如下所示。'
- en: '[PRE8]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '[PRE10]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
