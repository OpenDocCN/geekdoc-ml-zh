- en: Construction
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建过程
- en: 原文：[https://dafriedman97.github.io/mlbook/content/c1/construction.html](https://dafriedman97.github.io/mlbook/content/c1/construction.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://dafriedman97.github.io/mlbook/content/c1/construction.html](https://dafriedman97.github.io/mlbook/content/c1/construction.html)
- en: '\[ \newcommand{\sumN}{\sum_{n = 1}^N} \newcommand{\sumn}{\sum_n} \newcommand{\bx}{\mathbf{x}}
    \newcommand{\bbeta}{\boldsymbol{\beta}} \newcommand{\btheta}{\boldsymbol{\theta}}
    \newcommand{\bbetahat}{\boldsymbol{\hat{\beta}}} \newcommand{\bthetahat}{\boldsymbol{\hat{\theta}}}
    \newcommand{\dadb}[2]{\frac{\partial #1}{\partial #2}} \newcommand{\by}{\mathbf{y}}
    \newcommand{\bX}{\mathbf{X}} \]'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '\[ \newcommand{\sumN}{\sum_{n = 1}^N} \newcommand{\sumn}{\sum_n} \newcommand{\bx}{\mathbf{x}}
    \newcommand{\bbeta}{\boldsymbol{\beta}} \newcommand{\btheta}{\boldsymbol{\theta}}
    \newcommand{\bbetahat}{\boldsymbol{\hat{\beta}}} \newcommand{\bthetahat}{\boldsymbol{\hat{\theta}}}
    \newcommand{\dadb}[2]{\frac{\partial #1}{\partial #2}} \newcommand{\by}{\mathbf{y}}
    \newcommand{\bX}{\mathbf{X}} \]'
- en: This section demonstrates how to construct a linear regression model using only
    `numpy`. To do this, we generate a class named `LinearRegression`. We use this
    class to train the model and make future predictions.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本节演示了如何仅使用`numpy`构建线性回归模型。为此，我们创建了一个名为`LinearRegression`的类。我们使用这个类来训练模型和进行未来的预测。
- en: The first method in the `LinearRegression` class is `fit()`, which takes care
    of estimating the \(\bbeta\) parameters. This simply consists of calculating
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '`LinearRegression`类中的第一个方法是`fit()`，它负责估计\(\bbeta\)参数。这仅仅包括计算'
- en: \[ \bbetahat = \left(\bX^\top \bX\right)^{-1}\bX^\top \by \]
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bbetahat = \left(\bX^\top \bX\right)^{-1}\bX^\top \by \]
- en: The `fit` method also makes in-sample predictions with \(\hat{\by} = \bX \bbetahat\)
    and calculates the training loss with
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '`fit`方法也在样本内进行预测，\(\hat{\by} = \bX \bbetahat\)，并计算训练损失'
- en: \[ \mathcal{L}(\bbetahat) = \frac{1}{2}\sumN \left(y_n - \hat{y}_n \right)^2.
    \]
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathcal{L}(\bbetahat) = \frac{1}{2}\sumN \left(y_n - \hat{y}_n \right)^2.
    \]
- en: The second method is `predict()`, which forms out-of-sample predictions. Given
    a test set of predictors \(\bX'\), we can form fitted values with \(\hat{\by}'
    = \bX' \bbetahat\).
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 第二种方法是`predict()`，它形成样本外预测。给定一个预测变量测试集\(\bX'\)，我们可以用\(\hat{\by}' = \bX' \bbetahat\)来形成拟合值。
- en: '[PRE0]'
  id: totrans-9
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Let’s try out our `LinearRegression` class with some data. Here we use the [Boston
    housing](../appendix/data.html) dataset from `sklearn.datasets`. The target variable
    in this dataset is median neighborhood home value. The predictors are all continuous
    and represent factors possibly related to the median home value, such as average
    rooms per house. Hit “Click to show” to see the code that loads this data.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们用一些数据来测试我们的`LinearRegression`类。这里我们使用来自`sklearn.datasets`的[Boston housing](../appendix/data.html)数据集。该数据集的目标变量是中位数社区房价。预测变量都是连续的，代表可能与中位数房价相关的因素，例如每户平均房间数。点击“显示代码”来查看加载此数据的代码。
- en: '[PRE2]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: With the class built and the data loaded, we are ready to run our regression
    model. This is as simple as instantiating the model and applying `fit()`, as shown
    below.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建了类并加载了数据后，我们就可以运行我们的回归模型了。这就像实例化模型并应用`fit()`一样简单，如下所示。
- en: '[PRE3]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Let’s then see how well our fitted values model the true target values. The
    closer the points lie to the 45-degree line, the more accurate the fit. The model
    seems to do reasonably well; our predictions definitely follow the true values
    quite well, although we would like the fit to be a bit tighter.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 然后让我们看看我们的拟合值模型如何模拟真实的目标值。点越接近45度线，拟合越准确。模型似乎做得相当不错；我们的预测确实很好地遵循了真实值，尽管我们希望拟合更紧密一些。
- en: Note
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Note the handful of observations with \(y = 50\) exactly. This is due to censorship
    in the data collection process. It appears neighborhoods with average home values
    above $50,000 were assigned a value of 50 even.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 注意那些\(y = 50\)的观测值。这是由于数据收集过程中的审查所致。看起来平均房价超过50,000美元的社区甚至被分配了一个50的值。
- en: '[PRE4]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![../../_images/construction_10_0.png](../Images/da7ad87ad14998b49f5c2665f1e949d7.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/construction_10_0.png](../Images/da7ad87ad14998b49f5c2665f1e949d7.png)'
