- en: Predictive Machine Learning with scikit-learn
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用scikit-learn进行预测性机器学习
- en: 原文：[https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_predictive.html](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_predictive.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_predictive.html](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_predictive.html)
- en: Michael J. Pyrcz, Professor, The University of Texas at Austin
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: Michael J. Pyrcz，教授，德克萨斯大学奥斯汀分校
- en: '[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Geostatistics Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [Applied Machine Learning in Python e-book](https://geostatsguy.github.io/MachineLearningDemos_Book/)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [网站](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [地统计学书籍](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python应用地统计学电子书](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [Python应用机器学习电子书](https://geostatsguy.github.io/MachineLearningDemos_Book/)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
- en: 'Chapter of e-book “Applied Machine Learning in Python: a Hands-on Guide with
    Code”.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 电子书“《Python应用机器学习：带代码的手册》”的一章。
- en: 'Cite this e-Book as:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 请将此电子书引用如下：
- en: 'Pyrcz, M.J., 2024, *Applied Machine Learning in Python: A Hands-on Guide with
    Code* [e-book]. Zenodo. doi:10.5281/zenodo.15169138 [![DOI](../Images/7e4ea662f44af1eae87e87ecbb962ff4.png)](https://doi.org/10.5281/zenodo.15169138)'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: Pyrcz, M.J., 2024, *《Python应用机器学习：带代码的手册》[电子书]*. Zenodo. doi:10.5281/zenodo.15169138
    [![DOI](../Images/7e4ea662f44af1eae87e87ecbb962ff4.png)](https://doi.org/10.5281/zenodo.15169138)
- en: 'The workflows in this book and more are available here:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 本书中的工作流程以及更多内容都可以在这里找到：
- en: 'Cite the MachineLearningDemos GitHub Repository as:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 请将MachineLearningDemos GitHub仓库引用如下：
- en: 'Pyrcz, M.J., 2024, *MachineLearningDemos: Python Machine Learning Demonstration
    Workflows Repository* (0.0.3) [Software]. Zenodo. DOI: 10.5281/zenodo.13835312\.
    GitHub repository: [GeostatsGuy/MachineLearningDemos](https://github.com/GeostatsGuy/MachineLearningDemos)
    [![DOI](../Images/4e3a59c17d684b06a170c4af84e0f631.png)](https://zenodo.org/doi/10.5281/zenodo.13835312)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 'Pyrcz, M.J., 2024, *《MachineLearningDemos：Python机器学习演示工作流程仓库》*(0.0.3) [软件].
    Zenodo. DOI: 10.5281/zenodo.13835312\. GitHub仓库：[GeostatsGuy/MachineLearningDemos](https://github.com/GeostatsGuy/MachineLearningDemos)
    [![DOI](../Images/4e3a59c17d684b06a170c4af84e0f631.png)](https://zenodo.org/doi/10.5281/zenodo.13835312)'
- en: By Michael J. Pyrcz
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 作者：Michael J. Pyrcz
- en: © Copyright 2025.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: © 版权所有 2025。
- en: This chapter is a tutorial for / demonstration of **Predictive Machine Learning
    with scikit-learn**.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 本章是关于**使用scikit-learn进行预测性机器学习**的教程和演示。
- en: '**YouTube Lecture**: check out my lectures on:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '**YouTube讲座**：查看我在以下方面的讲座：'
- en: '[Introduction to Machine Learning](https://youtu.be/zOUM_AnI1DQ?si=wzWdJ35qJ9n8O6Bl)'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[机器学习简介](https://youtu.be/zOUM_AnI1DQ?si=wzWdJ35qJ9n8O6Bl)'
- en: '[Predictive Machine Learning in Python with sckit-learn](https://youtu.be/EbYePnjWB5o?si=dd7SpbQlQgMhFGZ5)'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用scikit-learn在Python中进行预测性机器学习](https://youtu.be/EbYePnjWB5o?si=dd7SpbQlQgMhFGZ5)'
- en: '[Machine Learning in Python with Pipelines](https://youtu.be/tYrPs8s1l9U?si=5OMrFm7rlK6koR6g)'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用Pipelines在Python中进行机器学习](https://youtu.be/tYrPs8s1l9U?si=5OMrFm7rlK6koR6g)'
- en: These lectures are all part of my [Machine Learning Course](https://youtube.com/playlist?list=PLG19vXLQHvSC2ZKFIkgVpI9fCjkN38kwf&si=XonjO2wHdXffMpeI)
    on YouTube with linked well-documented Python workflows and interactive dashboards.
    My goal is to share accessible, actionable, and repeatable educational content.
    If you want to know about my motivation, check out [Michael’s Story](https://michaelpyrcz.com/my-story).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 这些讲座都是我YouTube上的[机器学习课程](https://youtube.com/playlist?list=PLG19vXLQHvSC2ZKFIkgVpI9fCjkN38kwf&si=XonjO2wHdXffMpeI)的一部分，其中包含有良好文档记录的Python工作流程和交互式仪表板。我的目标是分享易于获取、可操作和可重复的教育内容。如果你想知道我的动机，请查看[Michael的故事](https://michaelpyrcz.com/my-story)。
- en: Motivation for Predictive Machine Learning with scikit-learn
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用scikit-learn进行预测性机器学习的动机
- en: This chapter is unusual for me. As a professor, I avoid lectures that focus
    on the specific tools, as I would rather teach the principles and then introduce
    the examples with the common tools. It is my opinion that,
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 这章对我来说很特别。作为一名教授，我避免专注于特定工具的讲座，因为我更愿意先教授原则，然后用常见工具介绍例子。我的观点是，
- en: theory will outlast any available software tools
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理论将超越任何可用的软件工具
- en: without a theory focus I may encourage black-box model use
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果没有理论重点，我可能会鼓励使用黑盒模型。
- en: with a strong understanding of the theory, one could pick up any software as
    needed
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果对理论有深入的理解，就可以根据需要选择任何软件。
- en: But in this case,
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 但在这种情况下，
- en: '[scikit-learn](https://scikit-learn.org/) is such a common machine learning
    package for machine learning that is very widely used'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[scikit-learn](https://scikit-learn.org/) 是一个非常常用的机器学习包，被广泛用于机器学习。'
- en: throughout this e-book I use scikit-learn
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在整个电子书中，我使用 scikit-learn
- en: scikit-learn uses a nuts and bolts approach to build machine learning workflows
    that maximizes flexibility
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: scikit-learn 使用一种螺丝钉和螺母的方法来构建机器学习工作流程，以最大化灵活性。
- en: scikit-learn provides the theory in the docs or links to original publications
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: scikit-learn 在文档中提供理论或链接到原始出版物
- en: In summary, scikit-learn get me and I see the package as a partner in education!
    Thank you!
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，scikit-learn 让我受益匪浅，我把这个包看作是教育中的合作伙伴！谢谢！
- en: So I have decided to add this chapter focused on the methods for machine learning
    modeling with scikit-learn.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我决定添加这一章，专注于使用 scikit-learn 进行机器学习建模的方法。
- en: Machine Learning-based Prediction
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于机器学习的预测
- en: Here’s a simple workflow, demonstration of scikit-learn training and tuning
    a machine learning model with a simple dataset.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个简单的流程，演示了使用简单数据集训练和调整 scikit-learn 机器学习模型。
- en: I provide this as the most basic, minimum Python workflow to assist those learning
    predictive machine learning
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我提供这个作为最基本、最少的 Python 工作流程，以帮助那些学习预测机器学习的人。
- en: I demonstration model training and tuning (by-hand and automatically), including
    the pipeline approach
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我演示了模型训练和调整（手动和自动），包括管道方法
- en: Given the 1 predictor feature and 1 response for ease of data and model visualization
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了便于数据和模型的可视化，这里给出了 1 个预测特征和 1 个响应
- en: This provides an opportunity to run and visualize a variety of machine learning
    models for experiential learning.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 这为运行和可视化各种机器学习模型以进行经验学习提供了机会。
- en: Machine Learning-based Prediction
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于机器学习的预测
- en: 'We build a decision tree-based predictive machine learning models with supervised
    learning:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用监督学习构建基于决策树的预测机器学习模型：
- en: '**Prediction**'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '**预测**'
- en: non-parametric method for regression (continuous response) and classification
    (categorical response)
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 非参数回归方法（连续响应）和分类（分类响应）
- en: a function \(\hat{f}\) of the nearest \(k\) training data in predictor feature
    space such that we predict a response feature \(Y\) from a set of predictor features
    \(X_1,\ldots,X_m\).
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个函数 \(\hat{f}\)，它是在预测特征空间中最近的 \(k\) 个训练数据，这样我们就可以从一组预测特征 \(X_1,\ldots,X_m\)
    中预测响应特征 \(Y\)。
- en: 'the prediction is of the form:'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预测的形式如下：
- en: \begin{equation} \hat{Y} = \hat{f}(X_1,\ldots,X_m) + \epsilon \end{equation}
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: \begin{equation} \hat{Y} = \hat{f}(X_1,\ldots,X_m) + \epsilon \end{equation}
- en: where \(\epsilon\) is an error term.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\epsilon\) 是一个误差项。
- en: '**Supervised Learning**'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**监督学习**'
- en: the response feature, \(Y\), is available over the training and testing data
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 响应特征 \(Y\) 在训练和测试数据中都是可用的
- en: Load the Required Libraries
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 加载所需的库
- en: The following code loads the required libraries. These should have been installed
    with Anaconda 3.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码加载所需的库。这些库应该已经与 Anaconda 3 一起安装。
- en: '[PRE0]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: If you get a package import error, you may have to first install some of these
    packages. This can usually be accomplished by opening up a command window on Windows
    and then typing ‘python -m pip install [package-name]’. More assistance is available
    with the respective package docs.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 如果遇到包导入错误，你可能需要首先安装这些包中的一些。这通常可以通过在 Windows 上打开命令窗口，然后输入‘python -m pip install
    [package-name]’来完成。更多帮助可以在相应的包文档中找到。
- en: Set the Random Number Seed
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置随机数种子
- en: 'These workflows and models may use random processes, e.g.:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 这些工作流程和模型可能使用随机过程，例如：
- en: random train and test split with cross validation and k-fold cross validation
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 随机训练和测试分割，以及交叉验证和 k 折交叉验证
- en: random selection of a subset of features to consider for the next split
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 随机选择下一分割要考虑的特征子集
- en: '[PRE1]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Declare functions
  id: totrans-55
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 声明函数
- en: Let’s define a function for plotting gridlines.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们定义一个用于绘制网格线的函数。
- en: '[PRE2]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Set the working directory
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置工作目录
- en: I always like to do this so I don’t lose files and to simplify subsequent read
    and writes (avoid including the full address each time).
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 我总是喜欢这样做，以免丢失文件，并简化后续的读取和写入（每次避免包含完整地址）。
- en: '[PRE3]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: You will have to update the part in quotes with your own working directory and
    the format is different on a Mac (e.g. “~/PGE”).
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 你将不得不更新引号中的部分以包含你自己的工作目录，并且在 Mac 上格式不同（例如：“~/PGE”）。
- en: Read the data table
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 读取数据表
- en: We use a data “1D_Porosity.csv” comma delimited file from my GitHub [GeoDataSets
    Respository](https://github.com/GeostatsGuy/GeoDataSets).
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用来自我的GitHub [GeoDataSets 仓库](https://github.com/GeostatsGuy/GeoDataSets)的“1D_Porosity.csv”逗号分隔文件。
- en: this code loads the data directly from my GitHub repository.
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 此代码直接从我的GitHub仓库加载数据。
- en: if you have the data file available locally (i.e. you are not connected to the
    internet) set the working directory to the location with the data file and use
    the second line below
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你有可用的本地数据文件（即你未连接到互联网），请将工作目录设置为数据文件所在的目录，并使用下面的第二行
- en: '[PRE4]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Plot the Available Data
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 绘制可用数据
- en: Let’s do a simple scatter plot to check the data.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们做一个简单的散点图来检查数据。
- en: '[PRE6]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![_images/c8f68d96b92a64e674753dd321abb3376a788853f792000775c676b02927aec1.png](../Images/1185159d2aa42c7833a49ebd954a9aca.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/1185159d2aa42c7833a49ebd954a9aca.png)'
- en: 'Optional: Add Random Error to the Response Feature, \(y\)'
  id: totrans-72
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 可选：向响应特征\(y\)添加随机误差
- en: For more experiential learning consider repeating this workflow with different
    amounts of additional error
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更多的经验学习，考虑使用不同数量的额外错误重复此工作流程
- en: to observe issues of model overfit consider adding some additional error,
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了观察模型过拟合的问题，考虑添加一些额外的错误，
- en: '[PRE7]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[PRE8]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![_images/db6bdae8f03df1faab8e473a6c4ac4068bec1a1c0601e89ed59590368330bf1c.png](../Images/a4f6a9c8841781db06c62d6cdf546dde.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/a4f6a9c8841781db06c62d6cdf546dde.png)'
- en: Fast Forward Through Data Analytics
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 快速通过数据分析
- en: This workflow is focussed on building predictive machine learning models
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 此工作流程专注于构建预测机器学习模型
- en: for brevity we skip data checking, data analytics, statistical analysis, feature
    transformations etc.
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了简洁起见，我们省略了数据检查、数据分析、统计分析、特征转换等。
- en: we skip all the way to model building
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们直接跳到模型构建
- en: we don’t even discuss model selection, feature selection, nor robust hyperparameter
    tuning
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们甚至没有讨论模型选择、特征选择，也没有讨论鲁棒的超参数调整
- en: This is the most simple predictive machine learning workflow possible!
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 这是可能的 simplest 预测机器学习工作流程！
- en: basics for machine learning with scikit-learn in Python. Nothing more.
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python中使用scikit-learn进行机器学习的基础。没有更多。
- en: Let’s Build a Predictive Machine Learning Model
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 让我们构建一个预测机器学习模型
- en: We use the following steps to build our model
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用以下步骤来构建我们的模型
- en: '**instantiate** the machine learning model with hyperparameters'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**实例化**机器学习模型并使用超参数'
- en: '**fit**, train the machine learing model to the training data'
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**拟合**，将机器学习模型训练到训练数据上'
- en: '**predict**, check the trained machine learning models to predict at withheld
    testing data'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**预测**，检查训练好的机器学习模型在保留的测试数据上的预测'
- en: '**select** the optimum hyperparameters, hyperparameter tuning'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**选择**最佳超参数，超参数调整'
- en: '**refit** the model by training with all data given the tuned hyperparmaeters'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**重新拟合**模型，使用所有数据和调整好的超参数进行训练'
- en: We will use the train - test approach, an alternative is the train, validate
    and test approach.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用训练-测试方法，另一种方法是训练、验证和测试方法。
- en: we will start simple and cover k-fold cross validation and scikit-learn pipeline
    class later
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们将从一个简单的例子开始，并稍后介绍k折交叉验证和scikit-learn管道类。
- en: Split Train and Test
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分割训练数据和测试数据
- en: 'We will demonstrate the following hyperparameter tuning methods:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将演示以下超参数调整方法：
- en: '**cross validation** - split 25% of data as withheld testing data, only 25%
    of data are tested'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**交叉验证** - 将25%的数据作为保留的测试数据，只有25%的数据进行测试'
- en: '**k-fold cross validation** - calculate average error over k folds, all data
    are tested'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**k折交叉验证** - 在k个折中计算平均误差，所有数据都进行测试'
- en: Let’s start with cross validation and then demonstrate k-fold cross validation.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从交叉验证开始，然后演示k折交叉验证。
- en: '[PRE9]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![_images/8301051d675ae545cbd9a77b7b63baad14810e3e9f3dfd6e299fd5ce3e5cdd5c.png](../Images/9d97f00b8d0b32eb2d7d97ab07abb605.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/9d97f00b8d0b32eb2d7d97ab07abb605.png)'
- en: Build a Decision Tree Model
  id: totrans-101
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 构建决策树模型
- en: Let’s instantiate (set the hyperparameter(s)) and fit (train with training data)
    a decision tree regression model to our data.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们实例化（设置超参数）并拟合（使用训练数据训练）决策树回归模型到我们的数据。
- en: '[PRE10]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Predict With a Decision Tree Model
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用决策树模型进行预测
- en: Now let’s make a prediction with our trained decision tree model.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们用我们的训练好的决策树模型进行预测。
- en: '[PRE11]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![_images/c8659b494469d1cf1349fd8143fe016473544dea1159f62300489b493236734c.png](../Images/93fe563da105e7191b40024dad8586f5.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/93fe563da105e7191b40024dad8586f5.png)'
- en: Predict Over a Range of Predictor Feature Values with a Decision Tree Model
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用决策树模型在一系列预测特征值上做出预测
- en: Now, let’s make predictions over a range of predictor feature values so we can
    visualize the model.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们在一系列预测特征值上做出预测，以便我们可以可视化模型。
- en: this is easy to do since we have just 1 predictor feature
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于我们只有一个预测特征，这很容易做到
- en: '[PRE12]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '![_images/3a5c6ea1ec85203a0f15c3d46ae86783757808f467cadc500454f9c887228fe0.png](../Images/29e1a12c1961942e61997bd3ac0110ca.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/29e1a12c1961942e61997bd3ac0110ca.png)'
- en: Changing the Model Hyperparameter(s)
  id: totrans-113
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 改变模型超参数
- en: Let’s try changing the model complexity and refitting the model.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试改变模型复杂度并重新调整模型。
- en: '[PRE13]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![_images/d3b73736375ae3ab790c7b21e2c4c20d28ebdffc2556a99912efb733b3fd7d82.png](../Images/32ce25273cb95be1bc73a931d2300783.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/32ce25273cb95be1bc73a931d2300783.png)'
- en: Tuning the Model Hyperparameter(s)
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 调整模型超参数
- en: To tune the model hyperparameters we need a metric to summarize model error
    over the withheld testing data
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 为了调整模型超参数，我们需要一个指标来总结保留测试数据上的模型错误
- en: let’s predict at the testing data and calculate our metric, testing mean square
    error.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 让我们在测试数据上做出预测并计算我们的指标，测试均方误差。
- en: '[PRE14]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[PRE15]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: and we need to rebuild the model with a variable level of complexity
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要以可变复杂度重建模型
- en: let’s loop over the number of leaf nodes and plot the performance over the withheld
    testing data
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 让我们遍历叶节点数量并绘制保留测试数据上的性能
- en: '[PRE16]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '![_images/d93257b45568bdd5ca8115c16b6ffab50c3eeae024f20178c1f5b9fc272cb45f.png](../Images/e07a293a3a9e2bf5b198ec8e220f17b1.png)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/e07a293a3a9e2bf5b198ec8e220f17b1.png)'
- en: For a more robust assessment of performance let’s use scikit-learns k-fold cross
    validation.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 为了对性能进行更稳健的评估，让我们使用scikit-learn的k折交叉验证。
- en: '[PRE17]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '![_images/c0edb899e876f1ebd639ac3d6c4eb5b5a9fe13138c12076aa8086978cb7789bc.png](../Images/93663d34dc6ae7a4b909718efe41cf18.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/93663d34dc6ae7a4b909718efe41cf18.png)'
- en: The main product from all of the previous work is the tuned hyperparameter,
    the optimum model complexity.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 所有先前工作的主要成果是调整后的超参数，最佳模型复杂度。
- en: now we refit the tuned model, train the model on all the data and our tuned
    model is ready for real-world use
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现在我们重新调整模型，在所有数据上训练模型，我们的调整后的模型现在可以用于实际应用
- en: once again we are assuming a train and test workflow, not a train, validate
    and test workflow
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 再次假设我们有一个训练和测试工作流程，而不是训练、验证和测试工作流程
- en: '[PRE18]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![_images/a69faa8f42377a8d0bc8f93c7f2b21baf60c67eb5e475c3ade5d40904f40b23c.png](../Images/7f70bf1f19953f869e52080eed2cf1f7.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/7f70bf1f19953f869e52080eed2cf1f7.png)'
- en: Complete Workflow with Pipelines
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 完整工作流程与管道
- en: 'Let’s repeat the above workflow with a pipline from scikit-learn. Here some
    general comments:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用scikit-learn的pipline重复上述工作流程。以下是一些一般性评论：
- en: '**pipeline workflow steps** - list of steps, custom labels and the associated
    scikit-learn classes'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**管道工作流程步骤** - 步骤列表、自定义标签以及相关的scikit-learn类'
- en: '**choices and hyperparameters** - as a dictionary with combined step custom
    labels and hyperparameter names'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**选择和超参数** - 作为包含组合步骤自定义标签和超参数名称的字典'
- en: '**workflow scenarios** - we can specify lists of choices and hyperparameters'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**工作流程场景** - 我们可以指定选择和超参数的列表'
- en: '**consistent iteration** - the entire workflow is repeated for the full combinatorial'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**一致的迭代** - 整个工作流程重复进行完整的组合'
- en: '**best model selected** - best combination of model hyperparameters and choices
    are refit with all data'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最佳模型选择** - 最佳模型超参数组合和选择与所有数据重新调整'
- en: '[PRE19]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '[PRE20]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Comments
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 评论
- en: This was a very simple demonstration of predictive machine learning model building
    with Python’s scikit-learn.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个使用Python的scikit-learn进行预测机器学习模型构建的非常简单的演示。
- en: this is a basic introduction, much more could be done
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这是一个基本介绍，可以做更多的事情
- en: I hope this was helpful,
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 希望这有所帮助，
- en: '*Michael*'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '*迈克尔*'
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, The Hildebrand Department of Petroleum
    and Geosystems Engineering, Bureau of Economic Geology, The Jackson School of
    Geosciences, The University of Texas at Austin On twitter I’m the @GeostatsGuy.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔·皮尔茨，博士，P.Eng. 教授，德克萨斯大学奥斯汀分校希尔布兰德石油和地球系统工程学院，经济地质局，杰克逊地球科学学院。在推特上，我是@GeostatsGuy。
- en: About the Author
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关于作者
- en: '![](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
- en: Professor Michael Pyrcz in his office on the 40 acres, campus of The University
    of Texas at Austin.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔·皮尔茨教授在德克萨斯大学奥斯汀分校40英亩校园的办公室。
- en: Michael Pyrcz is a professor in the [Cockrell School of Engineering](https://cockrell.utexas.edu/faculty-directory/alphabetical/p),
    and the [Jackson School of Geosciences](https://www.jsg.utexas.edu/researcher/michael_pyrcz/),
    at [The University of Texas at Austin](https://www.utexas.edu/), where he researches
    and teaches subsurface, spatial data analytics, geostatistics, and machine learning.
    Michael is also,
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔·皮尔奇兹是德克萨斯大学奥斯汀分校[科克雷尔工程学院](https://cockrell.utexas.edu/faculty-directory/alphabetical/p)和[杰克逊地球科学学院](https://www.jsg.utexas.edu/researcher/michael_pyrcz/)的教授，他在[德克萨斯大学奥斯汀分校](https://www.utexas.edu/)研究并教授地下、空间数据分析、地球统计学和机器学习。迈克尔还是，
- en: the principal investigator of the [Energy Analytics](https://fri.cns.utexas.edu/energy-analytics)
    freshmen research initiative and a core faculty in the Machine Learn Laboratory
    in the College of Natural Sciences, The University of Texas at Austin
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 能源分析新生研究计划的负责人，以及德克萨斯大学奥斯汀分校自然科学院机器学习实验室的核心教员。
- en: an associate editor for [Computers and Geosciences](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board),
    and a board member for [Mathematical Geosciences](https://link.springer.com/journal/11004/editorial-board),
    the International Association for Mathematical Geosciences.
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[《计算机与地球科学》](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board)的副编辑，以及国际数学地球科学协会[《数学地球科学》](https://link.springer.com/journal/11004/editorial-board)的董事会成员。'
- en: 'Michael has written over 70 [peer-reviewed publications](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en),
    a [Python package](https://pypi.org/project/geostatspy/) for spatial data analytics,
    co-authored a textbook on spatial data analytics, [Geostatistical Reservoir Modeling](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    and author of two recently released e-books, [Applied Geostatistics in Python:
    a Hands-on Guide with GeostatsPy](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    and [Applied Machine Learning in Python: a Hands-on Guide with Code](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html).'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔已经撰写了70多篇[同行评审出版物](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en)，一个用于空间数据分析的[Python包](https://pypi.org/project/geostatspy/)，合著了一本关于空间数据分析的教科书[《地球统计学储层建模》](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)，并是两本最近发布的电子书的作者，分别是[《Python应用地球统计学：GeostatsPy动手指南》](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)和[《Python应用机器学习：带代码的动手指南》](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html)。
- en: All of Michael’s university lectures are available on his [YouTube Channel](https://www.youtube.com/@GeostatsGuyLectures)
    with links to 100s of Python interactive dashboards and well-documented workflows
    in over 40 repositories on his [GitHub account](https://github.com/GeostatsGuy),
    to support any interested students and working professionals with evergreen content.
    To find out more about Michael’s work and shared educational resources visit his
    Website.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔的所有大学讲座都可以在他的[YouTube频道](https://www.youtube.com/@GeostatsGuyLectures)上找到，其中包含100多个Python交互式仪表板和40多个GitHub账户上的详细工作流程，这些工作流程分布在40多个存储库中，以支持任何感兴趣的学生和在职专业人士，提供永恒的内容。要了解更多关于迈克尔的工作和共享教育资源，请访问他的网站。
- en: Want to Work Together?
  id: totrans-157
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 想一起工作吗？
- en: I hope this content is helpful to those that want to learn more about subsurface
    modeling, data analytics and machine learning. Students and working professionals
    are welcome to participate.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望这些内容对那些想了解更多关于地下建模、数据分析和机器学习的人有所帮助。学生和在职专业人士欢迎参加。
- en: Want to invite me to visit your company for training, mentoring, project review,
    workflow design and / or consulting? I’d be happy to drop by and work with you!
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 想邀请我到贵公司进行培训、辅导、项目审查、工作流程设计和/或咨询吗？我很乐意拜访并与您合作！
- en: Interested in partnering, supporting my graduate student research or my Subsurface
    Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)?
    My research combines data analytics, stochastic modeling and machine learning
    theory with practice to develop novel methods and workflows to add value. We are
    solving challenging subsurface problems!
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 感兴趣于合作，支持我的研究生研究或我的地下数据分析与机器学习联盟（共同负责人是约翰·福斯特教授）吗？我的研究将数据分析、随机建模和机器学习理论与实践相结合，以开发新的方法和工作流程来增加价值。我们正在解决具有挑战性的地下问题！
- en: I can be reached at [mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu).
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我可以通过[mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu)联系到。
- en: I’m always happy to discuss,
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 我总是很高兴讨论，
- en: '*Michael*'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '*迈克尔*'
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The
    Jackson School of Geosciences, The University of Texas at Austin
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔·皮尔奇，博士，P.Eng. 教授，德克萨斯大学奥斯汀分校的科克雷尔工程学院和杰克逊地球科学学院
- en: 'More Resources Available at: [Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 更多资源请访问：[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [网站](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [书籍](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python
    地统计学应用电子书](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)
- en: Motivation for Predictive Machine Learning with scikit-learn
  id: totrans-166
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 scikit-learn 进行预测机器学习的动机
- en: This chapter is unusual for me. As a professor, I avoid lectures that focus
    on the specific tools, as I would rather teach the principles and then introduce
    the examples with the common tools. It is my opinion that,
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 这章对我来说很特别。作为一名教授，我避免专注于特定工具的讲座，因为我更愿意先教授原理，然后用常见的工具介绍例子。我的观点是，
- en: theory will outlast any available software tools
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理论将超越任何可用的软件工具
- en: without a theory focus I may encourage black-box model use
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果没有理论重点，我可能会鼓励使用黑盒模型
- en: with a strong understanding of the theory, one could pick up any software as
    needed
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果对理论有深入的理解，就可以根据需要选择任何软件
- en: But in this case,
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 但在这种情况下，
- en: '[scikit-learn](https://scikit-learn.org/) is such a common machine learning
    package for machine learning that is very widely used'
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[scikit-learn](https://scikit-learn.org/) 是一个非常常用的机器学习包，被广泛用于机器学习'
- en: throughout this e-book I use scikit-learn
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在整个电子书中，我使用 scikit-learn
- en: scikit-learn uses a nuts and bolts approach to build machine learning workflows
    that maximizes flexibility
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: scikit-learn 采用了一种螺丝钉方法来构建机器学习工作流程，以最大化灵活性
- en: scikit-learn provides the theory in the docs or links to original publications
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: scikit-learn 在文档中提供了理论，或链接到原始出版物
- en: In summary, scikit-learn get me and I see the package as a partner in education!
    Thank you!
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，scikit-learn 让我看到了它作为教育伙伴的价值！谢谢！
- en: So I have decided to add this chapter focused on the methods for machine learning
    modeling with scikit-learn.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我决定添加这一章，专注于使用 scikit-learn 进行机器学习建模的方法。
- en: Machine Learning-based Prediction
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于机器学习的预测
- en: Here’s a simple workflow, demonstration of scikit-learn training and tuning
    a machine learning model with a simple dataset.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个简单的流程，演示了使用简单数据集对 scikit-learn 进行训练和调整的机器学习模型。
- en: I provide this as the most basic, minimum Python workflow to assist those learning
    predictive machine learning
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我提供这个最基本、最少的 Python 工作流程，以帮助那些学习预测机器学习的人
- en: I demonstration model training and tuning (by-hand and automatically), including
    the pipeline approach
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我演示了模型训练和调整（手动和自动），包括管道方法
- en: Given the 1 predictor feature and 1 response for ease of data and model visualization
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了便于数据和模型的可视化，我们只使用 1 个预测特征和 1 个响应
- en: This provides an opportunity to run and visualize a variety of machine learning
    models for experiential learning.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 这为运行和可视化各种机器学习模型以进行经验学习提供了机会。
- en: Machine Learning-based Prediction
  id: totrans-184
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于机器学习的预测
- en: 'We build a decision tree-based predictive machine learning models with supervised
    learning:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用监督学习构建基于决策树的预测机器学习模型：
- en: '**Prediction**'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: '**预测**'
- en: non-parametric method for regression (continuous response) and classification
    (categorical response)
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 非参数回归（连续响应）和分类（分类响应）的方法
- en: a function \(\hat{f}\) of the nearest \(k\) training data in predictor feature
    space such that we predict a response feature \(Y\) from a set of predictor features
    \(X_1,\ldots,X_m\).
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个函数 \(\hat{f}\)，它是预测特征空间中最近的 \(k\) 个训练数据的函数，这样我们就可以从一组预测特征 \(X_1,\ldots,X_m\)
    中预测响应特征 \(Y\)。
- en: 'the prediction is of the form:'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预测的形式如下：
- en: \begin{equation} \hat{Y} = \hat{f}(X_1,\ldots,X_m) + \epsilon \end{equation}
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: \begin{equation} \hat{Y} = \hat{f}(X_1,\ldots,X_m) + \epsilon \end{equation}
- en: where \(\epsilon\) is an error term.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\epsilon\) 是一个误差项。
- en: '**Supervised Learning**'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: '**监督学习**'
- en: the response feature, \(Y\), is available over the training and testing data
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 响应特征，\(Y\)，在训练和测试数据中都是可用的
- en: Load the Required Libraries
  id: totrans-194
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 加载所需的库
- en: The following code loads the required libraries. These should have been installed
    with Anaconda 3.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码加载所需的库。这些库应该已经与Anaconda 3一起安装。
- en: '[PRE21]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: If you get a package import error, you may have to first install some of these
    packages. This can usually be accomplished by opening up a command window on Windows
    and then typing ‘python -m pip install [package-name]’. More assistance is available
    with the respective package docs.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你遇到包导入错误，你可能需要首先安装这些包中的几个。这通常可以通过在Windows上打开命令窗口然后输入‘python -m pip install
    [package-name]’来完成。更多帮助可以在相应的包文档中找到。
- en: Set the Random Number Seed
  id: totrans-198
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置随机数种子
- en: 'These workflows and models may use random processes, e.g.:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 这些工作流程和模型可能使用随机过程，例如：
- en: random train and test split with cross validation and k-fold cross validation
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 随机训练和测试分割，以及交叉验证和k折交叉验证
- en: random selection of a subset of features to consider for the next split
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 随机选择要考虑的下一分割的特征子集
- en: '[PRE22]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Declare functions
  id: totrans-203
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 声明函数
- en: Let’s define a function for plotting gridlines.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们定义一个用于绘制网格线的函数。
- en: '[PRE23]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Set the working directory
  id: totrans-206
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置工作目录
- en: I always like to do this so I don’t lose files and to simplify subsequent read
    and writes (avoid including the full address each time).
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 我总是喜欢这样做，这样我就不会丢失文件，并且可以简化后续的读取和写入（每次都避免包含完整的地址）。
- en: '[PRE24]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: You will have to update the part in quotes with your own working directory and
    the format is different on a Mac (e.g. “~/PGE”).
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 你将不得不更新引号内的部分为你的工作目录，并且格式在Mac上不同（例如：“~/PGE”）。
- en: Read the data table
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 读取数据表
- en: We use a data “1D_Porosity.csv” comma delimited file from my GitHub [GeoDataSets
    Respository](https://github.com/GeostatsGuy/GeoDataSets).
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用来自我的GitHub [GeoDataSets 仓库](https://github.com/GeostatsGuy/GeoDataSets)的数据“1D_Porosity.csv”逗号分隔文件。
- en: this code loads the data directly from my GitHub repository.
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这段代码直接从我的GitHub仓库加载数据。
- en: if you have the data file available locally (i.e. you are not connected to the
    internet) set the working directory to the location with the data file and use
    the second line below
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你本地有数据文件（即你未连接到互联网），请将工作目录设置为数据文件的位置，并使用下面的第二行
- en: '[PRE25]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '[PRE26]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Plot the Available Data
  id: totrans-216
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 绘制可用数据
- en: Let’s do a simple scatter plot to check the data.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们做一个简单的散点图来检查数据。
- en: '[PRE27]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '![_images/c8f68d96b92a64e674753dd321abb3376a788853f792000775c676b02927aec1.png](../Images/1185159d2aa42c7833a49ebd954a9aca.png)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/1185159d2aa42c7833a49ebd954a9aca.png)'
- en: 'Optional: Add Random Error to the Response Feature, \(y\)'
  id: totrans-220
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 可选：向响应特征，\(y\)，添加随机误差
- en: For more experiential learning consider repeating this workflow with different
    amounts of additional error
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更多的经验学习，考虑使用不同的额外错误量重复此工作流程
- en: to observe issues of model overfit consider adding some additional error,
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了观察模型过拟合的问题，可以添加一些额外的误差，
- en: '[PRE28]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '[PRE29]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '![_images/db6bdae8f03df1faab8e473a6c4ac4068bec1a1c0601e89ed59590368330bf1c.png](../Images/a4f6a9c8841781db06c62d6cdf546dde.png)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/a4f6a9c8841781db06c62d6cdf546dde.png)'
- en: Fast Forward Through Data Analytics
  id: totrans-226
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 快速跳过数据分析
- en: This workflow is focussed on building predictive machine learning models
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 此工作流程专注于构建预测机器学习模型
- en: for brevity we skip data checking, data analytics, statistical analysis, feature
    transformations etc.
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了简洁，我们跳过了数据检查、数据分析、统计分析、特征转换等。
- en: we skip all the way to model building
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们直接跳到模型构建
- en: we don’t even discuss model selection, feature selection, nor robust hyperparameter
    tuning
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们甚至没有讨论模型选择、特征选择，也没有讨论鲁棒的超参数调整
- en: This is the most simple predictive machine learning workflow possible!
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 这是最简单的预测机器学习工作流程！
- en: basics for machine learning with scikit-learn in Python. Nothing more.
  id: totrans-232
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python中使用scikit-learn进行机器学习的基础。仅此而已。
- en: Let’s Build a Predictive Machine Learning Model
  id: totrans-233
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 让我们构建一个预测机器学习模型
- en: We use the following steps to build our model
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用以下步骤来构建我们的模型
- en: '**instantiate** the machine learning model with hyperparameters'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**实例化**机器学习模型并设置超参数'
- en: '**fit**, train the machine learing model to the training data'
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**fit**，将机器学习模型训练到训练数据上'
- en: '**predict**, check the trained machine learning models to predict at withheld
    testing data'
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**预测**，检查训练好的机器学习模型在保留的测试数据上的预测'
- en: '**select** the optimum hyperparameters, hyperparameter tuning'
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**选择**最佳超参数，超参数调整'
- en: '**refit** the model by training with all data given the tuned hyperparmaeters'
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**refit**模型，通过使用所有给定并调整好的超参数进行训练'
- en: We will use the train - test approach, an alternative is the train, validate
    and test approach.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用训练-测试方法，另一种方法是训练、验证和测试方法。
- en: we will start simple and cover k-fold cross validation and scikit-learn pipeline
    class later
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们将从一个简单的例子开始，并稍后介绍k折交叉验证和scikit-learn管道类
- en: Split Train and Test
  id: totrans-242
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分割训练集和测试集
- en: 'We will demonstrate the following hyperparameter tuning methods:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将演示以下超参数调整方法：
- en: '**cross validation** - split 25% of data as withheld testing data, only 25%
    of data are tested'
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**交叉验证** - 将25%的数据作为保留的测试数据，只有25%的数据被测试'
- en: '**k-fold cross validation** - calculate average error over k folds, all data
    are tested'
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**k折交叉验证** - 在k个折上计算平均误差，所有数据都被测试'
- en: Let’s start with cross validation and then demonstrate k-fold cross validation.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从交叉验证开始，然后演示k折交叉验证。
- en: '[PRE30]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '![_images/8301051d675ae545cbd9a77b7b63baad14810e3e9f3dfd6e299fd5ce3e5cdd5c.png](../Images/9d97f00b8d0b32eb2d7d97ab07abb605.png)'
  id: totrans-248
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/9d97f00b8d0b32eb2d7d97ab07abb605.png)'
- en: Build a Decision Tree Model
  id: totrans-249
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 构建决策树模型
- en: Let’s instantiate (set the hyperparameter(s)) and fit (train with training data)
    a decision tree regression model to our data.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们实例化（设置超参数）并使用训练数据拟合一个决策树回归模型。
- en: '[PRE31]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: Predict With a Decision Tree Model
  id: totrans-252
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用决策树模型进行预测
- en: Now let’s make a prediction with our trained decision tree model.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们使用我们的训练决策树模型进行预测。
- en: '[PRE32]'
  id: totrans-254
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '![_images/c8659b494469d1cf1349fd8143fe016473544dea1159f62300489b493236734c.png](../Images/93fe563da105e7191b40024dad8586f5.png)'
  id: totrans-255
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/93fe563da105e7191b40024dad8586f5.png)'
- en: Predict Over a Range of Predictor Feature Values with a Decision Tree Model
  id: totrans-256
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用决策树模型预测一系列预测特征值
- en: Now, let’s make predictions over a range of predictor feature values so we can
    visualize the model.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们在一系列预测特征值上做出预测，以便我们可以可视化模型。
- en: this is easy to do since we have just 1 predictor feature
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这很容易做到，因为我们只有一个预测特征
- en: '[PRE33]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '![_images/3a5c6ea1ec85203a0f15c3d46ae86783757808f467cadc500454f9c887228fe0.png](../Images/29e1a12c1961942e61997bd3ac0110ca.png)'
  id: totrans-260
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/29e1a12c1961942e61997bd3ac0110ca.png)'
- en: Changing the Model Hyperparameter(s)
  id: totrans-261
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 改变模型超参数
- en: Let’s try changing the model complexity and refitting the model.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试改变模型复杂度并重新调整模型。
- en: '[PRE34]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '![_images/d3b73736375ae3ab790c7b21e2c4c20d28ebdffc2556a99912efb733b3fd7d82.png](../Images/32ce25273cb95be1bc73a931d2300783.png)'
  id: totrans-264
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/32ce25273cb95be1bc73a931d2300783.png)'
- en: Tuning the Model Hyperparameter(s)
  id: totrans-265
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 调整模型超参数
- en: To tune the model hyperparameters we need a metric to summarize model error
    over the withheld testing data
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 为了调整模型超参数，我们需要一个指标来总结保留测试数据上的模型误差
- en: let’s predict at the testing data and calculate our metric, testing mean square
    error.
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 让我们在测试数据上预测并计算我们的指标，即测试均方误差。
- en: '[PRE35]'
  id: totrans-268
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: '[PRE36]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: and we need to rebuild the model with a variable level of complexity
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要以可变复杂度重新构建模型
- en: let’s loop over the number of leaf nodes and plot the performance over the withheld
    testing data
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 让我们遍历叶节点数并绘制保留测试数据上的性能
- en: '[PRE37]'
  id: totrans-272
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: '![_images/d93257b45568bdd5ca8115c16b6ffab50c3eeae024f20178c1f5b9fc272cb45f.png](../Images/e07a293a3a9e2bf5b198ec8e220f17b1.png)'
  id: totrans-273
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/e07a293a3a9e2bf5b198ec8e220f17b1.png)'
- en: For a more robust assessment of performance let’s use scikit-learns k-fold cross
    validation.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 为了对性能进行更稳健的评估，让我们使用scikit-learn的k折交叉验证。
- en: '[PRE38]'
  id: totrans-275
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '![_images/c0edb899e876f1ebd639ac3d6c4eb5b5a9fe13138c12076aa8086978cb7789bc.png](../Images/93663d34dc6ae7a4b909718efe41cf18.png)'
  id: totrans-276
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/93663d34dc6ae7a4b909718efe41cf18.png)'
- en: The main product from all of the previous work is the tuned hyperparameter,
    the optimum model complexity.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 所有之前工作的主要成果是调整后的超参数，即最佳模型复杂度。
- en: now we refit the tuned model, train the model on all the data and our tuned
    model is ready for real-world use
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现在我们重新调整模型，在所有数据上训练模型，我们的调整后的模型现在可以用于实际应用了
- en: once again we are assuming a train and test workflow, not a train, validate
    and test workflow
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 再次假设我们有一个训练和测试工作流程，而不是训练、验证和测试工作流程
- en: '[PRE39]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: '![_images/a69faa8f42377a8d0bc8f93c7f2b21baf60c67eb5e475c3ade5d40904f40b23c.png](../Images/7f70bf1f19953f869e52080eed2cf1f7.png)'
  id: totrans-281
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/7f70bf1f19953f869e52080eed2cf1f7.png)'
- en: Complete Workflow with Pipelines
  id: totrans-282
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 完整工作流程与管道
- en: 'Let’s repeat the above workflow with a pipline from scikit-learn. Here some
    general comments:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们重复上述工作流程，使用scikit-learn的管道。以下是一些一般性评论：
- en: '**pipeline workflow steps** - list of steps, custom labels and the associated
    scikit-learn classes'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**管道工作流程步骤** - 步骤列表、自定义标签和相关的scikit-learn类'
- en: '**choices and hyperparameters** - as a dictionary with combined step custom
    labels and hyperparameter names'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**选择和超参数** - 以字典形式组合步骤自定义标签和超参数名称'
- en: '**workflow scenarios** - we can specify lists of choices and hyperparameters'
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**工作流程场景** - 我们可以指定选择和超参数的列表'
- en: '**consistent iteration** - the entire workflow is repeated for the full combinatorial'
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**一致迭代** - 整个工作流程会重复进行完整的组合'
- en: '**best model selected** - best combination of model hyperparameters and choices
    are refit with all data'
  id: totrans-288
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最佳模型选择** - 选择最佳模型超参数组合和选择，并使用所有数据进行重新拟合'
- en: '[PRE40]'
  id: totrans-289
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '[PRE41]'
  id: totrans-290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Comments
  id: totrans-291
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 评论
- en: This was a very simple demonstration of predictive machine learning model building
    with Python’s scikit-learn.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个使用Python的scikit-learn进行预测机器学习模型构建的简单演示。
- en: this is a basic introduction, much more could be done
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这是一个基本的介绍，可以做更多的事情
- en: I hope this was helpful,
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 希望这有所帮助，
- en: '*Michael*'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: '*迈克尔*'
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, The Hildebrand Department of Petroleum
    and Geosystems Engineering, Bureau of Economic Geology, The Jackson School of
    Geosciences, The University of Texas at Austin On twitter I’m the @GeostatsGuy.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔·皮尔茨，博士，P.Eng. 教授，德克萨斯大学奥斯汀分校Hildebrand石油和地质系统工程学院，经济地质局，Jackson地球科学学院，德克萨斯大学奥斯汀分校。在推特上，我是@GeostatsGuy。
- en: About the Author
  id: totrans-297
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关于作者
- en: '![](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
  id: totrans-298
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
- en: Professor Michael Pyrcz in his office on the 40 acres, campus of The University
    of Texas at Austin.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 在德克萨斯大学奥斯汀分校40英亩校园的办公室里，迈克尔·皮尔茨教授。
- en: Michael Pyrcz is a professor in the [Cockrell School of Engineering](https://cockrell.utexas.edu/faculty-directory/alphabetical/p),
    and the [Jackson School of Geosciences](https://www.jsg.utexas.edu/researcher/michael_pyrcz/),
    at [The University of Texas at Austin](https://www.utexas.edu/), where he researches
    and teaches subsurface, spatial data analytics, geostatistics, and machine learning.
    Michael is also,
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔·皮尔茨是德克萨斯大学奥斯汀分校的[Cockrell工程学院](https://cockrell.utexas.edu/faculty-directory/alphabetical/p)和[Jackson地球科学学院](https://www.jsg.utexas.edu/researcher/michael_pyrcz/)的教授，他在[德克萨斯大学奥斯汀分校](https://www.utexas.edu/)从事和教授地下、空间数据分析、地统计学和机器学习。迈克尔还，
- en: the principal investigator of the [Energy Analytics](https://fri.cns.utexas.edu/energy-analytics)
    freshmen research initiative and a core faculty in the Machine Learn Laboratory
    in the College of Natural Sciences, The University of Texas at Austin
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[能源分析](https://fri.cns.utexas.edu/energy-analytics)新生研究项目的首席研究员，以及德克萨斯大学奥斯汀分校自然科学学院机器学习实验室的核心教员。'
- en: an associate editor for [Computers and Geosciences](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board),
    and a board member for [Mathematical Geosciences](https://link.springer.com/journal/11004/editorial-board),
    the International Association for Mathematical Geosciences.
  id: totrans-302
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[计算机与地球科学](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board)的副编辑和[数学地球科学](https://link.springer.com/journal/11004/editorial-board)国际数学地球科学协会的董事会成员。'
- en: 'Michael has written over 70 [peer-reviewed publications](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en),
    a [Python package](https://pypi.org/project/geostatspy/) for spatial data analytics,
    co-authored a textbook on spatial data analytics, [Geostatistical Reservoir Modeling](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    and author of two recently released e-books, [Applied Geostatistics in Python:
    a Hands-on Guide with GeostatsPy](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    and [Applied Machine Learning in Python: a Hands-on Guide with Code](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html).'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔已经撰写了超过70篇[同行评审出版物](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en)，一个用于空间数据分析的[Python包](https://pypi.org/project/geostatspy/)，合著了一本关于空间数据分析的教科书[地统计学储层建模](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)，并是两本最近发布的电子书的作者，[Python中的应用地统计学：GeostatsPy实践指南](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)和[Python中的应用机器学习：带代码的实践指南](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html)。
- en: All of Michael’s university lectures are available on his [YouTube Channel](https://www.youtube.com/@GeostatsGuyLectures)
    with links to 100s of Python interactive dashboards and well-documented workflows
    in over 40 repositories on his [GitHub account](https://github.com/GeostatsGuy),
    to support any interested students and working professionals with evergreen content.
    To find out more about Michael’s work and shared educational resources visit his
    Website.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔的所有大学讲座都可以在他的[YouTube频道](https://www.youtube.com/@GeostatsGuyLectures)上找到，其中包含100多个Python交互式仪表板和40多个存储库中的详细记录工作流程，这些存储库位于他的[GitHub账户](https://github.com/GeostatsGuy)，以支持任何感兴趣的学生和在职专业人士，提供常青内容。想了解更多关于迈克尔的工作和共享教育资源，请访问他的网站。
- en: Want to Work Together?
  id: totrans-305
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 想要一起工作吗？
- en: I hope this content is helpful to those that want to learn more about subsurface
    modeling, data analytics and machine learning. Students and working professionals
    are welcome to participate.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望这些内容对那些想了解更多关于地下建模、数据分析和机器学习的人有所帮助。学生和在职专业人士欢迎参加。
- en: Want to invite me to visit your company for training, mentoring, project review,
    workflow design and / or consulting? I’d be happy to drop by and work with you!
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 想邀请我到贵公司进行培训、辅导、项目审查、工作流程设计和/或咨询吗？我很乐意拜访并与您合作！
- en: Interested in partnering, supporting my graduate student research or my Subsurface
    Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)?
    My research combines data analytics, stochastic modeling and machine learning
    theory with practice to develop novel methods and workflows to add value. We are
    solving challenging subsurface problems!
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 想要合作、支持我的研究生研究或我的地下数据分析与机器学习联盟（共同负责人是约翰·福斯特教授）吗？我的研究将数据分析、随机建模和机器学习理论与实践相结合，以开发新的方法和工作流程，增加价值。我们正在解决具有挑战性的地下问题！
- en: I can be reached at [mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu).
  id: totrans-309
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您可以通过[mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu)联系我。
- en: I’m always happy to discuss,
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 我总是很高兴讨论，
- en: '*Michael*'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: '*迈克尔*'
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The
    Jackson School of Geosciences, The University of Texas at Austin
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 迈克尔·皮尔奇，博士，注册工程师，德克萨斯大学奥斯汀分校 Cockrell 工程学院和 Jackson 地球科学学院教授
- en: 'More Resources Available at: [Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 更多资源可在以下链接获取：[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [网站](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [书籍](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python
    地质统计学电子书](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)
