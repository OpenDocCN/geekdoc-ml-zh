["```py\nimport pandas as pd\ndf = pd.read_csv(\"data/rent.csv\")\nprint(df.shape) # print rows, columns\ndf.head(2)       # dump first 2 rows\n```", "```py\ndf.head(2).T\n```", "```py\ndf.info()\n\n```", "```py\ndf_num = df[['bathrooms', 'bedrooms', 'longitude', 'latitude', 'price']]\ndf_num.head(2)\n```", "```py\nprint(df_num.isnull().any())\n```", "```py\n    X_train = df_num.drop('price', axis=1)\n    y_train = df_num['price']\n\n    ```", "```py\n    from sklearn.ensemble import RandomForestRegressor\n    rf = RandomForestRegressor(n_estimators=100,\n                               n_jobs=-1)        # train w/all CPU core\n\n    ```", "```py\n    rf.fit(X_train, y_train)\n\n    ```", "```py\nr2 = rf.score(X_train, y_train)\nprint( f\"{r2:.4f}\" )\n\n```", "```py\nrf = RandomForestRegressor(n_estimators=100,\n                           n_jobs=-1,\n                           oob_score=True)   # get error estimate\nrf.fit(X_train, y_train)\nnoisy_oob_r2 = rf.oob_score_\nprint(f\"OOB score {noisy_oob_r2:.4f}\")\n\n```", "```py\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_absolute_error\nimport numpy as np\n\nX, y = df_num.drop('price', axis=1), df_num['price']\n\nerrors = []\nprint(f\"Validation MAE trials:\", end='')\nfor i in range(7):\n X_train, X_test, y_train, y_test = \\\n train_test_split(X, y, test_size=0.20)\n rf = RandomForestRegressor(n_estimators=100, n_jobs=-1)\n rf.fit(X_train, y_train)\n y_predicted = rf.predict(X_test)\n e = mean_absolute_error(y_test, y_predicted)\n    print(f\" ${e:.0f}\", end='')\n    errors.append(e)\nprint()\nnoisy_avg_mae = np.mean(errors)\nprint(f\"Average validation MAE ${noisy_avg_mae:.0f}\")\n\n```", "```py\ndf_num.describe()\n```", "```py\nprint(df_num.price.sort_values(ascending=False).head(10))\n```", "```py\nprint(df_num.bathrooms.value_counts())\n```", "```py\nprint(df_num.bedrooms.value_counts())\n```", "```py\nbookcolors = { # our usual book color palette\n         'crimson': '#a50026', 'red': '#d73027',\n         'redorange': '#f46d43', 'orange': '#fdae61',\n         'yellow': '#fee090', 'sky': '#e0f3f8',\n         'babyblue': '#abd9e9', 'lightblue': '#74add1',\n         'blue': '#4575b4', 'purple': '#313695'}\nfig,ax = plt.subplots()\nax.set_xlabel('Num Bedrooms')\nax.set_ylabel('Num Apts')\nax.hist(df_num.bedrooms, color=bookcolors['blue'])\nplt.show()\n```", "```py\nbookcolors = {\n         'crimson': '#a50026', 'red': '#d73027',\n         'redorange': '#f46d43', 'orange': '#fdae61',\n         'yellow': '#fee090', 'sky': '#e0f3f8',\n         'babyblue': '#abd9e9', 'lightblue': '#74add1',\n         'blue': '#4575b4', 'purple': '#313695'\n     }\n\n```", "```py\nprint(len(df[(df.longitude==0.0) & (df.latitude==0.0)]))\n```", "```py\ndf_local = df[(df.latitude>40.764) & (df.latitude<40.7678) &\n              (df.longitude>=-73.9844) & (df.longitude<=-73.9842) &\n           (df.bathrooms==1) & (df.bedrooms==1)]\ndf_local[['bedrooms','bathrooms','street_address','price']].sort_values('price')\n```", "```py\n# filter all records (training/testing)\ndf_clean = df_num[(df_num.price>1_000) & (df_num.price<10_000)]\n\n```", "```py\nfig,ax = plt.subplots()\nax.set_xlabel('Clipped Price')\nax.set_ylabel('Num Apts at that price')\nax.hist(df_clean.price, bins=45, color=bookcolors['blue'])\nplt.show()\n```", "```py\nupper, lower = np.percentile(df.price, [1,99]) # find middle 98% of prices\nclipped = np.clip(df.price, upper, lower)\nfig,ax = plt.subplots()\nax.set_xlabel('Prices in middle 98% range')\nax.set_ylabel('Num Apts at that price')\nax.hist(clipped, bins=45, color=bookcolors['blue'])\nplt.show()\n```", "```py\ndf_missing = df_clean[(df_clean.longitude==0) | (df_clean.latitude==0)]\nprint(len(df_missing))\n```", "```py\ndf_clean = df_clean[(df_clean.longitude!=0) | (df_clean.latitude!=0)]\n\n```", "```py\ndf_clean = df_clean[(df_clean['latitude']>40.55) &\n                    (df_clean['latitude']<40.94) &\n                    (df_clean['longitude']>-74.1) &\n                    (df_clean['longitude']<-73.67)]\n\n```", "```py\nX, y = df_clean.drop('price', axis=1), df_clean['price']\nrf = RandomForestRegressor(n_estimators=100,\n                           n_jobs=-1,        # parallelize\n                           oob_score=True)   # get error estimate\nrf.fit(X, y)\nclean_oob_r2 = rf.oob_score_\nprint(f\"Validation OOB score {clean_oob_r2:.4f}\")\n\n```", "```py\nfrom sklearn.linear_model import Lasso\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20)\nlm = Lasso(alpha=0.5) # create linear model\nlm.fit(X_train, y_train)\nprint(f\"LM Training score {lm.score(X_train, y_train):.4f}\")\nprint(f\"LM Validation score {lm.score(X_test, y_test):.4f}\")\n\n```", "```py\nfrom sklearn.ensemble import GradientBoostingRegressor\n\ngbr = GradientBoostingRegressor(n_estimators = 2000)\ngbr.fit(X_train, y_train)\nprint(f\"GB Training score {gbr.score(X_train, y_train):.4f}\")\nprint(f\"GB Validation score {gbr.score(X_test, y_test):.4f}\")\n\n```", "```py\nX, y = df_num.drop('price', axis=1), df_num['price']\ny_log = np.log(y) # apply log to each price\n\nrf = RandomForestRegressor(n_estimators=100, n_jobs=-1, oob_score=True)\nrf.fit(X, y_log)\nlog_oob_r2 = rf.oob_score_\nprint(f\"OOB R^2 score for log(price) {log_oob_r2:.4f}\")\n\n```", "```py\ny_predicted_log = rf.predict(X_test)\ny_predicted = np.exp(y_predicted_log)\n```"]