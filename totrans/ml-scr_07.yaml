- en: Implementation
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实现
- en: 原文：[https://dafriedman97.github.io/mlbook/content/c1/code.html](https://dafriedman97.github.io/mlbook/content/c1/code.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://dafriedman97.github.io/mlbook/content/c1/code.html](https://dafriedman97.github.io/mlbook/content/c1/code.html)
- en: This section demonstrates how to fit a regression model in Python in practice.
    The two most common packages for fitting regression models in Python are `scikit-learn`
    and `statsmodels`. Both methods are shown before.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本节演示了如何在Python中实际拟合回归模型。Python中拟合回归模型最常用的两个包是`scikit-learn`和`statsmodels`。两种方法都已在之前展示。
- en: First, let’s import the data and necessary packages. We’ll again be using the
    [Boston housing](../appendix/data.html) dataset from `sklearn.datasets`.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们导入数据和必要的包。我们再次将使用来自`sklearn.datasets`的[Boston住房](../appendix/data.html)数据集。
- en: '[PRE0]'
  id: totrans-4
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Scikit-Learn
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Scikit-Learn
- en: 'Fitting the model in `scikit-learn` is very similar to how we fit our model
    from scratch in the previous section. The model is fit in two steps: first instantiate
    the model and second use the `fit()` method to train it.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在`scikit-learn`中拟合模型与我们在上一节从头开始拟合模型的方式非常相似。模型的拟合分为两个步骤：首先实例化模型，然后使用`fit()`方法对其进行训练。
- en: '[PRE1]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: As before, we can plot our fitted values against the true values. To form predictions
    with the `scikit-learn` model, we can use the `predict` method. Reassuringly,
    we get the same plot as before.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 与之前一样，我们可以将拟合值与真实值进行绘图。要使用`scikit-learn`模型进行预测，我们可以使用`predict`方法。令人欣慰的是，我们得到了与之前相同的图表。
- en: '[PRE2]'
  id: totrans-9
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![../../_images/code_7_0.png](../Images/c30172be75584d7a52239072918727de.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/code_7_0.png](../Images/c30172be75584d7a52239072918727de.png)'
- en: We can also check the estimated parameters using the `coef_` attribute as follows
    (note that only the first few are printed).
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以使用`coef_`属性来检查估计的参数，如下所示（注意只打印了前几个）。
- en: '[PRE3]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Statsmodels
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Statsmodels
- en: '`statsmodels` is another package frequently used for running linear regression
    in Python. There are two ways to run regression in `statsmodels`. The first uses
    `numpy` arrays like we did in the previous section. An example is given below.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '`statsmodels`是另一个在Python中运行线性回归时经常使用的包。在`statsmodels`中有两种运行回归的方式。第一种使用与上一节中相同的方式的`numpy`数组。以下是一个示例。'
- en: Note
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Note two subtle differences between this model and the models we’ve previously
    built. First, we have to manually add a constant to the predictor dataframe in
    order to give our model an intercept term. Second, we supply the training data
    when *instantiating* the model, rather than when fitting it.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 注意这个模型与我们之前构建的模型之间的两个细微差别。首先，我们必须手动将常数添加到预测变量数据框中，以便给我们的模型提供一个截距项。其次，我们在实例化模型时提供训练数据，而不是在拟合时提供。
- en: '[PRE5]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The second way to run regression in `statsmodels` is with `R`-style formulas
    and `pandas` dataframes. This allows us to identify predictors and target variables
    by name. An example is given below.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在`statsmodels`中运行回归的第二种方式是使用`R`风格的公式和`pandas`数据框。这允许我们通过名称识别预测变量和目标变量。以下是一个示例。
- en: '[PRE6]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '|  | CRIM | ZN | INDUS | CHAS | NOX | RM | AGE | DIS | RAD | TAX | PTRATIO
    | B | LSTAT | target |'
  id: totrans-21
  prefs: []
  type: TYPE_TB
  zh: '|  | CRIM | ZN | INDUS | CHAS | NOX | RM | AGE | DIS | RAD | TAX | PTRATIO
    | B | LSTAT | 目标 |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | ---
    | --- | --- |'
  id: totrans-22
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | ---
    | --- | --- |'
- en: '| 0 | 0.00632 | 18.0 | 2.31 | 0.0 | 0.538 | 6.575 | 65.2 | 4.0900 | 1.0 | 296.0
    | 15.3 | 396.90 | 4.98 | 24.0 |'
  id: totrans-23
  prefs: []
  type: TYPE_TB
  zh: '| 0 | 0.00632 | 18.0 | 2.31 | 0.0 | 0.538 | 6.575 | 65.2 | 4.0900 | 1.0 | 296.0
    | 15.3 | 396.90 | 4.98 | 24.0 |'
- en: '| 1 | 0.02731 | 0.0 | 7.07 | 0.0 | 0.469 | 6.421 | 78.9 | 4.9671 | 2.0 | 242.0
    | 17.8 | 396.90 | 9.14 | 21.6 |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 0.02731 | 0.0 | 7.07 | 0.0 | 0.469 | 6.421 | 78.9 | 4.9671 | 2.0 | 242.0
    | 17.8 | 396.90 | 9.14 | 21.6 |'
- en: '| 2 | 0.02729 | 0.0 | 7.07 | 0.0 | 0.469 | 7.185 | 61.1 | 4.9671 | 2.0 | 242.0
    | 17.8 | 392.83 | 4.03 | 34.7 |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 0.02729 | 0.0 | 7.07 | 0.0 | 0.469 | 7.185 | 61.1 | 4.9671 | 2.0 | 242.0
    | 17.8 | 392.83 | 4.03 | 34.7 |'
- en: '| 3 | 0.03237 | 0.0 | 2.18 | 0.0 | 0.458 | 6.998 | 45.8 | 6.0622 | 3.0 | 222.0
    | 18.7 | 394.63 | 2.94 | 33.4 |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 0.03237 | 0.0 | 2.18 | 0.0 | 0.458 | 6.998 | 45.8 | 6.0622 | 3.0 | 222.0
    | 18.7 | 394.63 | 2.94 | 33.4 |'
- en: '| 4 | 0.06905 | 0.0 | 2.18 | 0.0 | 0.458 | 7.147 | 54.2 | 6.0622 | 3.0 | 222.0
    | 18.7 | 396.90 | 5.33 | 36.2 |'
  id: totrans-27
  prefs: []
  type: TYPE_TB
  zh: '| 4 | 0.06905 | 0.0 | 2.18 | 0.0 | 0.458 | 7.147 | 54.2 | 6.0622 | 3.0 | 222.0
    | 18.7 | 396.90 | 5.33 | 36.2 |'
- en: '[PRE7]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[PRE8]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Scikit-Learn
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Scikit-Learn
- en: 'Fitting the model in `scikit-learn` is very similar to how we fit our model
    from scratch in the previous section. The model is fit in two steps: first instantiate
    the model and second use the `fit()` method to train it.'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在`scikit-learn`中拟合模型与我们在上一节从头开始拟合模型的方式非常相似。模型的拟合分为两个步骤：首先实例化模型，然后使用`fit()`方法对其进行训练。
- en: '[PRE9]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: As before, we can plot our fitted values against the true values. To form predictions
    with the `scikit-learn` model, we can use the `predict` method. Reassuringly,
    we get the same plot as before.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，我们可以将拟合值与真实值进行绘图。要使用`scikit-learn`模型进行预测，我们可以使用`predict`方法。令人欣慰的是，我们得到了与之前相同的图表。
- en: '[PRE10]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![../../_images/code_7_0.png](../Images/c30172be75584d7a52239072918727de.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/code_7_0.png](../Images/c30172be75584d7a52239072918727de.png)'
- en: We can also check the estimated parameters using the `coef_` attribute as follows
    (note that only the first few are printed).
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以使用`coef_`属性来检查估计的参数，如下所示（注意，这里只打印了前几个）。
- en: '[PRE11]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Statsmodels
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Statsmodels
- en: '`statsmodels` is another package frequently used for running linear regression
    in Python. There are two ways to run regression in `statsmodels`. The first uses
    `numpy` arrays like we did in the previous section. An example is given below.'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '`statsmodels`是另一个在Python中运行线性回归时经常使用的包。在`statsmodels`中有两种运行回归的方式。第一种使用与上一节中相同的`numpy`数组。以下是一个示例。'
- en: Note
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Note two subtle differences between this model and the models we’ve previously
    built. First, we have to manually add a constant to the predictor dataframe in
    order to give our model an intercept term. Second, we supply the training data
    when *instantiating* the model, rather than when fitting it.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 注意此模型与我们之前构建的模型之间的两个细微差别。首先，我们必须手动将常数添加到预测数据框中，以便给我们的模型提供一个截距项。其次，我们在实例化模型时提供训练数据，而不是在拟合时提供。
- en: '[PRE13]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: The second way to run regression in `statsmodels` is with `R`-style formulas
    and `pandas` dataframes. This allows us to identify predictors and target variables
    by name. An example is given below.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在`statsmodels`中运行回归的第二种方式是使用`R`风格的公式和`pandas`数据框。这允许我们通过名称识别预测变量和目标变量。以下是一个示例。
- en: '[PRE14]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '|  | CRIM | ZN | INDUS | CHAS | NOX | RM | AGE | DIS | RAD | TAX | PTRATIO
    | B | LSTAT | target |'
  id: totrans-46
  prefs: []
  type: TYPE_TB
  zh: '|  | CRIM | ZN | INDUS | CHAS | NOX | RM | AGE | DIS | RAD | TAX | PTRATIO
    | B | LSTAT | target |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | ---
    | --- | --- |'
  id: totrans-47
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | ---
    | --- | --- |'
- en: '| 0 | 0.00632 | 18.0 | 2.31 | 0.0 | 0.538 | 6.575 | 65.2 | 4.0900 | 1.0 | 296.0
    | 15.3 | 396.90 | 4.98 | 24.0 |'
  id: totrans-48
  prefs: []
  type: TYPE_TB
  zh: '| 0 | 0.00632 | 18.0 | 2.31 | 0.0 | 0.538 | 6.575 | 65.2 | 4.0900 | 1.0 | 296.0
    | 15.3 | 396.90 | 4.98 | 24.0 |'
- en: '| 1 | 0.02731 | 0.0 | 7.07 | 0.0 | 0.469 | 6.421 | 78.9 | 4.9671 | 2.0 | 242.0
    | 17.8 | 396.90 | 9.14 | 21.6 |'
  id: totrans-49
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 0.02731 | 0.0 | 7.07 | 0.0 | 0.469 | 6.421 | 78.9 | 4.9671 | 2.0 | 242.0
    | 17.8 | 396.90 | 9.14 | 21.6 |'
- en: '| 2 | 0.02729 | 0.0 | 7.07 | 0.0 | 0.469 | 7.185 | 61.1 | 4.9671 | 2.0 | 242.0
    | 17.8 | 392.83 | 4.03 | 34.7 |'
  id: totrans-50
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 0.02729 | 0.0 | 7.07 | 0.0 | 0.469 | 7.185 | 61.1 | 4.9671 | 2.0 | 242.0
    | 17.8 | 392.83 | 4.03 | 34.7 |'
- en: '| 3 | 0.03237 | 0.0 | 2.18 | 0.0 | 0.458 | 6.998 | 45.8 | 6.0622 | 3.0 | 222.0
    | 18.7 | 394.63 | 2.94 | 33.4 |'
  id: totrans-51
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 0.03237 | 0.0 | 2.18 | 0.0 | 0.458 | 6.998 | 45.8 | 6.0622 | 3.0 | 222.0
    | 18.7 | 394.63 | 2.94 | 33.4 |'
- en: '| 4 | 0.06905 | 0.0 | 2.18 | 0.0 | 0.458 | 7.147 | 54.2 | 6.0622 | 3.0 | 222.0
    | 18.7 | 396.90 | 5.33 | 36.2 |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '| 4 | 0.06905 | 0.0 | 2.18 | 0.0 | 0.458 | 7.147 | 54.2 | 6.0622 | 3.0 | 222.0
    | 18.7 | 396.90 | 5.33 | 36.2 |'
- en: '[PRE15]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
