["```py\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom matplotlib.ticker import (MultipleLocator, AutoMinorLocator, AutoLocator) # control of axes ticks\nplt.rc('axes', axisbelow=True)                            # set axes and grids in the background for all plots\nimport math\nseed = 13 \n```", "```py\ndef add_grid():\n    plt.gca().grid(True, which='major',linewidth = 1.0); plt.gca().grid(True, which='minor',linewidth = 0.2) # add y grids\n    plt.gca().tick_params(which='major',length=7); plt.gca().tick_params(which='minor', length=4)\n    plt.gca().xaxis.set_minor_locator(AutoMinorLocator()); plt.gca().yaxis.set_minor_locator(AutoMinorLocator()) # turn on minor ticks \n\ndef calculate_angle_rads(x1, y1, x2, y2):\n    dx = x2 - x1     # Calculate the differences\n    dy = y2 - y1\n    angle_rads = math.atan2(dy, dx)    # Calculate the angle in radians\n    #angle_degrees = math.degrees(angle_radians)    # Convert the angle to degrees\n    return angle_rads\n\ndef offset(pto, distance, angle_deg): # modified from ChatGPT 4.o generated\n    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians\n    x_new = pto[0] + distance * math.cos(angle_rads) # Calculate the new coordinates\n    y_new = pto[1] + distance * math.sin(angle_rads)\n    return np.array((x_new, y_new))\n\ndef offsetx(xo, distance, angle_deg): # modified from ChatGPT 4.o generated\n    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians\n    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates\n    return np.array((xo, x_new))\n\ndef offset_arrx(xo, distance, angle_deg,size): # modified from ChatGPT 4.o generated\n    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians\n    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates\n    x_arr = x_new + size * math.cos(angle_rads+2.48) # Calculate the new coordinates\n    return np.array((x_new, x_arr))\n\ndef offsety(yo, distance, angle_deg): # modified from ChatGPT 4.o generated\n    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians\n    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates\n    return np.array((yo, y_new))\n\ndef offset_arry(yo, distance, angle_deg,size): # modified from ChatGPT 4.o generated\n    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians\n    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates\n    y_arr = y_new + size * math.sin(angle_rads+2.48) # Calculate the new coordinates\n    return np.array((y_new, y_arr))\n\ndef lint(x1, y1, x2, y2, t):\n    # Calculate the interpolated coordinates\n    x = x1 + t * (x2 - x1)\n    y = y1 + t * (y2 - y1)\n    return np.array((x, y))\n\ndef lintx(x1, y1, x2, y2, t):\n    # Calculate the interpolated coordinates\n    x = x1 + t * (x2 - x1)\n    return x\n\ndef linty(x1, y1, x2, y2, t):\n    # Calculate the interpolated coordinates\n    y = y1 + t * (y2 - y1)\n    return y\n\ndef lint_intx(x1, y1, x2, y2, ts, te):\n    # Calculate the interpolated coordinates\n    xs = x1 + ts * (x2 - x1)\n    xe = x1 + te * (x2 - x1)\n    return np.array((xs,xe))\n\ndef lint_inty(x1, y1, x2, y2, ts, te):\n    # Calculate the interpolated coordinates\n    ys = y1 + ts * (y2 - y1)\n    ye = y1 + te * (y2 - y1)\n    return np.array((ys,ye))\n\ndef lint_int_arrx(x1, y1, x2, y2, ts, te, size):\n    # Calculate the interpolated coordinates\n    xe = x1 + te * (x2 - x1)\n    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)\n    x_arr = xe + size * math.cos(line_angle_rads+2.48) # Calculate the new coordinates\n    return np.array((xe,x_arr))\n\ndef lint_int_arry(x1, y1, x2, y2, ts, te, size):\n    # Calculate the interpolated coordinates\n    ye = y1 + te * (y2 - y1)\n    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)\n    y_arr = ye + size * math.sin(line_angle_rads+2.48) # Calculate the new coordinates\n    return np.array((ye,y_arr))\n\ndef as_si(x, ndp): # from xnx on StackOverflow https://stackoverflow.com/questions/31453422/displaying-numbers-with-x-instead-of-e-scientific-notation-in-matplotlib \n    s = '{x:0.{ndp:d}e}'.format(x=x, ndp=ndp)\n    m, e = s.split('e')\n    return r'{m:s}\\times 10^{{{e:d}}}'.format(m=m, e=int(e)) \n```", "```py\nx1 = 0.5; x2 = 0.2; x3 = 0.7; y = 0.3 # training data\nlr = 0.2 # learning rate\n\nnp.random.seed(seed=seed)\n\nnepoch = 1000\n\ny4 = np.zeros(nepoch); y5 = np.zeros(nepoch); y6 = np.zeros(nepoch)\n\nw14 = np.zeros(nepoch); w24 = np.zeros(nepoch); w34 = np.zeros(nepoch)\nw15 = np.zeros(nepoch); w25 = np.zeros(nepoch); w35 = np.zeros(nepoch)\nw46 = np.zeros(nepoch); w56 = np.zeros(nepoch)\n\ndw14 = np.zeros(nepoch); dw24 = np.zeros(nepoch); dw34 = np.zeros(nepoch)\ndw15 = np.zeros(nepoch); dw25 = np.zeros(nepoch); dw35 = np.zeros(nepoch)\ndw46 = np.zeros(nepoch); dw56 = np.zeros(nepoch)\n\ndb4 = np.zeros(nepoch); db5 = np.zeros(nepoch); db6 = np.zeros(nepoch)\n\nb4 = np.zeros(nepoch); b5 = np.zeros(nepoch); b6 = np.zeros(nepoch)\ny4 = np.zeros(nepoch); y5 = np.zeros(nepoch); y6 = np.zeros(nepoch)\nd4 = np.zeros(nepoch); d5 = np.zeros(nepoch); d6 = np.zeros(nepoch)\n\n# initialize the weights - Xavier Weight Initialization \nlower, upper = -(1.0 / np.sqrt(3.0)), (1.0 / np.sqrt(3.0)) # lower and upper bound for the weights, uses inputs to node\n#lower, upper = -(sqrt(6.0) / sqrt(3.0 + 2.0)), (sqrt(6.0) / sqrt(3.0 + 2.0)) # Normalized Xavier weights, integrates ouputs also\nw14[0] = lower + np.random.random() * (upper - lower); \nw24[0] = lower + np.random.random() * (upper - lower); \nw34[0] = lower + np.random.random() * (upper - lower);\nw15[0] = lower + np.random.random() * (upper - lower); \nw25[0] = lower + np.random.random() * (upper - lower); \nw35[0] = lower + np.random.random() * (upper - lower);\n\nlower, upper = -(1.0 / np.sqrt(2.0)), (1.0 / np.sqrt(2.0))\n#lower, upper = -(sqrt(6.0) / sqrt(2.0 + 1.0)), (sqrt(6.0) / sqrt(2.0 + 1.0)) # Normalized Xavier weights, integrates ouputs also\n\nw46[0] = lower + np.random.random() * (upper - lower); \nw56[0] = lower + np.random.random() * (upper - lower);     \n\n#b4[0] = np.random.random(); b5[0] = np.random.random(); b6[0] = np.random.random()\nb4[0] = (np.random.random()-0.5)*0.5; b5[0] = (np.random.random()-0.5)*0.5; b6[0] = (np.random.random()-0.5)*0.5; # small random value \n\nfor i in range(0,nepoch):\n\n# forward pass of model\n    y4[i] = w14[i]*x1 + w24[i]*x2 + w34[i]*x3 + b4[i]; \n    y4[i] = 1.0/(1 + math.exp(-1*y4[i]))\n\n    y5[i] = w15[i]*x1 + w25[i]*x2 + w35[i]*x3 + b5[i]\n    y5[i] = 1.0/(1 + math.exp(-1*y5[i]))\n\n    y6[i] = w46[i]*y4[i] + w56[i]*y5[i] + b6[i]\n#    y6[i] = 1.0/(1 + math.exp(-1*y6[i])) # sgimoid / logistic activation at o6 \n\n# back propagate the error through the nodes\n#    d6[i] = y6[i]*(1-y6[i])*(y-y6[i]) # sgimoid / logistic activation at o6 \n    d6[i] = (y-y6[i]) # identity activation o at o6\n    d5[i] = y5[i]*(1-y5[i])*w56[i]*d6[i]; d4[i] = y4[i]*(1-y4[i])*w46[i]*d6[i]\n\n# calculate the change in weights\n    if i < nepoch - 1:\n        dw14[i] = lr*d4[i]*x1; dw24[i] = lr*d4[i]*x2; dw34[i] = lr*d4[i]*x3\n        dw15[i] = lr*d5[i]*x1; dw25[i] = lr*d5[i]*x2; dw35[i] = lr*d5[i]*x3\n        dw46[i] = lr*d6[i]*y4[i]; dw56[i] = lr*d6[i]*y5[i] \n\n        db4[i] = lr*d4[i]; db5[i] = lr*d5[i]; db6[i] = lr*d6[i];\n\n        w14[i+1] = w14[i] + dw14[i]; w24[i+1] = w24[i] + dw24[i]; w34[i+1] = w34[i] + dw34[i] \n        w15[i+1] = w15[i] + dw15[i]; w25[i+1] = w25[i] + dw25[i]; w35[i+1] = w35[i] + dw35[i] \n        w46[i+1] = w46[i] + dw46[i]; w56[i+1] = w56[i] + dw56[i]\n\n        b4[i+1] = b4[i] + db4[i]; b5[i+1] = b5[i] + db5[i]; b6[i+1] = b6[i] + db6[i] \n```", "```py\niepoch = 1\n\ndx = -0.19; dy = -0.09; edge = 1.0\n\no6x = 17; o6y =5; h5x = 10; h5y = 3.5; h4x = 10; h4y = 6.5\ni1x = 3; i1y = 9.0; i2x = 3; i2y = 5; i3x = 3; i3y = 1.0; buffer = 0.5\n\nplt.subplot(111)\nplt.gca().set_axis_off()\n\ncircle_i1 = plt.Circle((i1x,i1y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_1$',(i1x+dx,i1y+dy),zorder=100); \ncircle_i1b = plt.Circle((i1x,i1y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)\n\ncircle_i2 = plt.Circle((i2x,i2y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_2$',(i2x+dx,i2y+dy),zorder=100); \ncircle_i2b = plt.Circle((i2x,i2y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_i2); plt.gca().add_patch(circle_i2b)\n\ncircle_i3 = plt.Circle((i3x,i3y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_3$',(i3x+dx,i3y+dy),zorder=100); \ncircle_i3b = plt.Circle((i3x,i3y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_i3); plt.gca().add_patch(circle_i3b)\n\ncircle_h4 = plt.Circle((h4x,h4y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$H_4$',(h4x+dx,h4y+dy),zorder=100); \ncircle_h4b = plt.Circle((h4x,h4y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_h4); plt.gca().add_patch(circle_h4b)\n\ncircle_h5 = plt.Circle((h5x,h5y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$H_5$',(h5x+dx,h5y+dy),zorder=100); \ncircle_h5b = plt.Circle((h5x,h5y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_h5); plt.gca().add_patch(circle_h5b)\n\ncircle_o6 = plt.Circle((o6x,o6y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$O_6$',(o6x+dx,o6y+dy),zorder=100); \ncircle_o6b = plt.Circle((o6x,o6y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_o6); plt.gca().add_patch(circle_o6b)\n\nplt.plot([i1x-edge,i1x],[i1y,i1y],color='grey',lw=1.0,zorder=1)\nplt.plot([i2x-edge,i2x],[i2y,i2y],color='grey',lw=1.0,zorder=1)\nplt.plot([i3x-edge,i3x],[i3y,i3y],color='grey',lw=1.0,zorder=1)\n\nplt.annotate(r'$x_1$ = ' + str(np.round(x1,2)),(i1x-buffer-1.6,i1y-0.05),size=8,zorder=200,color='grey',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) \nplt.annotate(r'$x_2$ = ' + str(np.round(x2,2)),(i2x-buffer-1.6,i2y-0.05),size=8,zorder=200,color='grey',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) \nplt.annotate(r'$x_3$ = ' + str(np.round(x3,2)),(i3x-buffer-1.6,i3y-0.05),size=8,zorder=200,color='grey',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) \n\nplt.plot([i1x,h4x],[i1y,h4y],color='lightcoral',lw=1.0,zorder=1)\nplt.plot([i2x,h4x],[i2y,h4y],color='red',lw=1.0,zorder=1)\nplt.plot([i3x,h4x],[i3y,h4y],color='darkred',lw=1.0,zorder=1)\n\nplt.plot([i1x,h5x],[i1y,h5y],color='dodgerblue',lw=1.0,zorder=1)\nplt.plot([i2x,h5x],[i2y,h5y],color='blue',lw=1.0,zorder=1)\nplt.plot([i3x,h5x],[i3y,h5y],color='darkblue',lw=1.0,zorder=1)\n\nplt.plot([h4x,o6x],[h4y,o6y],color='orange',lw=1.0,zorder=1)\nplt.plot([h5x,o6x],[h5y,o6y],color='darkorange',lw=1.0,zorder=1)\n\nplt.plot([o6x+edge,o6x],[o6y,o6y],color='grey',lw=1.0,zorder=1)\nplt.annotate(r'$\\hat{y}$ = ' + str(np.round(y6[iepoch],2)),(o6x+buffer+0.7,o6y-0.05),size=8,zorder=200,color='grey',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) \n\nplt.plot(offsetx(h4x,2,-12),offsety(h4y,2,-12)+0.1,color='orange',lw=1.0,zorder=1)\nplt.plot(offset_arrx(h4x,2,-12,0.2),offset_arry(h4y,2,-12,0.2)+0.1,color='orange',lw=1.0,zorder=1)\nplt.annotate(r'$H_{4}$ = ' + str(np.round(y4[iepoch],2)),(lintx(h4x,h4y,o6x,o6y,0.08),linty(h4x,h4y,o6x,o6y,0.08)-0.0),size=8,zorder=200,color='orange',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12)\n\nplt.plot(offsetx(h5x,2,12),offsety(h5y,2,12)+0.1,color='darkorange',lw=1.0,zorder=1)\nplt.plot(offset_arrx(h5x,2,12,0.2),offset_arry(h5y,2,12,0.2)+0.1,color='darkorange',lw=1.0,zorder=1)\nplt.annotate(r'$H_{5}$ = ' + str(np.round(y5[iepoch],2)),(lintx(h5x,h5y,o6x,o6y,0.07),linty(h5x,h5y,o6x,o6y,0.07)+0.25),size=8,zorder=200,color='darkorange',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)\n\nplt.annotate(r'$\\frac{\\partial P}{\\partial O_{6_{in}}}$ = ' + str(np.round(d6[iepoch],2)),(o6x-0.5,o6y-0.7),size=10)\nplt.annotate(r'$\\frac{\\partial P}{\\partial H_{4_{in}}}$ = ' + str(np.round(d4[iepoch],2)),(h4x-0.5,h4y-0.7),size=10)\nplt.annotate(r'$\\frac{\\partial P}{\\partial H_{5_{in}}}$ = ' + str(np.round(d5[iepoch],2)),(h5x-0.5,h5y-0.7),size=10)\n\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\hat{y}}$ = ' + str(np.round(d6[iepoch],2)),(o6x,o6y-1.2),size=10)\nplt.annotate(r'$\\frac{\\partial P}{\\partial H_{4_{out}}}$ = ' + str(np.round(w46[iepoch]*d6[iepoch],2)),(h4x,h4y-1.2),size=10)\nplt.annotate(r'$\\frac{\\partial P}{\\partial H_{5_{out}}}$ = ' + str(np.round(w56[iepoch]*d6[iepoch],2)),(h5x,h5y-1.2),size=10)\n\nplt.plot(lint_intx(h4x, h4y, o6x, o6y,0.4,0.6),lint_inty(h4x,h4y,o6x,o6y,0.4,0.6)-0.1,color='orange',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(o6x,o6y,h4x,h4y,0.4,0.6,0.2),lint_int_arry(o6x,o6y,h4x,h4y,0.4,0.6,0.2)-0.1,color='orange',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{4,6}}$ = ' + str(np.round(dw46[iepoch]/lr,4)),(lintx(h4x,h4y,o6x,o6y,0.5)-0.6,linty(h4x,h4y,o6x,o6y,0.5)-0.72),size=10,zorder=200,color='orange',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-11)\n\nplt.plot(lint_intx(h5x, h5y, o6x, o6y,0.4,0.6),lint_inty(h5x,h5y,o6x,o6y,0.4,0.6)-0.1,color='darkorange',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(o6x,o6y,h5x,h5y,0.4,0.6,0.2),lint_int_arry(o6x,o6y,h5x,h5y,0.4,0.6,0.2)-0.1,color='darkorange',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{5,6}}$ = ' + str(np.round(dw56[iepoch]/lr,4)),(lintx(h5x,h5y,o6x,o6y,0.5)-0.4,linty(h5x,h5y,o6x,o6y,0.5)-0.6),size=10,zorder=200,color='darkorange',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)\n\nplt.plot(offsetx(i1x,2,-20),offsety(i1y,2,-20)+0.1,color='lightcoral',lw=1.0,zorder=1)\nplt.plot(offset_arrx(i1x,2,-20,0.2),offset_arry(i1y,2,-20,0.2)+0.1,color='lightcoral',lw=1.0,zorder=1)\nplt.annotate(r'$I_{1}$ = ' + str(np.round(x1,2)),(lintx(i1x,i1y,h4x,h4y,0.1),linty(i1x,i1y,h4x,h4y,0.1)),size=8,zorder=200,color='lightcoral',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-20)\n\nplt.plot(offsetx(i2x,2,12),offsety(i2y,2,12)+0.1,color='red',lw=1.0,zorder=1)\nplt.plot(offset_arrx(i2x,2,12,0.2),offset_arry(i2y,2,12,0.2)+0.1,color='red',lw=1.0,zorder=1)\nplt.annotate(r'$I_{2}$ = ' + str(np.round(x2,2)),(lintx(i2x,i2y,h4x,h4y,0.1),linty(i2x,i2y,h4x,h4y,0.1)+0.22),size=8,zorder=200,color='red',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)\n\nplt.plot(offsetx(i3x,2,38),offsety(i3y,2,38)+0.1,color='darkred',lw=1.0,zorder=1)\nplt.plot(offset_arrx(i3x,2,38,0.2),offset_arry(i3y,2,38,0.2)+0.1,color='darkred',lw=1.0,zorder=1)\nplt.annotate(r'$I_{3}$ = ' + str(np.round(x3,2)),(lintx(i3x,i3y,h4x,h4y,0.08)-0.2,linty(i3x,i3y,h4x,h4y,0.08)+0.2),size=8,zorder=200,color='darkred',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=38)\n\nplt.annotate(r'$\\lambda_{1,4}$ = ' + str(np.round(w14[iepoch],2)),((i1x+h4x)*0.45,(i1y+h4y)*0.5-0.05),size=8,zorder=200,color='lightcoral',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-18) \nplt.annotate(r'$\\lambda_{2,4}$ = ' + str(np.round(w24[iepoch],2)),((i2x+h4x)*0.45-0.3,(i2y+h4y)*0.5-0.03),size=8,zorder=200,color='red',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=10) \nplt.annotate(r'$\\lambda_{3,4}$ = ' + str(np.round(w34[iepoch],2)),((i3x+h4x)*0.45-1.2,(i3y+h4y)*0.5-1.1),size=8,zorder=200,color='darkred',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=38) \n\nplt.annotate(r'$\\lambda_{1,5}$ = ' + str(np.round(w15[iepoch],2)),((i1x+h5x)*0.55-2.5,(i1y+h5y)*0.5+0.9),size=8,zorder=200,color='dodgerblue',\n    bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-36) \nplt.annotate(r'$\\lambda_{2,5}$ = ' + str(np.round(w25[iepoch],2)),((i2x+h5x)*0.55-1.5,(i2y+h5y)*0.5+0.05),size=8,zorder=200,color='blue',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12) \nplt.annotate(r'$\\lambda_{3,5}$ = ' + str(np.round(w35[iepoch],2)),((i3x+h5x)*0.55-1.0,(i3y+h5y)*0.5+0.1),size=8,zorder=200,color='darkblue',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=20) \n\nplt.annotate(r'$\\lambda_{4,6}$ = ' + str(np.round(w46[iepoch],2)),((h4x+o6x)*0.47,(h4y+o6y)*0.47+0.39),size=8,zorder=200,color='orange',\n    bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12) \nplt.annotate(r'$\\lambda_{5,6}$ = ' + str(np.round(w56[iepoch],2)),((h5x+o6x)*0.47,(h5y+o6y)*0.47+0.26),size=8,zorder=200,color='darkorange',\n    bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=12) \n\nplt.plot(lint_intx(i1x, i1y, h4x, h4y,0.4,0.6),lint_inty(i1x,i1y,h4x,h4y,0.4,0.6)-0.1,color='lightcoral',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h4x,h4y,i1x,i1y,0.4,0.6,0.2),lint_int_arry(h4x,h4y,i1x,i1y,0.4,0.6,0.2)-0.1,color='lightcoral',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{1,4}} =$' + r'${0:s}$'.format(as_si(dw14[iepoch]/lr,2)),(lintx(i1x,i1y,h4x,h4y,0.5)-0.6,linty(i1x,i1y,h4x,h4y,0.5)-1.0),size=8,zorder=200,color='lightcoral',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-20)\n\nplt.plot(lint_intx(i2x, i2y, h4x, h4y,0.3,0.5),lint_inty(i2x,i2y,h4x,h4y,0.3,0.5)-0.1,color='red',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h4x,h4y,i2x,i2y,0.5,0.7,0.2),lint_int_arry(h4x,h4y,i2x,i2y,0.5,0.7,0.2)-0.12,color='red',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{2,4}} =$' + r'${0:s}$'.format(as_si(dw24[iepoch]/lr,2)),(lintx(i2x,i2y,h4x,h4y,0.5)-1.05,linty(i2x,i2y,h4x,h4y,0.5)-0.7),size=8,zorder=200,color='red',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)\n\nplt.plot(lint_intx(i3x, i3y, h4x, h4y,0.2,0.4),lint_inty(i3x,i3y,h4x,h4y,0.2,0.4)-0.1,color='darkred',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h4x,h4y,i3x,i3y,0.5,0.8,0.2),lint_int_arry(h4x,h4y,i3x,i3y,0.5,0.8,0.2)-0.12,color='darkred',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{3,4}} =$' + r'${0:s}$'.format(as_si(dw34[iepoch]/lr,2)),(lintx(i3x,i3y,h4x,h4y,0.5)-1.7,linty(i3x,i3y,h4x,h4y,0.5)-1.7),size=8,zorder=200,color='darkred',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=38)\n\nplt.plot(lint_intx(i3x, i3y, h5x, h5y,0.4,0.6),lint_inty(i3x,i3y,h5x,h5y,0.4,0.6)-0.1,color='darkblue',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h5x,h5y,i3x,i3y,0.4,0.6,0.2),lint_int_arry(h5x,h5y,i3x,i3y,0.4,0.6,0.2)-0.12,color='darkblue',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{3,5}} =$' + r'${0:s}$'.format(as_si(dw35[iepoch]/lr,2)),(lintx(i3x,i3y,h5x,h5y,0.5)-0.4,linty(i3x,i3y,h5x,h5y,0.5)-0.6),size=8,zorder=200,color='darkblue',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=20)\n\nplt.plot(lint_intx(i2x, i2y, h5x, h5y,0.3,0.5),lint_inty(i2x,i2y,h5x,h5y,0.3,0.5)-0.1,color='blue',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h5x,h5y,i2x,i2y,0.3,0.7,0.2),lint_int_arry(h5x,h5y,i2x,i2y,0.3,0.7,0.2)-0.12,color='blue',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{2,5}} =$' + r'${0:s}$'.format(as_si(dw25[iepoch]/lr,2)),(lintx(i2x,i2y,h5x,h5y,0.5)-1.2,linty(i2x,i2y,h5x,h5y,0.5)-0.65),size=8,zorder=200,color='blue',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12)\n\nplt.plot(lint_intx(i1x, i1y, h5x, h5y,0.2,0.4),lint_inty(i1x,i1y,h5x,h5y,0.2,0.4)-0.1,color='dodgerblue',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h5x,h5y,i1x,i1y,0.2,0.8,0.2),lint_int_arry(h5x,h5y,i1x,i1y,0.2,0.8,0.2)-0.12,color='dodgerblue',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{1,5}} =$' + r'${0:s}$'.format(as_si(dw15[iepoch]/lr,2)),(lintx(i1x,i1y,h5x,h5y,0.5)-2.2,linty(i1x,i1y,h4x,h4y,0.5)-1.5),size=8,zorder=200,color='dodgerblue',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-36,xycoords = 'data')\n\nplt.subplots_adjust(left=0.0, bottom=0.0, right=1.5, top=1.0, wspace=0.2, hspace=0.2); plt.show() \n```", "```py\nplt.subplot(131)\nplt.plot(np.arange(1,nepoch+1,1),y6,color='red',label=r'$\\hat{y}$'); plt.xlim([1,nepoch]); plt.ylim([0,1])\nplt.xlabel('Epochs'); plt.ylabel(r'$\\hat{y}$'); plt.title('Simple Artificial Neural Network Prediction')\nplt.plot([1,nepoch],[y,y],color='black',ls='--'); plt.vlines(400,-1.5,1.5,color='black')\nadd_grid(); plt.legend(loc='upper right'); plt.xscale('log')\n\nplt.subplot(132)\nplt.plot(np.arange(1,nepoch+1,1),w14,color='lightcoral',label = r'$\\lambda_{1,4}$') \nplt.plot(np.arange(1,nepoch+1,1),w24,color='red',label = r'$\\lambda_{2,4}$') \nplt.plot(np.arange(1,nepoch+1,1),w34,color='darkred',label = r'$\\lambda_{3,4}$') \nplt.plot(np.arange(1,nepoch+1,1),w15,color='dodgerblue',label = r'$\\lambda_{1,5}$') \nplt.plot(np.arange(1,nepoch+1,1),w25,color='blue',label = r'$\\lambda_{2,5}$') \nplt.plot(np.arange(1,nepoch+1,1),w35,color='darkblue',label = r'$\\lambda_{3,5}$')\nplt.plot(np.arange(1,nepoch+1,1),w46,color='orange',label = r'$\\lambda_{4,6}$')\nplt.plot(np.arange(1,nepoch+1,1),w56,color='darkorange',label = r'$\\lambda_{5,6}$')\nplt.plot([1,nepoch],[0,0],color='black',ls='--')\nplt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')\nplt.xlabel('Epochs'); plt.ylabel(r'$\\hat{y}$'); plt.title('Simple Artificial Neural Network Weights')\nadd_grid(); plt.legend(loc='upper right'); plt.xscale('log')\n\nplt.subplot(133)\nplt.plot(np.arange(1,nepoch+1,1),w14,color='lightgreen',label = r'$\\phi_{4}$') \nplt.plot(np.arange(1,nepoch+1,1),w24,color='green',label = r'$\\phi_{5}$') \nplt.plot(np.arange(1,nepoch+1,1),w34,color='darkgreen',label = r'$\\phi_{6}$') \nplt.plot([1,nepoch],[0,0],color='black',ls='--')\nplt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')\nplt.xlabel('Epochs'); plt.ylabel(r'$\\hat{y}$'); plt.title('Simple Artificial Neural Network Biases')\nadd_grid(); plt.legend(loc='upper right'); plt.xscale('log')\n\nplt.subplots_adjust(left=0.0, bottom=0.0, right=3.0, top=1.0, wspace=0.2, hspace=0.2); plt.show() \n```", "```py\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom matplotlib.ticker import (MultipleLocator, AutoMinorLocator, AutoLocator) # control of axes ticks\nplt.rc('axes', axisbelow=True)                            # set axes and grids in the background for all plots\nimport math\nseed = 13 \n```", "```py\ndef add_grid():\n    plt.gca().grid(True, which='major',linewidth = 1.0); plt.gca().grid(True, which='minor',linewidth = 0.2) # add y grids\n    plt.gca().tick_params(which='major',length=7); plt.gca().tick_params(which='minor', length=4)\n    plt.gca().xaxis.set_minor_locator(AutoMinorLocator()); plt.gca().yaxis.set_minor_locator(AutoMinorLocator()) # turn on minor ticks \n\ndef calculate_angle_rads(x1, y1, x2, y2):\n    dx = x2 - x1     # Calculate the differences\n    dy = y2 - y1\n    angle_rads = math.atan2(dy, dx)    # Calculate the angle in radians\n    #angle_degrees = math.degrees(angle_radians)    # Convert the angle to degrees\n    return angle_rads\n\ndef offset(pto, distance, angle_deg): # modified from ChatGPT 4.o generated\n    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians\n    x_new = pto[0] + distance * math.cos(angle_rads) # Calculate the new coordinates\n    y_new = pto[1] + distance * math.sin(angle_rads)\n    return np.array((x_new, y_new))\n\ndef offsetx(xo, distance, angle_deg): # modified from ChatGPT 4.o generated\n    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians\n    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates\n    return np.array((xo, x_new))\n\ndef offset_arrx(xo, distance, angle_deg,size): # modified from ChatGPT 4.o generated\n    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians\n    x_new = xo + distance * math.cos(angle_rads) # Calculate the new coordinates\n    x_arr = x_new + size * math.cos(angle_rads+2.48) # Calculate the new coordinates\n    return np.array((x_new, x_arr))\n\ndef offsety(yo, distance, angle_deg): # modified from ChatGPT 4.o generated\n    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians\n    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates\n    return np.array((yo, y_new))\n\ndef offset_arry(yo, distance, angle_deg,size): # modified from ChatGPT 4.o generated\n    angle_rads = math.radians(angle_deg) # Convert angle from degrees to radians\n    y_new = yo + distance * math.sin(angle_rads) # Calculate the new coordinates\n    y_arr = y_new + size * math.sin(angle_rads+2.48) # Calculate the new coordinates\n    return np.array((y_new, y_arr))\n\ndef lint(x1, y1, x2, y2, t):\n    # Calculate the interpolated coordinates\n    x = x1 + t * (x2 - x1)\n    y = y1 + t * (y2 - y1)\n    return np.array((x, y))\n\ndef lintx(x1, y1, x2, y2, t):\n    # Calculate the interpolated coordinates\n    x = x1 + t * (x2 - x1)\n    return x\n\ndef linty(x1, y1, x2, y2, t):\n    # Calculate the interpolated coordinates\n    y = y1 + t * (y2 - y1)\n    return y\n\ndef lint_intx(x1, y1, x2, y2, ts, te):\n    # Calculate the interpolated coordinates\n    xs = x1 + ts * (x2 - x1)\n    xe = x1 + te * (x2 - x1)\n    return np.array((xs,xe))\n\ndef lint_inty(x1, y1, x2, y2, ts, te):\n    # Calculate the interpolated coordinates\n    ys = y1 + ts * (y2 - y1)\n    ye = y1 + te * (y2 - y1)\n    return np.array((ys,ye))\n\ndef lint_int_arrx(x1, y1, x2, y2, ts, te, size):\n    # Calculate the interpolated coordinates\n    xe = x1 + te * (x2 - x1)\n    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)\n    x_arr = xe + size * math.cos(line_angle_rads+2.48) # Calculate the new coordinates\n    return np.array((xe,x_arr))\n\ndef lint_int_arry(x1, y1, x2, y2, ts, te, size):\n    # Calculate the interpolated coordinates\n    ye = y1 + te * (y2 - y1)\n    line_angle_rads = calculate_angle_rads(x1, y1, x2, y2)\n    y_arr = ye + size * math.sin(line_angle_rads+2.48) # Calculate the new coordinates\n    return np.array((ye,y_arr))\n\ndef as_si(x, ndp): # from xnx on StackOverflow https://stackoverflow.com/questions/31453422/displaying-numbers-with-x-instead-of-e-scientific-notation-in-matplotlib \n    s = '{x:0.{ndp:d}e}'.format(x=x, ndp=ndp)\n    m, e = s.split('e')\n    return r'{m:s}\\times 10^{{{e:d}}}'.format(m=m, e=int(e)) \n```", "```py\nx1 = 0.5; x2 = 0.2; x3 = 0.7; y = 0.3 # training data\nlr = 0.2 # learning rate\n\nnp.random.seed(seed=seed)\n\nnepoch = 1000\n\ny4 = np.zeros(nepoch); y5 = np.zeros(nepoch); y6 = np.zeros(nepoch)\n\nw14 = np.zeros(nepoch); w24 = np.zeros(nepoch); w34 = np.zeros(nepoch)\nw15 = np.zeros(nepoch); w25 = np.zeros(nepoch); w35 = np.zeros(nepoch)\nw46 = np.zeros(nepoch); w56 = np.zeros(nepoch)\n\ndw14 = np.zeros(nepoch); dw24 = np.zeros(nepoch); dw34 = np.zeros(nepoch)\ndw15 = np.zeros(nepoch); dw25 = np.zeros(nepoch); dw35 = np.zeros(nepoch)\ndw46 = np.zeros(nepoch); dw56 = np.zeros(nepoch)\n\ndb4 = np.zeros(nepoch); db5 = np.zeros(nepoch); db6 = np.zeros(nepoch)\n\nb4 = np.zeros(nepoch); b5 = np.zeros(nepoch); b6 = np.zeros(nepoch)\ny4 = np.zeros(nepoch); y5 = np.zeros(nepoch); y6 = np.zeros(nepoch)\nd4 = np.zeros(nepoch); d5 = np.zeros(nepoch); d6 = np.zeros(nepoch)\n\n# initialize the weights - Xavier Weight Initialization \nlower, upper = -(1.0 / np.sqrt(3.0)), (1.0 / np.sqrt(3.0)) # lower and upper bound for the weights, uses inputs to node\n#lower, upper = -(sqrt(6.0) / sqrt(3.0 + 2.0)), (sqrt(6.0) / sqrt(3.0 + 2.0)) # Normalized Xavier weights, integrates ouputs also\nw14[0] = lower + np.random.random() * (upper - lower); \nw24[0] = lower + np.random.random() * (upper - lower); \nw34[0] = lower + np.random.random() * (upper - lower);\nw15[0] = lower + np.random.random() * (upper - lower); \nw25[0] = lower + np.random.random() * (upper - lower); \nw35[0] = lower + np.random.random() * (upper - lower);\n\nlower, upper = -(1.0 / np.sqrt(2.0)), (1.0 / np.sqrt(2.0))\n#lower, upper = -(sqrt(6.0) / sqrt(2.0 + 1.0)), (sqrt(6.0) / sqrt(2.0 + 1.0)) # Normalized Xavier weights, integrates ouputs also\n\nw46[0] = lower + np.random.random() * (upper - lower); \nw56[0] = lower + np.random.random() * (upper - lower);     \n\n#b4[0] = np.random.random(); b5[0] = np.random.random(); b6[0] = np.random.random()\nb4[0] = (np.random.random()-0.5)*0.5; b5[0] = (np.random.random()-0.5)*0.5; b6[0] = (np.random.random()-0.5)*0.5; # small random value \n\nfor i in range(0,nepoch):\n\n# forward pass of model\n    y4[i] = w14[i]*x1 + w24[i]*x2 + w34[i]*x3 + b4[i]; \n    y4[i] = 1.0/(1 + math.exp(-1*y4[i]))\n\n    y5[i] = w15[i]*x1 + w25[i]*x2 + w35[i]*x3 + b5[i]\n    y5[i] = 1.0/(1 + math.exp(-1*y5[i]))\n\n    y6[i] = w46[i]*y4[i] + w56[i]*y5[i] + b6[i]\n#    y6[i] = 1.0/(1 + math.exp(-1*y6[i])) # sgimoid / logistic activation at o6 \n\n# back propagate the error through the nodes\n#    d6[i] = y6[i]*(1-y6[i])*(y-y6[i]) # sgimoid / logistic activation at o6 \n    d6[i] = (y-y6[i]) # identity activation o at o6\n    d5[i] = y5[i]*(1-y5[i])*w56[i]*d6[i]; d4[i] = y4[i]*(1-y4[i])*w46[i]*d6[i]\n\n# calculate the change in weights\n    if i < nepoch - 1:\n        dw14[i] = lr*d4[i]*x1; dw24[i] = lr*d4[i]*x2; dw34[i] = lr*d4[i]*x3\n        dw15[i] = lr*d5[i]*x1; dw25[i] = lr*d5[i]*x2; dw35[i] = lr*d5[i]*x3\n        dw46[i] = lr*d6[i]*y4[i]; dw56[i] = lr*d6[i]*y5[i] \n\n        db4[i] = lr*d4[i]; db5[i] = lr*d5[i]; db6[i] = lr*d6[i];\n\n        w14[i+1] = w14[i] + dw14[i]; w24[i+1] = w24[i] + dw24[i]; w34[i+1] = w34[i] + dw34[i] \n        w15[i+1] = w15[i] + dw15[i]; w25[i+1] = w25[i] + dw25[i]; w35[i+1] = w35[i] + dw35[i] \n        w46[i+1] = w46[i] + dw46[i]; w56[i+1] = w56[i] + dw56[i]\n\n        b4[i+1] = b4[i] + db4[i]; b5[i+1] = b5[i] + db5[i]; b6[i+1] = b6[i] + db6[i] \n```", "```py\niepoch = 1\n\ndx = -0.19; dy = -0.09; edge = 1.0\n\no6x = 17; o6y =5; h5x = 10; h5y = 3.5; h4x = 10; h4y = 6.5\ni1x = 3; i1y = 9.0; i2x = 3; i2y = 5; i3x = 3; i3y = 1.0; buffer = 0.5\n\nplt.subplot(111)\nplt.gca().set_axis_off()\n\ncircle_i1 = plt.Circle((i1x,i1y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_1$',(i1x+dx,i1y+dy),zorder=100); \ncircle_i1b = plt.Circle((i1x,i1y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_i1); plt.gca().add_patch(circle_i1b)\n\ncircle_i2 = plt.Circle((i2x,i2y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_2$',(i2x+dx,i2y+dy),zorder=100); \ncircle_i2b = plt.Circle((i2x,i2y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_i2); plt.gca().add_patch(circle_i2b)\n\ncircle_i3 = plt.Circle((i3x,i3y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r' $I_3$',(i3x+dx,i3y+dy),zorder=100); \ncircle_i3b = plt.Circle((i3x,i3y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_i3); plt.gca().add_patch(circle_i3b)\n\ncircle_h4 = plt.Circle((h4x,h4y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$H_4$',(h4x+dx,h4y+dy),zorder=100); \ncircle_h4b = plt.Circle((h4x,h4y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_h4); plt.gca().add_patch(circle_h4b)\n\ncircle_h5 = plt.Circle((h5x,h5y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$H_5$',(h5x+dx,h5y+dy),zorder=100); \ncircle_h5b = plt.Circle((h5x,h5y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_h5); plt.gca().add_patch(circle_h5b)\n\ncircle_o6 = plt.Circle((o6x,o6y), 0.25, fill=False, edgecolor = 'black',lw=2,zorder=100); plt.annotate(r'$O_6$',(o6x+dx,o6y+dy),zorder=100); \ncircle_o6b = plt.Circle((o6x,o6y), 0.40, fill=True, facecolor = 'white',edgecolor = None,lw=1,zorder=10);\nplt.gca().add_patch(circle_o6); plt.gca().add_patch(circle_o6b)\n\nplt.plot([i1x-edge,i1x],[i1y,i1y],color='grey',lw=1.0,zorder=1)\nplt.plot([i2x-edge,i2x],[i2y,i2y],color='grey',lw=1.0,zorder=1)\nplt.plot([i3x-edge,i3x],[i3y,i3y],color='grey',lw=1.0,zorder=1)\n\nplt.annotate(r'$x_1$ = ' + str(np.round(x1,2)),(i1x-buffer-1.6,i1y-0.05),size=8,zorder=200,color='grey',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) \nplt.annotate(r'$x_2$ = ' + str(np.round(x2,2)),(i2x-buffer-1.6,i2y-0.05),size=8,zorder=200,color='grey',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) \nplt.annotate(r'$x_3$ = ' + str(np.round(x3,2)),(i3x-buffer-1.6,i3y-0.05),size=8,zorder=200,color='grey',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) \n\nplt.plot([i1x,h4x],[i1y,h4y],color='lightcoral',lw=1.0,zorder=1)\nplt.plot([i2x,h4x],[i2y,h4y],color='red',lw=1.0,zorder=1)\nplt.plot([i3x,h4x],[i3y,h4y],color='darkred',lw=1.0,zorder=1)\n\nplt.plot([i1x,h5x],[i1y,h5y],color='dodgerblue',lw=1.0,zorder=1)\nplt.plot([i2x,h5x],[i2y,h5y],color='blue',lw=1.0,zorder=1)\nplt.plot([i3x,h5x],[i3y,h5y],color='darkblue',lw=1.0,zorder=1)\n\nplt.plot([h4x,o6x],[h4y,o6y],color='orange',lw=1.0,zorder=1)\nplt.plot([h5x,o6x],[h5y,o6y],color='darkorange',lw=1.0,zorder=1)\n\nplt.plot([o6x+edge,o6x],[o6y,o6y],color='grey',lw=1.0,zorder=1)\nplt.annotate(r'$\\hat{y}$ = ' + str(np.round(y6[iepoch],2)),(o6x+buffer+0.7,o6y-0.05),size=8,zorder=200,color='grey',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=0) \n\nplt.plot(offsetx(h4x,2,-12),offsety(h4y,2,-12)+0.1,color='orange',lw=1.0,zorder=1)\nplt.plot(offset_arrx(h4x,2,-12,0.2),offset_arry(h4y,2,-12,0.2)+0.1,color='orange',lw=1.0,zorder=1)\nplt.annotate(r'$H_{4}$ = ' + str(np.round(y4[iepoch],2)),(lintx(h4x,h4y,o6x,o6y,0.08),linty(h4x,h4y,o6x,o6y,0.08)-0.0),size=8,zorder=200,color='orange',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12)\n\nplt.plot(offsetx(h5x,2,12),offsety(h5y,2,12)+0.1,color='darkorange',lw=1.0,zorder=1)\nplt.plot(offset_arrx(h5x,2,12,0.2),offset_arry(h5y,2,12,0.2)+0.1,color='darkorange',lw=1.0,zorder=1)\nplt.annotate(r'$H_{5}$ = ' + str(np.round(y5[iepoch],2)),(lintx(h5x,h5y,o6x,o6y,0.07),linty(h5x,h5y,o6x,o6y,0.07)+0.25),size=8,zorder=200,color='darkorange',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)\n\nplt.annotate(r'$\\frac{\\partial P}{\\partial O_{6_{in}}}$ = ' + str(np.round(d6[iepoch],2)),(o6x-0.5,o6y-0.7),size=10)\nplt.annotate(r'$\\frac{\\partial P}{\\partial H_{4_{in}}}$ = ' + str(np.round(d4[iepoch],2)),(h4x-0.5,h4y-0.7),size=10)\nplt.annotate(r'$\\frac{\\partial P}{\\partial H_{5_{in}}}$ = ' + str(np.round(d5[iepoch],2)),(h5x-0.5,h5y-0.7),size=10)\n\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\hat{y}}$ = ' + str(np.round(d6[iepoch],2)),(o6x,o6y-1.2),size=10)\nplt.annotate(r'$\\frac{\\partial P}{\\partial H_{4_{out}}}$ = ' + str(np.round(w46[iepoch]*d6[iepoch],2)),(h4x,h4y-1.2),size=10)\nplt.annotate(r'$\\frac{\\partial P}{\\partial H_{5_{out}}}$ = ' + str(np.round(w56[iepoch]*d6[iepoch],2)),(h5x,h5y-1.2),size=10)\n\nplt.plot(lint_intx(h4x, h4y, o6x, o6y,0.4,0.6),lint_inty(h4x,h4y,o6x,o6y,0.4,0.6)-0.1,color='orange',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(o6x,o6y,h4x,h4y,0.4,0.6,0.2),lint_int_arry(o6x,o6y,h4x,h4y,0.4,0.6,0.2)-0.1,color='orange',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{4,6}}$ = ' + str(np.round(dw46[iepoch]/lr,4)),(lintx(h4x,h4y,o6x,o6y,0.5)-0.6,linty(h4x,h4y,o6x,o6y,0.5)-0.72),size=10,zorder=200,color='orange',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-11)\n\nplt.plot(lint_intx(h5x, h5y, o6x, o6y,0.4,0.6),lint_inty(h5x,h5y,o6x,o6y,0.4,0.6)-0.1,color='darkorange',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(o6x,o6y,h5x,h5y,0.4,0.6,0.2),lint_int_arry(o6x,o6y,h5x,h5y,0.4,0.6,0.2)-0.1,color='darkorange',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{5,6}}$ = ' + str(np.round(dw56[iepoch]/lr,4)),(lintx(h5x,h5y,o6x,o6y,0.5)-0.4,linty(h5x,h5y,o6x,o6y,0.5)-0.6),size=10,zorder=200,color='darkorange',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)\n\nplt.plot(offsetx(i1x,2,-20),offsety(i1y,2,-20)+0.1,color='lightcoral',lw=1.0,zorder=1)\nplt.plot(offset_arrx(i1x,2,-20,0.2),offset_arry(i1y,2,-20,0.2)+0.1,color='lightcoral',lw=1.0,zorder=1)\nplt.annotate(r'$I_{1}$ = ' + str(np.round(x1,2)),(lintx(i1x,i1y,h4x,h4y,0.1),linty(i1x,i1y,h4x,h4y,0.1)),size=8,zorder=200,color='lightcoral',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-20)\n\nplt.plot(offsetx(i2x,2,12),offsety(i2y,2,12)+0.1,color='red',lw=1.0,zorder=1)\nplt.plot(offset_arrx(i2x,2,12,0.2),offset_arry(i2y,2,12,0.2)+0.1,color='red',lw=1.0,zorder=1)\nplt.annotate(r'$I_{2}$ = ' + str(np.round(x2,2)),(lintx(i2x,i2y,h4x,h4y,0.1),linty(i2x,i2y,h4x,h4y,0.1)+0.22),size=8,zorder=200,color='red',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)\n\nplt.plot(offsetx(i3x,2,38),offsety(i3y,2,38)+0.1,color='darkred',lw=1.0,zorder=1)\nplt.plot(offset_arrx(i3x,2,38,0.2),offset_arry(i3y,2,38,0.2)+0.1,color='darkred',lw=1.0,zorder=1)\nplt.annotate(r'$I_{3}$ = ' + str(np.round(x3,2)),(lintx(i3x,i3y,h4x,h4y,0.08)-0.2,linty(i3x,i3y,h4x,h4y,0.08)+0.2),size=8,zorder=200,color='darkred',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=38)\n\nplt.annotate(r'$\\lambda_{1,4}$ = ' + str(np.round(w14[iepoch],2)),((i1x+h4x)*0.45,(i1y+h4y)*0.5-0.05),size=8,zorder=200,color='lightcoral',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-18) \nplt.annotate(r'$\\lambda_{2,4}$ = ' + str(np.round(w24[iepoch],2)),((i2x+h4x)*0.45-0.3,(i2y+h4y)*0.5-0.03),size=8,zorder=200,color='red',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=10) \nplt.annotate(r'$\\lambda_{3,4}$ = ' + str(np.round(w34[iepoch],2)),((i3x+h4x)*0.45-1.2,(i3y+h4y)*0.5-1.1),size=8,zorder=200,color='darkred',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=38) \n\nplt.annotate(r'$\\lambda_{1,5}$ = ' + str(np.round(w15[iepoch],2)),((i1x+h5x)*0.55-2.5,(i1y+h5y)*0.5+0.9),size=8,zorder=200,color='dodgerblue',\n    bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-36) \nplt.annotate(r'$\\lambda_{2,5}$ = ' + str(np.round(w25[iepoch],2)),((i2x+h5x)*0.55-1.5,(i2y+h5y)*0.5+0.05),size=8,zorder=200,color='blue',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12) \nplt.annotate(r'$\\lambda_{3,5}$ = ' + str(np.round(w35[iepoch],2)),((i3x+h5x)*0.55-1.0,(i3y+h5y)*0.5+0.1),size=8,zorder=200,color='darkblue',\n             bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=20) \n\nplt.annotate(r'$\\lambda_{4,6}$ = ' + str(np.round(w46[iepoch],2)),((h4x+o6x)*0.47,(h4y+o6y)*0.47+0.39),size=8,zorder=200,color='orange',\n    bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12) \nplt.annotate(r'$\\lambda_{5,6}$ = ' + str(np.round(w56[iepoch],2)),((h5x+o6x)*0.47,(h5y+o6y)*0.47+0.26),size=8,zorder=200,color='darkorange',\n    bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=12) \n\nplt.plot(lint_intx(i1x, i1y, h4x, h4y,0.4,0.6),lint_inty(i1x,i1y,h4x,h4y,0.4,0.6)-0.1,color='lightcoral',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h4x,h4y,i1x,i1y,0.4,0.6,0.2),lint_int_arry(h4x,h4y,i1x,i1y,0.4,0.6,0.2)-0.1,color='lightcoral',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{1,4}} =$' + r'${0:s}$'.format(as_si(dw14[iepoch]/lr,2)),(lintx(i1x,i1y,h4x,h4y,0.5)-0.6,linty(i1x,i1y,h4x,h4y,0.5)-1.0),size=8,zorder=200,color='lightcoral',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-20)\n\nplt.plot(lint_intx(i2x, i2y, h4x, h4y,0.3,0.5),lint_inty(i2x,i2y,h4x,h4y,0.3,0.5)-0.1,color='red',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h4x,h4y,i2x,i2y,0.5,0.7,0.2),lint_int_arry(h4x,h4y,i2x,i2y,0.5,0.7,0.2)-0.12,color='red',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{2,4}} =$' + r'${0:s}$'.format(as_si(dw24[iepoch]/lr,2)),(lintx(i2x,i2y,h4x,h4y,0.5)-1.05,linty(i2x,i2y,h4x,h4y,0.5)-0.7),size=8,zorder=200,color='red',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=12)\n\nplt.plot(lint_intx(i3x, i3y, h4x, h4y,0.2,0.4),lint_inty(i3x,i3y,h4x,h4y,0.2,0.4)-0.1,color='darkred',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h4x,h4y,i3x,i3y,0.5,0.8,0.2),lint_int_arry(h4x,h4y,i3x,i3y,0.5,0.8,0.2)-0.12,color='darkred',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{3,4}} =$' + r'${0:s}$'.format(as_si(dw34[iepoch]/lr,2)),(lintx(i3x,i3y,h4x,h4y,0.5)-1.7,linty(i3x,i3y,h4x,h4y,0.5)-1.7),size=8,zorder=200,color='darkred',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=38)\n\nplt.plot(lint_intx(i3x, i3y, h5x, h5y,0.4,0.6),lint_inty(i3x,i3y,h5x,h5y,0.4,0.6)-0.1,color='darkblue',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h5x,h5y,i3x,i3y,0.4,0.6,0.2),lint_int_arry(h5x,h5y,i3x,i3y,0.4,0.6,0.2)-0.12,color='darkblue',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{3,5}} =$' + r'${0:s}$'.format(as_si(dw35[iepoch]/lr,2)),(lintx(i3x,i3y,h5x,h5y,0.5)-0.4,linty(i3x,i3y,h5x,h5y,0.5)-0.6),size=8,zorder=200,color='darkblue',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=20)\n\nplt.plot(lint_intx(i2x, i2y, h5x, h5y,0.3,0.5),lint_inty(i2x,i2y,h5x,h5y,0.3,0.5)-0.1,color='blue',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h5x,h5y,i2x,i2y,0.3,0.7,0.2),lint_int_arry(h5x,h5y,i2x,i2y,0.3,0.7,0.2)-0.12,color='blue',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{2,5}} =$' + r'${0:s}$'.format(as_si(dw25[iepoch]/lr,2)),(lintx(i2x,i2y,h5x,h5y,0.5)-1.2,linty(i2x,i2y,h5x,h5y,0.5)-0.65),size=8,zorder=200,color='blue',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-12)\n\nplt.plot(lint_intx(i1x, i1y, h5x, h5y,0.2,0.4),lint_inty(i1x,i1y,h5x,h5y,0.2,0.4)-0.1,color='dodgerblue',lw=1.0,zorder=1)\nplt.plot(lint_int_arrx(h5x,h5y,i1x,i1y,0.2,0.8,0.2),lint_int_arry(h5x,h5y,i1x,i1y,0.2,0.8,0.2)-0.12,color='dodgerblue',lw=1.0,zorder=1)\nplt.annotate(r'$\\frac{\\partial P}{\\partial \\lambda_{1,5}} =$' + r'${0:s}$'.format(as_si(dw15[iepoch]/lr,2)),(lintx(i1x,i1y,h5x,h5y,0.5)-2.2,linty(i1x,i1y,h4x,h4y,0.5)-1.5),size=8,zorder=200,color='dodgerblue',\n              bbox=dict(boxstyle=\"round,pad=0.0\", edgecolor='white', facecolor='white', alpha=1.0),rotation=-36,xycoords = 'data')\n\nplt.subplots_adjust(left=0.0, bottom=0.0, right=1.5, top=1.0, wspace=0.2, hspace=0.2); plt.show() \n```", "```py\nplt.subplot(131)\nplt.plot(np.arange(1,nepoch+1,1),y6,color='red',label=r'$\\hat{y}$'); plt.xlim([1,nepoch]); plt.ylim([0,1])\nplt.xlabel('Epochs'); plt.ylabel(r'$\\hat{y}$'); plt.title('Simple Artificial Neural Network Prediction')\nplt.plot([1,nepoch],[y,y],color='black',ls='--'); plt.vlines(400,-1.5,1.5,color='black')\nadd_grid(); plt.legend(loc='upper right'); plt.xscale('log')\n\nplt.subplot(132)\nplt.plot(np.arange(1,nepoch+1,1),w14,color='lightcoral',label = r'$\\lambda_{1,4}$') \nplt.plot(np.arange(1,nepoch+1,1),w24,color='red',label = r'$\\lambda_{2,4}$') \nplt.plot(np.arange(1,nepoch+1,1),w34,color='darkred',label = r'$\\lambda_{3,4}$') \nplt.plot(np.arange(1,nepoch+1,1),w15,color='dodgerblue',label = r'$\\lambda_{1,5}$') \nplt.plot(np.arange(1,nepoch+1,1),w25,color='blue',label = r'$\\lambda_{2,5}$') \nplt.plot(np.arange(1,nepoch+1,1),w35,color='darkblue',label = r'$\\lambda_{3,5}$')\nplt.plot(np.arange(1,nepoch+1,1),w46,color='orange',label = r'$\\lambda_{4,6}$')\nplt.plot(np.arange(1,nepoch+1,1),w56,color='darkorange',label = r'$\\lambda_{5,6}$')\nplt.plot([1,nepoch],[0,0],color='black',ls='--')\nplt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')\nplt.xlabel('Epochs'); plt.ylabel(r'$\\hat{y}$'); plt.title('Simple Artificial Neural Network Weights')\nadd_grid(); plt.legend(loc='upper right'); plt.xscale('log')\n\nplt.subplot(133)\nplt.plot(np.arange(1,nepoch+1,1),w14,color='lightgreen',label = r'$\\phi_{4}$') \nplt.plot(np.arange(1,nepoch+1,1),w24,color='green',label = r'$\\phi_{5}$') \nplt.plot(np.arange(1,nepoch+1,1),w34,color='darkgreen',label = r'$\\phi_{6}$') \nplt.plot([1,nepoch],[0,0],color='black',ls='--')\nplt.xlim([1,nepoch]); plt.ylim([-1.5,1.5]); plt.vlines(400,-1.5,1.5,color='black')\nplt.xlabel('Epochs'); plt.ylabel(r'$\\hat{y}$'); plt.title('Simple Artificial Neural Network Biases')\nadd_grid(); plt.legend(loc='upper right'); plt.xscale('log')\n\nplt.subplots_adjust(left=0.0, bottom=0.0, right=3.0, top=1.0, wspace=0.2, hspace=0.2); plt.show() \n```"]