- en: thiserror
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://rust-exercises.com/100-exercises/05_ticket_v2/12_thiserror.html](https://rust-exercises.com/100-exercises/05_ticket_v2/12_thiserror.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: That was a bit of detour, wasn't it? But a necessary one!
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s get back on track now: custom error types and `thiserror`.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Custom error types](#custom-error-types)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We've seen how to implement the `Error` trait "manually" for a custom error
    type.
  prefs: []
  type: TYPE_NORMAL
- en: Imagine that you have to do this for most error types in your codebase. That's
    a lot of boilerplate, isn't it?
  prefs: []
  type: TYPE_NORMAL
- en: We can remove some of the boilerplate by using [`thiserror`](https://docs.rs/thiserror/latest/thiserror/),
    a Rust crate that provides a **procedural macro** to simplify the creation of
    custom error types.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '[You can write your own macros](#you-can-write-your-own-macros)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: All the `derive` macros we've seen so far were provided by the Rust standard
    library.
  prefs: []
  type: TYPE_NORMAL
- en: '`thiserror::Error` is the first example of a **third-party** `derive` macro.'
  prefs: []
  type: TYPE_NORMAL
- en: '`derive` macros are a subset of **procedural macros**, a way to generate Rust
    code at compile time. We won''t get into the details of how to write a procedural
    macro in this course, but it''s important to know that you can write your own!'
  prefs: []
  type: TYPE_NORMAL
- en: A topic to approach in a more advanced Rust course.
  prefs: []
  type: TYPE_NORMAL
- en: '[Custom syntax](#custom-syntax)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Each procedural macro can define its own syntax, which is usually explained
    in the crate''s documentation. In the case of `thiserror`, we have:'
  prefs: []
  type: TYPE_NORMAL
- en: '`#[derive(thiserror::Error)]`: this is the syntax to derive the `Error` trait
    for a custom error type, helped by `thiserror`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`#[error("{0}")]`: this is the syntax to define a `Display` implementation
    for each variant of the custom error type. `{0}` is replaced by the zero-th field
    of the variant (`String`, in this case) when the error is displayed.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Exercise](#exercise)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The exercise for this section is located in [`05_ticket_v2/12_thiserror`](https://github.com/mainmatter/100-exercises-to-learn-rust/tree/main/exercises/05_ticket_v2/12_thiserror)
  prefs: []
  type: TYPE_NORMAL
