- en: Machine Learning Python Code Snippets
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_python.html](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_python.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Michael J. Pyrcz, Professor, The University of Texas at Austin
  prefs: []
  type: TYPE_NORMAL
- en: '[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Geostatistics Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [Applied Machine Learning in Python e-book](https://geostatsguy.github.io/MachineLearningDemos_Book/)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Chapter of e-book “Applied Machine Learning in Python: a Hands-on Guide with
    Code”.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Cite this e-Book as:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Pyrcz, M.J., 2024, *Applied Machine Learning in Python: A Hands-on Guide with
    Code* [e-book]. Zenodo. doi:10.5281/zenodo.15169138 [![DOI](../Images/7e4ea662f44af1eae87e87ecbb962ff4.png)](https://doi.org/10.5281/zenodo.15169138)'
  prefs: []
  type: TYPE_NORMAL
- en: 'The workflows in this book and more are available here:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Cite the MachineLearningDemos GitHub Repository as:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Pyrcz, M.J., 2024, *MachineLearningDemos: Python Machine Learning Demonstration
    Workflows Repository* (0.0.3) [Software]. Zenodo. DOI: 10.5281/zenodo.13835312\.
    GitHub repository: [GeostatsGuy/MachineLearningDemos](https://github.com/GeostatsGuy/MachineLearningDemos)
    [![DOI](../Images/4e3a59c17d684b06a170c4af84e0f631.png)](https://zenodo.org/doi/10.5281/zenodo.13835312)'
  prefs: []
  type: TYPE_NORMAL
- en: By Michael J. Pyrcz
  prefs: []
  type: TYPE_NORMAL
- en: © Copyright 2024.
  prefs: []
  type: TYPE_NORMAL
- en: This chapter is a set of **Machine Learning Python Code Snippets** to help folks
    build machine learning workflows in Python.
  prefs: []
  type: TYPE_NORMAL
- en: '**YouTube Lecture**: check out my live code walk-throughs in my data science
    basics in Python playlist:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Data Science Basics in Python Playlist](https://youtube.com/playlist?list=PLG19vXLQHvSAufDFgZEFAYQEwMJXklnQV&si=z9BF45XAod6brI8Z)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These walkthrough support of my courses,
  prefs: []
  type: TYPE_NORMAL
- en: '[Machine Learning Course](https://youtube.com/playlist?list=PLG19vXLQHvSC2ZKFIkgVpI9fCjkN38kwf&si=XonjO2wHdXffMpeI)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Data Analytics and Geostatistics Course](https://youtube.com/playlist?list=PLG19vXLQHvSB-D4XKYieEku9GQMQyAzjJ&si=XobEAdz3ntDdp870)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: on YouTube with linked well-documented Python workflows and interactive dashboards.
    My goal is to share accessible, actionable, and repeatable educational content.
    If you want to know about my motivation, check out [Michael’s Story](https://michaelpyrcz.com/my-story).
  prefs: []
  type: TYPE_NORMAL
- en: Motivation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I taught a high school hackathon with great students from all over Texas and
    beyond and I felt that they could use some additional resources in the form of
    a **code snippets** to help them over the hurdles of completing their first data
    science workflow in Python.
  prefs: []
  type: TYPE_NORMAL
- en: Remember the definition of a code snippet is,
  prefs: []
  type: TYPE_NORMAL
- en: a small, reusable section of code that programmers can quickly insert into a
    larger codebase
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: My goal is to,
  prefs: []
  type: TYPE_NORMAL
- en: '**provide a set of minimum, simple code snippets** to accomplish basic data
    science modeling build steps'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**avoid fancy additions**, like automatic diagnostics and plotting that are
    specific to the problem setting that will break with new data'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Therefore, improvements and additions to provide diagnostic outputs and plots
    are highly recommended.
  prefs: []
  type: TYPE_NORMAL
- en: Structure
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This is not a workflow!
  prefs: []
  type: TYPE_NORMAL
- en: These are alphabetically ordered code snippets and not a complete workflow.
    Please do not attempt to run this chapter in sequence.
  prefs: []
  type: TYPE_NORMAL
- en: In order to run the snippets we need to first,
  prefs: []
  type: TYPE_NORMAL
- en: Import some python packages
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Declare a couple of convenience functions
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Load some data to demonstrate the code snippets
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: After we load the data the remaining codes with be in alphabetical and not any
    logical workflow order for ease of search and retrieval.
  prefs: []
  type: TYPE_NORMAL
- en: Import Required Packages
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We need some standard packages. These should have been installed with Anaconda
    3.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: If you get a package import error, you may have to first install some of these
    packages. This can usually be accomplished by opening up a command window on Windows
    and then typing ‘python -m pip install [package-name]’. More assistance is available
    with the respective package docs.
  prefs: []
  type: TYPE_NORMAL
- en: Declare Functions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Here’s the functions to improve code readability.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Load a Couple Datasets
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We load a couple of datasets,
  prefs: []
  type: TYPE_NORMAL
- en: df - an exhaustive data table as a pandas DataFrame
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: df_missing an data table with some missing data as a pandas DataFrame
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: ndarray_2D - a 2D array map as a NumPy ndarray
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To demonstrat the methods below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Complete Some Basic Operations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Here I complete some basic operations to ensure that the alphabetically sorted
    code snippets below have the inputs to avoid errors.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: OK, now we are ready to walk thorugh our alphabetically ordered code snippets.
  prefs: []
  type: TYPE_NORMAL
- en: Beta, \(\beta\), Coefficients
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Feature importance based on the multilinear regression coefficients of the normalized
    features.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/0242c4c943789f3508ddcdf0f54466db0571605cbffc4694f303c5b6f867cfec.png](../Images/9f28a7f6ef95f0886ba1d37234411ead.png)'
  prefs: []
  type: TYPE_IMG
- en: Correlation (Pearson product momment)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/01b6c1f90ba99386369f74ed5c07b22976da6c3ab67393586c8e9287e428c995.png](../Images/055588d911cad1aa273eccf46788a793.png)'
  prefs: []
  type: TYPE_IMG
- en: Correlation (Spearman rank)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/793c62c2e433f3d5824617e6404b5a63fc9fa91f3ffb1a23e5f11b6aef582fd6.png](../Images/5a27c57a196ffce0c3c085265c5bc0e9.png)'
  prefs: []
  type: TYPE_IMG
- en: Cross Validation Plot (training and testing)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/9dd5b2ef7db8189250200c8fda4684707fd265c686f3d344fd988859b056f10c.png](../Images/751a56b5a9a1b3b432d910a4efc96752.png)'
  prefs: []
  type: TYPE_IMG
- en: Cross Validation Plot (testing)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/46b7748af289cbd304af34994fe959c5a2f18d75bc1f14f21555bf54972513bf.png](../Images/3eeeb0c09c9483eeaa7356c233fe26bf.png)'
  prefs: []
  type: TYPE_IMG
- en: Cross Validation Plot (training)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/e9004125ee8191a22a71ca31d0c303276bc944bdac42e6a5baa00e5f1de1320d.png](../Images/4b42cb5667d6c4b3852871763244ac85.png)'
  prefs: []
  type: TYPE_IMG
- en: DataFrame (add noise to a feature)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I do this to experiment and make educational content, e.g., add noise to the
    response feature to demonstrate overfit.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 1 | 12.08 | 2.92 | 2.80 | 81.40 | 1.16 | 2.31 | 2154.457620 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 2 | 12.38 | 3.53 | 3.22 | 46.17 | 0.89 | 1.88 | 3199.991714 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 3 | 14.02 | 2.59 | 4.01 | 72.80 | 0.89 | 2.72 | 2742.009861 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3927.738944 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 5 | 17.52 | 4.57 | 3.18 | 10.94 | 1.51 | 1.90 | 2343.080242 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (add a new feature/column)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod | Ones |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 1 | 12.08 | 2.92 | 2.80 | 81.40 | 1.16 | 2.31 | 2225.696687 | 1.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 2 | 12.38 | 3.53 | 3.22 | 46.17 | 0.89 | 1.88 | 3124.615076 | 1.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 3 | 14.02 | 2.59 | 4.01 | 72.80 | 0.89 | 2.72 | 2746.460169 | 1.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3882.557711 | 1.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 5 | 17.52 | 4.57 | 3.18 | 10.94 | 1.51 | 1.90 | 2208.570072 | 1.0 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (make new)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Ones | Zeros |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 1.0 | 0.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 1.0 | 0.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 1.0 | 0.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 1.0 | 0.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 1.0 | 0.0 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (preview)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Display the first ‘n’ rows of the DataFrame
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 1 | 12.08 | 2.92 | 2.80 | 81.40 | 1.16 | 2.31 | 2225.696687 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 2 | 12.38 | 3.53 | 3.22 | 46.17 | 0.89 | 1.88 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 3 | 14.02 | 2.59 | 4.01 | 72.80 | 0.89 | 2.72 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 5 | 17.52 | 4.57 | 3.18 | 10.94 | 1.51 | 1.90 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | 6 | 14.53 | 4.81 | 2.69 | 53.60 | 0.94 | 1.67 | 4353.192212 |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | 7 | 13.49 | 3.60 | 2.93 | 63.71 | 0.80 | 1.85 | 3516.494383 |'
  prefs: []
  type: TYPE_TB
- en: '| 7 | 8 | 11.58 | 3.03 | 3.25 | 53.00 | 0.69 | 1.93 | 2083.845221 |'
  prefs: []
  type: TYPE_TB
- en: '| 8 | 9 | 12.52 | 2.72 | 2.43 | 65.77 | 0.95 | 1.98 | 2775.906282 |'
  prefs: []
  type: TYPE_TB
- en: '| 9 | 10 | 13.25 | 3.94 | 3.71 | 66.20 | 1.14 | 2.65 | 2966.741947 |'
  prefs: []
  type: TYPE_TB
- en: '| 10 | 11 | 15.04 | 4.39 | 2.22 | 61.11 | 1.08 | 1.77 | 4022.323780 |'
  prefs: []
  type: TYPE_TB
- en: '| 11 | 12 | 16.19 | 6.30 | 2.29 | 49.10 | 1.53 | 1.86 | 4799.763575 |'
  prefs: []
  type: TYPE_TB
- en: '| 12 | 13 | 16.82 | 5.42 | 2.80 | 66.65 | 1.17 | 1.98 | 3616.427242 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (rename a feature/column)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Porosity (%) | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 1 | 12.08 | 2.92 | 2.80 | 81.40 | 1.16 | 2.31 | 2225.696687 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 2 | 12.38 | 3.53 | 3.22 | 46.17 | 0.89 | 1.88 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 3 | 14.02 | 2.59 | 4.01 | 72.80 | 0.89 | 2.72 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 5 | 17.52 | 4.57 | 3.18 | 10.94 | 1.51 | 1.90 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (remove features/columns)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Perm | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 2.92 | 81.40 | 1.16 | 2.31 | 2225.696687 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 3.53 | 46.17 | 0.89 | 1.88 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 2.59 | 72.80 | 0.89 | 2.72 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 6.75 | 39.81 | 1.08 | 1.88 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 4.57 | 10.94 | 1.51 | 1.90 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (remove samples/rows)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 2 | 12.38 | 3.53 | 3.22 | 46.17 | 0.89 | 1.88 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | 6 | 14.53 | 4.81 | 2.69 | 53.60 | 0.94 | 1.67 | 4353.192212 |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | 7 | 13.49 | 3.60 | 2.93 | 63.71 | 0.80 | 1.85 | 3516.494383 |'
  prefs: []
  type: TYPE_TB
- en: '| 7 | 8 | 11.58 | 3.03 | 3.25 | 53.00 | 0.69 | 1.93 | 2083.845221 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (remove samples/rows by condition)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 3 | 14.02 | 2.59 | 4.01 | 72.80 | 0.89 | 2.72 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 5 | 17.52 | 4.57 | 3.18 | 10.94 | 1.51 | 1.90 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | 6 | 14.53 | 4.81 | 2.69 | 53.60 | 0.94 | 1.67 | 4353.192212 |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | 7 | 13.49 | 3.60 | 2.93 | 63.71 | 0.80 | 1.85 | 3516.494383 |'
  prefs: []
  type: TYPE_TB
- en: Decision Tree (feature importance)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/498e717d8cd4f6a6f673071a88cbd7a4b3370249d7bdd3b4c0506fede88353ca.png](../Images/bcee90b2c8924008ccfa87e26612ee2c.png)'
  prefs: []
  type: TYPE_IMG
- en: Decision Tree (prediction at testing data)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply our model to predict at withheld testing data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 179 | 656.507448 | 2218.196237 |'
  prefs: []
  type: TYPE_TB
- en: '| 155 | 3110.245382 | 2218.196237 |'
  prefs: []
  type: TYPE_TB
- en: '| 23 | 2581.359826 | 2218.196237 |'
  prefs: []
  type: TYPE_TB
- en: '| 159 | 6498.151446 | 6482.917835 |'
  prefs: []
  type: TYPE_TB
- en: '| 96 | 4148.822923 | 4297.451039 |'
  prefs: []
  type: TYPE_TB
- en: Decision Tree (prediction at training data)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply our model to predict at the retained training data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 125 | 3750.106623 | 4297.451039 |'
  prefs: []
  type: TYPE_TB
- en: '| 68 | 4644.717576 | 4297.451039 |'
  prefs: []
  type: TYPE_TB
- en: '| 69 | 1991.991593 | 2218.196237 |'
  prefs: []
  type: TYPE_TB
- en: '| 108 | 6688.360827 | 6482.917835 |'
  prefs: []
  type: TYPE_TB
- en: '| 131 | 5076.638358 | 4297.451039 |'
  prefs: []
  type: TYPE_TB
- en: Decision Tree (train)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Train model parameters on training data with specified model hyperparameters
  prefs: []
  type: TYPE_NORMAL
- en: let’s look at the trained model parameters, by visualizing the trained decision
    tree.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/d6589d670e2e9b593d1e13e44cfe8c153b4c836395654656835da04c747d5194.png](../Images/17779d19ebdf48d8cb9ff106de64bb16.png)'
  prefs: []
  type: TYPE_IMG
- en: Decision Tree (retrain tuned model)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply tuned hyperparameters and retrain the model with all the data.
  prefs: []
  type: TYPE_NORMAL
- en: this is the model that we will use for future predictions, real-world use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/bed759efe8f74ab399429a00ba5e1a7deb2f0564e294d93190f0787e1b1df966.png](../Images/b9f7acf97318db4212998bf321561437.png)'
  prefs: []
  type: TYPE_IMG
- en: Decision Tree (tune/prune)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Train model parameters on training data with a range of model hyperparameters,
    select the model hyperparameters with minimum error over the withheld testing
    data
  prefs: []
  type: TYPE_NORMAL
- en: This requires the following steps,
  prefs: []
  type: TYPE_NORMAL
- en: Loop over the hyperparameter(s) values,
  prefs: []
  type: TYPE_NORMAL
- en: train the model with the retained training data
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: predict at the withheld testing data
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: calculate the testing error
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the hyperparameter that minimized the testing error
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/b60aa2eac0a1291d28f8028ee5949559b2cb770db7315a469587f57d0769aaa3.png](../Images/820a0d93ba1a606ae2d0b29b1b972028.png)'
  prefs: []
  type: TYPE_IMG
- en: Features Extraction (by name)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Build a new DataFrame with only the selected predictor feature and the response
    feature
  prefs: []
  type: TYPE_NORMAL
- en: specify the selected predictor features
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: specify the response feature
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: build a list with both
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: make a new DataFrame with first the predictor features and then the response
    feature as the last column
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | Perm | AI | Brittle | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 12.08 | 2.92 | 2.80 | 81.40 | 2225.696687 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 12.38 | 3.53 | 3.22 | 46.17 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 14.02 | 2.59 | 4.01 | 72.80 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 17.67 | 6.75 | 2.63 | 39.81 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 17.52 | 4.57 | 3.18 | 10.94 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: Features Extraction (by number)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Build a new DataFrame with only the selected predictor feature.
  prefs: []
  type: TYPE_NORMAL
- en: specify the selected predictor features
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: specify the response feature
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: build a list with both
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: make a new DataFrame with first the predictor features and then the response
    feature as the last column
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | Perm | AI | Brittle | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 12.08 | 2.92 | 2.80 | 81.40 | 2225.696687 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 12.38 | 3.53 | 3.22 | 46.17 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 14.02 | 2.59 | 4.01 | 72.80 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 17.67 | 6.75 | 2.63 | 39.81 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 17.52 | 4.57 | 3.18 | 10.94 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: Features Extraction (make X and y DataFrames)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Build a two new DataFrames, one with only the selected predictor feature and
    the other with the response feature,
  prefs: []
  type: TYPE_NORMAL
- en: assuming that the last feature is the response feature
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: Features Extraction (make X and y DataFrames assumed feature order)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Build a two new DataFrames, one with only the selected predictor feature and
    the other with the response feature,
  prefs: []
  type: TYPE_NORMAL
- en: assuming that the last feature is the response feature
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: Histogram
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Simple histogram,
  prefs: []
  type: TYPE_NORMAL
- en: you can set the histogram limits by specifying the exact bins with a method
    like, np.linspace(min,max,n)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/0ff41b2a04299239a5787ea06ee741abd39a85b84705e042e481757fa761783f.png](../Images/479b7b449b4f65cbff1f33f5912dd525.png)'
  prefs: []
  type: TYPE_IMG
- en: Histogram (normalized)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A histogram with probability on the y axis and the sum of all bars is one, i.e.,
    probability closure.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/418e0e90a2846168a380bc4e0ecbfdc630e06e4d53b06e01a518f9cf2dbe00a1.png](../Images/1f995c05278fd97a4977e9ffb72e72ca.png)'
  prefs: []
  type: TYPE_IMG
- en: Image Plot
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/c86ec564386d943eec0c63d05909805d2ef77161ec97f54666f8f4014aa78cd5.png](../Images/81941c32cdbce6c5d5afa4c43c371885.png)'
  prefs: []
  type: TYPE_IMG
- en: Image Plot (combined with location map)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Superimpose multiple plots on top of each other,
  prefs: []
  type: TYPE_NORMAL
- en: use ‘zorder’ to place object in front of other objects, higher number is in
    front
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: make sure all objects are in the same plot space
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE34]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/e209044ada9e1ec85d74ec9b44724049f126863a34e47f23e678d71f469c2e3d.png](../Images/a3b326fefec63f72f7e2b67536a2e4a6.png)'
  prefs: []
  type: TYPE_IMG
- en: K-Nearest Neighbours (feature imputation)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Feature imputation by estimating missing features with the nearest neighbours,
  prefs: []
  type: TYPE_NORMAL
- en: distance is accessed with all samples that have all features present in the
    sample with a missing feature
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: only one pass is applied, there is no iteration
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: not as robust as MICE is there is a lot of missing data, it does not learn the
    structure between the features to fill in missing data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE35]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | LogPerm | AI | Brittle | TOC | VR |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000
    | 1000.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 14.924820 | 1.375450 | 2.982915 | 49.227565 | 1.014950 | 1.997420
    |'
  prefs: []
  type: TYPE_TB
- en: '| std | 2.999168 | 0.367557 | 0.557240 | 13.755077 | 0.480852 | 0.284183 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 5.400000 | 0.120000 | 0.960000 | -1.500000 | -0.250000 | 0.900000 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 12.846250 | 1.145000 | 2.590000 | 40.640000 | 0.700000 | 1.830000 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 15.035000 | 1.360000 | 3.010000 | 49.477500 | 1.007500 | 2.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 17.012500 | 1.610000 | 3.330000 | 58.055000 | 1.370000 | 2.165000 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 24.650000 | 2.580000 | 4.700000 | 93.470000 | 2.710000 | 2.900000 |'
  prefs: []
  type: TYPE_TB
- en: K-Nearest Neighbours (prediction at testing data)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply our model to predict at withheld testing data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE36]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 179 | 656.507448 | 2303.626455 |'
  prefs: []
  type: TYPE_TB
- en: '| 155 | 3110.245382 | 3774.108284 |'
  prefs: []
  type: TYPE_TB
- en: '| 23 | 2581.359826 | 2321.644376 |'
  prefs: []
  type: TYPE_TB
- en: '| 159 | 6498.151446 | 5713.166746 |'
  prefs: []
  type: TYPE_TB
- en: '| 96 | 4148.822923 | 4108.942362 |'
  prefs: []
  type: TYPE_TB
- en: K-Nearest Neighbours (prediction at training data)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply our model to predict at the retained training data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE37]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 125 | 3750.106623 | 3974.087763 |'
  prefs: []
  type: TYPE_TB
- en: '| 68 | 4644.717576 | 4226.039680 |'
  prefs: []
  type: TYPE_TB
- en: '| 69 | 1991.991593 | 3165.041802 |'
  prefs: []
  type: TYPE_TB
- en: '| 108 | 6688.360827 | 6336.236197 |'
  prefs: []
  type: TYPE_TB
- en: '| 131 | 5076.638358 | 5332.676914 |'
  prefs: []
  type: TYPE_TB
- en: K-Nearest Neighbours (train)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Train model parameters on training data with specified model hyperparameters
  prefs: []
  type: TYPE_NORMAL
- en: since K-nearest neighbours is a lazy learning model, there are no trained model
    parameters to display
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: instead we look at the cross validation plot
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE38]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/eab39432f0ca9fd360006ebec626cc016401b43ee69b4f7b5b60678d249f978e.png](../Images/05f34f230707d1aed62b1163edc58876.png)'
  prefs: []
  type: TYPE_IMG
- en: K-Nearest Neighbours (retrain tuned model)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply tuned hyperparameters and retrain the model with all the data.
  prefs: []
  type: TYPE_NORMAL
- en: this is the model that we will use for future predictions, real-world use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE39]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/5a2ca81f6a2c7d36a865cd0ca4aaeda29ddbc131ec5d90cbd7651a11d56abf5b.png](../Images/e88e73510d427f28dd66ee5ee6f593d7.png)'
  prefs: []
  type: TYPE_IMG
- en: K-Nearest Neighbours (tune)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Train model parameters on training data with a range of model hyperparameters,
    select the model hyperparameters with minimum error over the withheld testing
    data
  prefs: []
  type: TYPE_NORMAL
- en: This requires the following steps,
  prefs: []
  type: TYPE_NORMAL
- en: Loop over the hyperparameter(s) values,
  prefs: []
  type: TYPE_NORMAL
- en: train the model with the retained training data
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: predict at the withheld testing data
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: calculate the testing error
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the hyperparameter that minimized the testing error
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE40]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/d19bc60e905a2ecfeaea5603abad42f0a080fc5df476fed45044fefd8c1b4a39.png](../Images/62c23543209403ea04861f7d6ec38b54.png)'
  prefs: []
  type: TYPE_IMG
- en: Linear Regression Model (model parameters)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Retreive the model parameters.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE41]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Feature | Coefficient |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | Intercept | -4053.511325 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | Por | 453.607135 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | Perm | 24.707076 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | AI | -154.448203 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | Brittle | 11.173989 |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | TOC | -183.938586 |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | VR | 580.078458 |'
  prefs: []
  type: TYPE_TB
- en: Linear Regression Model (prediction test)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE42]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 179 | 656.507448 | 379.818856 |'
  prefs: []
  type: TYPE_TB
- en: '| 155 | 3110.245382 | 2943.388125 |'
  prefs: []
  type: TYPE_TB
- en: '| 23 | 2581.359826 | 1372.426014 |'
  prefs: []
  type: TYPE_TB
- en: '| 159 | 6498.151446 | 5563.914978 |'
  prefs: []
  type: TYPE_TB
- en: '| 96 | 4148.822923 | 4987.375301 |'
  prefs: []
  type: TYPE_TB
- en: Linear Regression Model (prediction train)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE43]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 125 | 3750.106623 | 3938.246048 |'
  prefs: []
  type: TYPE_TB
- en: '| 68 | 4644.717576 | 3824.308392 |'
  prefs: []
  type: TYPE_TB
- en: '| 69 | 1991.991593 | 2906.015510 |'
  prefs: []
  type: TYPE_TB
- en: '| 108 | 6688.360827 | 6653.961261 |'
  prefs: []
  type: TYPE_TB
- en: '| 131 | 5076.638358 | 5048.864286 |'
  prefs: []
  type: TYPE_TB
- en: Linear Regression Model (train)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Train model parameters on training data, no hyperparameters
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE44]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Feature | Coefficient |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | Intercept | -4053.511325 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | Por | 453.607135 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | Perm | 24.707076 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | AI | -154.448203 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | Brittle | 11.173989 |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | TOC | -183.938586 |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | VR | 580.078458 |'
  prefs: []
  type: TYPE_TB
- en: Listwise Deletion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Remove all samples that are missing and features.
  prefs: []
  type: TYPE_NORMAL
- en: the “sledge hammer” approach to avoid feature imputation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: not recommended, often removes too much data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE45]'
  prefs: []
  type: TYPE_PRE
- en: '|  | WellIndex | Por | LogPerm | AI | Brittle | TOC | VR | Production |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 210.000000 | 210.000000 | 210.000000 | 210.000000 | 210.000000 |
    210.000000 | 210.000000 | 210.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 485.680952 | 14.976381 | 1.407238 | 2.999857 | 49.406143 | 1.005524
    | 2.001524 | 2373.025529 |'
  prefs: []
  type: TYPE_TB
- en: '| std | 292.292307 | 3.072786 | 0.422033 | 0.584267 | 14.311860 | 0.521783
    | 0.306854 | 1661.542253 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 3.000000 | 6.480000 | 0.360000 | 1.330000 | 17.200000 | -0.230000 |
    0.900000 | 75.215188 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 206.250000 | 12.682500 | 1.110000 | 2.612500 | 39.117500 | 0.640000
    | 1.800000 | 1154.774039 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 477.500000 | 15.035000 | 1.415000 | 3.055000 | 48.320000 | 0.980000
    | 2.010000 | 2029.697410 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 729.500000 | 17.085000 | 1.680000 | 3.360000 | 58.547500 | 1.347500
    | 2.220000 | 3223.502405 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 1000.000000 | 24.650000 | 2.480000 | 4.500000 | 86.800000 | 2.560000
    | 2.820000 | 12568.644130 |'
  prefs: []
  type: TYPE_TB
- en: Location Map
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For plotting sparsely sampled features with X and Y sample locations to inspect
    the spatial structures.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE46]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/a7838f0acb4fea58f25cb89ea2238304b6fc709f5438bc9fdbc9d89c96544a0e.png](../Images/77573508b926ea28e65e395fe3a10574.png)'
  prefs: []
  type: TYPE_IMG
- en: Mean (imputation)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A very simple approach for feature imputation, replace the missing values with
    the mean of the feature,
  prefs: []
  type: TYPE_NORMAL
- en: does on introduce a bias in the mean, but will introduce a bias in the standard
    deviation and variance
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: will likely bias low the between predictor and response feature correlation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE47]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | LogPerm | AI | Brittle | TOC | VR |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000
    | 1000.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 14.898708 | 1.383061 | 2.984200 | 49.607696 | 0.999551 | 1.996173
    |'
  prefs: []
  type: TYPE_TB
- en: '| std | 2.933199 | 0.344835 | 0.544243 | 12.532978 | 0.431517 | 0.265394 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 5.400000 | 0.120000 | 0.960000 | -1.500000 | -0.250000 | 0.900000 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 12.940000 | 1.217500 | 2.630000 | 43.937500 | 0.800000 | 1.897500 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 14.898708 | 1.383061 | 2.984200 | 49.607696 | 0.999551 | 1.996173 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 16.840000 | 1.530000 | 3.302500 | 55.515000 | 1.210000 | 2.110000 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 24.650000 | 2.580000 | 4.700000 | 93.470000 | 2.710000 | 2.900000 |'
  prefs: []
  type: TYPE_TB
- en: Minimum and Maximum (dataframe)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE48]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE49]'
  prefs: []
  type: TYPE_PRE
- en: Minimum and Maximum (ndarray)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE50]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE51]'
  prefs: []
  type: TYPE_PRE
- en: Model Plot (linear 1D)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We use the follow steps,
  prefs: []
  type: TYPE_NORMAL
- en: make an array of equally spaced values of the predictor feature(s)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: predict at all of these predictor values
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: cross plot the predictions with the predictor values
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE52]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/a4c0583b40c49bf06c7fa895961557fd17d1ca0773f145b95f65432f518cdeeb.png](../Images/141c08e9389489310c40fdfbff300226.png)'
  prefs: []
  type: TYPE_IMG
- en: Model Plot (linear 2D)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We use the follow steps,
  prefs: []
  type: TYPE_NORMAL
- en: make a mesh array of equally spaced values of the predictor feature(s)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: predict at all of these predictor values
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: flatten all meshes to 1D
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: plot with a colored scatter plot with square markers (s) scalled to fill in
    the plot
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: I prefer this method because plt.imshow often is inconsistent with other plots
    when added as a subplot
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE53]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/193089af665cc59cf9497b4914122f55a90b0c545f5a56100202ad8a88b12a47.png](../Images/aeff9cc3fc5950d96bb7e8d93ffafa1c.png)'
  prefs: []
  type: TYPE_IMG
- en: Model Mean Absolute Error (testing)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE54]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE55]'
  prefs: []
  type: TYPE_PRE
- en: Model Mean Absolute Error (training)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE56]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE57]'
  prefs: []
  type: TYPE_PRE
- en: Model MSE (testing)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE58]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE59]'
  prefs: []
  type: TYPE_PRE
- en: Model MSE (training)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE60]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE61]'
  prefs: []
  type: TYPE_PRE
- en: Multiple Imputation by Chained Equations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Feature imputation by iterative application of K-nearest neighbours,
  prefs: []
  type: TYPE_NORMAL
- en: accomplished by multiple passes, the structure in the data is learned to improve
    the imputation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: robust with significant porportion of missing feature values
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE62]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | LogPerm | AI | Brittle | TOC | VR |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000
    | 1000.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 14.944723 | 1.404668 | 2.980626 | 49.817322 | 1.005436 | 1.990035
    |'
  prefs: []
  type: TYPE_TB
- en: '| std | 3.030406 | 0.397241 | 0.565985 | 14.029791 | 0.492149 | 0.302019 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 5.400000 | 0.120000 | 0.960000 | -5.422936 | -0.306453 | 0.900000 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 12.850000 | 1.142772 | 2.580000 | 41.384356 | 0.660000 | 1.810000 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 14.950000 | 1.395805 | 3.010000 | 50.077539 | 1.010000 | 1.985885 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 17.052500 | 1.670000 | 3.350314 | 57.951806 | 1.358028 | 2.170000 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 24.650000 | 2.580000 | 4.700000 | 100.043660 | 2.710000 | 2.927459
    |'
  prefs: []
  type: TYPE_TB
- en: Mutual Information
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Measure of information shared between predictors and the response feature,
  prefs: []
  type: TYPE_NORMAL
- en: robust in the presence of nonlinearity and heteroscedasticity,
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '| MI Value Range | Interpretation |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Close to 0 | Variables are nearly independent |'
  prefs: []
  type: TYPE_TB
- en: '| Low (small positive) | Weak dependency or little shared information |'
  prefs: []
  type: TYPE_TB
- en: '| Moderate | Some meaningful dependency |'
  prefs: []
  type: TYPE_TB
- en: '| High | Strong dependency; variables share substantial information |'
  prefs: []
  type: TYPE_TB
- en: '| Very High | Near deterministic relationship |'
  prefs: []
  type: TYPE_TB
- en: '[PRE63]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/644b6fbdbf03216167f1baad977206f250ff2b88264e2e989d89465218f4edd7.png](../Images/e0abc6c7f9333ad69cfe019ae821faa6.png)'
  prefs: []
  type: TYPE_IMG
- en: Mutual Information (normalized)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Measure of information shared between predictors and the response feature,
  prefs: []
  type: TYPE_NORMAL
- en: robust in the presence of nonlinearity and heteroscedasticity
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: normalized by marginal entropies to have a maximum value of 1.0, 0.0 = no information,
    1.0 = perfect information
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Here’s the common rule of thumb to assist with interpretation,
  prefs: []
  type: TYPE_NORMAL
- en: '| NMI Value Range | Interpretation |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0.0 – 0.2 | Very weak or negligible relation |'
  prefs: []
  type: TYPE_TB
- en: '| 0.2 – 0.4 | Weak relation |'
  prefs: []
  type: TYPE_TB
- en: '| 0.4 – 0.6 | Moderate relation |'
  prefs: []
  type: TYPE_TB
- en: '| 0.6 – 0.8 | Strong relation |'
  prefs: []
  type: TYPE_TB
- en: '| 0.8 – 1.0 | Very strong or near perfect |'
  prefs: []
  type: TYPE_TB
- en: '[PRE64]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/0e31eacf7d15566196b691c4dfa7fef7850043fa2b7a438b1ff8cc6a68987be8.png](../Images/be383c1698d1aa37199bfed76c929418.png)'
  prefs: []
  type: TYPE_IMG
- en: Normalize Predictor Features
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Normalize the predictor features to remove any sensitivity to feature range
    or variance, for example,
  prefs: []
  type: TYPE_NORMAL
- en: put features all on equal playing field for distance calculations
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Min / max normalization forces the minimum to be 0.0 and the maximum to be 1.0
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE65]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | Perm | AI | Brittle | TOC | VR |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 200.000000 | 200.000000 | 200.000000 | 200.000000 | 200.000000 |
    200.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 0.496538 | 0.366219 | 0.504134 | 0.507180 | 0.498080 | 0.533144 |'
  prefs: []
  type: TYPE_TB
- en: '| std | 0.174775 | 0.198057 | 0.169220 | 0.192526 | 0.203202 | 0.155066 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 0.374265 | 0.227975 | 0.378358 | 0.365377 | 0.340717 | 0.432990 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 0.501176 | 0.332380 | 0.500000 | 0.525548 | 0.514768 | 0.530928 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 0.638382 | 0.475686 | 0.616418 | 0.644809 | 0.649789 | 0.625000 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 1.000000 | 1.000000 | 1.000000 | 1.000000 | 1.000000 | 1.000000 |'
  prefs: []
  type: TYPE_TB
- en: Random Forest (retrain tuned model)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply tuned hyperparameters and retrain the model.
  prefs: []
  type: TYPE_NORMAL
- en: this is the model that we will use for future predictions, real-world use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE66]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/e9fcd5f031e201181841d77931510c34d15f80eaae16df3fb6f993b0b29e18d1.png](../Images/85e09a63df070a97e49cb63ec6988185.png)'
  prefs: []
  type: TYPE_IMG
- en: Random Forest (train)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE67]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/d4f91ebd10926c4f96b51e807a79e5bae0107950b77cdbfce9b17f8a524c1300.png](../Images/7da55fa460cfbd2f8be764b0c7717cfc.png)'
  prefs: []
  type: TYPE_IMG
- en: Random Forest (tune)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE68]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/a4378ef7e741036b57b87da2bfebdaca422f740e5e57a7c80830378ffb2a97e5.png](../Images/279dbea2db8df7df5a66bc53d7d84b38.png)'
  prefs: []
  type: TYPE_IMG
- en: Scatter Plot
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE69]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/4aeafcadb98fdfb83173ccc394603ab43273c3b50a994399068a5faebea04ac0.png](../Images/b90b0ab6d27045759e55d1d659d09132.png)'
  prefs: []
  type: TYPE_IMG
- en: Standardize Predictor Features
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Standardize the predictor features to remove any sensitivity to feature range
    or variance, for example,
  prefs: []
  type: TYPE_NORMAL
- en: put features all on equal playing field for distance calculations
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Standardization forces the mean to be 0.0 and the standard deviation to be 1.0
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE70]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | Perm | AI | Brittle | TOC | VR |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 2.000000e+02 | 2.000000e+02 | 2.000000e+02 | 2.000000e+02 | 2.000000e+02
    | 2.000000e+02 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 2.486900e-16 | -6.217249e-17 | 4.130030e-16 | 2.042810e-16 | 3.375078e-16
    | 9.081624e-16 |'
  prefs: []
  type: TYPE_TB
- en: '| std | 1.002509e+00 | 1.002509e+00 | 1.002509e+00 | 1.002509e+00 | 1.002509e+00
    | 1.002509e+00 |'
  prefs: []
  type: TYPE_TB
- en: '| min | -2.848142e+00 | -1.853701e+00 | -2.986650e+00 | -2.640962e+00 | -2.457313e+00
    | -3.446814e+00 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | -7.013606e-01 | -6.997528e-01 | -7.451372e-01 | -7.383912e-01 | -7.763606e-01
    | -6.475066e-01 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 2.660490e-02 | -1.712823e-01 | -2.449306e-02 | 9.564649e-02 | 8.233024e-02
    | -1.432979e-02 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 8.136175e-01 | 5.540977e-01 | 6.652032e-01 | 7.166516e-01 | 7.484661e-01
    | 5.938532e-01 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 2.887855e+00 | 3.208033e+00 | 2.937664e+00 | 2.566186e+00 | 2.476256e+00
    | 3.018254e+00 |'
  prefs: []
  type: TYPE_TB
- en: Shapley Values (feature ranking)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE71]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/b3537b09e57d634463cb4d12485c10ea473a4bdc2f13c5a57bff20c0c1ddcca9.png](../Images/4661eb5c68462f9ee6ec2e119b0bd0ae.png)'
  prefs: []
  type: TYPE_IMG
- en: Summary Statistics (DataFrame)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE72]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 200.000000 | 200.000000 | 200.000000 | 200.000000 | 200.000000 |
    200.000000 | 200.000000 | 200.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 100.500000 | 14.991150 | 4.330750 | 2.968850 | 48.161950 | 0.990450
    | 1.964300 | 3874.056957 |'
  prefs: []
  type: TYPE_TB
- en: '| std | 57.879185 | 2.971176 | 1.731014 | 0.566885 | 14.129455 | 0.481588 |
    0.300827 | 1615.551334 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 1.000000 | 6.550000 | 1.130000 | 1.280000 | 10.940000 | -0.190000 |
    0.930000 | 463.579973 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 50.750000 | 12.912500 | 3.122500 | 2.547500 | 37.755000 | 0.617500
    | 1.770000 | 2616.522434 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 100.500000 | 15.070000 | 4.035000 | 2.955000 | 49.510000 | 1.030000
    | 1.960000 | 3801.156899 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 150.250000 | 17.402500 | 5.287500 | 3.345000 | 58.262500 | 1.350000
    | 2.142500 | 4786.375831 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 200.000000 | 23.550000 | 9.870000 | 4.630000 | 84.330000 | 2.180000
    | 2.870000 | 8428.187903 |'
  prefs: []
  type: TYPE_TB
- en: Train and Test Split
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Random splitting of the data into train and test splits.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE73]'
  prefs: []
  type: TYPE_PRE
- en: Variance Inflation Factor
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Feature ranking method that only considers the linear redundancy between the
    predictor features,
  prefs: []
  type: TYPE_NORMAL
- en: relationship with the response feature, relevancy is not considered
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: general used as a screening method to remove features before more comprehensive
    feature ranking
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE74]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/e86fe7cffabcf6080b3ed4c7a671ff49b6e2b59355c6e39c654f7ab12292fe8b.png](../Images/492166c07e6984b6bc1a673cdc12b030.png)'
  prefs: []
  type: TYPE_IMG
- en: Comments
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: These are some basic code snipets for predictive machine learning in Python.
    Much more could be done and discussed, I have many more resources. Check out my
    [shared resource inventory](https://michaelpyrcz.com/my-resources) and the YouTube
    lecture links at the start of this chapter with resource links in the videos’
    descriptions.
  prefs: []
  type: TYPE_NORMAL
- en: I hope this is helpful,
  prefs: []
  type: TYPE_NORMAL
- en: '*Michael*'
  prefs: []
  type: TYPE_NORMAL
- en: About the Author
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
  prefs: []
  type: TYPE_IMG
- en: Professor Michael Pyrcz in his office on the 40 acres, campus of The University
    of Texas at Austin.
  prefs: []
  type: TYPE_NORMAL
- en: Michael Pyrcz is a professor in the [Cockrell School of Engineering](https://cockrell.utexas.edu/faculty-directory/alphabetical/p),
    and the [Jackson School of Geosciences](https://www.jsg.utexas.edu/researcher/michael_pyrcz/),
    at [The University of Texas at Austin](https://www.utexas.edu/), where he researches
    and teaches subsurface, spatial data analytics, geostatistics, and machine learning.
    Michael is also,
  prefs: []
  type: TYPE_NORMAL
- en: the principal investigator of the [Energy Analytics](https://fri.cns.utexas.edu/energy-analytics)
    freshmen research initiative and a core faculty in the Machine Learn Laboratory
    in the College of Natural Sciences, The University of Texas at Austin
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: an associate editor for [Computers and Geosciences](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board),
    and a board member for [Mathematical Geosciences](https://link.springer.com/journal/11004/editorial-board),
    the International Association for Mathematical Geosciences.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Michael has written over 70 [peer-reviewed publications](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en),
    a [Python package](https://pypi.org/project/geostatspy/) for spatial data analytics,
    co-authored a textbook on spatial data analytics, [Geostatistical Reservoir Modeling](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    and author of two recently released e-books, [Applied Geostatistics in Python:
    a Hands-on Guide with GeostatsPy](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    and [Applied Machine Learning in Python: a Hands-on Guide with Code](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html).'
  prefs: []
  type: TYPE_NORMAL
- en: All of Michael’s university lectures are available on his [YouTube Channel](https://www.youtube.com/@GeostatsGuyLectures)
    with links to 100s of Python interactive dashboards and well-documented workflows
    in over 40 repositories on his [GitHub account](https://github.com/GeostatsGuy),
    to support any interested students and working professionals with evergreen content.
    To find out more about Michael’s work and shared educational resources visit his
    Website.
  prefs: []
  type: TYPE_NORMAL
- en: Want to Work Together?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I hope this content is helpful to those that want to learn more about subsurface
    modeling, data analytics and machine learning. Students and working professionals
    are welcome to participate.
  prefs: []
  type: TYPE_NORMAL
- en: Want to invite me to visit your company for training, mentoring, project review,
    workflow design and / or consulting? I’d be happy to drop by and work with you!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Interested in partnering, supporting my graduate student research or my Subsurface
    Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)?
    My research combines data analytics, stochastic modeling and machine learning
    theory with practice to develop novel methods and workflows to add value. We are
    solving challenging subsurface problems!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I can be reached at [mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I’m always happy to discuss,
  prefs: []
  type: TYPE_NORMAL
- en: '*Michael*'
  prefs: []
  type: TYPE_NORMAL
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The
    Jackson School of Geosciences, The University of Texas at Austin
  prefs: []
  type: TYPE_NORMAL
- en: 'More Resources Available at: [Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Geostatistics Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [Applied Machine Learning in Python e-book](https://geostatsguy.github.io/MachineLearningDemos_Book/)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  prefs: []
  type: TYPE_NORMAL
- en: Motivation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I taught a high school hackathon with great students from all over Texas and
    beyond and I felt that they could use some additional resources in the form of
    a **code snippets** to help them over the hurdles of completing their first data
    science workflow in Python.
  prefs: []
  type: TYPE_NORMAL
- en: Remember the definition of a code snippet is,
  prefs: []
  type: TYPE_NORMAL
- en: a small, reusable section of code that programmers can quickly insert into a
    larger codebase
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: My goal is to,
  prefs: []
  type: TYPE_NORMAL
- en: '**provide a set of minimum, simple code snippets** to accomplish basic data
    science modeling build steps'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**avoid fancy additions**, like automatic diagnostics and plotting that are
    specific to the problem setting that will break with new data'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Therefore, improvements and additions to provide diagnostic outputs and plots
    are highly recommended.
  prefs: []
  type: TYPE_NORMAL
- en: Structure
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This is not a workflow!
  prefs: []
  type: TYPE_NORMAL
- en: These are alphabetically ordered code snippets and not a complete workflow.
    Please do not attempt to run this chapter in sequence.
  prefs: []
  type: TYPE_NORMAL
- en: In order to run the snippets we need to first,
  prefs: []
  type: TYPE_NORMAL
- en: Import some python packages
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Declare a couple of convenience functions
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Load some data to demonstrate the code snippets
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: After we load the data the remaining codes with be in alphabetical and not any
    logical workflow order for ease of search and retrieval.
  prefs: []
  type: TYPE_NORMAL
- en: Import Required Packages
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We need some standard packages. These should have been installed with Anaconda
    3.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE75]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE76]'
  prefs: []
  type: TYPE_PRE
- en: If you get a package import error, you may have to first install some of these
    packages. This can usually be accomplished by opening up a command window on Windows
    and then typing ‘python -m pip install [package-name]’. More assistance is available
    with the respective package docs.
  prefs: []
  type: TYPE_NORMAL
- en: Declare Functions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Here’s the functions to improve code readability.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE77]'
  prefs: []
  type: TYPE_PRE
- en: Load a Couple Datasets
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We load a couple of datasets,
  prefs: []
  type: TYPE_NORMAL
- en: df - an exhaustive data table as a pandas DataFrame
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: df_missing an data table with some missing data as a pandas DataFrame
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: ndarray_2D - a 2D array map as a NumPy ndarray
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To demonstrat the methods below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE78]'
  prefs: []
  type: TYPE_PRE
- en: Complete Some Basic Operations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Here I complete some basic operations to ensure that the alphabetically sorted
    code snippets below have the inputs to avoid errors.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE79]'
  prefs: []
  type: TYPE_PRE
- en: OK, now we are ready to walk thorugh our alphabetically ordered code snippets.
  prefs: []
  type: TYPE_NORMAL
- en: Beta, \(\beta\), Coefficients
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Feature importance based on the multilinear regression coefficients of the normalized
    features.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE80]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/0242c4c943789f3508ddcdf0f54466db0571605cbffc4694f303c5b6f867cfec.png](../Images/9f28a7f6ef95f0886ba1d37234411ead.png)'
  prefs: []
  type: TYPE_IMG
- en: Correlation (Pearson product momment)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE81]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/01b6c1f90ba99386369f74ed5c07b22976da6c3ab67393586c8e9287e428c995.png](../Images/055588d911cad1aa273eccf46788a793.png)'
  prefs: []
  type: TYPE_IMG
- en: Correlation (Spearman rank)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE82]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/793c62c2e433f3d5824617e6404b5a63fc9fa91f3ffb1a23e5f11b6aef582fd6.png](../Images/5a27c57a196ffce0c3c085265c5bc0e9.png)'
  prefs: []
  type: TYPE_IMG
- en: Cross Validation Plot (training and testing)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE83]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/9dd5b2ef7db8189250200c8fda4684707fd265c686f3d344fd988859b056f10c.png](../Images/751a56b5a9a1b3b432d910a4efc96752.png)'
  prefs: []
  type: TYPE_IMG
- en: Cross Validation Plot (testing)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE84]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/46b7748af289cbd304af34994fe959c5a2f18d75bc1f14f21555bf54972513bf.png](../Images/3eeeb0c09c9483eeaa7356c233fe26bf.png)'
  prefs: []
  type: TYPE_IMG
- en: Cross Validation Plot (training)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE85]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/e9004125ee8191a22a71ca31d0c303276bc944bdac42e6a5baa00e5f1de1320d.png](../Images/4b42cb5667d6c4b3852871763244ac85.png)'
  prefs: []
  type: TYPE_IMG
- en: DataFrame (add noise to a feature)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I do this to experiment and make educational content, e.g., add noise to the
    response feature to demonstrate overfit.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE86]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 1 | 12.08 | 2.92 | 2.80 | 81.40 | 1.16 | 2.31 | 2154.457620 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 2 | 12.38 | 3.53 | 3.22 | 46.17 | 0.89 | 1.88 | 3199.991714 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 3 | 14.02 | 2.59 | 4.01 | 72.80 | 0.89 | 2.72 | 2742.009861 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3927.738944 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 5 | 17.52 | 4.57 | 3.18 | 10.94 | 1.51 | 1.90 | 2343.080242 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (add a new feature/column)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE87]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod | Ones |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 1 | 12.08 | 2.92 | 2.80 | 81.40 | 1.16 | 2.31 | 2225.696687 | 1.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 2 | 12.38 | 3.53 | 3.22 | 46.17 | 0.89 | 1.88 | 3124.615076 | 1.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 3 | 14.02 | 2.59 | 4.01 | 72.80 | 0.89 | 2.72 | 2746.460169 | 1.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3882.557711 | 1.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 5 | 17.52 | 4.57 | 3.18 | 10.94 | 1.51 | 1.90 | 2208.570072 | 1.0 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (make new)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE88]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Ones | Zeros |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 1.0 | 0.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 1.0 | 0.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 1.0 | 0.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 1.0 | 0.0 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 1.0 | 0.0 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (preview)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Display the first ‘n’ rows of the DataFrame
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE89]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 1 | 12.08 | 2.92 | 2.80 | 81.40 | 1.16 | 2.31 | 2225.696687 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 2 | 12.38 | 3.53 | 3.22 | 46.17 | 0.89 | 1.88 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 3 | 14.02 | 2.59 | 4.01 | 72.80 | 0.89 | 2.72 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 5 | 17.52 | 4.57 | 3.18 | 10.94 | 1.51 | 1.90 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | 6 | 14.53 | 4.81 | 2.69 | 53.60 | 0.94 | 1.67 | 4353.192212 |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | 7 | 13.49 | 3.60 | 2.93 | 63.71 | 0.80 | 1.85 | 3516.494383 |'
  prefs: []
  type: TYPE_TB
- en: '| 7 | 8 | 11.58 | 3.03 | 3.25 | 53.00 | 0.69 | 1.93 | 2083.845221 |'
  prefs: []
  type: TYPE_TB
- en: '| 8 | 9 | 12.52 | 2.72 | 2.43 | 65.77 | 0.95 | 1.98 | 2775.906282 |'
  prefs: []
  type: TYPE_TB
- en: '| 9 | 10 | 13.25 | 3.94 | 3.71 | 66.20 | 1.14 | 2.65 | 2966.741947 |'
  prefs: []
  type: TYPE_TB
- en: '| 10 | 11 | 15.04 | 4.39 | 2.22 | 61.11 | 1.08 | 1.77 | 4022.323780 |'
  prefs: []
  type: TYPE_TB
- en: '| 11 | 12 | 16.19 | 6.30 | 2.29 | 49.10 | 1.53 | 1.86 | 4799.763575 |'
  prefs: []
  type: TYPE_TB
- en: '| 12 | 13 | 16.82 | 5.42 | 2.80 | 66.65 | 1.17 | 1.98 | 3616.427242 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (rename a feature/column)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE90]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Porosity (%) | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 1 | 12.08 | 2.92 | 2.80 | 81.40 | 1.16 | 2.31 | 2225.696687 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 2 | 12.38 | 3.53 | 3.22 | 46.17 | 0.89 | 1.88 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 3 | 14.02 | 2.59 | 4.01 | 72.80 | 0.89 | 2.72 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 5 | 17.52 | 4.57 | 3.18 | 10.94 | 1.51 | 1.90 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (remove features/columns)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE91]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Perm | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 2.92 | 81.40 | 1.16 | 2.31 | 2225.696687 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 3.53 | 46.17 | 0.89 | 1.88 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 2.59 | 72.80 | 0.89 | 2.72 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 6.75 | 39.81 | 1.08 | 1.88 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 4.57 | 10.94 | 1.51 | 1.90 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (remove samples/rows)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE92]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 2 | 12.38 | 3.53 | 3.22 | 46.17 | 0.89 | 1.88 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | 6 | 14.53 | 4.81 | 2.69 | 53.60 | 0.94 | 1.67 | 4353.192212 |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | 7 | 13.49 | 3.60 | 2.93 | 63.71 | 0.80 | 1.85 | 3516.494383 |'
  prefs: []
  type: TYPE_TB
- en: '| 7 | 8 | 11.58 | 3.03 | 3.25 | 53.00 | 0.69 | 1.93 | 2083.845221 |'
  prefs: []
  type: TYPE_TB
- en: DataFrame (remove samples/rows by condition)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE93]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 3 | 14.02 | 2.59 | 4.01 | 72.80 | 0.89 | 2.72 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 4 | 17.67 | 6.75 | 2.63 | 39.81 | 1.08 | 1.88 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 5 | 17.52 | 4.57 | 3.18 | 10.94 | 1.51 | 1.90 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | 6 | 14.53 | 4.81 | 2.69 | 53.60 | 0.94 | 1.67 | 4353.192212 |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | 7 | 13.49 | 3.60 | 2.93 | 63.71 | 0.80 | 1.85 | 3516.494383 |'
  prefs: []
  type: TYPE_TB
- en: Decision Tree (feature importance)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE94]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/498e717d8cd4f6a6f673071a88cbd7a4b3370249d7bdd3b4c0506fede88353ca.png](../Images/bcee90b2c8924008ccfa87e26612ee2c.png)'
  prefs: []
  type: TYPE_IMG
- en: Decision Tree (prediction at testing data)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply our model to predict at withheld testing data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE95]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 179 | 656.507448 | 2218.196237 |'
  prefs: []
  type: TYPE_TB
- en: '| 155 | 3110.245382 | 2218.196237 |'
  prefs: []
  type: TYPE_TB
- en: '| 23 | 2581.359826 | 2218.196237 |'
  prefs: []
  type: TYPE_TB
- en: '| 159 | 6498.151446 | 6482.917835 |'
  prefs: []
  type: TYPE_TB
- en: '| 96 | 4148.822923 | 4297.451039 |'
  prefs: []
  type: TYPE_TB
- en: Decision Tree (prediction at training data)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply our model to predict at the retained training data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE96]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 125 | 3750.106623 | 4297.451039 |'
  prefs: []
  type: TYPE_TB
- en: '| 68 | 4644.717576 | 4297.451039 |'
  prefs: []
  type: TYPE_TB
- en: '| 69 | 1991.991593 | 2218.196237 |'
  prefs: []
  type: TYPE_TB
- en: '| 108 | 6688.360827 | 6482.917835 |'
  prefs: []
  type: TYPE_TB
- en: '| 131 | 5076.638358 | 4297.451039 |'
  prefs: []
  type: TYPE_TB
- en: Decision Tree (train)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Train model parameters on training data with specified model hyperparameters
  prefs: []
  type: TYPE_NORMAL
- en: let’s look at the trained model parameters, by visualizing the trained decision
    tree.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE97]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/d6589d670e2e9b593d1e13e44cfe8c153b4c836395654656835da04c747d5194.png](../Images/17779d19ebdf48d8cb9ff106de64bb16.png)'
  prefs: []
  type: TYPE_IMG
- en: Decision Tree (retrain tuned model)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply tuned hyperparameters and retrain the model with all the data.
  prefs: []
  type: TYPE_NORMAL
- en: this is the model that we will use for future predictions, real-world use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE98]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/bed759efe8f74ab399429a00ba5e1a7deb2f0564e294d93190f0787e1b1df966.png](../Images/b9f7acf97318db4212998bf321561437.png)'
  prefs: []
  type: TYPE_IMG
- en: Decision Tree (tune/prune)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Train model parameters on training data with a range of model hyperparameters,
    select the model hyperparameters with minimum error over the withheld testing
    data
  prefs: []
  type: TYPE_NORMAL
- en: This requires the following steps,
  prefs: []
  type: TYPE_NORMAL
- en: Loop over the hyperparameter(s) values,
  prefs: []
  type: TYPE_NORMAL
- en: train the model with the retained training data
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: predict at the withheld testing data
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: calculate the testing error
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the hyperparameter that minimized the testing error
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE99]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/b60aa2eac0a1291d28f8028ee5949559b2cb770db7315a469587f57d0769aaa3.png](../Images/820a0d93ba1a606ae2d0b29b1b972028.png)'
  prefs: []
  type: TYPE_IMG
- en: Features Extraction (by name)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Build a new DataFrame with only the selected predictor feature and the response
    feature
  prefs: []
  type: TYPE_NORMAL
- en: specify the selected predictor features
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: specify the response feature
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: build a list with both
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: make a new DataFrame with first the predictor features and then the response
    feature as the last column
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE100]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | Perm | AI | Brittle | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 12.08 | 2.92 | 2.80 | 81.40 | 2225.696687 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 12.38 | 3.53 | 3.22 | 46.17 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 14.02 | 2.59 | 4.01 | 72.80 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 17.67 | 6.75 | 2.63 | 39.81 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 17.52 | 4.57 | 3.18 | 10.94 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: Features Extraction (by number)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Build a new DataFrame with only the selected predictor feature.
  prefs: []
  type: TYPE_NORMAL
- en: specify the selected predictor features
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: specify the response feature
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: build a list with both
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: make a new DataFrame with first the predictor features and then the response
    feature as the last column
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE101]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | Perm | AI | Brittle | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | 12.08 | 2.92 | 2.80 | 81.40 | 2225.696687 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | 12.38 | 3.53 | 3.22 | 46.17 | 3124.615076 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | 14.02 | 2.59 | 4.01 | 72.80 | 2746.460169 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | 17.67 | 6.75 | 2.63 | 39.81 | 3882.557711 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | 17.52 | 4.57 | 3.18 | 10.94 | 2208.570072 |'
  prefs: []
  type: TYPE_TB
- en: Features Extraction (make X and y DataFrames)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Build a two new DataFrames, one with only the selected predictor feature and
    the other with the response feature,
  prefs: []
  type: TYPE_NORMAL
- en: assuming that the last feature is the response feature
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE102]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE103]'
  prefs: []
  type: TYPE_PRE
- en: Features Extraction (make X and y DataFrames assumed feature order)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Build a two new DataFrames, one with only the selected predictor feature and
    the other with the response feature,
  prefs: []
  type: TYPE_NORMAL
- en: assuming that the last feature is the response feature
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE104]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE105]'
  prefs: []
  type: TYPE_PRE
- en: Histogram
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Simple histogram,
  prefs: []
  type: TYPE_NORMAL
- en: you can set the histogram limits by specifying the exact bins with a method
    like, np.linspace(min,max,n)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE106]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/0ff41b2a04299239a5787ea06ee741abd39a85b84705e042e481757fa761783f.png](../Images/479b7b449b4f65cbff1f33f5912dd525.png)'
  prefs: []
  type: TYPE_IMG
- en: Histogram (normalized)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A histogram with probability on the y axis and the sum of all bars is one, i.e.,
    probability closure.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE107]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/418e0e90a2846168a380bc4e0ecbfdc630e06e4d53b06e01a518f9cf2dbe00a1.png](../Images/1f995c05278fd97a4977e9ffb72e72ca.png)'
  prefs: []
  type: TYPE_IMG
- en: Image Plot
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE108]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/c86ec564386d943eec0c63d05909805d2ef77161ec97f54666f8f4014aa78cd5.png](../Images/81941c32cdbce6c5d5afa4c43c371885.png)'
  prefs: []
  type: TYPE_IMG
- en: Image Plot (combined with location map)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Superimpose multiple plots on top of each other,
  prefs: []
  type: TYPE_NORMAL
- en: use ‘zorder’ to place object in front of other objects, higher number is in
    front
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: make sure all objects are in the same plot space
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE109]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/e209044ada9e1ec85d74ec9b44724049f126863a34e47f23e678d71f469c2e3d.png](../Images/a3b326fefec63f72f7e2b67536a2e4a6.png)'
  prefs: []
  type: TYPE_IMG
- en: K-Nearest Neighbours (feature imputation)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Feature imputation by estimating missing features with the nearest neighbours,
  prefs: []
  type: TYPE_NORMAL
- en: distance is accessed with all samples that have all features present in the
    sample with a missing feature
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: only one pass is applied, there is no iteration
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: not as robust as MICE is there is a lot of missing data, it does not learn the
    structure between the features to fill in missing data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE110]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | LogPerm | AI | Brittle | TOC | VR |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000
    | 1000.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 14.924820 | 1.375450 | 2.982915 | 49.227565 | 1.014950 | 1.997420
    |'
  prefs: []
  type: TYPE_TB
- en: '| std | 2.999168 | 0.367557 | 0.557240 | 13.755077 | 0.480852 | 0.284183 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 5.400000 | 0.120000 | 0.960000 | -1.500000 | -0.250000 | 0.900000 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 12.846250 | 1.145000 | 2.590000 | 40.640000 | 0.700000 | 1.830000 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 15.035000 | 1.360000 | 3.010000 | 49.477500 | 1.007500 | 2.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 17.012500 | 1.610000 | 3.330000 | 58.055000 | 1.370000 | 2.165000 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 24.650000 | 2.580000 | 4.700000 | 93.470000 | 2.710000 | 2.900000 |'
  prefs: []
  type: TYPE_TB
- en: K-Nearest Neighbours (prediction at testing data)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply our model to predict at withheld testing data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE111]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 179 | 656.507448 | 2303.626455 |'
  prefs: []
  type: TYPE_TB
- en: '| 155 | 3110.245382 | 3774.108284 |'
  prefs: []
  type: TYPE_TB
- en: '| 23 | 2581.359826 | 2321.644376 |'
  prefs: []
  type: TYPE_TB
- en: '| 159 | 6498.151446 | 5713.166746 |'
  prefs: []
  type: TYPE_TB
- en: '| 96 | 4148.822923 | 4108.942362 |'
  prefs: []
  type: TYPE_TB
- en: K-Nearest Neighbours (prediction at training data)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply our model to predict at the retained training data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE112]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 125 | 3750.106623 | 3974.087763 |'
  prefs: []
  type: TYPE_TB
- en: '| 68 | 4644.717576 | 4226.039680 |'
  prefs: []
  type: TYPE_TB
- en: '| 69 | 1991.991593 | 3165.041802 |'
  prefs: []
  type: TYPE_TB
- en: '| 108 | 6688.360827 | 6336.236197 |'
  prefs: []
  type: TYPE_TB
- en: '| 131 | 5076.638358 | 5332.676914 |'
  prefs: []
  type: TYPE_TB
- en: K-Nearest Neighbours (train)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Train model parameters on training data with specified model hyperparameters
  prefs: []
  type: TYPE_NORMAL
- en: since K-nearest neighbours is a lazy learning model, there are no trained model
    parameters to display
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: instead we look at the cross validation plot
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE113]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/eab39432f0ca9fd360006ebec626cc016401b43ee69b4f7b5b60678d249f978e.png](../Images/05f34f230707d1aed62b1163edc58876.png)'
  prefs: []
  type: TYPE_IMG
- en: K-Nearest Neighbours (retrain tuned model)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply tuned hyperparameters and retrain the model with all the data.
  prefs: []
  type: TYPE_NORMAL
- en: this is the model that we will use for future predictions, real-world use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE114]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/5a2ca81f6a2c7d36a865cd0ca4aaeda29ddbc131ec5d90cbd7651a11d56abf5b.png](../Images/e88e73510d427f28dd66ee5ee6f593d7.png)'
  prefs: []
  type: TYPE_IMG
- en: K-Nearest Neighbours (tune)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Train model parameters on training data with a range of model hyperparameters,
    select the model hyperparameters with minimum error over the withheld testing
    data
  prefs: []
  type: TYPE_NORMAL
- en: This requires the following steps,
  prefs: []
  type: TYPE_NORMAL
- en: Loop over the hyperparameter(s) values,
  prefs: []
  type: TYPE_NORMAL
- en: train the model with the retained training data
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: predict at the withheld testing data
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: calculate the testing error
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the hyperparameter that minimized the testing error
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE115]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/d19bc60e905a2ecfeaea5603abad42f0a080fc5df476fed45044fefd8c1b4a39.png](../Images/62c23543209403ea04861f7d6ec38b54.png)'
  prefs: []
  type: TYPE_IMG
- en: Linear Regression Model (model parameters)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Retreive the model parameters.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE116]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Feature | Coefficient |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | Intercept | -4053.511325 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | Por | 453.607135 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | Perm | 24.707076 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | AI | -154.448203 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | Brittle | 11.173989 |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | TOC | -183.938586 |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | VR | 580.078458 |'
  prefs: []
  type: TYPE_TB
- en: Linear Regression Model (prediction test)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE117]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 179 | 656.507448 | 379.818856 |'
  prefs: []
  type: TYPE_TB
- en: '| 155 | 3110.245382 | 2943.388125 |'
  prefs: []
  type: TYPE_TB
- en: '| 23 | 2581.359826 | 1372.426014 |'
  prefs: []
  type: TYPE_TB
- en: '| 159 | 6498.151446 | 5563.914978 |'
  prefs: []
  type: TYPE_TB
- en: '| 96 | 4148.822923 | 4987.375301 |'
  prefs: []
  type: TYPE_TB
- en: Linear Regression Model (prediction train)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE118]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Prod | Estimated Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 125 | 3750.106623 | 3938.246048 |'
  prefs: []
  type: TYPE_TB
- en: '| 68 | 4644.717576 | 3824.308392 |'
  prefs: []
  type: TYPE_TB
- en: '| 69 | 1991.991593 | 2906.015510 |'
  prefs: []
  type: TYPE_TB
- en: '| 108 | 6688.360827 | 6653.961261 |'
  prefs: []
  type: TYPE_TB
- en: '| 131 | 5076.638358 | 5048.864286 |'
  prefs: []
  type: TYPE_TB
- en: Linear Regression Model (train)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Train model parameters on training data, no hyperparameters
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE119]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Feature | Coefficient |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0 | Intercept | -4053.511325 |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | Por | 453.607135 |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | Perm | 24.707076 |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | AI | -154.448203 |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | Brittle | 11.173989 |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | TOC | -183.938586 |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | VR | 580.078458 |'
  prefs: []
  type: TYPE_TB
- en: Listwise Deletion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Remove all samples that are missing and features.
  prefs: []
  type: TYPE_NORMAL
- en: the “sledge hammer” approach to avoid feature imputation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: not recommended, often removes too much data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE120]'
  prefs: []
  type: TYPE_PRE
- en: '|  | WellIndex | Por | LogPerm | AI | Brittle | TOC | VR | Production |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 210.000000 | 210.000000 | 210.000000 | 210.000000 | 210.000000 |
    210.000000 | 210.000000 | 210.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 485.680952 | 14.976381 | 1.407238 | 2.999857 | 49.406143 | 1.005524
    | 2.001524 | 2373.025529 |'
  prefs: []
  type: TYPE_TB
- en: '| std | 292.292307 | 3.072786 | 0.422033 | 0.584267 | 14.311860 | 0.521783
    | 0.306854 | 1661.542253 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 3.000000 | 6.480000 | 0.360000 | 1.330000 | 17.200000 | -0.230000 |
    0.900000 | 75.215188 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 206.250000 | 12.682500 | 1.110000 | 2.612500 | 39.117500 | 0.640000
    | 1.800000 | 1154.774039 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 477.500000 | 15.035000 | 1.415000 | 3.055000 | 48.320000 | 0.980000
    | 2.010000 | 2029.697410 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 729.500000 | 17.085000 | 1.680000 | 3.360000 | 58.547500 | 1.347500
    | 2.220000 | 3223.502405 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 1000.000000 | 24.650000 | 2.480000 | 4.500000 | 86.800000 | 2.560000
    | 2.820000 | 12568.644130 |'
  prefs: []
  type: TYPE_TB
- en: Location Map
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For plotting sparsely sampled features with X and Y sample locations to inspect
    the spatial structures.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE121]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/a7838f0acb4fea58f25cb89ea2238304b6fc709f5438bc9fdbc9d89c96544a0e.png](../Images/77573508b926ea28e65e395fe3a10574.png)'
  prefs: []
  type: TYPE_IMG
- en: Mean (imputation)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A very simple approach for feature imputation, replace the missing values with
    the mean of the feature,
  prefs: []
  type: TYPE_NORMAL
- en: does on introduce a bias in the mean, but will introduce a bias in the standard
    deviation and variance
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: will likely bias low the between predictor and response feature correlation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE122]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | LogPerm | AI | Brittle | TOC | VR |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000
    | 1000.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 14.898708 | 1.383061 | 2.984200 | 49.607696 | 0.999551 | 1.996173
    |'
  prefs: []
  type: TYPE_TB
- en: '| std | 2.933199 | 0.344835 | 0.544243 | 12.532978 | 0.431517 | 0.265394 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 5.400000 | 0.120000 | 0.960000 | -1.500000 | -0.250000 | 0.900000 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 12.940000 | 1.217500 | 2.630000 | 43.937500 | 0.800000 | 1.897500 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 14.898708 | 1.383061 | 2.984200 | 49.607696 | 0.999551 | 1.996173 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 16.840000 | 1.530000 | 3.302500 | 55.515000 | 1.210000 | 2.110000 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 24.650000 | 2.580000 | 4.700000 | 93.470000 | 2.710000 | 2.900000 |'
  prefs: []
  type: TYPE_TB
- en: Minimum and Maximum (dataframe)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE123]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE124]'
  prefs: []
  type: TYPE_PRE
- en: Minimum and Maximum (ndarray)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE125]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE126]'
  prefs: []
  type: TYPE_PRE
- en: Model Plot (linear 1D)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We use the follow steps,
  prefs: []
  type: TYPE_NORMAL
- en: make an array of equally spaced values of the predictor feature(s)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: predict at all of these predictor values
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: cross plot the predictions with the predictor values
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE127]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/a4c0583b40c49bf06c7fa895961557fd17d1ca0773f145b95f65432f518cdeeb.png](../Images/141c08e9389489310c40fdfbff300226.png)'
  prefs: []
  type: TYPE_IMG
- en: Model Plot (linear 2D)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We use the follow steps,
  prefs: []
  type: TYPE_NORMAL
- en: make a mesh array of equally spaced values of the predictor feature(s)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: predict at all of these predictor values
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: flatten all meshes to 1D
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: plot with a colored scatter plot with square markers (s) scalled to fill in
    the plot
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: I prefer this method because plt.imshow often is inconsistent with other plots
    when added as a subplot
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE128]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/193089af665cc59cf9497b4914122f55a90b0c545f5a56100202ad8a88b12a47.png](../Images/aeff9cc3fc5950d96bb7e8d93ffafa1c.png)'
  prefs: []
  type: TYPE_IMG
- en: Model Mean Absolute Error (testing)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE129]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE130]'
  prefs: []
  type: TYPE_PRE
- en: Model Mean Absolute Error (training)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE131]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE132]'
  prefs: []
  type: TYPE_PRE
- en: Model MSE (testing)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE133]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE134]'
  prefs: []
  type: TYPE_PRE
- en: Model MSE (training)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE135]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE136]'
  prefs: []
  type: TYPE_PRE
- en: Multiple Imputation by Chained Equations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Feature imputation by iterative application of K-nearest neighbours,
  prefs: []
  type: TYPE_NORMAL
- en: accomplished by multiple passes, the structure in the data is learned to improve
    the imputation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: robust with significant porportion of missing feature values
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE137]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | LogPerm | AI | Brittle | TOC | VR |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000 | 1000.000000
    | 1000.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 14.944723 | 1.404668 | 2.980626 | 49.817322 | 1.005436 | 1.990035
    |'
  prefs: []
  type: TYPE_TB
- en: '| std | 3.030406 | 0.397241 | 0.565985 | 14.029791 | 0.492149 | 0.302019 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 5.400000 | 0.120000 | 0.960000 | -5.422936 | -0.306453 | 0.900000 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 12.850000 | 1.142772 | 2.580000 | 41.384356 | 0.660000 | 1.810000 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 14.950000 | 1.395805 | 3.010000 | 50.077539 | 1.010000 | 1.985885 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 17.052500 | 1.670000 | 3.350314 | 57.951806 | 1.358028 | 2.170000 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 24.650000 | 2.580000 | 4.700000 | 100.043660 | 2.710000 | 2.927459
    |'
  prefs: []
  type: TYPE_TB
- en: Mutual Information
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Measure of information shared between predictors and the response feature,
  prefs: []
  type: TYPE_NORMAL
- en: robust in the presence of nonlinearity and heteroscedasticity,
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '| MI Value Range | Interpretation |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Close to 0 | Variables are nearly independent |'
  prefs: []
  type: TYPE_TB
- en: '| Low (small positive) | Weak dependency or little shared information |'
  prefs: []
  type: TYPE_TB
- en: '| Moderate | Some meaningful dependency |'
  prefs: []
  type: TYPE_TB
- en: '| High | Strong dependency; variables share substantial information |'
  prefs: []
  type: TYPE_TB
- en: '| Very High | Near deterministic relationship |'
  prefs: []
  type: TYPE_TB
- en: '[PRE138]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/644b6fbdbf03216167f1baad977206f250ff2b88264e2e989d89465218f4edd7.png](../Images/e0abc6c7f9333ad69cfe019ae821faa6.png)'
  prefs: []
  type: TYPE_IMG
- en: Mutual Information (normalized)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Measure of information shared between predictors and the response feature,
  prefs: []
  type: TYPE_NORMAL
- en: robust in the presence of nonlinearity and heteroscedasticity
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: normalized by marginal entropies to have a maximum value of 1.0, 0.0 = no information,
    1.0 = perfect information
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Here’s the common rule of thumb to assist with interpretation,
  prefs: []
  type: TYPE_NORMAL
- en: '| NMI Value Range | Interpretation |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 0.0 – 0.2 | Very weak or negligible relation |'
  prefs: []
  type: TYPE_TB
- en: '| 0.2 – 0.4 | Weak relation |'
  prefs: []
  type: TYPE_TB
- en: '| 0.4 – 0.6 | Moderate relation |'
  prefs: []
  type: TYPE_TB
- en: '| 0.6 – 0.8 | Strong relation |'
  prefs: []
  type: TYPE_TB
- en: '| 0.8 – 1.0 | Very strong or near perfect |'
  prefs: []
  type: TYPE_TB
- en: '[PRE139]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/0e31eacf7d15566196b691c4dfa7fef7850043fa2b7a438b1ff8cc6a68987be8.png](../Images/be383c1698d1aa37199bfed76c929418.png)'
  prefs: []
  type: TYPE_IMG
- en: Normalize Predictor Features
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Normalize the predictor features to remove any sensitivity to feature range
    or variance, for example,
  prefs: []
  type: TYPE_NORMAL
- en: put features all on equal playing field for distance calculations
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Min / max normalization forces the minimum to be 0.0 and the maximum to be 1.0
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE140]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | Perm | AI | Brittle | TOC | VR |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 200.000000 | 200.000000 | 200.000000 | 200.000000 | 200.000000 |
    200.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 0.496538 | 0.366219 | 0.504134 | 0.507180 | 0.498080 | 0.533144 |'
  prefs: []
  type: TYPE_TB
- en: '| std | 0.174775 | 0.198057 | 0.169220 | 0.192526 | 0.203202 | 0.155066 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 0.374265 | 0.227975 | 0.378358 | 0.365377 | 0.340717 | 0.432990 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 0.501176 | 0.332380 | 0.500000 | 0.525548 | 0.514768 | 0.530928 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 0.638382 | 0.475686 | 0.616418 | 0.644809 | 0.649789 | 0.625000 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 1.000000 | 1.000000 | 1.000000 | 1.000000 | 1.000000 | 1.000000 |'
  prefs: []
  type: TYPE_TB
- en: Random Forest (retrain tuned model)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apply tuned hyperparameters and retrain the model.
  prefs: []
  type: TYPE_NORMAL
- en: this is the model that we will use for future predictions, real-world use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE141]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/e9fcd5f031e201181841d77931510c34d15f80eaae16df3fb6f993b0b29e18d1.png](../Images/85e09a63df070a97e49cb63ec6988185.png)'
  prefs: []
  type: TYPE_IMG
- en: Random Forest (train)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE142]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/d4f91ebd10926c4f96b51e807a79e5bae0107950b77cdbfce9b17f8a524c1300.png](../Images/7da55fa460cfbd2f8be764b0c7717cfc.png)'
  prefs: []
  type: TYPE_IMG
- en: Random Forest (tune)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE143]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/a4378ef7e741036b57b87da2bfebdaca422f740e5e57a7c80830378ffb2a97e5.png](../Images/279dbea2db8df7df5a66bc53d7d84b38.png)'
  prefs: []
  type: TYPE_IMG
- en: Scatter Plot
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE144]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/4aeafcadb98fdfb83173ccc394603ab43273c3b50a994399068a5faebea04ac0.png](../Images/b90b0ab6d27045759e55d1d659d09132.png)'
  prefs: []
  type: TYPE_IMG
- en: Standardize Predictor Features
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Standardize the predictor features to remove any sensitivity to feature range
    or variance, for example,
  prefs: []
  type: TYPE_NORMAL
- en: put features all on equal playing field for distance calculations
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Standardization forces the mean to be 0.0 and the standard deviation to be 1.0
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE145]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Por | Perm | AI | Brittle | TOC | VR |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 2.000000e+02 | 2.000000e+02 | 2.000000e+02 | 2.000000e+02 | 2.000000e+02
    | 2.000000e+02 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 2.486900e-16 | -6.217249e-17 | 4.130030e-16 | 2.042810e-16 | 3.375078e-16
    | 9.081624e-16 |'
  prefs: []
  type: TYPE_TB
- en: '| std | 1.002509e+00 | 1.002509e+00 | 1.002509e+00 | 1.002509e+00 | 1.002509e+00
    | 1.002509e+00 |'
  prefs: []
  type: TYPE_TB
- en: '| min | -2.848142e+00 | -1.853701e+00 | -2.986650e+00 | -2.640962e+00 | -2.457313e+00
    | -3.446814e+00 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | -7.013606e-01 | -6.997528e-01 | -7.451372e-01 | -7.383912e-01 | -7.763606e-01
    | -6.475066e-01 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 2.660490e-02 | -1.712823e-01 | -2.449306e-02 | 9.564649e-02 | 8.233024e-02
    | -1.432979e-02 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 8.136175e-01 | 5.540977e-01 | 6.652032e-01 | 7.166516e-01 | 7.484661e-01
    | 5.938532e-01 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 2.887855e+00 | 3.208033e+00 | 2.937664e+00 | 2.566186e+00 | 2.476256e+00
    | 3.018254e+00 |'
  prefs: []
  type: TYPE_TB
- en: Shapley Values (feature ranking)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE146]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/b3537b09e57d634463cb4d12485c10ea473a4bdc2f13c5a57bff20c0c1ddcca9.png](../Images/4661eb5c68462f9ee6ec2e119b0bd0ae.png)'
  prefs: []
  type: TYPE_IMG
- en: Summary Statistics (DataFrame)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[PRE147]'
  prefs: []
  type: TYPE_PRE
- en: '|  | Well | Por | Perm | AI | Brittle | TOC | VR | Prod |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| count | 200.000000 | 200.000000 | 200.000000 | 200.000000 | 200.000000 |
    200.000000 | 200.000000 | 200.000000 |'
  prefs: []
  type: TYPE_TB
- en: '| mean | 100.500000 | 14.991150 | 4.330750 | 2.968850 | 48.161950 | 0.990450
    | 1.964300 | 3874.056957 |'
  prefs: []
  type: TYPE_TB
- en: '| std | 57.879185 | 2.971176 | 1.731014 | 0.566885 | 14.129455 | 0.481588 |
    0.300827 | 1615.551334 |'
  prefs: []
  type: TYPE_TB
- en: '| min | 1.000000 | 6.550000 | 1.130000 | 1.280000 | 10.940000 | -0.190000 |
    0.930000 | 463.579973 |'
  prefs: []
  type: TYPE_TB
- en: '| 25% | 50.750000 | 12.912500 | 3.122500 | 2.547500 | 37.755000 | 0.617500
    | 1.770000 | 2616.522434 |'
  prefs: []
  type: TYPE_TB
- en: '| 50% | 100.500000 | 15.070000 | 4.035000 | 2.955000 | 49.510000 | 1.030000
    | 1.960000 | 3801.156899 |'
  prefs: []
  type: TYPE_TB
- en: '| 75% | 150.250000 | 17.402500 | 5.287500 | 3.345000 | 58.262500 | 1.350000
    | 2.142500 | 4786.375831 |'
  prefs: []
  type: TYPE_TB
- en: '| max | 200.000000 | 23.550000 | 9.870000 | 4.630000 | 84.330000 | 2.180000
    | 2.870000 | 8428.187903 |'
  prefs: []
  type: TYPE_TB
- en: Train and Test Split
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Random splitting of the data into train and test splits.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE148]'
  prefs: []
  type: TYPE_PRE
- en: Variance Inflation Factor
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Feature ranking method that only considers the linear redundancy between the
    predictor features,
  prefs: []
  type: TYPE_NORMAL
- en: relationship with the response feature, relevancy is not considered
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: general used as a screening method to remove features before more comprehensive
    feature ranking
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE149]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/e86fe7cffabcf6080b3ed4c7a671ff49b6e2b59355c6e39c654f7ab12292fe8b.png](../Images/492166c07e6984b6bc1a673cdc12b030.png)'
  prefs: []
  type: TYPE_IMG
- en: Comments
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: These are some basic code snipets for predictive machine learning in Python.
    Much more could be done and discussed, I have many more resources. Check out my
    [shared resource inventory](https://michaelpyrcz.com/my-resources) and the YouTube
    lecture links at the start of this chapter with resource links in the videos’
    descriptions.
  prefs: []
  type: TYPE_NORMAL
- en: I hope this is helpful,
  prefs: []
  type: TYPE_NORMAL
- en: '*Michael*'
  prefs: []
  type: TYPE_NORMAL
- en: About the Author
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
  prefs: []
  type: TYPE_IMG
- en: Professor Michael Pyrcz in his office on the 40 acres, campus of The University
    of Texas at Austin.
  prefs: []
  type: TYPE_NORMAL
- en: Michael Pyrcz is a professor in the [Cockrell School of Engineering](https://cockrell.utexas.edu/faculty-directory/alphabetical/p),
    and the [Jackson School of Geosciences](https://www.jsg.utexas.edu/researcher/michael_pyrcz/),
    at [The University of Texas at Austin](https://www.utexas.edu/), where he researches
    and teaches subsurface, spatial data analytics, geostatistics, and machine learning.
    Michael is also,
  prefs: []
  type: TYPE_NORMAL
- en: the principal investigator of the [Energy Analytics](https://fri.cns.utexas.edu/energy-analytics)
    freshmen research initiative and a core faculty in the Machine Learn Laboratory
    in the College of Natural Sciences, The University of Texas at Austin
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: an associate editor for [Computers and Geosciences](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board),
    and a board member for [Mathematical Geosciences](https://link.springer.com/journal/11004/editorial-board),
    the International Association for Mathematical Geosciences.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Michael has written over 70 [peer-reviewed publications](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en),
    a [Python package](https://pypi.org/project/geostatspy/) for spatial data analytics,
    co-authored a textbook on spatial data analytics, [Geostatistical Reservoir Modeling](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    and author of two recently released e-books, [Applied Geostatistics in Python:
    a Hands-on Guide with GeostatsPy](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    and [Applied Machine Learning in Python: a Hands-on Guide with Code](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html).'
  prefs: []
  type: TYPE_NORMAL
- en: All of Michael’s university lectures are available on his [YouTube Channel](https://www.youtube.com/@GeostatsGuyLectures)
    with links to 100s of Python interactive dashboards and well-documented workflows
    in over 40 repositories on his [GitHub account](https://github.com/GeostatsGuy),
    to support any interested students and working professionals with evergreen content.
    To find out more about Michael’s work and shared educational resources visit his
    Website.
  prefs: []
  type: TYPE_NORMAL
- en: Want to Work Together?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I hope this content is helpful to those that want to learn more about subsurface
    modeling, data analytics and machine learning. Students and working professionals
    are welcome to participate.
  prefs: []
  type: TYPE_NORMAL
- en: Want to invite me to visit your company for training, mentoring, project review,
    workflow design and / or consulting? I’d be happy to drop by and work with you!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Interested in partnering, supporting my graduate student research or my Subsurface
    Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)?
    My research combines data analytics, stochastic modeling and machine learning
    theory with practice to develop novel methods and workflows to add value. We are
    solving challenging subsurface problems!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I can be reached at [mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I’m always happy to discuss,
  prefs: []
  type: TYPE_NORMAL
- en: '*Michael*'
  prefs: []
  type: TYPE_NORMAL
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The
    Jackson School of Geosciences, The University of Texas at Austin
  prefs: []
  type: TYPE_NORMAL
- en: 'More Resources Available at: [Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Geostatistics Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [Applied Machine Learning in Python e-book](https://geostatsguy.github.io/MachineLearningDemos_Book/)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  prefs: []
  type: TYPE_NORMAL
