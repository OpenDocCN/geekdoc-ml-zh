["```py\n# Implements the data augmentation policy\ndef augment_image(image, label):\n    # Flips the image randomly\n    image = tf.image.random_flip_left_right(image)\n\n    # Increase the image size, then randomly crop it down to\n    # the original dimensions\n    resize_factor = random.uniform(1, 1.2)\n    new_height = math.floor(resize_factor * INPUT_SHAPE[0])\n    new_width = math.floor(resize_factor * INPUT_SHAPE[1])\n    image = tf.image.resize_with_crop_or_pad(image, new_height,\n                                             new_width)\n    image = tf.image.random_crop(image, size=INPUT_SHAPE)\n\n    # Vary the brightness of the image\n    image = tf.image.random_brightness(image, max_delta=0.2)\n\n    return image, label\n```", "```py\nimport time\nWhile True:\n...\n    time.sleep_ms(200)  # Delay for .2 second\n```", "```py\n# Marcelo Rovai - NICLA Vision - Image Classification\n# Adapted from Edge Impulse - OpenMV Image Classification Example\n# @24March25\n\nimport sensor\nimport time\nimport ml\n\nsensor.reset()  # Reset and initialize the sensor.\n# Set pixel format to RGB565 (or GRAYSCALE)\nsensor.set_pixformat(sensor.RGB565)\n# Set frame size to QVGA (320x240)\nsensor.set_framesize(sensor.QVGA)\nsensor.set_windowing((240, 240))  # Set 240x240 window.\nsensor.skip_frames(time=2000)  # Let the camera adjust.\n\nmodel = ml.Model(\"trained\")#mobilenet, load_to_fb=True)\n\nclock = time.clock()\n\nwhile True:\n    clock.tick()\n    img = sensor.snapshot()\n\n    fps = clock.fps()\n    lat = clock.avg()\n    print(\"**********\\nPrediction:\")\n    # Combines labels & confidence into a list of tuples and then\n    # sorts that list by the confidence values.\n    sorted_list = sorted(\n        zip(model.labels, model.predict([img])[0].flatten().tolist()),\n      key=lambda x: x[1], reverse=True\n    )\n\n    # Print only the class with the highest probability\n    max_val = sorted_list[0][1]\n    max_lbl = sorted_list[0][0]\n\n    if max_val < 0.5:\n        max_lbl = 'uncertain'\n\n    print(\"{} with a prob of {:.2f}\".format(max_lbl, max_val))\n    print(\"FPS: {:.2f} fps ==> latency: {:.0f} ms\".format(fps, lat))\n\n    # Draw the label with the highest probability to the image viewer\n    img.draw_string(\n    10, 10,\n    max_lbl + \"\\n{:.2f}\".format(max_val),\n    mono_space = False,\n    scale=3\n    )\n\n    time.sleep_ms(500)  # Delay for .5 second\n```", "```py\n# Marcelo Rovai - NICLA Vision - Image Classification with LEDs\n# Adapted from Edge Impulse - OpenMV Image Classification Example\n# @24Aug23\n\nimport sensor, time, ml\nfrom machine import LED\n\nledRed = LED(\"LED_RED\")\nledGre = LED(\"LED_GREEN\")\nledBlu = LED(\"LED_BLUE\")\n\nsensor.reset()  # Reset and initialize the sensor.\n# Set pixel format to RGB565 (or GRAYSCALE)\nsensor.set_pixformat(sensor.RGB565)\n# Set frame size to QVGA (320x240)\nsensor.set_framesize(sensor.QVGA)\nsensor.set_windowing((240, 240))  # Set 240x240 window.\nsensor.skip_frames(time=2000)  # Let the camera adjust.\n\nmodel = ml.Model(\"trained\")#mobilenet, load_to_fb=True)\n\nledRed.off()\nledGre.off()\nledBlu.off()\n\nclock = time.clock()\n\ndef setLEDs(max_lbl):\n    if max_lbl == 'uncertain’:\n ledRed.on()\n        ledGre.off()\n        ledBlu.off()\n\n    if max_lbl == 'periquito’:\n ledRed.off()\n        ledGre.on()\n        ledBlu.off()\n\n    if max_lbl == 'robot’:\n ledRed.off()\n        ledGre.off()\n        ledBlu.on()\n\n    if max_lbl == 'background’:\n ledRed.off()\n        ledGre.off()\n        ledBlu.off()\n\n  while True:\n    img = sensor.snapshot()\n\n    clock.tick()\n    fps = clock.fps()\n    lat = clock.avg()\n    print(\"**********\\nPrediction:\")\n    sorted_list = sorted(\n        zip(model.labels, model.predict([img])[0].flatten().tolist()),\n      key=lambda x: x[1], reverse=True\n    )\n\n    # Print only the class with the highest probability\n    max_val = sorted_list[0][1]\n    max_lbl = sorted_list[0][0]\n\n    if max_val < 0.5:\n        max_lbl = 'uncertain'\n\n    print(\"{} with a prob of {:.2f}\".format(max_lbl, max_val))\n    print(\"FPS: {:.2f} fps ==> latency: {:.0f} ms\".format(fps, lat))\n\n    # Draw the label with the highest probability to the image viewer\n    img.draw_string(\n    10, 10,\n    max_lbl + \"\\n{:.2f}\".format(max_val),\n    mono_space = False,\n    scale=3\n    )\n\n    setLEDs(max_lbl)\n    time.sleep_ms(200)  # Delay for .2 second\n```"]