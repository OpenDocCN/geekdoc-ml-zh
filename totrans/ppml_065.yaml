- en: Combinators
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://rust-exercises.com/100-exercises/06_ticket_management/07_combinators.html](https://rust-exercises.com/100-exercises/06_ticket_management/07_combinators.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Iterators can do so much more than `for` loops!
  prefs: []
  type: TYPE_NORMAL
- en: If you look at the documentation for the `Iterator` trait, you'll find a **vast**
    collection of methods that you can leverage to transform, filter, and combine
    iterators in various ways.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s mention the most common ones:'
  prefs: []
  type: TYPE_NORMAL
- en: '`map` applies a function to each element of the iterator.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`filter` keeps only the elements that satisfy a predicate.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`filter_map` combines `filter` and `map` in one step.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`cloned` converts an iterator of references into an iterator of values, cloning
    each element.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`enumerate` returns a new iterator that yields `(index, value)` pairs.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`skip` skips the first `n` elements of the iterator.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`take` stops the iterator after `n` elements.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`chain` combines two iterators into one.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These methods are called **combinators**.
  prefs: []
  type: TYPE_NORMAL
- en: 'They are usually **chained** together to create complex transformations in
    a concise and readable way:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '[Closures](#closures)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: What's going on with the `filter` and `map` methods above?
  prefs: []
  type: TYPE_NORMAL
- en: They take **closures** as arguments.
  prefs: []
  type: TYPE_NORMAL
- en: Closures are **anonymous functions**, i.e. functions that are not defined using
    the `fn` syntax we are used to.
  prefs: []
  type: TYPE_NORMAL
- en: 'They are defined using the `|args| body` syntax, where `args` are the arguments
    and `body` is the function body. `body` can be a block of code or a single expression.
    For example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Closures can take more than one argument:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'They can also capture variables from their environment:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'If necessary, you can specify the types of the arguments and/or the return
    type:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '[`collect`](#collect)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: What happens when you're done transforming an iterator using combinators?
  prefs: []
  type: TYPE_NORMAL
- en: You either iterate over the transformed values using a `for` loop, or you collect
    them into a collection.
  prefs: []
  type: TYPE_NORMAL
- en: The latter is done using the `collect` method.
  prefs: []
  type: TYPE_NORMAL
- en: '`collect` consumes the iterator and collects its elements into a collection
    of your choice.'
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, you can collect the squares of the even numbers into a `Vec`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '`collect` is generic over its **return type**.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Therefore you usually need to provide a type hint to help the compiler infer
    the correct type. In the example above, we annotated the type of `squares_of_evens`
    to be `Vec<u32>`. Alternatively, you can use the **turbofish syntax** to specify
    the type:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '[Further reading](#further-reading)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[`Iterator`''s documentation](https://doc.rust-lang.org/std/iter/trait.Iterator.html)
    gives you an overview of the methods available for iterators in `std`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[The `itertools` crate](https://docs.rs/itertools/) defines even **more** combinators
    for iterators.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Exercise](#exercise)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The exercise for this section is located in [`06_ticket_management/07_combinators`](https://github.com/mainmatter/100-exercises-to-learn-rust/tree/main/exercises/06_ticket_management/07_combinators)
  prefs: []
  type: TYPE_NORMAL
