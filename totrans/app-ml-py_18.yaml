- en: Predictive Machine Learning with scikit-learn
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_predictive.html](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_predictive.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Michael J. Pyrcz, Professor, The University of Texas at Austin
  prefs: []
  type: TYPE_NORMAL
- en: '[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Geostatistics Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [Applied Machine Learning in Python e-book](https://geostatsguy.github.io/MachineLearningDemos_Book/)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Chapter of e-book “Applied Machine Learning in Python: a Hands-on Guide with
    Code”.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Cite this e-Book as:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Pyrcz, M.J., 2024, *Applied Machine Learning in Python: A Hands-on Guide with
    Code* [e-book]. Zenodo. doi:10.5281/zenodo.15169138 [![DOI](../Images/7e4ea662f44af1eae87e87ecbb962ff4.png)](https://doi.org/10.5281/zenodo.15169138)'
  prefs: []
  type: TYPE_NORMAL
- en: 'The workflows in this book and more are available here:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Cite the MachineLearningDemos GitHub Repository as:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Pyrcz, M.J., 2024, *MachineLearningDemos: Python Machine Learning Demonstration
    Workflows Repository* (0.0.3) [Software]. Zenodo. DOI: 10.5281/zenodo.13835312\.
    GitHub repository: [GeostatsGuy/MachineLearningDemos](https://github.com/GeostatsGuy/MachineLearningDemos)
    [![DOI](../Images/4e3a59c17d684b06a170c4af84e0f631.png)](https://zenodo.org/doi/10.5281/zenodo.13835312)'
  prefs: []
  type: TYPE_NORMAL
- en: By Michael J. Pyrcz
  prefs: []
  type: TYPE_NORMAL
- en: © Copyright 2025.
  prefs: []
  type: TYPE_NORMAL
- en: This chapter is a tutorial for / demonstration of **Predictive Machine Learning
    with scikit-learn**.
  prefs: []
  type: TYPE_NORMAL
- en: '**YouTube Lecture**: check out my lectures on:'
  prefs: []
  type: TYPE_NORMAL
- en: '[Introduction to Machine Learning](https://youtu.be/zOUM_AnI1DQ?si=wzWdJ35qJ9n8O6Bl)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Predictive Machine Learning in Python with sckit-learn](https://youtu.be/EbYePnjWB5o?si=dd7SpbQlQgMhFGZ5)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Machine Learning in Python with Pipelines](https://youtu.be/tYrPs8s1l9U?si=5OMrFm7rlK6koR6g)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These lectures are all part of my [Machine Learning Course](https://youtube.com/playlist?list=PLG19vXLQHvSC2ZKFIkgVpI9fCjkN38kwf&si=XonjO2wHdXffMpeI)
    on YouTube with linked well-documented Python workflows and interactive dashboards.
    My goal is to share accessible, actionable, and repeatable educational content.
    If you want to know about my motivation, check out [Michael’s Story](https://michaelpyrcz.com/my-story).
  prefs: []
  type: TYPE_NORMAL
- en: Motivation for Predictive Machine Learning with scikit-learn
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This chapter is unusual for me. As a professor, I avoid lectures that focus
    on the specific tools, as I would rather teach the principles and then introduce
    the examples with the common tools. It is my opinion that,
  prefs: []
  type: TYPE_NORMAL
- en: theory will outlast any available software tools
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: without a theory focus I may encourage black-box model use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: with a strong understanding of the theory, one could pick up any software as
    needed
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: But in this case,
  prefs: []
  type: TYPE_NORMAL
- en: '[scikit-learn](https://scikit-learn.org/) is such a common machine learning
    package for machine learning that is very widely used'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: throughout this e-book I use scikit-learn
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: scikit-learn uses a nuts and bolts approach to build machine learning workflows
    that maximizes flexibility
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: scikit-learn provides the theory in the docs or links to original publications
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In summary, scikit-learn get me and I see the package as a partner in education!
    Thank you!
  prefs: []
  type: TYPE_NORMAL
- en: So I have decided to add this chapter focused on the methods for machine learning
    modeling with scikit-learn.
  prefs: []
  type: TYPE_NORMAL
- en: Machine Learning-based Prediction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Here’s a simple workflow, demonstration of scikit-learn training and tuning
    a machine learning model with a simple dataset.
  prefs: []
  type: TYPE_NORMAL
- en: I provide this as the most basic, minimum Python workflow to assist those learning
    predictive machine learning
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I demonstration model training and tuning (by-hand and automatically), including
    the pipeline approach
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Given the 1 predictor feature and 1 response for ease of data and model visualization
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This provides an opportunity to run and visualize a variety of machine learning
    models for experiential learning.
  prefs: []
  type: TYPE_NORMAL
- en: Machine Learning-based Prediction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We build a decision tree-based predictive machine learning models with supervised
    learning:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Prediction**'
  prefs: []
  type: TYPE_NORMAL
- en: non-parametric method for regression (continuous response) and classification
    (categorical response)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: a function \(\hat{f}\) of the nearest \(k\) training data in predictor feature
    space such that we predict a response feature \(Y\) from a set of predictor features
    \(X_1,\ldots,X_m\).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'the prediction is of the form:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: \begin{equation} \hat{Y} = \hat{f}(X_1,\ldots,X_m) + \epsilon \end{equation}
  prefs: []
  type: TYPE_NORMAL
- en: where \(\epsilon\) is an error term.
  prefs: []
  type: TYPE_NORMAL
- en: '**Supervised Learning**'
  prefs: []
  type: TYPE_NORMAL
- en: the response feature, \(Y\), is available over the training and testing data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Load the Required Libraries
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The following code loads the required libraries. These should have been installed
    with Anaconda 3.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: If you get a package import error, you may have to first install some of these
    packages. This can usually be accomplished by opening up a command window on Windows
    and then typing ‘python -m pip install [package-name]’. More assistance is available
    with the respective package docs.
  prefs: []
  type: TYPE_NORMAL
- en: Set the Random Number Seed
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'These workflows and models may use random processes, e.g.:'
  prefs: []
  type: TYPE_NORMAL
- en: random train and test split with cross validation and k-fold cross validation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: random selection of a subset of features to consider for the next split
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Declare functions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s define a function for plotting gridlines.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Set the working directory
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I always like to do this so I don’t lose files and to simplify subsequent read
    and writes (avoid including the full address each time).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: You will have to update the part in quotes with your own working directory and
    the format is different on a Mac (e.g. “~/PGE”).
  prefs: []
  type: TYPE_NORMAL
- en: Read the data table
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We use a data “1D_Porosity.csv” comma delimited file from my GitHub [GeoDataSets
    Respository](https://github.com/GeostatsGuy/GeoDataSets).
  prefs: []
  type: TYPE_NORMAL
- en: this code loads the data directly from my GitHub repository.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: if you have the data file available locally (i.e. you are not connected to the
    internet) set the working directory to the location with the data file and use
    the second line below
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Plot the Available Data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s do a simple scatter plot to check the data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/c8f68d96b92a64e674753dd321abb3376a788853f792000775c676b02927aec1.png](../Images/1185159d2aa42c7833a49ebd954a9aca.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Optional: Add Random Error to the Response Feature, \(y\)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For more experiential learning consider repeating this workflow with different
    amounts of additional error
  prefs: []
  type: TYPE_NORMAL
- en: to observe issues of model overfit consider adding some additional error,
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/db6bdae8f03df1faab8e473a6c4ac4068bec1a1c0601e89ed59590368330bf1c.png](../Images/a4f6a9c8841781db06c62d6cdf546dde.png)'
  prefs: []
  type: TYPE_IMG
- en: Fast Forward Through Data Analytics
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This workflow is focussed on building predictive machine learning models
  prefs: []
  type: TYPE_NORMAL
- en: for brevity we skip data checking, data analytics, statistical analysis, feature
    transformations etc.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: we skip all the way to model building
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: we don’t even discuss model selection, feature selection, nor robust hyperparameter
    tuning
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This is the most simple predictive machine learning workflow possible!
  prefs: []
  type: TYPE_NORMAL
- en: basics for machine learning with scikit-learn in Python. Nothing more.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let’s Build a Predictive Machine Learning Model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We use the following steps to build our model
  prefs: []
  type: TYPE_NORMAL
- en: '**instantiate** the machine learning model with hyperparameters'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**fit**, train the machine learing model to the training data'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**predict**, check the trained machine learning models to predict at withheld
    testing data'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**select** the optimum hyperparameters, hyperparameter tuning'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**refit** the model by training with all data given the tuned hyperparmaeters'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We will use the train - test approach, an alternative is the train, validate
    and test approach.
  prefs: []
  type: TYPE_NORMAL
- en: we will start simple and cover k-fold cross validation and scikit-learn pipeline
    class later
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Split Train and Test
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We will demonstrate the following hyperparameter tuning methods:'
  prefs: []
  type: TYPE_NORMAL
- en: '**cross validation** - split 25% of data as withheld testing data, only 25%
    of data are tested'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**k-fold cross validation** - calculate average error over k folds, all data
    are tested'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let’s start with cross validation and then demonstrate k-fold cross validation.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/8301051d675ae545cbd9a77b7b63baad14810e3e9f3dfd6e299fd5ce3e5cdd5c.png](../Images/9d97f00b8d0b32eb2d7d97ab07abb605.png)'
  prefs: []
  type: TYPE_IMG
- en: Build a Decision Tree Model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s instantiate (set the hyperparameter(s)) and fit (train with training data)
    a decision tree regression model to our data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: Predict With a Decision Tree Model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now let’s make a prediction with our trained decision tree model.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/c8659b494469d1cf1349fd8143fe016473544dea1159f62300489b493236734c.png](../Images/93fe563da105e7191b40024dad8586f5.png)'
  prefs: []
  type: TYPE_IMG
- en: Predict Over a Range of Predictor Feature Values with a Decision Tree Model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now, let’s make predictions over a range of predictor feature values so we can
    visualize the model.
  prefs: []
  type: TYPE_NORMAL
- en: this is easy to do since we have just 1 predictor feature
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/3a5c6ea1ec85203a0f15c3d46ae86783757808f467cadc500454f9c887228fe0.png](../Images/29e1a12c1961942e61997bd3ac0110ca.png)'
  prefs: []
  type: TYPE_IMG
- en: Changing the Model Hyperparameter(s)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s try changing the model complexity and refitting the model.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/d3b73736375ae3ab790c7b21e2c4c20d28ebdffc2556a99912efb733b3fd7d82.png](../Images/32ce25273cb95be1bc73a931d2300783.png)'
  prefs: []
  type: TYPE_IMG
- en: Tuning the Model Hyperparameter(s)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To tune the model hyperparameters we need a metric to summarize model error
    over the withheld testing data
  prefs: []
  type: TYPE_NORMAL
- en: let’s predict at the testing data and calculate our metric, testing mean square
    error.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: and we need to rebuild the model with a variable level of complexity
  prefs: []
  type: TYPE_NORMAL
- en: let’s loop over the number of leaf nodes and plot the performance over the withheld
    testing data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/d93257b45568bdd5ca8115c16b6ffab50c3eeae024f20178c1f5b9fc272cb45f.png](../Images/e07a293a3a9e2bf5b198ec8e220f17b1.png)'
  prefs: []
  type: TYPE_IMG
- en: For a more robust assessment of performance let’s use scikit-learns k-fold cross
    validation.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/c0edb899e876f1ebd639ac3d6c4eb5b5a9fe13138c12076aa8086978cb7789bc.png](../Images/93663d34dc6ae7a4b909718efe41cf18.png)'
  prefs: []
  type: TYPE_IMG
- en: The main product from all of the previous work is the tuned hyperparameter,
    the optimum model complexity.
  prefs: []
  type: TYPE_NORMAL
- en: now we refit the tuned model, train the model on all the data and our tuned
    model is ready for real-world use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: once again we are assuming a train and test workflow, not a train, validate
    and test workflow
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/a69faa8f42377a8d0bc8f93c7f2b21baf60c67eb5e475c3ade5d40904f40b23c.png](../Images/7f70bf1f19953f869e52080eed2cf1f7.png)'
  prefs: []
  type: TYPE_IMG
- en: Complete Workflow with Pipelines
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Let’s repeat the above workflow with a pipline from scikit-learn. Here some
    general comments:'
  prefs: []
  type: TYPE_NORMAL
- en: '**pipeline workflow steps** - list of steps, custom labels and the associated
    scikit-learn classes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**choices and hyperparameters** - as a dictionary with combined step custom
    labels and hyperparameter names'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**workflow scenarios** - we can specify lists of choices and hyperparameters'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**consistent iteration** - the entire workflow is repeated for the full combinatorial'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**best model selected** - best combination of model hyperparameters and choices
    are refit with all data'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: Comments
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This was a very simple demonstration of predictive machine learning model building
    with Python’s scikit-learn.
  prefs: []
  type: TYPE_NORMAL
- en: this is a basic introduction, much more could be done
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I hope this was helpful,
  prefs: []
  type: TYPE_NORMAL
- en: '*Michael*'
  prefs: []
  type: TYPE_NORMAL
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, The Hildebrand Department of Petroleum
    and Geosystems Engineering, Bureau of Economic Geology, The Jackson School of
    Geosciences, The University of Texas at Austin On twitter I’m the @GeostatsGuy.
  prefs: []
  type: TYPE_NORMAL
- en: About the Author
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
  prefs: []
  type: TYPE_IMG
- en: Professor Michael Pyrcz in his office on the 40 acres, campus of The University
    of Texas at Austin.
  prefs: []
  type: TYPE_NORMAL
- en: Michael Pyrcz is a professor in the [Cockrell School of Engineering](https://cockrell.utexas.edu/faculty-directory/alphabetical/p),
    and the [Jackson School of Geosciences](https://www.jsg.utexas.edu/researcher/michael_pyrcz/),
    at [The University of Texas at Austin](https://www.utexas.edu/), where he researches
    and teaches subsurface, spatial data analytics, geostatistics, and machine learning.
    Michael is also,
  prefs: []
  type: TYPE_NORMAL
- en: the principal investigator of the [Energy Analytics](https://fri.cns.utexas.edu/energy-analytics)
    freshmen research initiative and a core faculty in the Machine Learn Laboratory
    in the College of Natural Sciences, The University of Texas at Austin
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: an associate editor for [Computers and Geosciences](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board),
    and a board member for [Mathematical Geosciences](https://link.springer.com/journal/11004/editorial-board),
    the International Association for Mathematical Geosciences.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Michael has written over 70 [peer-reviewed publications](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en),
    a [Python package](https://pypi.org/project/geostatspy/) for spatial data analytics,
    co-authored a textbook on spatial data analytics, [Geostatistical Reservoir Modeling](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    and author of two recently released e-books, [Applied Geostatistics in Python:
    a Hands-on Guide with GeostatsPy](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    and [Applied Machine Learning in Python: a Hands-on Guide with Code](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html).'
  prefs: []
  type: TYPE_NORMAL
- en: All of Michael’s university lectures are available on his [YouTube Channel](https://www.youtube.com/@GeostatsGuyLectures)
    with links to 100s of Python interactive dashboards and well-documented workflows
    in over 40 repositories on his [GitHub account](https://github.com/GeostatsGuy),
    to support any interested students and working professionals with evergreen content.
    To find out more about Michael’s work and shared educational resources visit his
    Website.
  prefs: []
  type: TYPE_NORMAL
- en: Want to Work Together?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I hope this content is helpful to those that want to learn more about subsurface
    modeling, data analytics and machine learning. Students and working professionals
    are welcome to participate.
  prefs: []
  type: TYPE_NORMAL
- en: Want to invite me to visit your company for training, mentoring, project review,
    workflow design and / or consulting? I’d be happy to drop by and work with you!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Interested in partnering, supporting my graduate student research or my Subsurface
    Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)?
    My research combines data analytics, stochastic modeling and machine learning
    theory with practice to develop novel methods and workflows to add value. We are
    solving challenging subsurface problems!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I can be reached at [mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I’m always happy to discuss,
  prefs: []
  type: TYPE_NORMAL
- en: '*Michael*'
  prefs: []
  type: TYPE_NORMAL
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The
    Jackson School of Geosciences, The University of Texas at Austin
  prefs: []
  type: TYPE_NORMAL
- en: 'More Resources Available at: [Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  prefs: []
  type: TYPE_NORMAL
- en: Motivation for Predictive Machine Learning with scikit-learn
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This chapter is unusual for me. As a professor, I avoid lectures that focus
    on the specific tools, as I would rather teach the principles and then introduce
    the examples with the common tools. It is my opinion that,
  prefs: []
  type: TYPE_NORMAL
- en: theory will outlast any available software tools
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: without a theory focus I may encourage black-box model use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: with a strong understanding of the theory, one could pick up any software as
    needed
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: But in this case,
  prefs: []
  type: TYPE_NORMAL
- en: '[scikit-learn](https://scikit-learn.org/) is such a common machine learning
    package for machine learning that is very widely used'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: throughout this e-book I use scikit-learn
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: scikit-learn uses a nuts and bolts approach to build machine learning workflows
    that maximizes flexibility
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: scikit-learn provides the theory in the docs or links to original publications
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In summary, scikit-learn get me and I see the package as a partner in education!
    Thank you!
  prefs: []
  type: TYPE_NORMAL
- en: So I have decided to add this chapter focused on the methods for machine learning
    modeling with scikit-learn.
  prefs: []
  type: TYPE_NORMAL
- en: Machine Learning-based Prediction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Here’s a simple workflow, demonstration of scikit-learn training and tuning
    a machine learning model with a simple dataset.
  prefs: []
  type: TYPE_NORMAL
- en: I provide this as the most basic, minimum Python workflow to assist those learning
    predictive machine learning
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I demonstration model training and tuning (by-hand and automatically), including
    the pipeline approach
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Given the 1 predictor feature and 1 response for ease of data and model visualization
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This provides an opportunity to run and visualize a variety of machine learning
    models for experiential learning.
  prefs: []
  type: TYPE_NORMAL
- en: Machine Learning-based Prediction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We build a decision tree-based predictive machine learning models with supervised
    learning:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Prediction**'
  prefs: []
  type: TYPE_NORMAL
- en: non-parametric method for regression (continuous response) and classification
    (categorical response)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: a function \(\hat{f}\) of the nearest \(k\) training data in predictor feature
    space such that we predict a response feature \(Y\) from a set of predictor features
    \(X_1,\ldots,X_m\).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'the prediction is of the form:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: \begin{equation} \hat{Y} = \hat{f}(X_1,\ldots,X_m) + \epsilon \end{equation}
  prefs: []
  type: TYPE_NORMAL
- en: where \(\epsilon\) is an error term.
  prefs: []
  type: TYPE_NORMAL
- en: '**Supervised Learning**'
  prefs: []
  type: TYPE_NORMAL
- en: the response feature, \(Y\), is available over the training and testing data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Load the Required Libraries
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The following code loads the required libraries. These should have been installed
    with Anaconda 3.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: If you get a package import error, you may have to first install some of these
    packages. This can usually be accomplished by opening up a command window on Windows
    and then typing ‘python -m pip install [package-name]’. More assistance is available
    with the respective package docs.
  prefs: []
  type: TYPE_NORMAL
- en: Set the Random Number Seed
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'These workflows and models may use random processes, e.g.:'
  prefs: []
  type: TYPE_NORMAL
- en: random train and test split with cross validation and k-fold cross validation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: random selection of a subset of features to consider for the next split
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: Declare functions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s define a function for plotting gridlines.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: Set the working directory
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I always like to do this so I don’t lose files and to simplify subsequent read
    and writes (avoid including the full address each time).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: You will have to update the part in quotes with your own working directory and
    the format is different on a Mac (e.g. “~/PGE”).
  prefs: []
  type: TYPE_NORMAL
- en: Read the data table
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We use a data “1D_Porosity.csv” comma delimited file from my GitHub [GeoDataSets
    Respository](https://github.com/GeostatsGuy/GeoDataSets).
  prefs: []
  type: TYPE_NORMAL
- en: this code loads the data directly from my GitHub repository.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: if you have the data file available locally (i.e. you are not connected to the
    internet) set the working directory to the location with the data file and use
    the second line below
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: Plot the Available Data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s do a simple scatter plot to check the data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/c8f68d96b92a64e674753dd321abb3376a788853f792000775c676b02927aec1.png](../Images/1185159d2aa42c7833a49ebd954a9aca.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Optional: Add Random Error to the Response Feature, \(y\)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For more experiential learning consider repeating this workflow with different
    amounts of additional error
  prefs: []
  type: TYPE_NORMAL
- en: to observe issues of model overfit consider adding some additional error,
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/db6bdae8f03df1faab8e473a6c4ac4068bec1a1c0601e89ed59590368330bf1c.png](../Images/a4f6a9c8841781db06c62d6cdf546dde.png)'
  prefs: []
  type: TYPE_IMG
- en: Fast Forward Through Data Analytics
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This workflow is focussed on building predictive machine learning models
  prefs: []
  type: TYPE_NORMAL
- en: for brevity we skip data checking, data analytics, statistical analysis, feature
    transformations etc.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: we skip all the way to model building
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: we don’t even discuss model selection, feature selection, nor robust hyperparameter
    tuning
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This is the most simple predictive machine learning workflow possible!
  prefs: []
  type: TYPE_NORMAL
- en: basics for machine learning with scikit-learn in Python. Nothing more.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let’s Build a Predictive Machine Learning Model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We use the following steps to build our model
  prefs: []
  type: TYPE_NORMAL
- en: '**instantiate** the machine learning model with hyperparameters'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**fit**, train the machine learing model to the training data'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**predict**, check the trained machine learning models to predict at withheld
    testing data'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**select** the optimum hyperparameters, hyperparameter tuning'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**refit** the model by training with all data given the tuned hyperparmaeters'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We will use the train - test approach, an alternative is the train, validate
    and test approach.
  prefs: []
  type: TYPE_NORMAL
- en: we will start simple and cover k-fold cross validation and scikit-learn pipeline
    class later
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Split Train and Test
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We will demonstrate the following hyperparameter tuning methods:'
  prefs: []
  type: TYPE_NORMAL
- en: '**cross validation** - split 25% of data as withheld testing data, only 25%
    of data are tested'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**k-fold cross validation** - calculate average error over k folds, all data
    are tested'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let’s start with cross validation and then demonstrate k-fold cross validation.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/8301051d675ae545cbd9a77b7b63baad14810e3e9f3dfd6e299fd5ce3e5cdd5c.png](../Images/9d97f00b8d0b32eb2d7d97ab07abb605.png)'
  prefs: []
  type: TYPE_IMG
- en: Build a Decision Tree Model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s instantiate (set the hyperparameter(s)) and fit (train with training data)
    a decision tree regression model to our data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: Predict With a Decision Tree Model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now let’s make a prediction with our trained decision tree model.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/c8659b494469d1cf1349fd8143fe016473544dea1159f62300489b493236734c.png](../Images/93fe563da105e7191b40024dad8586f5.png)'
  prefs: []
  type: TYPE_IMG
- en: Predict Over a Range of Predictor Feature Values with a Decision Tree Model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now, let’s make predictions over a range of predictor feature values so we can
    visualize the model.
  prefs: []
  type: TYPE_NORMAL
- en: this is easy to do since we have just 1 predictor feature
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/3a5c6ea1ec85203a0f15c3d46ae86783757808f467cadc500454f9c887228fe0.png](../Images/29e1a12c1961942e61997bd3ac0110ca.png)'
  prefs: []
  type: TYPE_IMG
- en: Changing the Model Hyperparameter(s)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s try changing the model complexity and refitting the model.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/d3b73736375ae3ab790c7b21e2c4c20d28ebdffc2556a99912efb733b3fd7d82.png](../Images/32ce25273cb95be1bc73a931d2300783.png)'
  prefs: []
  type: TYPE_IMG
- en: Tuning the Model Hyperparameter(s)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To tune the model hyperparameters we need a metric to summarize model error
    over the withheld testing data
  prefs: []
  type: TYPE_NORMAL
- en: let’s predict at the testing data and calculate our metric, testing mean square
    error.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE35]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE36]'
  prefs: []
  type: TYPE_PRE
- en: and we need to rebuild the model with a variable level of complexity
  prefs: []
  type: TYPE_NORMAL
- en: let’s loop over the number of leaf nodes and plot the performance over the withheld
    testing data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE37]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/d93257b45568bdd5ca8115c16b6ffab50c3eeae024f20178c1f5b9fc272cb45f.png](../Images/e07a293a3a9e2bf5b198ec8e220f17b1.png)'
  prefs: []
  type: TYPE_IMG
- en: For a more robust assessment of performance let’s use scikit-learns k-fold cross
    validation.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE38]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/c0edb899e876f1ebd639ac3d6c4eb5b5a9fe13138c12076aa8086978cb7789bc.png](../Images/93663d34dc6ae7a4b909718efe41cf18.png)'
  prefs: []
  type: TYPE_IMG
- en: The main product from all of the previous work is the tuned hyperparameter,
    the optimum model complexity.
  prefs: []
  type: TYPE_NORMAL
- en: now we refit the tuned model, train the model on all the data and our tuned
    model is ready for real-world use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: once again we are assuming a train and test workflow, not a train, validate
    and test workflow
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE39]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/a69faa8f42377a8d0bc8f93c7f2b21baf60c67eb5e475c3ade5d40904f40b23c.png](../Images/7f70bf1f19953f869e52080eed2cf1f7.png)'
  prefs: []
  type: TYPE_IMG
- en: Complete Workflow with Pipelines
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Let’s repeat the above workflow with a pipline from scikit-learn. Here some
    general comments:'
  prefs: []
  type: TYPE_NORMAL
- en: '**pipeline workflow steps** - list of steps, custom labels and the associated
    scikit-learn classes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**choices and hyperparameters** - as a dictionary with combined step custom
    labels and hyperparameter names'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**workflow scenarios** - we can specify lists of choices and hyperparameters'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**consistent iteration** - the entire workflow is repeated for the full combinatorial'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**best model selected** - best combination of model hyperparameters and choices
    are refit with all data'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE40]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE41]'
  prefs: []
  type: TYPE_PRE
- en: Comments
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This was a very simple demonstration of predictive machine learning model building
    with Python’s scikit-learn.
  prefs: []
  type: TYPE_NORMAL
- en: this is a basic introduction, much more could be done
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I hope this was helpful,
  prefs: []
  type: TYPE_NORMAL
- en: '*Michael*'
  prefs: []
  type: TYPE_NORMAL
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, The Hildebrand Department of Petroleum
    and Geosystems Engineering, Bureau of Economic Geology, The Jackson School of
    Geosciences, The University of Texas at Austin On twitter I’m the @GeostatsGuy.
  prefs: []
  type: TYPE_NORMAL
- en: About the Author
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
  prefs: []
  type: TYPE_IMG
- en: Professor Michael Pyrcz in his office on the 40 acres, campus of The University
    of Texas at Austin.
  prefs: []
  type: TYPE_NORMAL
- en: Michael Pyrcz is a professor in the [Cockrell School of Engineering](https://cockrell.utexas.edu/faculty-directory/alphabetical/p),
    and the [Jackson School of Geosciences](https://www.jsg.utexas.edu/researcher/michael_pyrcz/),
    at [The University of Texas at Austin](https://www.utexas.edu/), where he researches
    and teaches subsurface, spatial data analytics, geostatistics, and machine learning.
    Michael is also,
  prefs: []
  type: TYPE_NORMAL
- en: the principal investigator of the [Energy Analytics](https://fri.cns.utexas.edu/energy-analytics)
    freshmen research initiative and a core faculty in the Machine Learn Laboratory
    in the College of Natural Sciences, The University of Texas at Austin
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: an associate editor for [Computers and Geosciences](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board),
    and a board member for [Mathematical Geosciences](https://link.springer.com/journal/11004/editorial-board),
    the International Association for Mathematical Geosciences.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Michael has written over 70 [peer-reviewed publications](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en),
    a [Python package](https://pypi.org/project/geostatspy/) for spatial data analytics,
    co-authored a textbook on spatial data analytics, [Geostatistical Reservoir Modeling](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    and author of two recently released e-books, [Applied Geostatistics in Python:
    a Hands-on Guide with GeostatsPy](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    and [Applied Machine Learning in Python: a Hands-on Guide with Code](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html).'
  prefs: []
  type: TYPE_NORMAL
- en: All of Michael’s university lectures are available on his [YouTube Channel](https://www.youtube.com/@GeostatsGuyLectures)
    with links to 100s of Python interactive dashboards and well-documented workflows
    in over 40 repositories on his [GitHub account](https://github.com/GeostatsGuy),
    to support any interested students and working professionals with evergreen content.
    To find out more about Michael’s work and shared educational resources visit his
    Website.
  prefs: []
  type: TYPE_NORMAL
- en: Want to Work Together?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I hope this content is helpful to those that want to learn more about subsurface
    modeling, data analytics and machine learning. Students and working professionals
    are welcome to participate.
  prefs: []
  type: TYPE_NORMAL
- en: Want to invite me to visit your company for training, mentoring, project review,
    workflow design and / or consulting? I’d be happy to drop by and work with you!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Interested in partnering, supporting my graduate student research or my Subsurface
    Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)?
    My research combines data analytics, stochastic modeling and machine learning
    theory with practice to develop novel methods and workflows to add value. We are
    solving challenging subsurface problems!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I can be reached at [mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I’m always happy to discuss,
  prefs: []
  type: TYPE_NORMAL
- en: '*Michael*'
  prefs: []
  type: TYPE_NORMAL
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The
    Jackson School of Geosciences, The University of Texas at Austin
  prefs: []
  type: TYPE_NORMAL
- en: 'More Resources Available at: [Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  prefs: []
  type: TYPE_NORMAL
