- en: Ticket ids
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://rust-exercises.com/100-exercises/06_ticket_management/12_two_states.html](https://rust-exercises.com/100-exercises/06_ticket_management/12_two_states.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Let's think again about our ticket management system.
  prefs: []
  type: TYPE_NORMAL
- en: 'Our ticket model right now looks like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'One thing is missing here: an **identifier** to uniquely identify a ticket.'
  prefs: []
  type: TYPE_NORMAL
- en: That identifier should be unique for each ticket. That can be guaranteed by
    generating it automatically when a new ticket is created.
  prefs: []
  type: TYPE_NORMAL
- en: '[Refining the model](#refining-the-model)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Where should the id be stored?
  prefs: []
  type: TYPE_NORMAL
- en: 'We could add a new field to the `Ticket` struct:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: But we don't know the id before creating the ticket. So it can't be there from
    the get-go.
  prefs: []
  type: TYPE_NORMAL
- en: 'It''d have to be optional:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: That's also not ideal—we'd have to handle the `None` case every single time
    we retrieve a ticket from the store, even though we know that the id should always
    be there once the ticket has been created.
  prefs: []
  type: TYPE_NORMAL
- en: 'The best solution is to have two different ticket **states**, represented by
    two separate types: a `TicketDraft` and a `Ticket`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: A `TicketDraft` is a ticket that hasn't been created yet. It doesn't have an
    id, and it doesn't have a status.
  prefs: []
  type: TYPE_NORMAL
- en: A `Ticket` is a ticket that has been created. It has an id and a status.
  prefs: []
  type: TYPE_NORMAL
- en: Since each field in `TicketDraft` and `Ticket` embeds its own constraints, we
    don't have to duplicate logic across the two types.
  prefs: []
  type: TYPE_NORMAL
- en: '[Exercise](#exercise)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The exercise for this section is located in [`06_ticket_management/12_two_states`](https://github.com/mainmatter/100-exercises-to-learn-rust/tree/main/exercises/06_ticket_management/12_two_states)
  prefs: []
  type: TYPE_NORMAL
