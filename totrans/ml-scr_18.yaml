- en: Construction
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建过程
- en: 原文：[https://dafriedman97.github.io/mlbook/content/c4/construction.html](https://dafriedman97.github.io/mlbook/content/c4/construction.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://dafriedman97.github.io/mlbook/content/c4/construction.html](https://dafriedman97.github.io/mlbook/content/c4/construction.html)
- en: In this section, we build LDA, QDA, and Naive Bayes classifiers. We will demo
    these classes on the [wine](../appendix/data.html) dataset.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们构建LDA、QDA和朴素贝叶斯分类器。我们将在[wine](../appendix/data.html)数据集上演示这些类别。
- en: '[PRE0]'
  id: totrans-3
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: LDA
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: LDA
- en: An implementation of linear discriminant analysis (LDA) is given below. The
    main method is `.fit()`. This method makes three important estimates. For each
    \(k\), we estimate \(\pi_k\), the class prior probability. For each class we also
    estimate the mean of the data in that class, \(\bmu_k\). Finally, we estimate
    the overall covariance matrix across classes, \(\bSigma\). The formulas for these
    estimates are detailed in the [concept section](concept.html).
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 下面给出了线性判别分析（LDA）的实现。主要方法是`.fit()`。此方法进行三个重要的估计。对于每个\(k\)，我们估计\(\pi_k\)，即该类的先验概率。对于每个类别，我们也估计该类数据的均值\(\bmu_k\)。最后，我们估计跨类别的总体协方差矩阵\(\bSigma\)。这些估计的公式在[概念部分](concept.html)中详细说明。
- en: The second two methods, `.mvn_density()` and `.classify()` are for classifying
    new observations. `.mvn_density()` just calculates the density (up to a multiplicative
    constant) of a Multivariate Normal sample provided the mean vector and covariance
    matrix. `.classify()` actually makes the classifications for each test observation.
    It calculates the density for each class, \(p(\bx_n|Y_n = k)\), and multiplies
    this by the prior class probability, \(p(Y_n = k) = \pi_k\), to get a posterior
    class probability, \(p(Y_n = k|\bx_n)\). It then predicts the class with the highest
    posterior probability.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 第二种和第三种方法，`.mvn_density()`和`.classify()`，用于对新观察值进行分类。`.mvn_density()`仅计算给定均值向量和协方差矩阵的多变量正态样本的密度（乘以一个常数）。`.classify()`实际上对每个测试观察值进行分类。它计算每个类别的密度，\(p(\bx_n|Y_n
    = k)\)，并将其乘以先验类别概率，\(p(Y_n = k) = \pi_k\)，以得到后验类别概率，\(p(Y_n = k|\bx_n)\)。然后它预测具有最高后验概率的类别。
- en: '[PRE1]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: We fit the LDA model below and classify the training observations. As the output
    shows, we have 100% training accuracy.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 我们拟合了下面的LDA模型并对训练观察值进行了分类。如输出所示，我们达到了100%的训练准确率。
- en: '[PRE2]'
  id: totrans-9
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[PRE3]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The function below visualizes class predictions based on the input values for
    a model with \(\bx_n \in \mathbb{R}^2\). To apply this function, we build a model
    with only two columns from the `wine` dataset. We see that the decision boundaries
    are linear, as we expect from LDA.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的函数根据模型的输入值可视化类别预测，其中\(\bx_n \in \mathbb{R}^2\)。要应用此函数，我们从`wine`数据集中构建一个只有两列的模型。我们看到决策边界是线性的，正如我们期望从LDA中得到的。
- en: '[PRE4]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![../../_images/construction_10_01.png](../Images/1b9a79d08f7ecd7c4c1585a85c6f1451.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/construction_10_01.png](../Images/1b9a79d08f7ecd7c4c1585a85c6f1451.png)'
- en: QDA
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: QDA
- en: The QDA model is implemented below. It is nearly identical to LDA except the
    covariance matrices \(\bSigma_k\) are estimated separately. Again see the [concept
    section](concept.html) for details.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的QDA模型实现了。它与LDA几乎相同，除了协方差矩阵\(\bSigma_k\)是分别估计的。有关详细信息，请参阅[概念部分](concept.html)。
- en: '[PRE6]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[PRE8]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: The below plot shows predictions based on the input variables for the QDA model.
    As expected, the decision boundaries are quadratic, rather than linear. We also
    see that the area corresponding to class 2 is much smaller than the other areas.
    This suggests that either there were fewer observations in class 2 or the estimated
    variance of the input variables for observations in class 2 was smaller than the
    variance for observations in other classes .
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的图显示了基于QDA模型的输入变量的预测。正如预期的那样，决策边界是二次的，而不是线性的。我们还看到，对应于类别2的区域比其他区域小得多。这表明，要么类别2中的观察值较少，要么类别2中观察值的输入变量的估计方差小于其他类别的方差。
- en: '[PRE9]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![../../_images/construction_16_0.png](../Images/63bf0542bf9b24c488c87783a168325e.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/construction_16_0.png](../Images/63bf0542bf9b24c488c87783a168325e.png)'
- en: Naive Bayes
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 朴素贝叶斯
- en: Finally, we implement a Naive Bayes model below. This model allows us to assign
    each variable in our dataset a distribution, though by default they are all assumed
    to be Normal. Since each variable has its own distribution, estimating the model’s
    parameters is more involved. For each variable and each class, we estimate the
    parameters separately through the `_estimate_class_parameters`. The structure
    below allows for Normal, Bernoulli, and Poisson distributions, though any distribution
    could be implemented.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们在下面实现了一个朴素贝叶斯模型。此模型允许我们为数据集中的每个变量分配一个分布，尽管默认情况下它们都被假定为正态分布。由于每个变量都有自己的分布，因此估计模型参数更为复杂。对于每个变量和每个类别，我们通过
    `_estimate_class_parameters` 分别估计参数。下面的结构允许使用正态、伯努利和泊松分布，尽管可以实现任何分布。
- en: Again, we make predictions by calculating \(p(Y_n = k|\bx_n)\) for \(k = 1,
    \dots, K\) through Bayes’ rule and predicting the class with the highest posterior
    probability. Since each variable can have its own distribution, this problem is
    also more involved. The `_get_class_probability` method calculates the probability
    density of a test observation’s input variables. By the conditional independence
    assumption, this is just the product of the individual densities.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，我们通过计算 \(p(Y_n = k|\bx_n)\) 对于 \(k = 1, \dots, K\) 通过贝叶斯规则，并预测具有最高后验概率的类别来进行预测。由于每个变量可以有自己的分布，这个问题也更复杂。`_get_class_probability`
    方法计算测试观察值的输入变量的概率密度。根据条件独立性假设，这仅仅是单个密度的乘积。
- en: Naive Bayes performs worse than LDA or QDA on the training data, suggesting
    the conditional independence assumption might be inappropriate for this problem.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 朴素贝叶斯在训练数据上的表现不如LDA或QDA，这表明条件独立性假设可能不适合这个问题。
- en: '[PRE10]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![../../_images/construction_21_0.png](../Images/da28caee5bf852f6f58e41ce46c77e22.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/construction_21_0.png](../Images/da28caee5bf852f6f58e41ce46c77e22.png)'
- en: LDA
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: LDA
- en: An implementation of linear discriminant analysis (LDA) is given below. The
    main method is `.fit()`. This method makes three important estimates. For each
    \(k\), we estimate \(\pi_k\), the class prior probability. For each class we also
    estimate the mean of the data in that class, \(\bmu_k\). Finally, we estimate
    the overall covariance matrix across classes, \(\bSigma\). The formulas for these
    estimates are detailed in the [concept section](concept.html).
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 以下给出了线性判别分析（LDA）的实现。主要方法是 `.fit()`。此方法进行三个重要的估计。对于每个 \(k\)，我们估计 \(\pi_k\)，即该类的先验概率。对于每个类别，我们也估计该类中数据的均值，\(\bmu_k\)。最后，我们估计跨类别的总体协方差矩阵，\(\bSigma\)。这些估计的公式在[概念部分](concept.html)中详细说明。
- en: The second two methods, `.mvn_density()` and `.classify()` are for classifying
    new observations. `.mvn_density()` just calculates the density (up to a multiplicative
    constant) of a Multivariate Normal sample provided the mean vector and covariance
    matrix. `.classify()` actually makes the classifications for each test observation.
    It calculates the density for each class, \(p(\bx_n|Y_n = k)\), and multiplies
    this by the prior class probability, \(p(Y_n = k) = \pi_k\), to get a posterior
    class probability, \(p(Y_n = k|\bx_n)\). It then predicts the class with the highest
    posterior probability.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 后两个方法，`.mvn_density()` 和 `.classify()`，用于对新观察值进行分类。`.mvn_density()` 仅计算给定均值向量和协方差矩阵的多变量正态样本的密度（乘以一个乘数常数）。`.classify()`
    实际上对每个测试观察值进行分类。它计算每个类别的密度 \(p(\bx_n|Y_n = k)\)，并将其乘以先验类别概率 \(p(Y_n = k) = \pi_k\)，以得到后验类别概率
    \(p(Y_n = k|\bx_n)\)。然后它预测具有最高后验概率的类别。
- en: '[PRE14]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: We fit the LDA model below and classify the training observations. As the output
    shows, we have 100% training accuracy.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在下面拟合了LDA模型并对训练观察值进行了分类。如图所示，我们达到了100%的训练准确率。
- en: '[PRE15]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: The function below visualizes class predictions based on the input values for
    a model with \(\bx_n \in \mathbb{R}^2\). To apply this function, we build a model
    with only two columns from the `wine` dataset. We see that the decision boundaries
    are linear, as we expect from LDA.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的函数根据输入值可视化具有 \(\bx_n \in \mathbb{R}^2\) 的模型的类别预测。要应用此函数，我们从 `wine` 数据集中仅构建两个列的模型。我们看到决策边界是线性的，正如我们期望的LDA那样。
- en: '[PRE17]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![../../_images/construction_10_01.png](../Images/1b9a79d08f7ecd7c4c1585a85c6f1451.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/construction_10_01.png](../Images/1b9a79d08f7ecd7c4c1585a85c6f1451.png)'
- en: QDA
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: QDA
- en: The QDA model is implemented below. It is nearly identical to LDA except the
    covariance matrices \(\bSigma_k\) are estimated separately. Again see the [concept
    section](concept.html) for details.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的QDA模型实现。它与LDA几乎相同，除了协方差矩阵 \(\bSigma_k\) 是分别估计的。有关详细信息，请参阅[概念部分](concept.html)。
- en: '[PRE19]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '[PRE20]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '[PRE21]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: The below plot shows predictions based on the input variables for the QDA model.
    As expected, the decision boundaries are quadratic, rather than linear. We also
    see that the area corresponding to class 2 is much smaller than the other areas.
    This suggests that either there were fewer observations in class 2 or the estimated
    variance of the input variables for observations in class 2 was smaller than the
    variance for observations in other classes .
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的图表显示了基于输入变量的 QDA 模型的预测结果。正如预期的那样，决策边界是二次的，而不是线性的。我们还看到，对应于类别 2 的区域比其他区域小得多。这表明，要么类别
    2 中的观察值较少，要么类别 2 中观察值的输入变量的估计方差小于其他类别的方差。
- en: '[PRE22]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '![../../_images/construction_16_0.png](../Images/63bf0542bf9b24c488c87783a168325e.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/construction_16_0.png](../Images/63bf0542bf9b24c488c87783a168325e.png)'
- en: Naive Bayes
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 简单贝叶斯
- en: Finally, we implement a Naive Bayes model below. This model allows us to assign
    each variable in our dataset a distribution, though by default they are all assumed
    to be Normal. Since each variable has its own distribution, estimating the model’s
    parameters is more involved. For each variable and each class, we estimate the
    parameters separately through the `_estimate_class_parameters`. The structure
    below allows for Normal, Bernoulli, and Poisson distributions, though any distribution
    could be implemented.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们在下面实现了一个简单贝叶斯模型。这个模型允许我们为数据集中的每个变量分配一个分布，尽管默认情况下它们都被假定为正态分布。由于每个变量都有自己的分布，因此估计模型参数更加复杂。对于每个变量和每个类别，我们通过
    `_estimate_class_parameters` 方法分别估计参数。下面的结构允许实现正态、伯努利和泊松分布，尽管可以实现任何分布。
- en: Again, we make predictions by calculating \(p(Y_n = k|\bx_n)\) for \(k = 1,
    \dots, K\) through Bayes’ rule and predicting the class with the highest posterior
    probability. Since each variable can have its own distribution, this problem is
    also more involved. The `_get_class_probability` method calculates the probability
    density of a test observation’s input variables. By the conditional independence
    assumption, this is just the product of the individual densities.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，我们通过计算 \(p(Y_n = k|\bx_n)\) 来进行预测，其中 \(k = 1, \dots, K\)，这是通过贝叶斯定理来预测具有最高后验概率的类别。由于每个变量可以有自己的分布，因此这个问题也更加复杂。`_get_class_probability`
    方法计算测试观察值的输入变量的概率密度。根据条件独立性假设，这仅仅是各个密度的乘积。
- en: Naive Bayes performs worse than LDA or QDA on the training data, suggesting
    the conditional independence assumption might be inappropriate for this problem.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 简单贝叶斯在训练数据上的表现不如 LDA 或 QDA，这表明条件独立性假设可能不适合这个问题。
- en: '[PRE23]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[PRE24]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '[PRE25]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '[PRE26]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '![../../_images/construction_21_0.png](../Images/da28caee5bf852f6f58e41ce46c77e22.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/construction_21_0.png](../Images/da28caee5bf852f6f58e41ce46c77e22.png)'
