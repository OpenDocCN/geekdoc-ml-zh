- en: Implementation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://dafriedman97.github.io/mlbook/content/c5/code.html](https://dafriedman97.github.io/mlbook/content/c5/code.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: This section demonstrates how to fit regression and decision trees with `scikit-learn`.
    We will again use the [tips](../appendix/data.html) dataset for the regression
    tree and the [penguins](../appendix/data.html) dataset for the classification
    tree.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 1\. Regression Tree
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s start by loading in the data. We’ll keep things as `pandas` dataframes
    rather than `numpy` arrays now.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: We can then fit the regression tree with the `DecisionTreeRegressor` class.
    Unfortunately, `scikit-learn` does not currently support categorical predictors.
    Instead, we have to first convert these predictors to dummy variables. Note that
    this implies that splits of categorical variables can only separate one value
    from the rest. For instance, a variable with discrete values \(a, b, c,\) and
    \(d\) could not be split as \(\{a, b\}\) versus \(\{c, d\}\).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/code_7_02.png](../Images/f1f8174dde1a3828250bd86b2bcf5906.png)'
  prefs: []
  type: TYPE_IMG
- en: 2\. Classification Tree
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The classification tree implementation in `scikit-learn` is nearly identical.
    The corresponding code is provided below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 1\. Regression Tree
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let’s start by loading in the data. We’ll keep things as `pandas` dataframes
    rather than `numpy` arrays now.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: We can then fit the regression tree with the `DecisionTreeRegressor` class.
    Unfortunately, `scikit-learn` does not currently support categorical predictors.
    Instead, we have to first convert these predictors to dummy variables. Note that
    this implies that splits of categorical variables can only separate one value
    from the rest. For instance, a variable with discrete values \(a, b, c,\) and
    \(d\) could not be split as \(\{a, b\}\) versus \(\{c, d\}\).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/code_7_02.png](../Images/f1f8174dde1a3828250bd86b2bcf5906.png)'
  prefs: []
  type: TYPE_IMG
- en: 2\. Classification Tree
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The classification tree implementation in `scikit-learn` is nearly identical.
    The corresponding code is provided below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
