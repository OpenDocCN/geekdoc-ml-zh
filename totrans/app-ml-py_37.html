<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Synthetic Datasets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Synthetic Datasets</h1>
<blockquote>原文：<a href="https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_datasets.html">https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_datasets.html</a></blockquote>

<p>Michael J. Pyrcz, Professor, The University of Texas at Austin</p>
<p><a class="reference external" href="https://twitter.com/geostatsguy">Twitter</a> | <a class="reference external" href="https://github.com/GeostatsGuy">GitHub</a> | <a class="reference external" href="http://michaelpyrcz.com">Website</a> | <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en&amp;oi=ao">GoogleScholar</a> | <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistics Book</a> | <a class="reference external" href="https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig">YouTube</a>  | <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostats in Python e-book</a> | <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/">Applied Machine Learning in Python e-book</a> | <a class="reference external" href="https://www.linkedin.com/in/michael-pyrcz-61a648a1">LinkedIn</a></p>
<p>Chapter of e-book “Applied Machine Learning in Python: a Hands-on Guide with Code”.</p>
<div class="remove-from-content-only admonition">
<p class="admonition-title">Cite this e-Book as:</p>
<p>Pyrcz, M.J., 2024, <em>Applied Machine Learning in Python: A Hands-on Guide with Code</em> [e-book]. Zenodo. doi:10.5281/zenodo.15169138 <a class="reference external" href="https://doi.org/10.5281/zenodo.15169138"><img alt="DOI" src="../Images/7e4ea662f44af1eae87e87ecbb962ff4.png" data-original-src="https://zenodo.org/badge/863274676.svg"/></a></p>
</div>
<p>The workflows in this book and more are available here:</p>
<div class="remove-from-content-only admonition">
<p class="admonition-title">Cite the MachineLearningDemos GitHub Repository as:</p>
<p>Pyrcz, M.J., 2024, <em>MachineLearningDemos: Python Machine Learning Demonstration Workflows Repository</em> (0.0.3) [Software]. Zenodo. DOI: 10.5281/zenodo.13835312. GitHub repository: <a class="github reference external" href="https://github.com/GeostatsGuy/MachineLearningDemos">GeostatsGuy/MachineLearningDemos</a> <a class="reference external" href="https://zenodo.org/doi/10.5281/zenodo.13835312"><img alt="DOI" src="../Images/4e3a59c17d684b06a170c4af84e0f631.png" data-original-src="https://zenodo.org/badge/862519860.svg"/></a></p>
</div>
<p>By Michael J. Pyrcz <br/>
© Copyright 2024.</p>
<p>This chapter is a summary of each of the synthetic <strong>Datasets</strong> that I constructed to be,</p>
<ul class="simple">
<li><p>used in the demonstrations in this e-book</p></li>
<li><p>available for anyone to learn data science workflows</p></li>
<li><p>benchmark and test examples for others’ data science workflows</p></li>
</ul>
<section id="motivation-for-fake-data">
<h2>Motivation for Fake Data</h2>
<p>Let me start with a confession,</p>
<ul class="simple">
<li><p>I make a lot of fake data!</p></li>
</ul>
<p>I do it all the time. In fact, I also make workflows to make fake data so that I can rapidly make a variety of new datasets fit-for-purpose of the specific model testing and educational content. But I find that often I need to defend my fake data generation habit with,</p>
<ul class="simple">
<li><p>students that are hungry to tackle real data problems</p></li>
<li><p>reviewers that are incredulous of fake data</p></li>
</ul>
<p>Why do I use fake data so much in my research and educational content?</p>
<ol class="arabic simple">
<li><p><strong>Avoid the Inference Problem</strong> - when we work with real data, we often cannot know the truth. Our subsurface data is often very limited! Perhaps we can rewind the clock and test against the newest data, or mask a region for testing our ability to estimate spatially away from data. But, we can never completely avoid the inference problem, i.e., did our model perform poorly because we used the wrong data or made the wrong model choices?</p></li>
<li><p><strong>Working in Expected Value</strong> - it is possible to be lucky, to run a proposed method on a single dataset and see great improvement vs. the established method, and then on the next run with a new dataset to see worsening! A data scientist bases their work in probability and statistics; therefore, we know that we need many replicates. We can generate an ensemble of dataset cases and then summarize model performance in expected value for greater rigor.</p></li>
<li><p><strong>Test a Wide Range of Conditions</strong> - how does your model handle data noise? redundant features? nonlinearity in the relationships between your features? sparse data? It would be quite difficult to curate a sufficient number of datasets to test the potentially wide range of modeling conditions. With fake data you can turn the dial and evaluate the impact on your model for any combination and severity of conditions, and even test your model to failure like the ‘Myth Busters’ approach.</p></li>
<li><p><strong>Tune the Data Difficulty</strong> - this follows from the previous point, but it has to do with tuning the modeling difficulty. With fake data you can give yourself perfectly ideal data with no bias, no error, great coverage and even low dimensionality. In fact, my fake data generation algorithms often starts there and then performs operations to imposed biased sampling, add measurement error, reduce coverage and even add additional features. Remember it is very easy to take perfect data and wreck it, but generally impossible to take poor data and improve it.</p></li>
<li><p><strong>Open Educational Content</strong> - I promise, I also use a lot of real data, but most of this data is not in public domain. I appreciate and respect the working professionals that take the time to obtain the approvals for my students and I to use their real data, but it would not be possible to use this data in my free, online educational content. To support my open education efforts, I need reproducible course notes; therefore, I need to be able to freely share the datasets.</p></li>
</ol>
<p>I have continued to say “fake data”, mostly for effect, because it sounds dramatic to state that, “I make fake data”. From now on I use the more formal term, “synthetic datasets”.</p>
<ul class="simple">
<li><p>rest assured, as a geostatician I’m actually quite good at making synthetic datasets with realistic, distributions, relationships and sampling.</p></li>
</ul>
</section>
<section id="general-comments-about-the-synthetic-datasets">
<h2>General Comments About the Synthetic Datasets</h2>
<p>Now I will make several comments about the synthetic datasets that I have shared. Yet, while making these statements I do not limit the type of synthetic datasets that I will add in the future.</p>
<ul class="simple">
<li><p>let me know if you have a suggestion and I will likely make some new data, recall, I love making synthetic data!</p></li>
</ul>
</section>
<section id="d-spatial-datasets">
<h2>2D Spatial Datasets</h2>
<p>In the days of modern three dimensional spatial algorithms and visualization it may be surprising that I am working with two dimensional spatial data. Why not just include a ‘z’ (<em>‘zed’</em> - shout out to my fellow Canadians) or an iz axes in the NumPy ndarray object?</p>
<ul class="simple">
<li><p>it is easy to do this. Actually, most of my GeostatsPy package that I wrote has 3D spatial methods available.</p></li>
</ul>
<p>The problem is computational complexity, and data and model visualization,</p>
<ul class="simple">
<li><p>many spatial data analytics and geostatistics methods have computational complexity with a <span class="math notranslate nohighlight">\(n_z\)</span> term, i.e., by adding a minimal number of <span class="math notranslate nohighlight">\(z\)</span> layers like 10, we increase the run time by an order of magnitude. Sure I love cool hardware, but for the purpose of education in my classrooms and around the world I would rather err on the side of very easy to run, very low computational complexity for very fast run times.</p></li>
<li><p>I’ve been in industrial VR facilities and I own a HTC Vive Pro at home. It is amazing to wander the road from Whiterun to Solitude in Skyrim (when is Elder Scrolls 6 going to be released?). I know the potential for amazing and effective 3D visualization. Yet, 3D model and data visualization with standard Anaconda packages is a bit limited, lacking flexible interactivity with the display, rotation, slicing and scaling.</p></li>
</ul>
<p>Given these considerations, I prefer 2D spatial datasets for my educational content.</p>
</section>
<section id="hybrid-stochastic-and-deterministic-models">
<h2>Hybrid Stochastic and Deterministic Models</h2>
<p>My original data science discipline is geostatistics and I have reviewed geostatistical subsurface models all over the world and they were all hybrid stochastic and deterministic models with,</p>
<ul class="simple">
<li><p>deterministic trend structures to impose nonstationarity in space or relationships between features</p></li>
<li><p>stochastic residual structures to integrate heterogeneity and noise</p></li>
</ul>
<p>My synthetic datasets use geostatistical simulation approaches to include all of these components,</p>
<ul class="simple">
<li><p>through the explicit assignment of random number seed the dataset generation process is repeatable</p></li>
</ul>
</section>
<section id="gaussian-distributions">
<h2>Gaussian Distributions</h2>
<p>I have used standard geostatistical simulation methods that assume Gaussian distributions, for example,</p>
<ul class="simple">
<li><p>sequential Gaussian simulation</p></li>
<li><p>collocated cokriging-based simulation</p></li>
<li><p>truncated Gaussian simulation</p></li>
</ul>
<p>Through the back-transformation of the global distribution or truncation we can achieve non-Gaussian global distributions, also,</p>
<ul class="simple">
<li><p>I build mixture models that combine multiple Gaussian models for more complicated distributions and relationships.</p></li>
<li><p>I scale individual features to improve skew and nonlinearity</p></li>
</ul>
<p>So while I may use Gaussian methods to generate synthetic data, my synthetic data is not limited to Gaussian distributed.</p>
</section>
<section id="what-about-images">
<h2>What About Images?</h2>
<p>Yes, I have also made a lot of training images for deep learning and multiple point simulation geostatistics. These are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/MLTrainingImages">MLTrainingImages</a></p></li>
</ul>
<div class="remove-from-content-only admonition">
<p class="admonition-title">You are welcome to cite our synthetic training image respository as:</p>
<p>Pyrcz, Michael J. and Morales, Misael M. (2023). Machine Learning Training Images Repository (1.0.0). Zenodo. <a class="reference external" href="https://doi.org/10.5281/zenodo.7702128">https://doi.org/10.5281/zenodo.7702128</a> <a class="reference external" href="https://doi.org/10.5281/zenodo.7702127"><img alt="DOI" src="../Images/d3f7da7f97ef0c3ee2127ac476fdd755.png" data-original-src="https://zenodo.org/badge/609354774.svg"/></a></p>
</div>
</section>
<section id="availability-of-the-datasets">
<h2>Availability of the Datasets</h2>
<p>All of my synthetic datasets are available in my GitHub repositories,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets">GeoDataSets</a></p></li>
</ul>
<p>with in my GitHub account,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy">GeostatsGuy</a></p></li>
</ul>
<div class="remove-from-content-only admonition">
<p class="admonition-title">You are welcome to cite my synthetic data repository as:</p>
<p>Pyrcz, M.J., 2024, <em>GeoDataSets: Synthetic Subsurface Data Repository</em>. Zenodo. doi:10.5281/zenodo.15169133 <a class="reference external" href="https://doi.org/10.5281/zenodo.5564873"><img alt="DOI" src="../Images/e5c96c99dae6eea4cae456ff92b41366.png" data-original-src="https://zenodo.org/badge/117575737.svg"/></a></p>
</div>
<p>Star the repository to help you find it again and keep checking back as I continue to update the synthetic datasets.</p>
<ul class="simple">
<li><p>I’m stoked to help with interesting and useful synthetic data.</p></li>
</ul>
</section>
<section id="available-synthetic-datasets">
<h2>Available Synthetic Datasets</h2>
<p>Here is a list of the available datasets, summarized below,</p>
<ul class="simple">
<li><p><strong>Twelve / 12</strong> - densely sampled, spatial with two facies, biased sampling and exaustive secondary data.</p></li>
<li><p><strong>Density and Porosity Well</strong> - simple 1D, 2 feature dataset with a generally linear relationship.</p></li>
<li><p><strong>Spatial Nonlinear Multivariate Sandstone Only Facies v5</strong> - porosity truth model for testing, missing component of the distribution suitable for softdata debiasing methods.</p></li>
<li><p><strong>Unconventional Multivariate v5</strong> - large number of potential features for feature selection, feature engineering and predictive machine learning model construction.</p></li>
</ul>
</section>
<section id="synthetic-data-summaries">
<h2>Synthetic Data Summaries</h2>
<p>Below I provide a summary of each dataset. This includes,</p>
<ul class="simple">
<li><p><strong>name and link</strong> to access the dataset on my GitHub account</p></li>
<li><p><strong>method</strong> to generate the data with link</p></li>
<li><p><strong>basic</strong> data display dashboard customized for each dataset</p></li>
</ul>
</section>
<section id="load-the-required-libraries">
<h2>Load the Required Libraries</h2>
<p>The following code loads the required libraries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="kn">import</span> <span class="nn">geostatspy.GSLIB</span> <span class="k">as</span> <span class="nn">GSLIB</span>                              <span class="c1"># GSLIB utilies, visualization and wrapper</span>
<span class="kn">import</span> <span class="nn">geostatspy.geostats</span> <span class="k">as</span> <span class="nn">geostats</span>                        <span class="c1"># GSLIB methods convert to Python        </span>
</pre></div>
</div>
</div>
</div>
<p>We will also need some standard packages. These should have been installed with Anaconda 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="kc">True</span>                                        <span class="c1"># ignore warnings?</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>                                            <span class="c1"># ndarrys for gridded data</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>                                           <span class="c1"># DataFrames for tabular data</span>
<span class="kn">import</span> <span class="nn">os</span>                                                     <span class="c1"># set working directory, run executables</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>                               <span class="c1"># for plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>                                      <span class="c1"># custom colorbar</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticker</span>                            <span class="c1"># custom axes</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>                      <span class="c1"># custom layout</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">AutoMinorLocator</span><span class="p">)</span> <span class="c1"># control of axes ticks</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">FuncFormatter</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>                                         <span class="c1"># advanced plotting</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">Rbf</span>                             <span class="c1"># countours that extrapolate</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>                                       <span class="c1"># summary statistics</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">convolve2d</span>                           <span class="c1"># convolution</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">import</span> <span class="nn">math</span>                                                   <span class="c1"># trig etc.</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'axes'</span><span class="p">,</span> <span class="n">axisbelow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                <span class="c1"># plot all grids below the plot elements</span>
<span class="k">if</span> <span class="n">ignore_warnings</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>                                   
    <span class="kn">import</span> <span class="nn">warnings</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">13</span>                                                     <span class="c1"># set ramdon number seed</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span>                                         <span class="c1"># default colormap</span>
</pre></div>
</div>
</div>
</div>
<p>If you get a package import error, you may have to first install some of these packages. This can usually be accomplished by opening up a command window on Windows and then typing ‘python -m pip install [package-name]’. More assistance is available with the respective package docs.</p>
</section>
<section id="declare-functions">
<h2>Declare Functions</h2>
<p>These are some conveneince functions for more readable code in our workflows.</p>
<ul class="simple">
<li><p>add major and minor gridlines</p></li>
<li><p>custom location map for sandstone and shalestone facies</p></li>
<li><p>custom histogram for sandstone and shalestone facies</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">def</span> <span class="nf">add_grid2</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="c1"># add y grids</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">7</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">());</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span> <span class="c1"># turn on minor ticks  </span>

<span class="k">def</span> <span class="nf">add_grid</span><span class="p">(</span><span class="n">sub_plot</span><span class="p">):</span>
    <span class="n">sub_plot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span> <span class="n">sub_plot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="c1"># add y grids</span>
    <span class="n">sub_plot</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">7</span><span class="p">);</span> <span class="n">sub_plot</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">sub_plot</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">());</span> <span class="n">sub_plot</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span> <span class="c1"># turn on minor ticks</span>

<span class="k">def</span> <span class="nf">locmap_facies</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">,</span><span class="n">vcol</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">xlabel</span><span class="p">,</span><span class="n">ylabel</span><span class="p">,</span><span class="n">vlabel</span><span class="p">,</span><span class="n">cmap</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">xcol</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="n">ycol</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">vcol</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">edgecolors</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">'</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">'</span><span class="p">))</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"vertical"</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">vlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">'Shale'</span><span class="p">,</span> <span class="s1">'Sand'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">hist_sand_shale</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">vcol</span><span class="p">,</span><span class="n">title</span><span class="p">):</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">vcol</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
    <span class="n">patches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'grey'</span><span class="p">);</span> <span class="n">patches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'gold'</span><span class="p">)</span> <span class="c1"># Set custom colors for each bar</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">'Shalestone'</span><span class="p">,</span> <span class="s1">'Sandstone'</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Frequency'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">AutoMinorLocator</span><span class="p">());</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">'-'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">'-'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_formatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">type</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">'small'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">'large'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">'int'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">'one'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-custom-colorbar">
<h2>Make Custom Colorbar</h2>
<p>We make this colorbar to display our categorical, sand and shale facies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">cmap_facies</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">'grey'</span><span class="p">,</span><span class="s1">'gold'</span><span class="p">])</span>
<span class="n">cmap_facies</span><span class="o">.</span><span class="n">set_over</span><span class="p">(</span><span class="s1">'white'</span><span class="p">);</span> <span class="n">cmap_facies</span><span class="o">.</span><span class="n">set_under</span><span class="p">(</span><span class="s1">'white'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataset-twelve-12">
<h2>Dataset: Twelve / 12</h2>
<p>Twelve (12) is a densely sampled, multivariate, spatial conventional hydrocarbon dataset with large sandstone and shale facies and continuous porosity, permeability and acoustic impedance between facies.</p>
<p><strong>Highlights</strong> - densely sampled, spatial with two facies, biased sampling and exhaustive secondary data.</p>
<p>‘12’ is a spatial multivariate dataset with,</p>
<ul class="simple">
<li><p>multivariate sparse sample data,</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>X</p></td>
<td class="text-center"><p>X</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>x coordinate</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Y</p></td>
<td class="text-center"><p>Y</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>y coordinate</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Facies</p></td>
<td class="text-center"><p>Facies</p></td>
<td class="text-center"><p>indicator</p></td>
<td><p>0 = shalestone, 1 = sandstone</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>effective porosity</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Permeability</p></td>
<td class="text-center"><p>Perm</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(mD\)</span></p></td>
<td><p>isotropic, horizontal</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>interpolated from seismic</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>2D regular grid map,</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>inverted from seismic data</p></td>
</tr>
</tbody>
</table>
<section id="depositional-setting">
<h3>Depositional Setting</h3>
<p>A single stratigraphic unit (average of 20 m in thickness) of weakly confined deepwater lobes, including possibly 7 lobe elements within a 2 lobe complexes. The lobe stacking includes components of retrogradation and compensation-driven avulsions, likely representing a rising sea level and associated waning sediment supply. Within the lobe elements there are petrophysical trends with decreasing porosity and permeability toward the lobe element margins, laterally and distally. The overbank, interlobe component, is low energy fine grained shalestone sourced from the mud component flow stripped from the turbidity currents and general hemipelagic deposition.</p>
<figure style="text-align: center;">
  <img src="../Images/f0685108f8139d306aa092360000e15f.png" style="display: block; margin: 0 auto; width: 60%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/twelvegeo.png"/>
  <figcaption style="text-align: center;">Interpreted deepwater lobe element sequence from 1 to 7. Lobes 2 to 7 are interpreted as a single retrograding lobe complex. </figcaption>
</figure>
</section>
<section id="method-for-synthetic-data-generation">
<h3>Method for Synthetic Data Generation</h3>
<p>Truth model / population by geostatistical simulation over a exhaustive grid of 10 m x 10 m cells with,</p>
<ul class="simple">
<li><p>continuous porosity simulation with sequential Gaussian simulation with variogram range about 1/3 data extent</p></li>
<li><p>truncation of porosity simulation to calculate sand and shale facies for porosity continuity across facies boundaries</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of permeability given the porosity realization</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of acoustic impedance given the porosity realization</p></li>
</ul>
<p>Sampling by,</p>
<ul class="simple">
<li><p>combination of regular and random sampling with rejection sampler to promote a high sample bias (low for acoustic impedance) to calculate 2D well locations</p></li>
<li><p>values of collocated grid cell with error component assigned to the 2D point set</p></li>
</ul>
</section>
<section id="load-the-dataset">
<h3>Load the Dataset</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/12_sample_data.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">AI_12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="sa">r</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/12_AI.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">)</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>         <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataset-dictionary">
<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">twelve</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Facies"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"cmap_facies"</span><span class="p">,</span>         
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Facies"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Facies"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"Sand - 1, Shale - 0"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'int'</span>
    <span class="p">},</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"fraction"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">6500</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="n">AI_12</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-dataset">
<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">twelve</span><span class="p">):</span>                   <span class="c1"># loop over features</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">twelve</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>
        <span class="n">locmap_facies</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
              <span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X (m)'</span><span class="p">,</span><span class="s1">'Y (m)'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span>
              <span class="n">cmap_facies</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">locmap_st</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                <span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X(m)'</span><span class="p">,</span><span class="s1">'Y(m)'</span><span class="p">,</span>
                             <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">]);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">AI_12</span><span class="p">,</span><span class="n">interpolation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                            <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map and Grid'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="s1">'large'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">twelve</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>         
        <span class="n">hist_sand_shale</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="s1">'Twelve: Facies Well Data Distribution'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
                 <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Well Data'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'Average: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.82</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'St.Dev.: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.77</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P10:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.72</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P90:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.67</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'n:       '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.62</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">' Well Data Distribution'</span><span class="p">);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Seismic'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5cb94f5fcbf98ca2e1a2c7fd7d7ce5c4a6c719c65327d6be075957487604ac03.png" src="../Images/bd8db61587012578bf4ac5ffa4e48d97.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/5cb94f5fcbf98ca2e1a2c7fd7d7ce5c4a6c719c65327d6be075957487604ac03.png"/>
</div>
</div>
</section>
</section>
<section id="dataset-density-and-porosity-well">
<h2>Dataset: Density and Porosity Well</h2>
<p>Density and Porosity Well is a single vertical well section with exhaustively sampled density from RHOB well log and porosity from a continuous well core sampled at 0.25 <span class="math notranslate nohighlight">\(m\)</span> intervals along the well. All of the samples are within a single reservoir formation and a single facies.</p>
<p><strong>Highlights</strong> - simple 1D, 2 feature dataset with a generally linear relationship</p>
<p>Density and Porosity Well includes these features,</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Density</p></td>
<td class="text-center"><p>Density</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{g}{cm^3}\)</span></p></td>
<td><p>RHOB</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\%\)</span></p></td>
<td><p>from core analysis</p></td>
</tr>
</tbody>
</table>
<section id="id1">
<h3>Depositional Setting</h3>
<p>A single stratigraphic unit interpreted as stacked fluvial channel complex with channel elements from 1 to 9. The channel elements incise into each other greatly reducing the apparent element thickness and removing the low porosity top of channel element fills and overbank due to channel avulsion. The channels may be confined because of the lack of margin and overbank depofacies, the well log seems to only include the channel axis component of the stacked channel elements.</p>
<figure style="text-align: center;">
  <img src="../Images/3c53c2329f8aaa701f5941d69ae0e9b4.png" style="display: block; margin: 0 auto; width: 40%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/denporgeo.png"/>
  <figcaption style="text-align: center;">Interpreted stacked fluvial channel element sequence from 1 to 9. The channel elements cut into each other greatly reducing the apparent thickness and removing the low porosity top of channel element fills and all overbank due to avulsion. </figcaption>
</figure>
</section>
<section id="id2">
<h3>Method for Synthetic Data Generation</h3>
<p>Density log by,</p>
<ul class="simple">
<li><p>convolution applied to a vector of random Gaussian values to impose spatial continuity</p></li>
</ul>
<p>Porosity log by,</p>
<ul class="simple">
<li><p>truncation of porosity simulation to calculate sand and shale facies for porosity continuity across facies boundaries</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of permeability given the porosity realization</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of acoustic impedance given the porosity realization</p></li>
</ul>
<p>Sampling by,</p>
<ul class="simple">
<li><p>combination of regular and random sampling with rejection sampler to promote a high sample bias (low for acoustic impedance) to calculate 2D well locations</p></li>
<li><p>values of collocated grid cell with error component assigned to the 2D point set</p></li>
</ul>
</section>
<section id="id3">
<h3>Load the Dataset</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_denpor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/Density_Por_data.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>         <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">denpor</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Depth"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">26.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>         
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Depth"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Depth"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$m$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Density"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">2.4</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>         
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{g}</span><span class="s2">{cm^3}$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'one'</span>
    <span class="p">},</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">25.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"viridis"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\%$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'one'</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>

<span class="n">feature_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Density'</span><span class="p">,</span><span class="s1">'Porosity'</span><span class="p">]</span>   <span class="c1"># early Python does not preserve dictionary list, this is safer than looping over dictionary</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>  <span class="c1"># Adjust for comfortable aspect</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax5</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># Spans both columns</span>

<span class="n">mid_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax3</span><span class="p">,</span><span class="n">ax4</span><span class="p">];</span> <span class="n">top_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">]</span>

<span class="k">for</span> <span class="n">iax</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">top_axes</span><span class="p">):</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="n">feature_list</span><span class="p">[</span><span class="n">iax</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">df_denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"min"</span><span class="p">]);</span> <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Density and Porosity Well: '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Log'</span><span class="p">)</span>
    <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>

<span class="k">for</span> <span class="n">iax</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mid_axes</span><span class="p">):</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="n">feature_list</span><span class="p">[</span><span class="n">iax</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
          <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Well Data'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'Average: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.90</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'St.Dev.: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.85</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P10:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.80</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P90:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.75</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'n:       '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.70</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Density and Porosity Well: '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">' Well Data Distribution'</span><span class="p">);</span> <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">ax5</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">],</span><span class="n">df_denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"max"</span><span class="p">]);</span> <span class="n">add_grid</span><span class="p">(</span><span class="n">ax5</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Density and Porosity Well: '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' vs. '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Log'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0f4a5b57cf79896f73db5f91af7e52f3e52bc86964806f0c537bbb7248105d51.png" src="../Images/2d56e175a4958ecbd3d748340b61deb6.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/0f4a5b57cf79896f73db5f91af7e52f3e52bc86964806f0c537bbb7248105d51.png"/>
</div>
</div>
</section>
</section>
<section id="dataset-spatial-nonlinear-multivariate-sandstone-only-facies-v5">
<h2>Dataset: Spatial Nonlinear Multivariate Sandstone Only Facies v5</h2>
<p>Spatial Nonlinear Multivariate Sandstone Only Facies v5 (SNMSv5) is a densely sampled, multivariate, spatial conventional hydrocarbon dataset with a single sandstone facies.</p>
<p><strong>Link</strong> - the dataset is available <a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/spatial_nonlinear_MV_facies_v5_sand_only.csv">here</a> and the acoustic impedance map is <a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/spatial_nonlinear_MV_facies_v5_sand_only_truth_AI.csv">here</a> and the porosity truth model is <a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/spatial_nonlinear_MV_facies_v5_sand_only_truth_por.csv">here</a>.</p>
<p><strong>Highlights</strong>- porosity truth model for testing, missing component of the distribution suitable for soft data debiasing methods</p>
<ul class="simple">
<li><p>multivariate sparse sample data,</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>X</p></td>
<td class="text-center"><p>X</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>x coordinate</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Y</p></td>
<td class="text-center"><p>Y</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>y coordinate</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Facies</p></td>
<td class="text-center"><p>Facies</p></td>
<td class="text-center"><p>indicator</p></td>
<td><p>0 = shalestone, 1 = sandstone</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>effective porosity</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Permeability</p></td>
<td class="text-center"><p>Perm</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(mD\)</span></p></td>
<td><p>isotropic, horizontal</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>interpolated from seismic</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>2D regular grid truth model and map,</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>truth model for testing</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>inverted from seismic data</p></td>
</tr>
</tbody>
</table>
<section id="id6">
<h3>Depositional Setting</h3>
<p>A single stratigraphic unit interpreted as fluvial dominated mixed sediment delta with 2 protruding subdeltas. Within each delta and subdelta there is distributary paleoflow resulting in multiple paleoflow directions and a general reduction in porosity and permeability from inner to outer delta.</p>
<figure style="text-align: center;">
  <img src="../Images/2cd1f4de49191162b44766175f8d15fc.png" style="display: block; margin: 0 auto; width: 60%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/snms5geo.png"/>
  <figcaption style="text-align: center;">Interpreted fluvial dominated, mixed sediment delta. </figcaption>
</figure>
</section>
<section id="id7">
<h3>Method for Synthetic Data Generation</h3>
<p>Truth model / population by geostatistical simulation over a exhaustive grid of 10 m x 10 m cells with,</p>
<ul class="simple">
<li><p>continuous porosity simulation with sequential Gaussian simulation with variogram range about 1/3 data extent</p></li>
<li><p>truncation of porosity simulation to calculate sand and shale facies for porosity continuity across facies boundaries</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of permeability given the porosity realization</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of acoustic impedance given the porosity realization</p></li>
</ul>
<p>Sampling by,</p>
<ul class="simple">
<li><p>combination of regular and random sampling with rejection sampler to promote a high sample bias (low for acoustic impedance) to calculate 2D well locations</p></li>
<li><p>values of collocated grid cell with error component assigned to the 2D point set</p></li>
</ul>
</section>
<section id="load-the-dataset-and-truth-model">
<h3>Load the Dataset and Truth Model</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_snms5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/spatial_nonlinear_MV_facies_v5_sand_only.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">AI_snms5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="sa">r</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/spatial_nonlinear_MV_facies_v5_sand_only_truth_AI.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">)</span>
<span class="n">Por_snms5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="sa">r</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/spatial_nonlinear_MV_facies_v5_sand_only_truth_por.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">)</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>         <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">snms5</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Por"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"fraction"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="n">Por_snms5</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">5500</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="n">AI_snms5</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snms5</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snms5</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>
        <span class="n">locmap_facies</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
              <span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X (m)'</span><span class="p">,</span><span class="s1">'Y (m)'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span>
              <span class="n">cmap_facies</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">locmap_st</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                <span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X(m)'</span><span class="p">,</span><span class="s1">'Y(m)'</span><span class="p">,</span>
                             <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">]);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">],</span><span class="n">interpolation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                            <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map and Grid'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="s1">'large'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snms5</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>         
        <span class="n">hist_sand_shale</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="s1">'Twelve: Facies Well Data Distribution'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
                 <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Well Data'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'Average: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.82</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'St.Dev.: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.77</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P10:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.72</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P90:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.67</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'n:       '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">))),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.62</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">' Well Data Distribution'</span><span class="p">);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Seismic'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">3.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3b991a08cacd0b184293ce92b3678c9f795629a76557b4d5443f80eb75db5be8.png" src="../Images/0a3cac4710963495851187a3a4d17be5.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/3b991a08cacd0b184293ce92b3678c9f795629a76557b4d5443f80eb75db5be8.png"/>
</div>
</div>
</section>
</section>
<section id="dataset-unconventional-multivariate-v5">
<h2>Dataset: Unconventional Multivariate v5</h2>
<p>Unconventional Mutlivariate v5 (UNMV5) is a densely sampled, multivariate, unconventional hydrocarbon dataset with a single sandstone facies.</p>
<p><strong>Link</strong> - the dataset is available <a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/unconv_MV_v5.csv">here</a>.</p>
<p><strong>Highlights</strong> - large number of potential features for feature selection, feature engineering and predictive machine learning model construction</p>
<ul class="simple">
<li><p>multivariate sparse sample data,</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>effective porosity</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Permeability</p></td>
<td class="text-center"><p>Perm</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(mD\)</span></p></td>
<td><p>isotropic, horizontal</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>interpolated from seismic inversion</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Brittleness Index</p></td>
<td class="text-center"><p>Brittle</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>elastic moduli-based method</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Total Organic Carbon</p></td>
<td class="text-center"><p>TOC</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\%\)</span></p></td>
<td><p>LECO analyzer</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Vitrinite Reflectance</p></td>
<td class="text-center"><p>VR</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\%\)</span></p></td>
<td><p>mean random reflectance</p></td>
</tr>
</tbody>
</table>
<section id="id10">
<h3>Depositional Setting</h3>
<p>Mixed carbonate and siliciclastic unconventional gas reservoir with good porosity, but poor permeability. In an effort to improve production potential prediction, various features have been collected including total organic carbon, brittleness and vitrinite reflectance. Due to the complicated recovery mechanisms, and the superposition of factors such as natural fracture systems interacting with artificial fractures, and often limited matrix flow rates, unconventional reservoir forecasting can be quite challenging.</p>
</section>
<section id="id11">
<h3>Method for Synthetic Data Generation</h3>
<p>Samples drawn from multivariate distributions,</p>
<ul class="simple">
<li><p>sample from a large <span class="math notranslate nohighlight">\(M\)</span> multivariate Gaussian distribution with correlation defined by a covariance matrix with strong and weak, positive and negative correlations</p></li>
<li><p>calculate the features as combinations of the <span class="math notranslate nohighlight">\(M\)</span> features with a variety of transformations to impose nonlinear relationships</p></li>
<li><p>transform the marginal distributions to impose nonGaussian univariate distributions</p></li>
</ul>
</section>
<section id="id12">
<h3>Load the Dataset and Truth Model</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_unmv5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/unconv_MV_v5.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>

<span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>                                <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">unmv5</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Por"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"fraction"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Brittle"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Brittleness"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Brittle"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"unitless"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"TOC"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Total Organic Carbon"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"TOC"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\%$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"VR"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Vitrinite Reflectance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"VR"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\%$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Prod"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Production"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Prod"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$MCFPD$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">'fname'</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">unmv5</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unmv5</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">unmv5</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">df_unmv5</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">map_upper</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'darkorange'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'darkorange'</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'k'</span><span class="p">)</span><span class="c1"># Map a density plot to the lower triangle</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">,</span> 
                              <span class="n">shade</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">shade_lowest</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n_levels</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># pp_unmv5.map(sns.scatterplot)</span>

<span class="c1"># Draw everything first so axes exist and are not overridden</span>
<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]):</span>  <span class="c1"># First column =&gt; leftmost Y axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]):</span>  <span class="c1"># First column =&gt; leftmost Y axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
        <span class="c1"># print(i,j)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4e0bd252f6c9ea9e0b842143513db9a84fa1215a4e33ad41ffaf0a80b1632a53.png" src="../Images/992ab9aa628b6539fb25e760f2952531.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/4e0bd252f6c9ea9e0b842143513db9a84fa1215a4e33ad41ffaf0a80b1632a53.png"/>
</div>
</div>
</section>
</section>
<section id="dataset-reservoir-21">
<h2>Dataset: Reservoir 21</h2>
<p>Reservoir 21 is a large, isolated reservoir unit with good porosity and permeability.</p>
<section id="id15">
<h3>Depositional Setting</h3>
<p>The reservoir sediments was transported by submarine turbidity currents and deposited lithified to become turbidites. The turbidites are separated into 4 ordinal facies,</p>
<ol class="arabic simple">
<li><p>shalestone</p></li>
<li><p>sandy-shalestone</p></li>
<li><p>shaly-sandstone</p></li>
<li><p>sandstone</p></li>
</ol>
<p>with increase rock quality, porosity and permeability over the above indicated categories from worst = 1 (shalestone) to best = 4 (sandstone). Postdepositional the turbidite formation’s pore space was filled by migrating hydrocarbons that were trapped by a thick shale above the unit.</p>
<p>The transport and depositional mechanisms of turbidites are explained in <a class="reference external" href="https://en.wikipedia.org/wiki/Turbidite">Wikipedia’s Turbidtes Article</a> and a good overview of modeling turbidite reservoirs is available in <a class="reference external" href="https://en.wikipedia.org/wiki/Turbidite">McHarge et al., 2011</a>.</p>
<p>A schematic of turbidite transport and demposition is available in Wikipedia Turbidite article (Figure 1).</p>
<figure style="text-align: center;">
  <img src="../Images/75f1e88b704c9094336ec818b66e6e06.png" style="display: block; margin: 0 auto; width: 100%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/turbidite_deposition.gif"/>
  <figcaption style="text-align: center;">Type of sediment source and sediment and the resulting types of turbidite deposits (image from Stow and Mayall, 2000).</figcaption>
</figure>
<p>A good model for is a submarine avalanche, known as a turbidity current, traveling from the shelf break down the slope to the deep ocean basins</p>
<ul class="simple">
<li><p>the driving force is a apparent increase in density due to the mixing of water and grains</p></li>
<li><p>the gradient of the slope is typically between 1 and 2 degrees (1% - 4% gradient)</p></li>
<li><p>these turbidity current can travel 100s to 1,500 km (Bay of Biscay to the Atlantic abyssal plain)</p></li>
<li><p>common speeds are 5 - 20 m/s (20 - 70 km/h)</p></li>
<li><p>to visualize this in the laboratory, see this short <a class="reference external" href="https://youtu.be/y7BbYg1sDnU?si=wUjMEh5xSxfQFM_L">Turbidity Current YouTube Video</a>.</p></li>
</ul>
<p>Turbidity currents result in formation of extensive high porosity and moderate permeability reservoirs in deep water settings.</p>
<p>Here’s some more important details about this dataset,</p>
<ul class="simple">
<li><p><strong>Volume of Interest</strong>: clastic deepwater turbidite reservoir unit with extents 10 km by 10 km by 50 m (thickness)</p></li>
<li><p><strong>Fluids</strong>: initial oil water contact is at the depth of 3067.4m and the average connate water saturation is about 20.3%</p></li>
<li><p><strong>Structure</strong>: Anticline structure with a major vertical fault that crosses the reservoir (see location and equation on the image below). It is unknown if there is translation (discontinuity) across the fault.</p></li>
<li><p><strong>Grids</strong>: the 2D maps conform to the standard Python convention, origin on Top Left (see the image below).</p></li>
</ul>
<figure style="text-align: center;">
  <img src="../Images/df72b88a158bcef1ed565b75d7b26240.png" style="display: block; margin: 0 auto; width: 60%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/res21_planview.png"/>
  <figcaption style="text-align: center;">Plan view of Reservoir 21.</figcaption>
</figure>
<p><strong>Figure 2:</strong> Plan view of Reservoir 21.</p>
<ul class="simple">
<li><p><strong>Wells</strong>: 83 vertical wells were drilled across the reservoir and completed throughout the reservoir unit. Due to the field management constraints, only 73 wells were open to produce oil for the first three years, while the remaining 10 wells were kept shut-in. At the end of the third year, the remaining 10 unproduced wells are planned to be opened.</p></li>
</ul>
</section>
<section id="well-logs">
<h3>Well Logs</h3>
<p>The well logs for the 73 wells are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_wells.csv">res21_well.csv</a> a</p></li>
</ul>
<p>and the associated 1, 2 and 3 year cumulative oil and water production are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_production_history.csv">res21_production_history.csv</a> a</p></li>
</ul>
<p>while the new 10 wells (prior to production) well logs are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_new_wells.csv">res21_new_wells.csv</a></p></li>
</ul>
<p>Comments:</p>
<ul class="simple">
<li><p>all the well names are masked (replaced with simple indices from 1 to 83) and coordinates transformed to the area of interest to conceal the actual reservoir.</p></li>
<li><p>available petrophysical and geomechanical properties are listed.</p></li>
<li><p>blank entries in the file indicate missing data at those locations.</p></li>
</ul>
<p>Predictor features:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Well ID</p></td>
<td><p>Integer</p></td>
<td><p>Unique well identifier, anonymized, random integer</p></td>
</tr>
<tr class="row-odd"><td><p>X, Y</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>Well location in area of interest (0 - 10,000 in X and Y)</p></td>
</tr>
<tr class="row-even"><td><p>Facies</p></td>
<td><p>ordinal category</p></td>
<td><p>1 = shalestone, 2 = sandy-shalestone, 3 shaly-sandstone, 4 sandstone.</p></td>
</tr>
<tr class="row-odd"><td><p>Porosity</p></td>
<td><p>%</p></td>
<td><p>Measure of the void spaces in a material, expressed as a percentage.</p></td>
</tr>
<tr class="row-even"><td><p>Permeability</p></td>
<td><p><span class="math notranslate nohighlight">\(mD\)</span></p></td>
<td><p>Ability of a material to allow fluids to pass through its pore spaces im milliDarcies.</p></td>
</tr>
<tr class="row-odd"><td><p>Acoustic Impedance</p></td>
<td><p><span class="math notranslate nohighlight">\(kg/m^2 \cdot s x 10^6\)</span></p></td>
<td><p>Product of a material’s density and sound velocity, affecting wave behavior.</p></td>
</tr>
<tr class="row-even"><td><p>Rock Density</p></td>
<td><p><span class="math notranslate nohighlight">\(g/cm^3\)</span></p></td>
<td><p>Mass of a rock per unit volume.</p></td>
</tr>
<tr class="row-odd"><td><p>P-wave Velocity</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s}\)</span></p></td>
<td><p>Speed of compressional seismic waves through a material.</p></td>
</tr>
<tr class="row-even"><td><p>S-wave Velocity</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s}\)</span></p></td>
<td><p>Speed of shear seismic waves through a material.</p></td>
</tr>
<tr class="row-odd"><td><p>Young’s Modulus</p></td>
<td><p><span class="math notranslate nohighlight">\(GPa\)</span></p></td>
<td><p>Ratio of stress to strain in the elastic region; measures stiffness in gigapascals.</p></td>
</tr>
<tr class="row-even"><td><p>Shear Modulus</p></td>
<td><p><span class="math notranslate nohighlight">\(GPa\)</span></p></td>
<td><p>Ratio of shear stress to shear strain; measures resistance to shear in gigapascals.</p></td>
</tr>
</tbody>
</table>
<p>Response Feature:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cumul. Oil 1 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total oil produced by the well over one year in 1000s of barrels</p></td>
</tr>
<tr class="row-odd"><td><p>Cumul. Oil 2 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total oil produced by the well over two years in 1000s of barrels</p></td>
</tr>
<tr class="row-even"><td><p>Cumul. Oil 3 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total oil produced by the well over three years in 1000s of barrels</p></td>
</tr>
<tr class="row-odd"><td><p>Cumul. Water 1 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total water produced by the well over one year in 1000s of barrels</p></td>
</tr>
<tr class="row-even"><td><p>Cumul. Water 2 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total water produced by the well over two years in 1000s of barrels</p></td>
</tr>
<tr class="row-odd"><td><p>Cumul. Water 3 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total water produced by the well over three year in 1000s of barrels</p></td>
</tr>
</tbody>
</table>
</section>
<section id="map-data">
<h3>Map Data</h3>
<p>The following map data are available,</p>
<p>Acoustic impedance (AI) inverted from geophysical amplitudes and interpretations,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_ai_map.npy"><strong>res21_ai_map.npy</strong></a></p></li>
</ul>
<p>Proportion of facies, sandstone, shaly-sandstone, sandy-shalestone and shalestone are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_2d_sand_prop_map.npy">res21_2d_sand_prop_map.npy</a></p></li>
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_shaly_sand_prop_map.npy">res21_shaly_sand_prop_map.npy</a></p></li>
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_sandy_shale_prop_map.npy">res21_sandy_shale_prop_map.npy</a></p></li>
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_shale_prop_map.npy">res21_shale_prop_map.npy</a></p></li>
</ul>
<p>Note, the facies proportions are calculated by a well calibrated model with well data and acoustic impedance and the 4 proportions sum to 1.0 (honor probability closure). The top of the formation map is available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_top_depth_map.npy">res21_top_depth_map.npy</a></p></li>
</ul>
<p>Comments on the 2D map, gridded data format,</p>
<ul class="simple">
<li><p>2D maps are regular grids 200 by 200 cells, cell extents are 50m by 50m, extending over the reservoir</p></li>
<li><p>values indicate the vertically averaged property, vertical resolution is the entire reservoir unit</p></li>
<li><p>the indices follow standard Python convention, original is top left corner, indices are from 0, 1, …, n-1 and the first index is the row (from the top) and the second index is the column from the left</p></li>
<li><p>e.g. to select the 5th grid cell in x (column) and the 10th grid cell in y (rows), use ndarray[9,4] in Python (aside, array[10,5] in Matlab)</p></li>
<li><p>the origin of the 2D data (e.g., array[0,0]) is the center of the top left cell, 25m and 25m along y and x direction (refer to the image above)</p></li>
</ul>
</section>
<section id="d-vertically-averaged-data">
<h3>2D Vertically Averaged Data</h3>
<p>For simplified workflow testing, a vertically averaged 2D variant of the dataset was made by,</p>
<ul class="simple">
<li><p>averaging all the continuous well log features over the entire reservoir unit</p></li>
<li><p>combining a single response feature (3 year cumulative oil production) with the predictor features</p></li>
<li><p>removing facies to avoid the issue of upscaling the categorical ordinal feature</p></li>
</ul>
<p>These two files contain the predictor features, well log data, averaged over the entire well bore for all 73 wells, i.e., one value per well for each feature, and the one response feature, 3 year cumulative oil production,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_2D_wells.csv"><strong>res21_2D_wells.csv</strong></a> - 2D averaged well data and 3 year cumulative oil production for the previous production wells, well indices from 1 to 73</p></li>
</ul>
<p>and well log data averaged over the entire well bore for all 10 test wells,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_2D_wells_test.csv"><strong>res21_2D_wells_test.csv</strong></a> - 2D averaged well data for the remaining, preproduction wells, well indices from 74 to 83</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">res21</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"X"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"X"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"X"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"m"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Y"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Y"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Y"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"m"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span> 
    <span class="s2">"Por"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">17.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Por"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"%"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">70.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">200.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">6.9</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">7.6</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Density"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">1.6</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">2.6</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"\frac</span><span class="si">{g}</span><span class="s2">{cm^2}"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"PVel"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">3200.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">4500.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"P-wave Velocity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"PVel"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{m}{s}</span><span class="s2">$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Youngs"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">22.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">32.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Youngs Modulas"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Youngs"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$GPA$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span> 
    <span class="s2">"SVel"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">1600.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">1750.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"S-wave Velocity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"SVel"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{m}{s}</span><span class="s2">$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>    
    <span class="s2">"Shear"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">4.5</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Shear Modulus"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Shear"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$GPA$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"CumulativeOil"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">3000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Cumulative Oil Production"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"CumulativeOil"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$Mbbls$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h3>Load the Dataset and Truth Model</h3>
<p>Let’s load the 2D dataset and visualize it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_res21_2D</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_2D_wells.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">'Well_ID'</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">df_res21_2D_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_2D_wells_test.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">'Well_ID'</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="c1">#df_res21_2D.head()                                           # vizualize dataframe with 73 wells without production </span>
<span class="c1">#df_res21_2D_test.head()                                      # visualize dataframe with 10 wells with production</span>
<span class="n">df_res21_2D</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>                            <span class="c1"># check summary statistics</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th/>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>73.0</td>
      <td>4188.698630</td>
      <td>1783.143687</td>
      <td>1175.000000</td>
      <td>2925.000000</td>
      <td>3875.000000</td>
      <td>5325.000000</td>
      <td>7975.000000</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>73.0</td>
      <td>5770.890411</td>
      <td>2405.487844</td>
      <td>775.000000</td>
      <td>3825.000000</td>
      <td>6125.000000</td>
      <td>7625.000000</td>
      <td>9775.000000</td>
    </tr>
    <tr>
      <th>Por</th>
      <td>69.0</td>
      <td>12.822361</td>
      <td>1.069242</td>
      <td>10.449132</td>
      <td>12.122789</td>
      <td>12.842228</td>
      <td>13.532038</td>
      <td>15.837603</td>
    </tr>
    <tr>
      <th>Perm</th>
      <td>53.0</td>
      <td>119.292589</td>
      <td>23.003770</td>
      <td>85.457752</td>
      <td>101.821216</td>
      <td>116.341824</td>
      <td>130.554974</td>
      <td>184.753428</td>
    </tr>
    <tr>
      <th>AI</th>
      <td>69.0</td>
      <td>7.319194</td>
      <td>0.096761</td>
      <td>7.062172</td>
      <td>7.280405</td>
      <td>7.333877</td>
      <td>7.379185</td>
      <td>7.499137</td>
    </tr>
    <tr>
      <th>Density</th>
      <td>70.0</td>
      <td>2.043288</td>
      <td>0.138222</td>
      <td>1.793870</td>
      <td>1.921390</td>
      <td>2.039170</td>
      <td>2.162651</td>
      <td>2.301552</td>
    </tr>
    <tr>
      <th>PVel</th>
      <td>69.0</td>
      <td>3696.762373</td>
      <td>276.382117</td>
      <td>3229.902892</td>
      <td>3463.035301</td>
      <td>3688.453880</td>
      <td>3897.219799</td>
      <td>4327.857887</td>
    </tr>
    <tr>
      <th>Youngs</th>
      <td>49.0</td>
      <td>27.173417</td>
      <td>2.164984</td>
      <td>23.516002</td>
      <td>25.378138</td>
      <td>26.801655</td>
      <td>28.641350</td>
      <td>31.463424</td>
    </tr>
    <tr>
      <th>SVel</th>
      <td>65.0</td>
      <td>1676.908144</td>
      <td>19.277228</td>
      <td>1637.806458</td>
      <td>1662.280505</td>
      <td>1676.458624</td>
      <td>1688.682882</td>
      <td>1721.987891</td>
    </tr>
    <tr>
      <th>Shear</th>
      <td>48.0</td>
      <td>5.793693</td>
      <td>0.474087</td>
      <td>4.937921</td>
      <td>5.397281</td>
      <td>5.769809</td>
      <td>6.208277</td>
      <td>6.714150</td>
    </tr>
    <tr>
      <th>CumulativeOil</th>
      <td>73.0</td>
      <td>940.976027</td>
      <td>429.622150</td>
      <td>307.120000</td>
      <td>643.140000</td>
      <td>819.490000</td>
      <td>1185.400000</td>
      <td>2514.500000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now let’s load two of the 2D maps,</p>
<ul class="simple">
<li><p>average sand proportion</p></li>
<li><p>acoustic impedance</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">sand_prop_map_url</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_2d_sand_prop_map.npy'</span><span class="p">)</span>
<span class="n">sand_prop_map_url</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>                          <span class="c1"># Raise an error if the download fails</span>
<span class="n">sand_prop_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">sand_prop_map_url</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>   <span class="c1"># load the .npy file from the downloaded bytes</span>

<span class="n">AI_map_url</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_ai_map.npy'</span><span class="p">)</span>
<span class="n">AI_map_url</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>                                 <span class="c1"># Raise an error if the download fails</span>
<span class="n">AI_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">AI_map_url</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>                 <span class="c1"># load the .npy file from the downloaded bytes</span>
<span class="n">AI_map</span> <span class="o">=</span> <span class="n">AI_map</span><span class="o">/</span><span class="mf">1000000.0</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-histograms-for-each-feature">
<h3>Calculate Histograms for Each Feature</h3>
<p>Let’s use the dictionary above to make histograms for each feature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">for</span> <span class="n">ifeat</span><span class="p">,</span><span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>          <span class="c1"># loop over all features in the dataframe with 73 wells with production</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ifeat</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                                  <span class="c1"># subplot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'fname'</span><span class="p">]],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span> <span class="c1"># histogram</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Frequency'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">feature</span> <span class="o">+</span> <span class="s1">' Histogram'</span><span class="p">)</span> <span class="c1"># labels </span>
    <span class="n">add_grid2</span><span class="p">()</span>                                               <span class="c1"># major and minor gridlines function</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">3.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b4761de96b21bc454ebeacf66cc850f374aa90d60414d5e118476081f8c2d2e5.png" src="../Images/8789e1495b2bb781d5a677f928dc01ba.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/b4761de96b21bc454ebeacf66cc850f374aa90d60414d5e118476081f8c2d2e5.png"/>
</div>
</div>
</section>
<section id="id17">
<h3>Visualize the Dataset</h3>
<p>Now we can visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">ifeat</span> <span class="o">=</span> <span class="mi">4</span>                                                    <span class="c1"># select feature for scatter plot, 0 - 10</span>
<span class="n">feature</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="n">res21</span><span class="p">)[</span><span class="n">ifeat</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sand_prop_map</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span> <span class="c1"># 2D map</span>
<span class="n">cb1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.036</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.18</span><span class="p">)</span>                         <span class="c1"># colorbar for 2D map</span>
<span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">"Proportion of Sand (fraction)"</span><span class="p">)</span>                           <span class="c1"># colorbar label for 2D map</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'fname'</span><span class="p">]],</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'current wells'</span><span class="p">)</span>       <span class="c1"># wells with production scatter plot</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>                         <span class="c1"># colorbar for scatter plot</span>
<span class="n">cb2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">)</span> <span class="c1"># colorbar label for scatter plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'new wells'</span><span class="p">)</span> <span class="c1"># wells without production</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Y (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' and Sand Proportion Map'</span><span class="p">)</span> <span class="c1"># labels for axes and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">AI_map</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span> <span class="c1"># 2D map</span>
<span class="n">cb1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.036</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.18</span><span class="p">)</span>                         <span class="c1"># colorbar for 2D map</span>
<span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">)</span>                           <span class="c1"># colorbar label for 2D map</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'fname'</span><span class="p">]],</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'current wells'</span><span class="p">)</span> <span class="c1"># wells with production scatter plot</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>                         <span class="c1"># colorbar for scatter plot</span>
<span class="n">cb2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">)</span> <span class="c1"># colorbar label for scatter plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'new wells'</span><span class="p">)</span> <span class="c1"># wells without production</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Y (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' and Acoustic Impedance Map'</span><span class="p">)</span> <span class="c1"># labels for axes and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/124ec120233d26da8692b8d6959cc2235528e45cbad7fbb44ac2e4635874d7bc.png" src="../Images/85757e86276ec552d3cb1ae5aa5224da.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/124ec120233d26da8692b8d6959cc2235528e45cbad7fbb44ac2e4635874d7bc.png"/>
</div>
</div>
</section>
</section>
<section id="scatter-plots">
<h2>Scatter Plots</h2>
<p>Let’s check the relationships between the features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">'fname'</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">res21</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">res21</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">res21</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">pp_res21</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>
<span class="n">pp_res21</span> <span class="o">=</span> <span class="n">pp_res21</span><span class="o">.</span><span class="n">map_upper</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'darkorange'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">pp_res21</span> <span class="o">=</span> <span class="n">pp_res21</span><span class="o">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'darkorange'</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'k'</span><span class="p">)</span><span class="c1"># Map a density plot to the lower triangle</span>
<span class="n">pp_res21</span> <span class="o">=</span> <span class="n">pp_res21</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">,</span> 
                              <span class="n">shade</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">shade_lowest</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n_levels</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Draw everything first so axes exist and are not overridden</span>
<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp_res21</span><span class="o">.</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]):</span>  <span class="c1"># First column =&gt; leftmost Y axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp_res21</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]):</span>  <span class="c1"># First column =&gt; leftmost Y axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pp_res21</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pp_res21</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
        <span class="c1"># print(i,j)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">pp_res21</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">res21</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">res21</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/19f7e946cd16a7908a2703f9cfcf41b91769c58e4b657355896ce5e5d65de9af.png" src="../Images/6bee67ef12013774d2708affb44ffe41.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/19f7e946cd16a7908a2703f9cfcf41b91769c58e4b657355896ce5e5d65de9af.png"/>
</div>
</div>
</section>
<section id="comments">
<h2>Comments</h2>
<p>This is a summary of some of the synthetic datasets that I have generated for the demonstrations in the e-book and my other course content. I hope this,</p>
<ul class="simple">
<li><p>helps you better understand the datasets used in this book</p></li>
<li><p>provides some other datasets for your to test your knowledge and to benchmark your workflows</p></li>
</ul>
<p>I hope this is helpful,</p>
<p><em>Michael</em></p>
</section>
<section id="about-the-author">
<h2>About the Author</h2>
<figure style="text-align: center;">
  <img src="../Images/eb709b2c0a0c715da01ae0165efdf3b2.png" style="display: block; margin: 0 auto; width: 70%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/intro/michael_pyrcz_officeshot_jacket.jpg"/>
  <figcaption style="text-align: center;"> Professor Michael Pyrcz in his office on the 40 acres, campus of The University of Texas at Austin.
</figcaption>
</figure>
<p>Michael Pyrcz is a professor in the <a class="reference external" href="https://cockrell.utexas.edu/faculty-directory/alphabetical/p">Cockrell School of Engineering</a>, and the <a class="reference external" href="https://www.jsg.utexas.edu/researcher/michael_pyrcz/">Jackson School of Geosciences</a>, at <a class="reference external" href="https://www.utexas.edu/">The University of Texas at Austin</a>, where he researches and teaches subsurface, spatial data analytics, geostatistics, and machine learning. Michael is also,</p>
<ul class="simple">
<li><p>the principal investigator of the <a class="reference external" href="https://fri.cns.utexas.edu/energy-analytics">Energy Analytics</a> freshmen research initiative and a core faculty in the Machine Learn Laboratory in the College of Natural Sciences, The University of Texas at Austin</p></li>
<li><p>an associate editor for <a class="reference external" href="https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board">Computers and Geosciences</a>, and a board member for <a class="reference external" href="https://link.springer.com/journal/11004/editorial-board">Mathematical Geosciences</a>, the International Association for Mathematical Geosciences.</p></li>
</ul>
<p>Michael has written over 70 <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en">peer-reviewed publications</a>, a <a class="reference external" href="https://pypi.org/project/geostatspy/">Python package</a> for spatial data analytics, co-authored a textbook on spatial data analytics, <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistical Reservoir Modeling</a> and author of two recently released e-books, <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostatistics in Python: a Hands-on Guide with GeostatsPy</a> and <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html">Applied Machine Learning in Python: a Hands-on Guide with Code</a>.</p>
<p>All of Michael’s university lectures are available on his <a class="reference external" href="https://www.youtube.com/@GeostatsGuyLectures">YouTube Channel</a> with links to 100s of Python interactive dashboards and well-documented workflows in over 40 repositories on his <a class="reference external" href="https://github.com/GeostatsGuy">GitHub account</a>, to support any interested students and working professionals with evergreen content. To find out more about Michael’s work and shared educational resources visit his <span class="xref myst">Website</span>.</p>
</section>
<section id="want-to-work-together">
<h2>Want to Work Together?</h2>
<p>I hope this content is helpful to those that want to learn more about subsurface modeling, data analytics and machine learning. Students and working professionals are welcome to participate.</p>
<ul class="simple">
<li><p>Want to invite me to visit your company for training, mentoring, project review, workflow design and / or consulting? I’d be happy to drop by and work with you!</p></li>
<li><p>Interested in partnering, supporting my graduate student research or my Subsurface Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)? My research combines data analytics, stochastic modeling and machine learning theory with practice to develop novel methods and workflows to add value. We are solving challenging subsurface problems!</p></li>
<li><p>I can be reached at <a class="reference external" href="mailto:mpyrcz%40austin.utexas.edu">mpyrcz<span>@</span>austin<span>.</span>utexas<span>.</span>edu</a>.</p></li>
</ul>
<p>I’m always happy to discuss,</p>
<p><em>Michael</em></p>
<p>Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The Jackson School of Geosciences, The University of Texas at Austin</p>
<p>More Resources Available at: <a class="reference external" href="https://twitter.com/geostatsguy">Twitter</a> | <a class="reference external" href="https://github.com/GeostatsGuy">GitHub</a> | <a class="reference external" href="http://michaelpyrcz.com">Website</a> | <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en&amp;oi=ao">GoogleScholar</a> | <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistics Book</a> | <a class="reference external" href="https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig">YouTube</a>  | <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostats in Python e-book</a> | <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/">Applied Machine Learning in Python e-book</a> | <a class="reference external" href="https://www.linkedin.com/in/michael-pyrcz-61a648a1">LinkedIn</a></p>
</section>
&#13;

<h2>Motivation for Fake Data</h2>
<p>Let me start with a confession,</p>
<ul class="simple">
<li><p>I make a lot of fake data!</p></li>
</ul>
<p>I do it all the time. In fact, I also make workflows to make fake data so that I can rapidly make a variety of new datasets fit-for-purpose of the specific model testing and educational content. But I find that often I need to defend my fake data generation habit with,</p>
<ul class="simple">
<li><p>students that are hungry to tackle real data problems</p></li>
<li><p>reviewers that are incredulous of fake data</p></li>
</ul>
<p>Why do I use fake data so much in my research and educational content?</p>
<ol class="arabic simple">
<li><p><strong>Avoid the Inference Problem</strong> - when we work with real data, we often cannot know the truth. Our subsurface data is often very limited! Perhaps we can rewind the clock and test against the newest data, or mask a region for testing our ability to estimate spatially away from data. But, we can never completely avoid the inference problem, i.e., did our model perform poorly because we used the wrong data or made the wrong model choices?</p></li>
<li><p><strong>Working in Expected Value</strong> - it is possible to be lucky, to run a proposed method on a single dataset and see great improvement vs. the established method, and then on the next run with a new dataset to see worsening! A data scientist bases their work in probability and statistics; therefore, we know that we need many replicates. We can generate an ensemble of dataset cases and then summarize model performance in expected value for greater rigor.</p></li>
<li><p><strong>Test a Wide Range of Conditions</strong> - how does your model handle data noise? redundant features? nonlinearity in the relationships between your features? sparse data? It would be quite difficult to curate a sufficient number of datasets to test the potentially wide range of modeling conditions. With fake data you can turn the dial and evaluate the impact on your model for any combination and severity of conditions, and even test your model to failure like the ‘Myth Busters’ approach.</p></li>
<li><p><strong>Tune the Data Difficulty</strong> - this follows from the previous point, but it has to do with tuning the modeling difficulty. With fake data you can give yourself perfectly ideal data with no bias, no error, great coverage and even low dimensionality. In fact, my fake data generation algorithms often starts there and then performs operations to imposed biased sampling, add measurement error, reduce coverage and even add additional features. Remember it is very easy to take perfect data and wreck it, but generally impossible to take poor data and improve it.</p></li>
<li><p><strong>Open Educational Content</strong> - I promise, I also use a lot of real data, but most of this data is not in public domain. I appreciate and respect the working professionals that take the time to obtain the approvals for my students and I to use their real data, but it would not be possible to use this data in my free, online educational content. To support my open education efforts, I need reproducible course notes; therefore, I need to be able to freely share the datasets.</p></li>
</ol>
<p>I have continued to say “fake data”, mostly for effect, because it sounds dramatic to state that, “I make fake data”. From now on I use the more formal term, “synthetic datasets”.</p>
<ul class="simple">
<li><p>rest assured, as a geostatician I’m actually quite good at making synthetic datasets with realistic, distributions, relationships and sampling.</p></li>
</ul>
&#13;

<h2>General Comments About the Synthetic Datasets</h2>
<p>Now I will make several comments about the synthetic datasets that I have shared. Yet, while making these statements I do not limit the type of synthetic datasets that I will add in the future.</p>
<ul class="simple">
<li><p>let me know if you have a suggestion and I will likely make some new data, recall, I love making synthetic data!</p></li>
</ul>
&#13;

<h2>2D Spatial Datasets</h2>
<p>In the days of modern three dimensional spatial algorithms and visualization it may be surprising that I am working with two dimensional spatial data. Why not just include a ‘z’ (<em>‘zed’</em> - shout out to my fellow Canadians) or an iz axes in the NumPy ndarray object?</p>
<ul class="simple">
<li><p>it is easy to do this. Actually, most of my GeostatsPy package that I wrote has 3D spatial methods available.</p></li>
</ul>
<p>The problem is computational complexity, and data and model visualization,</p>
<ul class="simple">
<li><p>many spatial data analytics and geostatistics methods have computational complexity with a <span class="math notranslate nohighlight">\(n_z\)</span> term, i.e., by adding a minimal number of <span class="math notranslate nohighlight">\(z\)</span> layers like 10, we increase the run time by an order of magnitude. Sure I love cool hardware, but for the purpose of education in my classrooms and around the world I would rather err on the side of very easy to run, very low computational complexity for very fast run times.</p></li>
<li><p>I’ve been in industrial VR facilities and I own a HTC Vive Pro at home. It is amazing to wander the road from Whiterun to Solitude in Skyrim (when is Elder Scrolls 6 going to be released?). I know the potential for amazing and effective 3D visualization. Yet, 3D model and data visualization with standard Anaconda packages is a bit limited, lacking flexible interactivity with the display, rotation, slicing and scaling.</p></li>
</ul>
<p>Given these considerations, I prefer 2D spatial datasets for my educational content.</p>
&#13;

<h2>Hybrid Stochastic and Deterministic Models</h2>
<p>My original data science discipline is geostatistics and I have reviewed geostatistical subsurface models all over the world and they were all hybrid stochastic and deterministic models with,</p>
<ul class="simple">
<li><p>deterministic trend structures to impose nonstationarity in space or relationships between features</p></li>
<li><p>stochastic residual structures to integrate heterogeneity and noise</p></li>
</ul>
<p>My synthetic datasets use geostatistical simulation approaches to include all of these components,</p>
<ul class="simple">
<li><p>through the explicit assignment of random number seed the dataset generation process is repeatable</p></li>
</ul>
&#13;

<h2>Gaussian Distributions</h2>
<p>I have used standard geostatistical simulation methods that assume Gaussian distributions, for example,</p>
<ul class="simple">
<li><p>sequential Gaussian simulation</p></li>
<li><p>collocated cokriging-based simulation</p></li>
<li><p>truncated Gaussian simulation</p></li>
</ul>
<p>Through the back-transformation of the global distribution or truncation we can achieve non-Gaussian global distributions, also,</p>
<ul class="simple">
<li><p>I build mixture models that combine multiple Gaussian models for more complicated distributions and relationships.</p></li>
<li><p>I scale individual features to improve skew and nonlinearity</p></li>
</ul>
<p>So while I may use Gaussian methods to generate synthetic data, my synthetic data is not limited to Gaussian distributed.</p>
&#13;

<h2>What About Images?</h2>
<p>Yes, I have also made a lot of training images for deep learning and multiple point simulation geostatistics. These are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/MLTrainingImages">MLTrainingImages</a></p></li>
</ul>
<div class="remove-from-content-only admonition">
<p class="admonition-title">You are welcome to cite our synthetic training image respository as:</p>
<p>Pyrcz, Michael J. and Morales, Misael M. (2023). Machine Learning Training Images Repository (1.0.0). Zenodo. <a class="reference external" href="https://doi.org/10.5281/zenodo.7702128">https://doi.org/10.5281/zenodo.7702128</a> <a class="reference external" href="https://doi.org/10.5281/zenodo.7702127"><img alt="DOI" src="../Images/d3f7da7f97ef0c3ee2127ac476fdd755.png" data-original-src="https://zenodo.org/badge/609354774.svg"/></a></p>
</div>
&#13;

<h2>Availability of the Datasets</h2>
<p>All of my synthetic datasets are available in my GitHub repositories,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets">GeoDataSets</a></p></li>
</ul>
<p>with in my GitHub account,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy">GeostatsGuy</a></p></li>
</ul>
<div class="remove-from-content-only admonition">
<p class="admonition-title">You are welcome to cite my synthetic data repository as:</p>
<p>Pyrcz, M.J., 2024, <em>GeoDataSets: Synthetic Subsurface Data Repository</em>. Zenodo. doi:10.5281/zenodo.15169133 <a class="reference external" href="https://doi.org/10.5281/zenodo.5564873"><img alt="DOI" src="../Images/e5c96c99dae6eea4cae456ff92b41366.png" data-original-src="https://zenodo.org/badge/117575737.svg"/></a></p>
</div>
<p>Star the repository to help you find it again and keep checking back as I continue to update the synthetic datasets.</p>
<ul class="simple">
<li><p>I’m stoked to help with interesting and useful synthetic data.</p></li>
</ul>
&#13;

<h2>Available Synthetic Datasets</h2>
<p>Here is a list of the available datasets, summarized below,</p>
<ul class="simple">
<li><p><strong>Twelve / 12</strong> - densely sampled, spatial with two facies, biased sampling and exaustive secondary data.</p></li>
<li><p><strong>Density and Porosity Well</strong> - simple 1D, 2 feature dataset with a generally linear relationship.</p></li>
<li><p><strong>Spatial Nonlinear Multivariate Sandstone Only Facies v5</strong> - porosity truth model for testing, missing component of the distribution suitable for softdata debiasing methods.</p></li>
<li><p><strong>Unconventional Multivariate v5</strong> - large number of potential features for feature selection, feature engineering and predictive machine learning model construction.</p></li>
</ul>
&#13;

<h2>Synthetic Data Summaries</h2>
<p>Below I provide a summary of each dataset. This includes,</p>
<ul class="simple">
<li><p><strong>name and link</strong> to access the dataset on my GitHub account</p></li>
<li><p><strong>method</strong> to generate the data with link</p></li>
<li><p><strong>basic</strong> data display dashboard customized for each dataset</p></li>
</ul>
&#13;

<h2>Load the Required Libraries</h2>
<p>The following code loads the required libraries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="kn">import</span> <span class="nn">geostatspy.GSLIB</span> <span class="k">as</span> <span class="nn">GSLIB</span>                              <span class="c1"># GSLIB utilies, visualization and wrapper</span>
<span class="kn">import</span> <span class="nn">geostatspy.geostats</span> <span class="k">as</span> <span class="nn">geostats</span>                        <span class="c1"># GSLIB methods convert to Python        </span>
</pre></div>
</div>
</div>
</div>
<p>We will also need some standard packages. These should have been installed with Anaconda 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="kc">True</span>                                        <span class="c1"># ignore warnings?</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>                                            <span class="c1"># ndarrys for gridded data</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>                                           <span class="c1"># DataFrames for tabular data</span>
<span class="kn">import</span> <span class="nn">os</span>                                                     <span class="c1"># set working directory, run executables</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>                               <span class="c1"># for plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>                                      <span class="c1"># custom colorbar</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticker</span>                            <span class="c1"># custom axes</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>                      <span class="c1"># custom layout</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">AutoMinorLocator</span><span class="p">)</span> <span class="c1"># control of axes ticks</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">FuncFormatter</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>                                         <span class="c1"># advanced plotting</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">Rbf</span>                             <span class="c1"># countours that extrapolate</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>                                       <span class="c1"># summary statistics</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">convolve2d</span>                           <span class="c1"># convolution</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">import</span> <span class="nn">math</span>                                                   <span class="c1"># trig etc.</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'axes'</span><span class="p">,</span> <span class="n">axisbelow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                <span class="c1"># plot all grids below the plot elements</span>
<span class="k">if</span> <span class="n">ignore_warnings</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>                                   
    <span class="kn">import</span> <span class="nn">warnings</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">13</span>                                                     <span class="c1"># set ramdon number seed</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span>                                         <span class="c1"># default colormap</span>
</pre></div>
</div>
</div>
</div>
<p>If you get a package import error, you may have to first install some of these packages. This can usually be accomplished by opening up a command window on Windows and then typing ‘python -m pip install [package-name]’. More assistance is available with the respective package docs.</p>
&#13;

<h2>Declare Functions</h2>
<p>These are some conveneince functions for more readable code in our workflows.</p>
<ul class="simple">
<li><p>add major and minor gridlines</p></li>
<li><p>custom location map for sandstone and shalestone facies</p></li>
<li><p>custom histogram for sandstone and shalestone facies</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">def</span> <span class="nf">add_grid2</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="c1"># add y grids</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">7</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">());</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span> <span class="c1"># turn on minor ticks  </span>

<span class="k">def</span> <span class="nf">add_grid</span><span class="p">(</span><span class="n">sub_plot</span><span class="p">):</span>
    <span class="n">sub_plot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span> <span class="n">sub_plot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="c1"># add y grids</span>
    <span class="n">sub_plot</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">7</span><span class="p">);</span> <span class="n">sub_plot</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">sub_plot</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">());</span> <span class="n">sub_plot</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span> <span class="c1"># turn on minor ticks</span>

<span class="k">def</span> <span class="nf">locmap_facies</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">,</span><span class="n">vcol</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">xlabel</span><span class="p">,</span><span class="n">ylabel</span><span class="p">,</span><span class="n">vlabel</span><span class="p">,</span><span class="n">cmap</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">xcol</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="n">ycol</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">vcol</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">edgecolors</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">'</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">'</span><span class="p">))</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"vertical"</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">vlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">'Shale'</span><span class="p">,</span> <span class="s1">'Sand'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">hist_sand_shale</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">vcol</span><span class="p">,</span><span class="n">title</span><span class="p">):</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">vcol</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
    <span class="n">patches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'grey'</span><span class="p">);</span> <span class="n">patches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'gold'</span><span class="p">)</span> <span class="c1"># Set custom colors for each bar</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">'Shalestone'</span><span class="p">,</span> <span class="s1">'Sandstone'</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Frequency'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">AutoMinorLocator</span><span class="p">());</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">'-'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">'-'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_formatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">type</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">'small'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">'large'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">'int'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">'one'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h2>Make Custom Colorbar</h2>
<p>We make this colorbar to display our categorical, sand and shale facies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">cmap_facies</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">'grey'</span><span class="p">,</span><span class="s1">'gold'</span><span class="p">])</span>
<span class="n">cmap_facies</span><span class="o">.</span><span class="n">set_over</span><span class="p">(</span><span class="s1">'white'</span><span class="p">);</span> <span class="n">cmap_facies</span><span class="o">.</span><span class="n">set_under</span><span class="p">(</span><span class="s1">'white'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h2>Dataset: Twelve / 12</h2>
<p>Twelve (12) is a densely sampled, multivariate, spatial conventional hydrocarbon dataset with large sandstone and shale facies and continuous porosity, permeability and acoustic impedance between facies.</p>
<p><strong>Highlights</strong> - densely sampled, spatial with two facies, biased sampling and exhaustive secondary data.</p>
<p>‘12’ is a spatial multivariate dataset with,</p>
<ul class="simple">
<li><p>multivariate sparse sample data,</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>X</p></td>
<td class="text-center"><p>X</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>x coordinate</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Y</p></td>
<td class="text-center"><p>Y</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>y coordinate</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Facies</p></td>
<td class="text-center"><p>Facies</p></td>
<td class="text-center"><p>indicator</p></td>
<td><p>0 = shalestone, 1 = sandstone</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>effective porosity</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Permeability</p></td>
<td class="text-center"><p>Perm</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(mD\)</span></p></td>
<td><p>isotropic, horizontal</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>interpolated from seismic</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>2D regular grid map,</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>inverted from seismic data</p></td>
</tr>
</tbody>
</table>
<section id="depositional-setting">
<h3>Depositional Setting</h3>
<p>A single stratigraphic unit (average of 20 m in thickness) of weakly confined deepwater lobes, including possibly 7 lobe elements within a 2 lobe complexes. The lobe stacking includes components of retrogradation and compensation-driven avulsions, likely representing a rising sea level and associated waning sediment supply. Within the lobe elements there are petrophysical trends with decreasing porosity and permeability toward the lobe element margins, laterally and distally. The overbank, interlobe component, is low energy fine grained shalestone sourced from the mud component flow stripped from the turbidity currents and general hemipelagic deposition.</p>
<figure style="text-align: center;">
  <img src="../Images/f0685108f8139d306aa092360000e15f.png" style="display: block; margin: 0 auto; width: 60%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/twelvegeo.png"/>
  <figcaption style="text-align: center;">Interpreted deepwater lobe element sequence from 1 to 7. Lobes 2 to 7 are interpreted as a single retrograding lobe complex. </figcaption>
</figure>
</section>
<section id="method-for-synthetic-data-generation">
<h3>Method for Synthetic Data Generation</h3>
<p>Truth model / population by geostatistical simulation over a exhaustive grid of 10 m x 10 m cells with,</p>
<ul class="simple">
<li><p>continuous porosity simulation with sequential Gaussian simulation with variogram range about 1/3 data extent</p></li>
<li><p>truncation of porosity simulation to calculate sand and shale facies for porosity continuity across facies boundaries</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of permeability given the porosity realization</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of acoustic impedance given the porosity realization</p></li>
</ul>
<p>Sampling by,</p>
<ul class="simple">
<li><p>combination of regular and random sampling with rejection sampler to promote a high sample bias (low for acoustic impedance) to calculate 2D well locations</p></li>
<li><p>values of collocated grid cell with error component assigned to the 2D point set</p></li>
</ul>
</section>
<section id="load-the-dataset">
<h3>Load the Dataset</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/12_sample_data.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">AI_12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="sa">r</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/12_AI.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">)</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>         <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataset-dictionary">
<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">twelve</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Facies"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"cmap_facies"</span><span class="p">,</span>         
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Facies"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Facies"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"Sand - 1, Shale - 0"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'int'</span>
    <span class="p">},</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"fraction"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">6500</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="n">AI_12</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-dataset">
<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">twelve</span><span class="p">):</span>                   <span class="c1"># loop over features</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">twelve</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>
        <span class="n">locmap_facies</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
              <span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X (m)'</span><span class="p">,</span><span class="s1">'Y (m)'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span>
              <span class="n">cmap_facies</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">locmap_st</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                <span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X(m)'</span><span class="p">,</span><span class="s1">'Y(m)'</span><span class="p">,</span>
                             <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">]);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">AI_12</span><span class="p">,</span><span class="n">interpolation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                            <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map and Grid'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="s1">'large'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">twelve</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>         
        <span class="n">hist_sand_shale</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="s1">'Twelve: Facies Well Data Distribution'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
                 <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Well Data'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'Average: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.82</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'St.Dev.: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.77</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P10:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.72</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P90:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.67</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'n:       '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.62</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">' Well Data Distribution'</span><span class="p">);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Seismic'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5cb94f5fcbf98ca2e1a2c7fd7d7ce5c4a6c719c65327d6be075957487604ac03.png" src="../Images/bd8db61587012578bf4ac5ffa4e48d97.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/5cb94f5fcbf98ca2e1a2c7fd7d7ce5c4a6c719c65327d6be075957487604ac03.png"/>
</div>
</div>
</section>
&#13;

<h3>Depositional Setting</h3>
<p>A single stratigraphic unit (average of 20 m in thickness) of weakly confined deepwater lobes, including possibly 7 lobe elements within a 2 lobe complexes. The lobe stacking includes components of retrogradation and compensation-driven avulsions, likely representing a rising sea level and associated waning sediment supply. Within the lobe elements there are petrophysical trends with decreasing porosity and permeability toward the lobe element margins, laterally and distally. The overbank, interlobe component, is low energy fine grained shalestone sourced from the mud component flow stripped from the turbidity currents and general hemipelagic deposition.</p>
<figure style="text-align: center;">
  <img src="../Images/f0685108f8139d306aa092360000e15f.png" style="display: block; margin: 0 auto; width: 60%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/twelvegeo.png"/>
  <figcaption style="text-align: center;">Interpreted deepwater lobe element sequence from 1 to 7. Lobes 2 to 7 are interpreted as a single retrograding lobe complex. </figcaption>
</figure>
&#13;

<h3>Method for Synthetic Data Generation</h3>
<p>Truth model / population by geostatistical simulation over a exhaustive grid of 10 m x 10 m cells with,</p>
<ul class="simple">
<li><p>continuous porosity simulation with sequential Gaussian simulation with variogram range about 1/3 data extent</p></li>
<li><p>truncation of porosity simulation to calculate sand and shale facies for porosity continuity across facies boundaries</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of permeability given the porosity realization</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of acoustic impedance given the porosity realization</p></li>
</ul>
<p>Sampling by,</p>
<ul class="simple">
<li><p>combination of regular and random sampling with rejection sampler to promote a high sample bias (low for acoustic impedance) to calculate 2D well locations</p></li>
<li><p>values of collocated grid cell with error component assigned to the 2D point set</p></li>
</ul>
&#13;

<h3>Load the Dataset</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/12_sample_data.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">AI_12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="sa">r</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/12_AI.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">)</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>         <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">twelve</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Facies"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"cmap_facies"</span><span class="p">,</span>         
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Facies"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Facies"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"Sand - 1, Shale - 0"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'int'</span>
    <span class="p">},</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"fraction"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">6500</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="n">AI_12</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">twelve</span><span class="p">):</span>                   <span class="c1"># loop over features</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">twelve</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>
        <span class="n">locmap_facies</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
              <span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X (m)'</span><span class="p">,</span><span class="s1">'Y (m)'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span>
              <span class="n">cmap_facies</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">locmap_st</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                <span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X(m)'</span><span class="p">,</span><span class="s1">'Y(m)'</span><span class="p">,</span>
                             <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">]);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">AI_12</span><span class="p">,</span><span class="n">interpolation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                            <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map and Grid'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="s1">'large'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">twelve</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>         
        <span class="n">hist_sand_shale</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="s1">'Twelve: Facies Well Data Distribution'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
                 <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Well Data'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'Average: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.82</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'St.Dev.: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.77</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P10:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.72</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P90:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.67</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'n:       '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.62</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Twelve: '</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">' Well Data Distribution'</span><span class="p">);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Seismic'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5cb94f5fcbf98ca2e1a2c7fd7d7ce5c4a6c719c65327d6be075957487604ac03.png" src="../Images/bd8db61587012578bf4ac5ffa4e48d97.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/5cb94f5fcbf98ca2e1a2c7fd7d7ce5c4a6c719c65327d6be075957487604ac03.png"/>
</div>
</div>
&#13;

<h2>Dataset: Density and Porosity Well</h2>
<p>Density and Porosity Well is a single vertical well section with exhaustively sampled density from RHOB well log and porosity from a continuous well core sampled at 0.25 <span class="math notranslate nohighlight">\(m\)</span> intervals along the well. All of the samples are within a single reservoir formation and a single facies.</p>
<p><strong>Highlights</strong> - simple 1D, 2 feature dataset with a generally linear relationship</p>
<p>Density and Porosity Well includes these features,</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Density</p></td>
<td class="text-center"><p>Density</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{g}{cm^3}\)</span></p></td>
<td><p>RHOB</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\%\)</span></p></td>
<td><p>from core analysis</p></td>
</tr>
</tbody>
</table>
<section id="id1">
<h3>Depositional Setting</h3>
<p>A single stratigraphic unit interpreted as stacked fluvial channel complex with channel elements from 1 to 9. The channel elements incise into each other greatly reducing the apparent element thickness and removing the low porosity top of channel element fills and overbank due to channel avulsion. The channels may be confined because of the lack of margin and overbank depofacies, the well log seems to only include the channel axis component of the stacked channel elements.</p>
<figure style="text-align: center;">
  <img src="../Images/3c53c2329f8aaa701f5941d69ae0e9b4.png" style="display: block; margin: 0 auto; width: 40%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/denporgeo.png"/>
  <figcaption style="text-align: center;">Interpreted stacked fluvial channel element sequence from 1 to 9. The channel elements cut into each other greatly reducing the apparent thickness and removing the low porosity top of channel element fills and all overbank due to avulsion. </figcaption>
</figure>
</section>
<section id="id2">
<h3>Method for Synthetic Data Generation</h3>
<p>Density log by,</p>
<ul class="simple">
<li><p>convolution applied to a vector of random Gaussian values to impose spatial continuity</p></li>
</ul>
<p>Porosity log by,</p>
<ul class="simple">
<li><p>truncation of porosity simulation to calculate sand and shale facies for porosity continuity across facies boundaries</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of permeability given the porosity realization</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of acoustic impedance given the porosity realization</p></li>
</ul>
<p>Sampling by,</p>
<ul class="simple">
<li><p>combination of regular and random sampling with rejection sampler to promote a high sample bias (low for acoustic impedance) to calculate 2D well locations</p></li>
<li><p>values of collocated grid cell with error component assigned to the 2D point set</p></li>
</ul>
</section>
<section id="id3">
<h3>Load the Dataset</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_denpor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/Density_Por_data.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>         <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">denpor</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Depth"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">26.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>         
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Depth"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Depth"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$m$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Density"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">2.4</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>         
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{g}</span><span class="s2">{cm^3}$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'one'</span>
    <span class="p">},</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">25.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"viridis"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\%$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'one'</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>

<span class="n">feature_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Density'</span><span class="p">,</span><span class="s1">'Porosity'</span><span class="p">]</span>   <span class="c1"># early Python does not preserve dictionary list, this is safer than looping over dictionary</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>  <span class="c1"># Adjust for comfortable aspect</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax5</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># Spans both columns</span>

<span class="n">mid_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax3</span><span class="p">,</span><span class="n">ax4</span><span class="p">];</span> <span class="n">top_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">]</span>

<span class="k">for</span> <span class="n">iax</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">top_axes</span><span class="p">):</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="n">feature_list</span><span class="p">[</span><span class="n">iax</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">df_denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"min"</span><span class="p">]);</span> <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Density and Porosity Well: '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Log'</span><span class="p">)</span>
    <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>

<span class="k">for</span> <span class="n">iax</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mid_axes</span><span class="p">):</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="n">feature_list</span><span class="p">[</span><span class="n">iax</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
          <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Well Data'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'Average: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.90</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'St.Dev.: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.85</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P10:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.80</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P90:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.75</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'n:       '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.70</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Density and Porosity Well: '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">' Well Data Distribution'</span><span class="p">);</span> <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">ax5</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">],</span><span class="n">df_denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"max"</span><span class="p">]);</span> <span class="n">add_grid</span><span class="p">(</span><span class="n">ax5</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Density and Porosity Well: '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' vs. '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Log'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0f4a5b57cf79896f73db5f91af7e52f3e52bc86964806f0c537bbb7248105d51.png" src="../Images/2d56e175a4958ecbd3d748340b61deb6.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/0f4a5b57cf79896f73db5f91af7e52f3e52bc86964806f0c537bbb7248105d51.png"/>
</div>
</div>
</section>
&#13;

<h3>Depositional Setting</h3>
<p>A single stratigraphic unit interpreted as stacked fluvial channel complex with channel elements from 1 to 9. The channel elements incise into each other greatly reducing the apparent element thickness and removing the low porosity top of channel element fills and overbank due to channel avulsion. The channels may be confined because of the lack of margin and overbank depofacies, the well log seems to only include the channel axis component of the stacked channel elements.</p>
<figure style="text-align: center;">
  <img src="../Images/3c53c2329f8aaa701f5941d69ae0e9b4.png" style="display: block; margin: 0 auto; width: 40%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/denporgeo.png"/>
  <figcaption style="text-align: center;">Interpreted stacked fluvial channel element sequence from 1 to 9. The channel elements cut into each other greatly reducing the apparent thickness and removing the low porosity top of channel element fills and all overbank due to avulsion. </figcaption>
</figure>
&#13;

<h3>Method for Synthetic Data Generation</h3>
<p>Density log by,</p>
<ul class="simple">
<li><p>convolution applied to a vector of random Gaussian values to impose spatial continuity</p></li>
</ul>
<p>Porosity log by,</p>
<ul class="simple">
<li><p>truncation of porosity simulation to calculate sand and shale facies for porosity continuity across facies boundaries</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of permeability given the porosity realization</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of acoustic impedance given the porosity realization</p></li>
</ul>
<p>Sampling by,</p>
<ul class="simple">
<li><p>combination of regular and random sampling with rejection sampler to promote a high sample bias (low for acoustic impedance) to calculate 2D well locations</p></li>
<li><p>values of collocated grid cell with error component assigned to the 2D point set</p></li>
</ul>
&#13;

<h3>Load the Dataset</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_denpor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/Density_Por_data.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>         <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">denpor</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Depth"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">26.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>         
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Depth"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Depth"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$m$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Density"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">2.4</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>         
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{g}</span><span class="s2">{cm^3}$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'one'</span>
    <span class="p">},</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">25.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"viridis"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\%$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'one'</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>

<span class="n">feature_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Density'</span><span class="p">,</span><span class="s1">'Porosity'</span><span class="p">]</span>   <span class="c1"># early Python does not preserve dictionary list, this is safer than looping over dictionary</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>  <span class="c1"># Adjust for comfortable aspect</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax5</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># Spans both columns</span>

<span class="n">mid_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax3</span><span class="p">,</span><span class="n">ax4</span><span class="p">];</span> <span class="n">top_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">]</span>

<span class="k">for</span> <span class="n">iax</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">top_axes</span><span class="p">):</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="n">feature_list</span><span class="p">[</span><span class="n">iax</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">df_denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Depth'</span><span class="p">][</span><span class="s2">"min"</span><span class="p">]);</span> <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Density and Porosity Well: '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Log'</span><span class="p">)</span>
    <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>

<span class="k">for</span> <span class="n">iax</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mid_axes</span><span class="p">):</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="n">feature_list</span><span class="p">[</span><span class="n">iax</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
          <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Well Data'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'Average: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.90</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'St.Dev.: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.85</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P10:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.80</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P90:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.75</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'n:       '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))),[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.70</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
    <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Density and Porosity Well: '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">' Well Data Distribution'</span><span class="p">);</span> <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">ax5</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">],</span><span class="n">df_denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"max"</span><span class="p">]);</span> <span class="n">add_grid</span><span class="p">(</span><span class="n">ax5</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Density and Porosity Well: '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Porosity'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' vs. '</span> <span class="o">+</span> <span class="n">denpor</span><span class="p">[</span><span class="s1">'Density'</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Log'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0f4a5b57cf79896f73db5f91af7e52f3e52bc86964806f0c537bbb7248105d51.png" src="../Images/2d56e175a4958ecbd3d748340b61deb6.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/0f4a5b57cf79896f73db5f91af7e52f3e52bc86964806f0c537bbb7248105d51.png"/>
</div>
</div>
&#13;

<h2>Dataset: Spatial Nonlinear Multivariate Sandstone Only Facies v5</h2>
<p>Spatial Nonlinear Multivariate Sandstone Only Facies v5 (SNMSv5) is a densely sampled, multivariate, spatial conventional hydrocarbon dataset with a single sandstone facies.</p>
<p><strong>Link</strong> - the dataset is available <a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/spatial_nonlinear_MV_facies_v5_sand_only.csv">here</a> and the acoustic impedance map is <a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/spatial_nonlinear_MV_facies_v5_sand_only_truth_AI.csv">here</a> and the porosity truth model is <a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/spatial_nonlinear_MV_facies_v5_sand_only_truth_por.csv">here</a>.</p>
<p><strong>Highlights</strong>- porosity truth model for testing, missing component of the distribution suitable for soft data debiasing methods</p>
<ul class="simple">
<li><p>multivariate sparse sample data,</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>X</p></td>
<td class="text-center"><p>X</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>x coordinate</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Y</p></td>
<td class="text-center"><p>Y</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>y coordinate</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Facies</p></td>
<td class="text-center"><p>Facies</p></td>
<td class="text-center"><p>indicator</p></td>
<td><p>0 = shalestone, 1 = sandstone</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>effective porosity</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Permeability</p></td>
<td class="text-center"><p>Perm</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(mD\)</span></p></td>
<td><p>isotropic, horizontal</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>interpolated from seismic</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>2D regular grid truth model and map,</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>truth model for testing</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>inverted from seismic data</p></td>
</tr>
</tbody>
</table>
<section id="id6">
<h3>Depositional Setting</h3>
<p>A single stratigraphic unit interpreted as fluvial dominated mixed sediment delta with 2 protruding subdeltas. Within each delta and subdelta there is distributary paleoflow resulting in multiple paleoflow directions and a general reduction in porosity and permeability from inner to outer delta.</p>
<figure style="text-align: center;">
  <img src="../Images/2cd1f4de49191162b44766175f8d15fc.png" style="display: block; margin: 0 auto; width: 60%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/snms5geo.png"/>
  <figcaption style="text-align: center;">Interpreted fluvial dominated, mixed sediment delta. </figcaption>
</figure>
</section>
<section id="id7">
<h3>Method for Synthetic Data Generation</h3>
<p>Truth model / population by geostatistical simulation over a exhaustive grid of 10 m x 10 m cells with,</p>
<ul class="simple">
<li><p>continuous porosity simulation with sequential Gaussian simulation with variogram range about 1/3 data extent</p></li>
<li><p>truncation of porosity simulation to calculate sand and shale facies for porosity continuity across facies boundaries</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of permeability given the porosity realization</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of acoustic impedance given the porosity realization</p></li>
</ul>
<p>Sampling by,</p>
<ul class="simple">
<li><p>combination of regular and random sampling with rejection sampler to promote a high sample bias (low for acoustic impedance) to calculate 2D well locations</p></li>
<li><p>values of collocated grid cell with error component assigned to the 2D point set</p></li>
</ul>
</section>
<section id="load-the-dataset-and-truth-model">
<h3>Load the Dataset and Truth Model</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_snms5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/spatial_nonlinear_MV_facies_v5_sand_only.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">AI_snms5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="sa">r</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/spatial_nonlinear_MV_facies_v5_sand_only_truth_AI.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">)</span>
<span class="n">Por_snms5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="sa">r</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/spatial_nonlinear_MV_facies_v5_sand_only_truth_por.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">)</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>         <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">snms5</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Por"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"fraction"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="n">Por_snms5</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">5500</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="n">AI_snms5</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snms5</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snms5</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>
        <span class="n">locmap_facies</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
              <span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X (m)'</span><span class="p">,</span><span class="s1">'Y (m)'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span>
              <span class="n">cmap_facies</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">locmap_st</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                <span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X(m)'</span><span class="p">,</span><span class="s1">'Y(m)'</span><span class="p">,</span>
                             <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">]);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">],</span><span class="n">interpolation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                            <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map and Grid'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="s1">'large'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snms5</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>         
        <span class="n">hist_sand_shale</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="s1">'Twelve: Facies Well Data Distribution'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
                 <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Well Data'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'Average: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.82</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'St.Dev.: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.77</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P10:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.72</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P90:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.67</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'n:       '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">))),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.62</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">' Well Data Distribution'</span><span class="p">);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Seismic'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">3.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3b991a08cacd0b184293ce92b3678c9f795629a76557b4d5443f80eb75db5be8.png" src="../Images/0a3cac4710963495851187a3a4d17be5.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/3b991a08cacd0b184293ce92b3678c9f795629a76557b4d5443f80eb75db5be8.png"/>
</div>
</div>
</section>
&#13;

<h3>Depositional Setting</h3>
<p>A single stratigraphic unit interpreted as fluvial dominated mixed sediment delta with 2 protruding subdeltas. Within each delta and subdelta there is distributary paleoflow resulting in multiple paleoflow directions and a general reduction in porosity and permeability from inner to outer delta.</p>
<figure style="text-align: center;">
  <img src="../Images/2cd1f4de49191162b44766175f8d15fc.png" style="display: block; margin: 0 auto; width: 60%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/snms5geo.png"/>
  <figcaption style="text-align: center;">Interpreted fluvial dominated, mixed sediment delta. </figcaption>
</figure>
&#13;

<h3>Method for Synthetic Data Generation</h3>
<p>Truth model / population by geostatistical simulation over a exhaustive grid of 10 m x 10 m cells with,</p>
<ul class="simple">
<li><p>continuous porosity simulation with sequential Gaussian simulation with variogram range about 1/3 data extent</p></li>
<li><p>truncation of porosity simulation to calculate sand and shale facies for porosity continuity across facies boundaries</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of permeability given the porosity realization</p></li>
<li><p>continuous, cosimulation with collocated cokriging Markov-Bayes simulation of acoustic impedance given the porosity realization</p></li>
</ul>
<p>Sampling by,</p>
<ul class="simple">
<li><p>combination of regular and random sampling with rejection sampler to promote a high sample bias (low for acoustic impedance) to calculate 2D well locations</p></li>
<li><p>values of collocated grid cell with error component assigned to the 2D point set</p></li>
</ul>
&#13;

<h3>Load the Dataset and Truth Model</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_snms5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/spatial_nonlinear_MV_facies_v5_sand_only.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">AI_snms5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="sa">r</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/spatial_nonlinear_MV_facies_v5_sand_only_truth_AI.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">)</span>
<span class="n">Por_snms5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="sa">r</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/spatial_nonlinear_MV_facies_v5_sand_only_truth_por.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">)</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span> <span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>         <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">snms5</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Por"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"fraction"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="n">Por_snms5</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">5500</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="n">AI_snms5</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snms5</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snms5</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>
        <span class="n">locmap_facies</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
              <span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X (m)'</span><span class="p">,</span><span class="s1">'Y (m)'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span>
              <span class="n">cmap_facies</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">locmap_st</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="s1">'Y'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                <span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map'</span><span class="p">,</span><span class="s1">'X(m)'</span><span class="p">,</span><span class="s1">'Y(m)'</span><span class="p">,</span>
                             <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">]);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">],</span><span class="n">interpolation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span>
                            <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"colormap"</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' Well Data Location Map and Grid'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="s1">'large'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snms5</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">'Facies'</span><span class="p">:</span>         
        <span class="n">hist_sand_shale</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">],</span><span class="s1">'Twelve: Facies Well Data Distribution'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
                 <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Well Data'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'Average: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.82</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'St.Dev.: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.77</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P10:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.72</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'P90:     '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.67</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'n:       '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">))),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.62</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">'axes fraction'</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_snms5</span><span class="p">[</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"fname"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"format"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"units"</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'SNMS5: '</span> <span class="o">+</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">' Well Data Distribution'</span><span class="p">);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"map"</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">snms5</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">"max"</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Seismic'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">3.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3b991a08cacd0b184293ce92b3678c9f795629a76557b4d5443f80eb75db5be8.png" src="../Images/0a3cac4710963495851187a3a4d17be5.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/3b991a08cacd0b184293ce92b3678c9f795629a76557b4d5443f80eb75db5be8.png"/>
</div>
</div>
&#13;

<h2>Dataset: Unconventional Multivariate v5</h2>
<p>Unconventional Mutlivariate v5 (UNMV5) is a densely sampled, multivariate, unconventional hydrocarbon dataset with a single sandstone facies.</p>
<p><strong>Link</strong> - the dataset is available <a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/unconv_MV_v5.csv">here</a>.</p>
<p><strong>Highlights</strong> - large number of potential features for feature selection, feature engineering and predictive machine learning model construction</p>
<ul class="simple">
<li><p>multivariate sparse sample data,</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>effective porosity</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Permeability</p></td>
<td class="text-center"><p>Perm</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(mD\)</span></p></td>
<td><p>isotropic, horizontal</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>interpolated from seismic inversion</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Brittleness Index</p></td>
<td class="text-center"><p>Brittle</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>elastic moduli-based method</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Total Organic Carbon</p></td>
<td class="text-center"><p>TOC</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\%\)</span></p></td>
<td><p>LECO analyzer</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Vitrinite Reflectance</p></td>
<td class="text-center"><p>VR</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\%\)</span></p></td>
<td><p>mean random reflectance</p></td>
</tr>
</tbody>
</table>
<section id="id10">
<h3>Depositional Setting</h3>
<p>Mixed carbonate and siliciclastic unconventional gas reservoir with good porosity, but poor permeability. In an effort to improve production potential prediction, various features have been collected including total organic carbon, brittleness and vitrinite reflectance. Due to the complicated recovery mechanisms, and the superposition of factors such as natural fracture systems interacting with artificial fractures, and often limited matrix flow rates, unconventional reservoir forecasting can be quite challenging.</p>
</section>
<section id="id11">
<h3>Method for Synthetic Data Generation</h3>
<p>Samples drawn from multivariate distributions,</p>
<ul class="simple">
<li><p>sample from a large <span class="math notranslate nohighlight">\(M\)</span> multivariate Gaussian distribution with correlation defined by a covariance matrix with strong and weak, positive and negative correlations</p></li>
<li><p>calculate the features as combinations of the <span class="math notranslate nohighlight">\(M\)</span> features with a variety of transformations to impose nonlinear relationships</p></li>
<li><p>transform the marginal distributions to impose nonGaussian univariate distributions</p></li>
</ul>
</section>
<section id="id12">
<h3>Load the Dataset and Truth Model</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_unmv5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/unconv_MV_v5.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>

<span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>                                <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">unmv5</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Por"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"fraction"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Brittle"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Brittleness"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Brittle"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"unitless"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"TOC"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Total Organic Carbon"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"TOC"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\%$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"VR"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Vitrinite Reflectance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"VR"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\%$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Prod"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Production"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Prod"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$MCFPD$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">'fname'</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">unmv5</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unmv5</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">unmv5</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">df_unmv5</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">map_upper</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'darkorange'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'darkorange'</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'k'</span><span class="p">)</span><span class="c1"># Map a density plot to the lower triangle</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">,</span> 
                              <span class="n">shade</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">shade_lowest</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n_levels</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># pp_unmv5.map(sns.scatterplot)</span>

<span class="c1"># Draw everything first so axes exist and are not overridden</span>
<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]):</span>  <span class="c1"># First column =&gt; leftmost Y axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]):</span>  <span class="c1"># First column =&gt; leftmost Y axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
        <span class="c1"># print(i,j)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4e0bd252f6c9ea9e0b842143513db9a84fa1215a4e33ad41ffaf0a80b1632a53.png" src="../Images/992ab9aa628b6539fb25e760f2952531.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/4e0bd252f6c9ea9e0b842143513db9a84fa1215a4e33ad41ffaf0a80b1632a53.png"/>
</div>
</div>
</section>
&#13;

<h3>Depositional Setting</h3>
<p>Mixed carbonate and siliciclastic unconventional gas reservoir with good porosity, but poor permeability. In an effort to improve production potential prediction, various features have been collected including total organic carbon, brittleness and vitrinite reflectance. Due to the complicated recovery mechanisms, and the superposition of factors such as natural fracture systems interacting with artificial fractures, and often limited matrix flow rates, unconventional reservoir forecasting can be quite challenging.</p>
&#13;

<h3>Method for Synthetic Data Generation</h3>
<p>Samples drawn from multivariate distributions,</p>
<ul class="simple">
<li><p>sample from a large <span class="math notranslate nohighlight">\(M\)</span> multivariate Gaussian distribution with correlation defined by a covariance matrix with strong and weak, positive and negative correlations</p></li>
<li><p>calculate the features as combinations of the <span class="math notranslate nohighlight">\(M\)</span> features with a variety of transformations to impose nonlinear relationships</p></li>
<li><p>transform the marginal distributions to impose nonGaussian univariate distributions</p></li>
</ul>
&#13;

<h3>Load the Dataset and Truth Model</h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_unmv5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/unconv_MV_v5.csv"</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>

<span class="n">nbin</span> <span class="o">=</span> <span class="mi">30</span>                                <span class="c1"># set the data extents and number of bins for histograms</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h3>Dataset Dictionary</h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">unmv5</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"Porosity"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Por"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"fraction"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Brittle"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Brittleness"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Brittle"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"unitless"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"TOC"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Total Organic Carbon"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"TOC"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\%$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"VR"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Vitrinite Reflectance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"VR"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\%$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Prod"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Production"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Prod"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$MCFPD$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h3>Visualize the Dataset</h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">'fname'</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">unmv5</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unmv5</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">unmv5</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">df_unmv5</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">map_upper</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'darkorange'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'darkorange'</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'k'</span><span class="p">)</span><span class="c1"># Map a density plot to the lower triangle</span>
<span class="n">pp_unmv5</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">,</span> 
                              <span class="n">shade</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">shade_lowest</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n_levels</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># pp_unmv5.map(sns.scatterplot)</span>

<span class="c1"># Draw everything first so axes exist and are not overridden</span>
<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]):</span>  <span class="c1"># First column =&gt; leftmost Y axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]):</span>  <span class="c1"># First column =&gt; leftmost Y axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
        <span class="c1"># print(i,j)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">pp_unmv5</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">unmv5</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4e0bd252f6c9ea9e0b842143513db9a84fa1215a4e33ad41ffaf0a80b1632a53.png" src="../Images/992ab9aa628b6539fb25e760f2952531.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/4e0bd252f6c9ea9e0b842143513db9a84fa1215a4e33ad41ffaf0a80b1632a53.png"/>
</div>
</div>
&#13;

<h2>Dataset: Reservoir 21</h2>
<p>Reservoir 21 is a large, isolated reservoir unit with good porosity and permeability.</p>
<section id="id15">
<h3>Depositional Setting</h3>
<p>The reservoir sediments was transported by submarine turbidity currents and deposited lithified to become turbidites. The turbidites are separated into 4 ordinal facies,</p>
<ol class="arabic simple">
<li><p>shalestone</p></li>
<li><p>sandy-shalestone</p></li>
<li><p>shaly-sandstone</p></li>
<li><p>sandstone</p></li>
</ol>
<p>with increase rock quality, porosity and permeability over the above indicated categories from worst = 1 (shalestone) to best = 4 (sandstone). Postdepositional the turbidite formation’s pore space was filled by migrating hydrocarbons that were trapped by a thick shale above the unit.</p>
<p>The transport and depositional mechanisms of turbidites are explained in <a class="reference external" href="https://en.wikipedia.org/wiki/Turbidite">Wikipedia’s Turbidtes Article</a> and a good overview of modeling turbidite reservoirs is available in <a class="reference external" href="https://en.wikipedia.org/wiki/Turbidite">McHarge et al., 2011</a>.</p>
<p>A schematic of turbidite transport and demposition is available in Wikipedia Turbidite article (Figure 1).</p>
<figure style="text-align: center;">
  <img src="../Images/75f1e88b704c9094336ec818b66e6e06.png" style="display: block; margin: 0 auto; width: 100%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/turbidite_deposition.gif"/>
  <figcaption style="text-align: center;">Type of sediment source and sediment and the resulting types of turbidite deposits (image from Stow and Mayall, 2000).</figcaption>
</figure>
<p>A good model for is a submarine avalanche, known as a turbidity current, traveling from the shelf break down the slope to the deep ocean basins</p>
<ul class="simple">
<li><p>the driving force is a apparent increase in density due to the mixing of water and grains</p></li>
<li><p>the gradient of the slope is typically between 1 and 2 degrees (1% - 4% gradient)</p></li>
<li><p>these turbidity current can travel 100s to 1,500 km (Bay of Biscay to the Atlantic abyssal plain)</p></li>
<li><p>common speeds are 5 - 20 m/s (20 - 70 km/h)</p></li>
<li><p>to visualize this in the laboratory, see this short <a class="reference external" href="https://youtu.be/y7BbYg1sDnU?si=wUjMEh5xSxfQFM_L">Turbidity Current YouTube Video</a>.</p></li>
</ul>
<p>Turbidity currents result in formation of extensive high porosity and moderate permeability reservoirs in deep water settings.</p>
<p>Here’s some more important details about this dataset,</p>
<ul class="simple">
<li><p><strong>Volume of Interest</strong>: clastic deepwater turbidite reservoir unit with extents 10 km by 10 km by 50 m (thickness)</p></li>
<li><p><strong>Fluids</strong>: initial oil water contact is at the depth of 3067.4m and the average connate water saturation is about 20.3%</p></li>
<li><p><strong>Structure</strong>: Anticline structure with a major vertical fault that crosses the reservoir (see location and equation on the image below). It is unknown if there is translation (discontinuity) across the fault.</p></li>
<li><p><strong>Grids</strong>: the 2D maps conform to the standard Python convention, origin on Top Left (see the image below).</p></li>
</ul>
<figure style="text-align: center;">
  <img src="../Images/df72b88a158bcef1ed565b75d7b26240.png" style="display: block; margin: 0 auto; width: 60%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/res21_planview.png"/>
  <figcaption style="text-align: center;">Plan view of Reservoir 21.</figcaption>
</figure>
<p><strong>Figure 2:</strong> Plan view of Reservoir 21.</p>
<ul class="simple">
<li><p><strong>Wells</strong>: 83 vertical wells were drilled across the reservoir and completed throughout the reservoir unit. Due to the field management constraints, only 73 wells were open to produce oil for the first three years, while the remaining 10 wells were kept shut-in. At the end of the third year, the remaining 10 unproduced wells are planned to be opened.</p></li>
</ul>
</section>
<section id="well-logs">
<h3>Well Logs</h3>
<p>The well logs for the 73 wells are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_wells.csv">res21_well.csv</a> a</p></li>
</ul>
<p>and the associated 1, 2 and 3 year cumulative oil and water production are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_production_history.csv">res21_production_history.csv</a> a</p></li>
</ul>
<p>while the new 10 wells (prior to production) well logs are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_new_wells.csv">res21_new_wells.csv</a></p></li>
</ul>
<p>Comments:</p>
<ul class="simple">
<li><p>all the well names are masked (replaced with simple indices from 1 to 83) and coordinates transformed to the area of interest to conceal the actual reservoir.</p></li>
<li><p>available petrophysical and geomechanical properties are listed.</p></li>
<li><p>blank entries in the file indicate missing data at those locations.</p></li>
</ul>
<p>Predictor features:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Well ID</p></td>
<td><p>Integer</p></td>
<td><p>Unique well identifier, anonymized, random integer</p></td>
</tr>
<tr class="row-odd"><td><p>X, Y</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>Well location in area of interest (0 - 10,000 in X and Y)</p></td>
</tr>
<tr class="row-even"><td><p>Facies</p></td>
<td><p>ordinal category</p></td>
<td><p>1 = shalestone, 2 = sandy-shalestone, 3 shaly-sandstone, 4 sandstone.</p></td>
</tr>
<tr class="row-odd"><td><p>Porosity</p></td>
<td><p>%</p></td>
<td><p>Measure of the void spaces in a material, expressed as a percentage.</p></td>
</tr>
<tr class="row-even"><td><p>Permeability</p></td>
<td><p><span class="math notranslate nohighlight">\(mD\)</span></p></td>
<td><p>Ability of a material to allow fluids to pass through its pore spaces im milliDarcies.</p></td>
</tr>
<tr class="row-odd"><td><p>Acoustic Impedance</p></td>
<td><p><span class="math notranslate nohighlight">\(kg/m^2 \cdot s x 10^6\)</span></p></td>
<td><p>Product of a material’s density and sound velocity, affecting wave behavior.</p></td>
</tr>
<tr class="row-even"><td><p>Rock Density</p></td>
<td><p><span class="math notranslate nohighlight">\(g/cm^3\)</span></p></td>
<td><p>Mass of a rock per unit volume.</p></td>
</tr>
<tr class="row-odd"><td><p>P-wave Velocity</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s}\)</span></p></td>
<td><p>Speed of compressional seismic waves through a material.</p></td>
</tr>
<tr class="row-even"><td><p>S-wave Velocity</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s}\)</span></p></td>
<td><p>Speed of shear seismic waves through a material.</p></td>
</tr>
<tr class="row-odd"><td><p>Young’s Modulus</p></td>
<td><p><span class="math notranslate nohighlight">\(GPa\)</span></p></td>
<td><p>Ratio of stress to strain in the elastic region; measures stiffness in gigapascals.</p></td>
</tr>
<tr class="row-even"><td><p>Shear Modulus</p></td>
<td><p><span class="math notranslate nohighlight">\(GPa\)</span></p></td>
<td><p>Ratio of shear stress to shear strain; measures resistance to shear in gigapascals.</p></td>
</tr>
</tbody>
</table>
<p>Response Feature:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cumul. Oil 1 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total oil produced by the well over one year in 1000s of barrels</p></td>
</tr>
<tr class="row-odd"><td><p>Cumul. Oil 2 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total oil produced by the well over two years in 1000s of barrels</p></td>
</tr>
<tr class="row-even"><td><p>Cumul. Oil 3 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total oil produced by the well over three years in 1000s of barrels</p></td>
</tr>
<tr class="row-odd"><td><p>Cumul. Water 1 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total water produced by the well over one year in 1000s of barrels</p></td>
</tr>
<tr class="row-even"><td><p>Cumul. Water 2 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total water produced by the well over two years in 1000s of barrels</p></td>
</tr>
<tr class="row-odd"><td><p>Cumul. Water 3 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total water produced by the well over three year in 1000s of barrels</p></td>
</tr>
</tbody>
</table>
</section>
<section id="map-data">
<h3>Map Data</h3>
<p>The following map data are available,</p>
<p>Acoustic impedance (AI) inverted from geophysical amplitudes and interpretations,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_ai_map.npy"><strong>res21_ai_map.npy</strong></a></p></li>
</ul>
<p>Proportion of facies, sandstone, shaly-sandstone, sandy-shalestone and shalestone are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_2d_sand_prop_map.npy">res21_2d_sand_prop_map.npy</a></p></li>
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_shaly_sand_prop_map.npy">res21_shaly_sand_prop_map.npy</a></p></li>
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_sandy_shale_prop_map.npy">res21_sandy_shale_prop_map.npy</a></p></li>
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_shale_prop_map.npy">res21_shale_prop_map.npy</a></p></li>
</ul>
<p>Note, the facies proportions are calculated by a well calibrated model with well data and acoustic impedance and the 4 proportions sum to 1.0 (honor probability closure). The top of the formation map is available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_top_depth_map.npy">res21_top_depth_map.npy</a></p></li>
</ul>
<p>Comments on the 2D map, gridded data format,</p>
<ul class="simple">
<li><p>2D maps are regular grids 200 by 200 cells, cell extents are 50m by 50m, extending over the reservoir</p></li>
<li><p>values indicate the vertically averaged property, vertical resolution is the entire reservoir unit</p></li>
<li><p>the indices follow standard Python convention, original is top left corner, indices are from 0, 1, …, n-1 and the first index is the row (from the top) and the second index is the column from the left</p></li>
<li><p>e.g. to select the 5th grid cell in x (column) and the 10th grid cell in y (rows), use ndarray[9,4] in Python (aside, array[10,5] in Matlab)</p></li>
<li><p>the origin of the 2D data (e.g., array[0,0]) is the center of the top left cell, 25m and 25m along y and x direction (refer to the image above)</p></li>
</ul>
</section>
<section id="d-vertically-averaged-data">
<h3>2D Vertically Averaged Data</h3>
<p>For simplified workflow testing, a vertically averaged 2D variant of the dataset was made by,</p>
<ul class="simple">
<li><p>averaging all the continuous well log features over the entire reservoir unit</p></li>
<li><p>combining a single response feature (3 year cumulative oil production) with the predictor features</p></li>
<li><p>removing facies to avoid the issue of upscaling the categorical ordinal feature</p></li>
</ul>
<p>These two files contain the predictor features, well log data, averaged over the entire well bore for all 73 wells, i.e., one value per well for each feature, and the one response feature, 3 year cumulative oil production,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_2D_wells.csv"><strong>res21_2D_wells.csv</strong></a> - 2D averaged well data and 3 year cumulative oil production for the previous production wells, well indices from 1 to 73</p></li>
</ul>
<p>and well log data averaged over the entire well bore for all 10 test wells,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_2D_wells_test.csv"><strong>res21_2D_wells_test.csv</strong></a> - 2D averaged well data for the remaining, preproduction wells, well indices from 74 to 83</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">res21</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"X"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"X"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"X"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"m"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Y"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Y"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Y"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"m"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span> 
    <span class="s2">"Por"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">17.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Por"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"%"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">70.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">200.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">6.9</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">7.6</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Density"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">1.6</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">2.6</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"\frac</span><span class="si">{g}</span><span class="s2">{cm^2}"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"PVel"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">3200.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">4500.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"P-wave Velocity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"PVel"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{m}{s}</span><span class="s2">$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Youngs"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">22.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">32.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Youngs Modulas"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Youngs"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$GPA$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span> 
    <span class="s2">"SVel"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">1600.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">1750.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"S-wave Velocity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"SVel"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{m}{s}</span><span class="s2">$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>    
    <span class="s2">"Shear"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">4.5</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Shear Modulus"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Shear"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$GPA$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"CumulativeOil"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">3000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Cumulative Oil Production"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"CumulativeOil"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$Mbbls$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h3>Load the Dataset and Truth Model</h3>
<p>Let’s load the 2D dataset and visualize it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_res21_2D</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_2D_wells.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">'Well_ID'</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">df_res21_2D_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_2D_wells_test.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">'Well_ID'</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="c1">#df_res21_2D.head()                                           # vizualize dataframe with 73 wells without production </span>
<span class="c1">#df_res21_2D_test.head()                                      # visualize dataframe with 10 wells with production</span>
<span class="n">df_res21_2D</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>                            <span class="c1"># check summary statistics</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th/>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>73.0</td>
      <td>4188.698630</td>
      <td>1783.143687</td>
      <td>1175.000000</td>
      <td>2925.000000</td>
      <td>3875.000000</td>
      <td>5325.000000</td>
      <td>7975.000000</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>73.0</td>
      <td>5770.890411</td>
      <td>2405.487844</td>
      <td>775.000000</td>
      <td>3825.000000</td>
      <td>6125.000000</td>
      <td>7625.000000</td>
      <td>9775.000000</td>
    </tr>
    <tr>
      <th>Por</th>
      <td>69.0</td>
      <td>12.822361</td>
      <td>1.069242</td>
      <td>10.449132</td>
      <td>12.122789</td>
      <td>12.842228</td>
      <td>13.532038</td>
      <td>15.837603</td>
    </tr>
    <tr>
      <th>Perm</th>
      <td>53.0</td>
      <td>119.292589</td>
      <td>23.003770</td>
      <td>85.457752</td>
      <td>101.821216</td>
      <td>116.341824</td>
      <td>130.554974</td>
      <td>184.753428</td>
    </tr>
    <tr>
      <th>AI</th>
      <td>69.0</td>
      <td>7.319194</td>
      <td>0.096761</td>
      <td>7.062172</td>
      <td>7.280405</td>
      <td>7.333877</td>
      <td>7.379185</td>
      <td>7.499137</td>
    </tr>
    <tr>
      <th>Density</th>
      <td>70.0</td>
      <td>2.043288</td>
      <td>0.138222</td>
      <td>1.793870</td>
      <td>1.921390</td>
      <td>2.039170</td>
      <td>2.162651</td>
      <td>2.301552</td>
    </tr>
    <tr>
      <th>PVel</th>
      <td>69.0</td>
      <td>3696.762373</td>
      <td>276.382117</td>
      <td>3229.902892</td>
      <td>3463.035301</td>
      <td>3688.453880</td>
      <td>3897.219799</td>
      <td>4327.857887</td>
    </tr>
    <tr>
      <th>Youngs</th>
      <td>49.0</td>
      <td>27.173417</td>
      <td>2.164984</td>
      <td>23.516002</td>
      <td>25.378138</td>
      <td>26.801655</td>
      <td>28.641350</td>
      <td>31.463424</td>
    </tr>
    <tr>
      <th>SVel</th>
      <td>65.0</td>
      <td>1676.908144</td>
      <td>19.277228</td>
      <td>1637.806458</td>
      <td>1662.280505</td>
      <td>1676.458624</td>
      <td>1688.682882</td>
      <td>1721.987891</td>
    </tr>
    <tr>
      <th>Shear</th>
      <td>48.0</td>
      <td>5.793693</td>
      <td>0.474087</td>
      <td>4.937921</td>
      <td>5.397281</td>
      <td>5.769809</td>
      <td>6.208277</td>
      <td>6.714150</td>
    </tr>
    <tr>
      <th>CumulativeOil</th>
      <td>73.0</td>
      <td>940.976027</td>
      <td>429.622150</td>
      <td>307.120000</td>
      <td>643.140000</td>
      <td>819.490000</td>
      <td>1185.400000</td>
      <td>2514.500000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now let’s load two of the 2D maps,</p>
<ul class="simple">
<li><p>average sand proportion</p></li>
<li><p>acoustic impedance</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">sand_prop_map_url</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_2d_sand_prop_map.npy'</span><span class="p">)</span>
<span class="n">sand_prop_map_url</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>                          <span class="c1"># Raise an error if the download fails</span>
<span class="n">sand_prop_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">sand_prop_map_url</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>   <span class="c1"># load the .npy file from the downloaded bytes</span>

<span class="n">AI_map_url</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_ai_map.npy'</span><span class="p">)</span>
<span class="n">AI_map_url</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>                                 <span class="c1"># Raise an error if the download fails</span>
<span class="n">AI_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">AI_map_url</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>                 <span class="c1"># load the .npy file from the downloaded bytes</span>
<span class="n">AI_map</span> <span class="o">=</span> <span class="n">AI_map</span><span class="o">/</span><span class="mf">1000000.0</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-histograms-for-each-feature">
<h3>Calculate Histograms for Each Feature</h3>
<p>Let’s use the dictionary above to make histograms for each feature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">for</span> <span class="n">ifeat</span><span class="p">,</span><span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>          <span class="c1"># loop over all features in the dataframe with 73 wells with production</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ifeat</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                                  <span class="c1"># subplot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'fname'</span><span class="p">]],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span> <span class="c1"># histogram</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Frequency'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">feature</span> <span class="o">+</span> <span class="s1">' Histogram'</span><span class="p">)</span> <span class="c1"># labels </span>
    <span class="n">add_grid2</span><span class="p">()</span>                                               <span class="c1"># major and minor gridlines function</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">3.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b4761de96b21bc454ebeacf66cc850f374aa90d60414d5e118476081f8c2d2e5.png" src="../Images/8789e1495b2bb781d5a677f928dc01ba.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/b4761de96b21bc454ebeacf66cc850f374aa90d60414d5e118476081f8c2d2e5.png"/>
</div>
</div>
</section>
<section id="id17">
<h3>Visualize the Dataset</h3>
<p>Now we can visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">ifeat</span> <span class="o">=</span> <span class="mi">4</span>                                                    <span class="c1"># select feature for scatter plot, 0 - 10</span>
<span class="n">feature</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="n">res21</span><span class="p">)[</span><span class="n">ifeat</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sand_prop_map</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span> <span class="c1"># 2D map</span>
<span class="n">cb1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.036</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.18</span><span class="p">)</span>                         <span class="c1"># colorbar for 2D map</span>
<span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">"Proportion of Sand (fraction)"</span><span class="p">)</span>                           <span class="c1"># colorbar label for 2D map</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'fname'</span><span class="p">]],</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'current wells'</span><span class="p">)</span>       <span class="c1"># wells with production scatter plot</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>                         <span class="c1"># colorbar for scatter plot</span>
<span class="n">cb2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">)</span> <span class="c1"># colorbar label for scatter plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'new wells'</span><span class="p">)</span> <span class="c1"># wells without production</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Y (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' and Sand Proportion Map'</span><span class="p">)</span> <span class="c1"># labels for axes and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">AI_map</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span> <span class="c1"># 2D map</span>
<span class="n">cb1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.036</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.18</span><span class="p">)</span>                         <span class="c1"># colorbar for 2D map</span>
<span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">)</span>                           <span class="c1"># colorbar label for 2D map</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'fname'</span><span class="p">]],</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'current wells'</span><span class="p">)</span> <span class="c1"># wells with production scatter plot</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>                         <span class="c1"># colorbar for scatter plot</span>
<span class="n">cb2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">)</span> <span class="c1"># colorbar label for scatter plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'new wells'</span><span class="p">)</span> <span class="c1"># wells without production</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Y (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' and Acoustic Impedance Map'</span><span class="p">)</span> <span class="c1"># labels for axes and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/124ec120233d26da8692b8d6959cc2235528e45cbad7fbb44ac2e4635874d7bc.png" src="../Images/85757e86276ec552d3cb1ae5aa5224da.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/124ec120233d26da8692b8d6959cc2235528e45cbad7fbb44ac2e4635874d7bc.png"/>
</div>
</div>
</section>
&#13;

<h3>Depositional Setting</h3>
<p>The reservoir sediments was transported by submarine turbidity currents and deposited lithified to become turbidites. The turbidites are separated into 4 ordinal facies,</p>
<ol class="arabic simple">
<li><p>shalestone</p></li>
<li><p>sandy-shalestone</p></li>
<li><p>shaly-sandstone</p></li>
<li><p>sandstone</p></li>
</ol>
<p>with increase rock quality, porosity and permeability over the above indicated categories from worst = 1 (shalestone) to best = 4 (sandstone). Postdepositional the turbidite formation’s pore space was filled by migrating hydrocarbons that were trapped by a thick shale above the unit.</p>
<p>The transport and depositional mechanisms of turbidites are explained in <a class="reference external" href="https://en.wikipedia.org/wiki/Turbidite">Wikipedia’s Turbidtes Article</a> and a good overview of modeling turbidite reservoirs is available in <a class="reference external" href="https://en.wikipedia.org/wiki/Turbidite">McHarge et al., 2011</a>.</p>
<p>A schematic of turbidite transport and demposition is available in Wikipedia Turbidite article (Figure 1).</p>
<figure style="text-align: center;">
  <img src="../Images/75f1e88b704c9094336ec818b66e6e06.png" style="display: block; margin: 0 auto; width: 100%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/turbidite_deposition.gif"/>
  <figcaption style="text-align: center;">Type of sediment source and sediment and the resulting types of turbidite deposits (image from Stow and Mayall, 2000).</figcaption>
</figure>
<p>A good model for is a submarine avalanche, known as a turbidity current, traveling from the shelf break down the slope to the deep ocean basins</p>
<ul class="simple">
<li><p>the driving force is a apparent increase in density due to the mixing of water and grains</p></li>
<li><p>the gradient of the slope is typically between 1 and 2 degrees (1% - 4% gradient)</p></li>
<li><p>these turbidity current can travel 100s to 1,500 km (Bay of Biscay to the Atlantic abyssal plain)</p></li>
<li><p>common speeds are 5 - 20 m/s (20 - 70 km/h)</p></li>
<li><p>to visualize this in the laboratory, see this short <a class="reference external" href="https://youtu.be/y7BbYg1sDnU?si=wUjMEh5xSxfQFM_L">Turbidity Current YouTube Video</a>.</p></li>
</ul>
<p>Turbidity currents result in formation of extensive high porosity and moderate permeability reservoirs in deep water settings.</p>
<p>Here’s some more important details about this dataset,</p>
<ul class="simple">
<li><p><strong>Volume of Interest</strong>: clastic deepwater turbidite reservoir unit with extents 10 km by 10 km by 50 m (thickness)</p></li>
<li><p><strong>Fluids</strong>: initial oil water contact is at the depth of 3067.4m and the average connate water saturation is about 20.3%</p></li>
<li><p><strong>Structure</strong>: Anticline structure with a major vertical fault that crosses the reservoir (see location and equation on the image below). It is unknown if there is translation (discontinuity) across the fault.</p></li>
<li><p><strong>Grids</strong>: the 2D maps conform to the standard Python convention, origin on Top Left (see the image below).</p></li>
</ul>
<figure style="text-align: center;">
  <img src="../Images/df72b88a158bcef1ed565b75d7b26240.png" style="display: block; margin: 0 auto; width: 60%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/data/res21_planview.png"/>
  <figcaption style="text-align: center;">Plan view of Reservoir 21.</figcaption>
</figure>
<p><strong>Figure 2:</strong> Plan view of Reservoir 21.</p>
<ul class="simple">
<li><p><strong>Wells</strong>: 83 vertical wells were drilled across the reservoir and completed throughout the reservoir unit. Due to the field management constraints, only 73 wells were open to produce oil for the first three years, while the remaining 10 wells were kept shut-in. At the end of the third year, the remaining 10 unproduced wells are planned to be opened.</p></li>
</ul>
&#13;

<h3>Well Logs</h3>
<p>The well logs for the 73 wells are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_wells.csv">res21_well.csv</a> a</p></li>
</ul>
<p>and the associated 1, 2 and 3 year cumulative oil and water production are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_production_history.csv">res21_production_history.csv</a> a</p></li>
</ul>
<p>while the new 10 wells (prior to production) well logs are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_new_wells.csv">res21_new_wells.csv</a></p></li>
</ul>
<p>Comments:</p>
<ul class="simple">
<li><p>all the well names are masked (replaced with simple indices from 1 to 83) and coordinates transformed to the area of interest to conceal the actual reservoir.</p></li>
<li><p>available petrophysical and geomechanical properties are listed.</p></li>
<li><p>blank entries in the file indicate missing data at those locations.</p></li>
</ul>
<p>Predictor features:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Well ID</p></td>
<td><p>Integer</p></td>
<td><p>Unique well identifier, anonymized, random integer</p></td>
</tr>
<tr class="row-odd"><td><p>X, Y</p></td>
<td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>Well location in area of interest (0 - 10,000 in X and Y)</p></td>
</tr>
<tr class="row-even"><td><p>Facies</p></td>
<td><p>ordinal category</p></td>
<td><p>1 = shalestone, 2 = sandy-shalestone, 3 shaly-sandstone, 4 sandstone.</p></td>
</tr>
<tr class="row-odd"><td><p>Porosity</p></td>
<td><p>%</p></td>
<td><p>Measure of the void spaces in a material, expressed as a percentage.</p></td>
</tr>
<tr class="row-even"><td><p>Permeability</p></td>
<td><p><span class="math notranslate nohighlight">\(mD\)</span></p></td>
<td><p>Ability of a material to allow fluids to pass through its pore spaces im milliDarcies.</p></td>
</tr>
<tr class="row-odd"><td><p>Acoustic Impedance</p></td>
<td><p><span class="math notranslate nohighlight">\(kg/m^2 \cdot s x 10^6\)</span></p></td>
<td><p>Product of a material’s density and sound velocity, affecting wave behavior.</p></td>
</tr>
<tr class="row-even"><td><p>Rock Density</p></td>
<td><p><span class="math notranslate nohighlight">\(g/cm^3\)</span></p></td>
<td><p>Mass of a rock per unit volume.</p></td>
</tr>
<tr class="row-odd"><td><p>P-wave Velocity</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s}\)</span></p></td>
<td><p>Speed of compressional seismic waves through a material.</p></td>
</tr>
<tr class="row-even"><td><p>S-wave Velocity</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{m}{s}\)</span></p></td>
<td><p>Speed of shear seismic waves through a material.</p></td>
</tr>
<tr class="row-odd"><td><p>Young’s Modulus</p></td>
<td><p><span class="math notranslate nohighlight">\(GPa\)</span></p></td>
<td><p>Ratio of stress to strain in the elastic region; measures stiffness in gigapascals.</p></td>
</tr>
<tr class="row-even"><td><p>Shear Modulus</p></td>
<td><p><span class="math notranslate nohighlight">\(GPa\)</span></p></td>
<td><p>Ratio of shear stress to shear strain; measures resistance to shear in gigapascals.</p></td>
</tr>
</tbody>
</table>
<p>Response Feature:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cumul. Oil 1 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total oil produced by the well over one year in 1000s of barrels</p></td>
</tr>
<tr class="row-odd"><td><p>Cumul. Oil 2 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total oil produced by the well over two years in 1000s of barrels</p></td>
</tr>
<tr class="row-even"><td><p>Cumul. Oil 3 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total oil produced by the well over three years in 1000s of barrels</p></td>
</tr>
<tr class="row-odd"><td><p>Cumul. Water 1 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total water produced by the well over one year in 1000s of barrels</p></td>
</tr>
<tr class="row-even"><td><p>Cumul. Water 2 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total water produced by the well over two years in 1000s of barrels</p></td>
</tr>
<tr class="row-odd"><td><p>Cumul. Water 3 year</p></td>
<td><p>Mbbls</p></td>
<td><p>Total water produced by the well over three year in 1000s of barrels</p></td>
</tr>
</tbody>
</table>
&#13;

<h3>Map Data</h3>
<p>The following map data are available,</p>
<p>Acoustic impedance (AI) inverted from geophysical amplitudes and interpretations,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_ai_map.npy"><strong>res21_ai_map.npy</strong></a></p></li>
</ul>
<p>Proportion of facies, sandstone, shaly-sandstone, sandy-shalestone and shalestone are available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_2d_sand_prop_map.npy">res21_2d_sand_prop_map.npy</a></p></li>
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_shaly_sand_prop_map.npy">res21_shaly_sand_prop_map.npy</a></p></li>
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_sandy_shale_prop_map.npy">res21_sandy_shale_prop_map.npy</a></p></li>
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_shale_prop_map.npy">res21_shale_prop_map.npy</a></p></li>
</ul>
<p>Note, the facies proportions are calculated by a well calibrated model with well data and acoustic impedance and the 4 proportions sum to 1.0 (honor probability closure). The top of the formation map is available at,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_top_depth_map.npy">res21_top_depth_map.npy</a></p></li>
</ul>
<p>Comments on the 2D map, gridded data format,</p>
<ul class="simple">
<li><p>2D maps are regular grids 200 by 200 cells, cell extents are 50m by 50m, extending over the reservoir</p></li>
<li><p>values indicate the vertically averaged property, vertical resolution is the entire reservoir unit</p></li>
<li><p>the indices follow standard Python convention, original is top left corner, indices are from 0, 1, …, n-1 and the first index is the row (from the top) and the second index is the column from the left</p></li>
<li><p>e.g. to select the 5th grid cell in x (column) and the 10th grid cell in y (rows), use ndarray[9,4] in Python (aside, array[10,5] in Matlab)</p></li>
<li><p>the origin of the 2D data (e.g., array[0,0]) is the center of the top left cell, 25m and 25m along y and x direction (refer to the image above)</p></li>
</ul>
&#13;

<h3>2D Vertically Averaged Data</h3>
<p>For simplified workflow testing, a vertically averaged 2D variant of the dataset was made by,</p>
<ul class="simple">
<li><p>averaging all the continuous well log features over the entire reservoir unit</p></li>
<li><p>combining a single response feature (3 year cumulative oil production) with the predictor features</p></li>
<li><p>removing facies to avoid the issue of upscaling the categorical ordinal feature</p></li>
</ul>
<p>These two files contain the predictor features, well log data, averaged over the entire well bore for all 73 wells, i.e., one value per well for each feature, and the one response feature, 3 year cumulative oil production,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_2D_wells.csv"><strong>res21_2D_wells.csv</strong></a> - 2D averaged well data and 3 year cumulative oil production for the previous production wells, well indices from 1 to 73</p></li>
</ul>
<p>and well log data averaged over the entire well bore for all 10 test wells,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_2D_wells_test.csv"><strong>res21_2D_wells_test.csv</strong></a> - 2D averaged well data for the remaining, preproduction wells, well indices from 74 to 83</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">res21</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"X"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"X"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"X"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"m"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Y"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Y"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Y"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"m"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span> 
    <span class="s2">"Por"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">17.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Porosity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Por"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"%"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Perm"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">70.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">200.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>       
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Permeability"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Perm"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="s2">"mD"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">},</span>
    <span class="s2">"AI"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">6.9</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">7.6</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Acoustic Impedance"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"AI"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Density"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">1.6</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">2.6</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Density"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"\frac</span><span class="si">{g}</span><span class="s2">{cm^2}"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"PVel"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">3200.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">4500.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"P-wave Velocity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"PVel"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{m}{s}</span><span class="s2">$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"Youngs"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">22.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">32.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Youngs Modulas"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Youngs"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$GPA$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span> 
    <span class="s2">"SVel"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">1600.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">1750.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"S-wave Velocity"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"SVel"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\frac</span><span class="si">{m}{s}</span><span class="s2">$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>    
    <span class="s2">"Shear"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">4.5</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Shear Modulus"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"Shear"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$GPA$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'small'</span>
    <span class="p">},</span>
    <span class="s2">"CumulativeOil"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"min"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">"max"</span><span class="p">:</span> <span class="mf">3000.0</span><span class="p">,</span>
        <span class="s2">"colormap"</span><span class="p">:</span> <span class="s2">"inferno"</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Cumulative Oil Production"</span><span class="p">,</span><span class="s2">"fname"</span><span class="p">:</span> <span class="s2">"CumulativeOil"</span><span class="p">,</span>
        <span class="s2">"units"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$Mbbls$"</span><span class="p">,</span>
        <span class="s2">"map"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">'format'</span><span class="p">:</span> <span class="s1">'large'</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h3>Load the Dataset and Truth Model</h3>
<p>Let’s load the 2D dataset and visualize it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">df_res21_2D</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_2D_wells.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">'Well_ID'</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="n">df_res21_2D_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_2D_wells_test.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">'Well_ID'</span><span class="p">)</span> <span class="c1"># load the data from Dr. Pyrcz's GitHub repository</span>
<span class="c1">#df_res21_2D.head()                                           # vizualize dataframe with 73 wells without production </span>
<span class="c1">#df_res21_2D_test.head()                                      # visualize dataframe with 10 wells with production</span>
<span class="n">df_res21_2D</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>                            <span class="c1"># check summary statistics</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th/>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>73.0</td>
      <td>4188.698630</td>
      <td>1783.143687</td>
      <td>1175.000000</td>
      <td>2925.000000</td>
      <td>3875.000000</td>
      <td>5325.000000</td>
      <td>7975.000000</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>73.0</td>
      <td>5770.890411</td>
      <td>2405.487844</td>
      <td>775.000000</td>
      <td>3825.000000</td>
      <td>6125.000000</td>
      <td>7625.000000</td>
      <td>9775.000000</td>
    </tr>
    <tr>
      <th>Por</th>
      <td>69.0</td>
      <td>12.822361</td>
      <td>1.069242</td>
      <td>10.449132</td>
      <td>12.122789</td>
      <td>12.842228</td>
      <td>13.532038</td>
      <td>15.837603</td>
    </tr>
    <tr>
      <th>Perm</th>
      <td>53.0</td>
      <td>119.292589</td>
      <td>23.003770</td>
      <td>85.457752</td>
      <td>101.821216</td>
      <td>116.341824</td>
      <td>130.554974</td>
      <td>184.753428</td>
    </tr>
    <tr>
      <th>AI</th>
      <td>69.0</td>
      <td>7.319194</td>
      <td>0.096761</td>
      <td>7.062172</td>
      <td>7.280405</td>
      <td>7.333877</td>
      <td>7.379185</td>
      <td>7.499137</td>
    </tr>
    <tr>
      <th>Density</th>
      <td>70.0</td>
      <td>2.043288</td>
      <td>0.138222</td>
      <td>1.793870</td>
      <td>1.921390</td>
      <td>2.039170</td>
      <td>2.162651</td>
      <td>2.301552</td>
    </tr>
    <tr>
      <th>PVel</th>
      <td>69.0</td>
      <td>3696.762373</td>
      <td>276.382117</td>
      <td>3229.902892</td>
      <td>3463.035301</td>
      <td>3688.453880</td>
      <td>3897.219799</td>
      <td>4327.857887</td>
    </tr>
    <tr>
      <th>Youngs</th>
      <td>49.0</td>
      <td>27.173417</td>
      <td>2.164984</td>
      <td>23.516002</td>
      <td>25.378138</td>
      <td>26.801655</td>
      <td>28.641350</td>
      <td>31.463424</td>
    </tr>
    <tr>
      <th>SVel</th>
      <td>65.0</td>
      <td>1676.908144</td>
      <td>19.277228</td>
      <td>1637.806458</td>
      <td>1662.280505</td>
      <td>1676.458624</td>
      <td>1688.682882</td>
      <td>1721.987891</td>
    </tr>
    <tr>
      <th>Shear</th>
      <td>48.0</td>
      <td>5.793693</td>
      <td>0.474087</td>
      <td>4.937921</td>
      <td>5.397281</td>
      <td>5.769809</td>
      <td>6.208277</td>
      <td>6.714150</td>
    </tr>
    <tr>
      <th>CumulativeOil</th>
      <td>73.0</td>
      <td>940.976027</td>
      <td>429.622150</td>
      <td>307.120000</td>
      <td>643.140000</td>
      <td>819.490000</td>
      <td>1185.400000</td>
      <td>2514.500000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now let’s load two of the 2D maps,</p>
<ul class="simple">
<li><p>average sand proportion</p></li>
<li><p>acoustic impedance</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">sand_prop_map_url</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_2d_sand_prop_map.npy'</span><span class="p">)</span>
<span class="n">sand_prop_map_url</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>                          <span class="c1"># Raise an error if the download fails</span>
<span class="n">sand_prop_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">sand_prop_map_url</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>   <span class="c1"># load the .npy file from the downloaded bytes</span>

<span class="n">AI_map_url</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/refs/heads/master/res21_ai_map.npy'</span><span class="p">)</span>
<span class="n">AI_map_url</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>                                 <span class="c1"># Raise an error if the download fails</span>
<span class="n">AI_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">AI_map_url</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>                 <span class="c1"># load the .npy file from the downloaded bytes</span>
<span class="n">AI_map</span> <span class="o">=</span> <span class="n">AI_map</span><span class="o">/</span><span class="mf">1000000.0</span>
</pre></div>
</div>
</div>
</div>
&#13;

<h3>Calculate Histograms for Each Feature</h3>
<p>Let’s use the dictionary above to make histograms for each feature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">for</span> <span class="n">ifeat</span><span class="p">,</span><span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>          <span class="c1"># loop over all features in the dataframe with 73 wells with production</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ifeat</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                                  <span class="c1"># subplot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'fname'</span><span class="p">]],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span> <span class="c1"># histogram</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Frequency'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">feature</span> <span class="o">+</span> <span class="s1">' Histogram'</span><span class="p">)</span> <span class="c1"># labels </span>
    <span class="n">add_grid2</span><span class="p">()</span>                                               <span class="c1"># major and minor gridlines function</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">3.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b4761de96b21bc454ebeacf66cc850f374aa90d60414d5e118476081f8c2d2e5.png" src="../Images/8789e1495b2bb781d5a677f928dc01ba.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/b4761de96b21bc454ebeacf66cc850f374aa90d60414d5e118476081f8c2d2e5.png"/>
</div>
</div>
&#13;

<h3>Visualize the Dataset</h3>
<p>Now we can visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">ifeat</span> <span class="o">=</span> <span class="mi">4</span>                                                    <span class="c1"># select feature for scatter plot, 0 - 10</span>
<span class="n">feature</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="n">res21</span><span class="p">)[</span><span class="n">ifeat</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sand_prop_map</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span> <span class="c1"># 2D map</span>
<span class="n">cb1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.036</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.18</span><span class="p">)</span>                         <span class="c1"># colorbar for 2D map</span>
<span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">"Proportion of Sand (fraction)"</span><span class="p">)</span>                           <span class="c1"># colorbar label for 2D map</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'fname'</span><span class="p">]],</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'current wells'</span><span class="p">)</span>       <span class="c1"># wells with production scatter plot</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>                         <span class="c1"># colorbar for scatter plot</span>
<span class="n">cb2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">)</span> <span class="c1"># colorbar label for scatter plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'new wells'</span><span class="p">)</span> <span class="c1"># wells without production</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Y (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' and Sand Proportion Map'</span><span class="p">)</span> <span class="c1"># labels for axes and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">AI_map</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">vmin</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span> <span class="c1"># 2D map</span>
<span class="n">cb1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.036</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.18</span><span class="p">)</span>                         <span class="c1"># colorbar for 2D map</span>
<span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="s1">'AI'</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">)</span>                           <span class="c1"># colorbar label for 2D map</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df_res21_2D</span><span class="p">[</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'fname'</span><span class="p">]],</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'min'</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'max'</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'current wells'</span><span class="p">)</span> <span class="c1"># wells with production scatter plot</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>                         <span class="c1"># colorbar for scatter plot</span>
<span class="n">cb2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span><span class="s1">')'</span><span class="p">)</span> <span class="c1"># colorbar label for scatter plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span><span class="n">df_res21_2D_test</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'new wells'</span><span class="p">)</span> <span class="c1"># wells without production</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Y (m)'</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' and Acoustic Impedance Map'</span><span class="p">)</span> <span class="c1"># labels for axes and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/124ec120233d26da8692b8d6959cc2235528e45cbad7fbb44ac2e4635874d7bc.png" src="../Images/85757e86276ec552d3cb1ae5aa5224da.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/124ec120233d26da8692b8d6959cc2235528e45cbad7fbb44ac2e4635874d7bc.png"/>
</div>
</div>
&#13;

<h2>Scatter Plots</h2>
<p>Let’s check the relationships between the features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">'fname'</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">res21</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">res21</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ('</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">')'</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">res21</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="n">pp_res21</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">df_res21_2D</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>
<span class="n">pp_res21</span> <span class="o">=</span> <span class="n">pp_res21</span><span class="o">.</span><span class="n">map_upper</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'darkorange'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">pp_res21</span> <span class="o">=</span> <span class="n">pp_res21</span><span class="o">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'darkorange'</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'k'</span><span class="p">)</span><span class="c1"># Map a density plot to the lower triangle</span>
<span class="n">pp_res21</span> <span class="o">=</span> <span class="n">pp_res21</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">,</span> 
                              <span class="n">shade</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">shade_lowest</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n_levels</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Draw everything first so axes exist and are not overridden</span>
<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp_res21</span><span class="o">.</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]):</span>  <span class="c1"># First column =&gt; leftmost Y axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp_res21</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]):</span>  <span class="c1"># First column =&gt; leftmost Y axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pp_res21</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pp_res21</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
        <span class="c1"># print(i,j)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">pp_res21</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">res21</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">res21</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s2">"min"</span><span class="p">],</span><span class="n">res21</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s2">"max"</span><span class="p">])</span>
        <span class="n">add_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/19f7e946cd16a7908a2703f9cfcf41b91769c58e4b657355896ce5e5d65de9af.png" src="../Images/6bee67ef12013774d2708affb44ffe41.png" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_images/19f7e946cd16a7908a2703f9cfcf41b91769c58e4b657355896ce5e5d65de9af.png"/>
</div>
</div>
&#13;

<h2>Comments</h2>
<p>This is a summary of some of the synthetic datasets that I have generated for the demonstrations in the e-book and my other course content. I hope this,</p>
<ul class="simple">
<li><p>helps you better understand the datasets used in this book</p></li>
<li><p>provides some other datasets for your to test your knowledge and to benchmark your workflows</p></li>
</ul>
<p>I hope this is helpful,</p>
<p><em>Michael</em></p>
&#13;

<h2>About the Author</h2>
<figure style="text-align: center;">
  <img src="../Images/eb709b2c0a0c715da01ae0165efdf3b2.png" style="display: block; margin: 0 auto; width: 70%;" data-original-src="https://geostatsguy.github.io/MachineLearningDemos_Book/_static/intro/michael_pyrcz_officeshot_jacket.jpg"/>
  <figcaption style="text-align: center;"> Professor Michael Pyrcz in his office on the 40 acres, campus of The University of Texas at Austin.
</figcaption>
</figure>
<p>Michael Pyrcz is a professor in the <a class="reference external" href="https://cockrell.utexas.edu/faculty-directory/alphabetical/p">Cockrell School of Engineering</a>, and the <a class="reference external" href="https://www.jsg.utexas.edu/researcher/michael_pyrcz/">Jackson School of Geosciences</a>, at <a class="reference external" href="https://www.utexas.edu/">The University of Texas at Austin</a>, where he researches and teaches subsurface, spatial data analytics, geostatistics, and machine learning. Michael is also,</p>
<ul class="simple">
<li><p>the principal investigator of the <a class="reference external" href="https://fri.cns.utexas.edu/energy-analytics">Energy Analytics</a> freshmen research initiative and a core faculty in the Machine Learn Laboratory in the College of Natural Sciences, The University of Texas at Austin</p></li>
<li><p>an associate editor for <a class="reference external" href="https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board">Computers and Geosciences</a>, and a board member for <a class="reference external" href="https://link.springer.com/journal/11004/editorial-board">Mathematical Geosciences</a>, the International Association for Mathematical Geosciences.</p></li>
</ul>
<p>Michael has written over 70 <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en">peer-reviewed publications</a>, a <a class="reference external" href="https://pypi.org/project/geostatspy/">Python package</a> for spatial data analytics, co-authored a textbook on spatial data analytics, <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistical Reservoir Modeling</a> and author of two recently released e-books, <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostatistics in Python: a Hands-on Guide with GeostatsPy</a> and <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html">Applied Machine Learning in Python: a Hands-on Guide with Code</a>.</p>
<p>All of Michael’s university lectures are available on his <a class="reference external" href="https://www.youtube.com/@GeostatsGuyLectures">YouTube Channel</a> with links to 100s of Python interactive dashboards and well-documented workflows in over 40 repositories on his <a class="reference external" href="https://github.com/GeostatsGuy">GitHub account</a>, to support any interested students and working professionals with evergreen content. To find out more about Michael’s work and shared educational resources visit his <span class="xref myst">Website</span>.</p>
&#13;

<h2>Want to Work Together?</h2>
<p>I hope this content is helpful to those that want to learn more about subsurface modeling, data analytics and machine learning. Students and working professionals are welcome to participate.</p>
<ul class="simple">
<li><p>Want to invite me to visit your company for training, mentoring, project review, workflow design and / or consulting? I’d be happy to drop by and work with you!</p></li>
<li><p>Interested in partnering, supporting my graduate student research or my Subsurface Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)? My research combines data analytics, stochastic modeling and machine learning theory with practice to develop novel methods and workflows to add value. We are solving challenging subsurface problems!</p></li>
<li><p>I can be reached at <a class="reference external" href="mailto:mpyrcz%40austin.utexas.edu">mpyrcz<span>@</span>austin<span>.</span>utexas<span>.</span>edu</a>.</p></li>
</ul>
<p>I’m always happy to discuss,</p>
<p><em>Michael</em></p>
<p>Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The Jackson School of Geosciences, The University of Texas at Austin</p>
<p>More Resources Available at: <a class="reference external" href="https://twitter.com/geostatsguy">Twitter</a> | <a class="reference external" href="https://github.com/GeostatsGuy">GitHub</a> | <a class="reference external" href="http://michaelpyrcz.com">Website</a> | <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en&amp;oi=ao">GoogleScholar</a> | <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistics Book</a> | <a class="reference external" href="https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig">YouTube</a>  | <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostats in Python e-book</a> | <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/">Applied Machine Learning in Python e-book</a> | <a class="reference external" href="https://www.linkedin.com/in/michael-pyrcz-61a648a1">LinkedIn</a></p>
    
</body>
</html>