["```py\nconda install -c conda-forge jupyterlab\n```", "```py\ncd /Users/YOURID \nmkdir mlbook\ncd mlbook\n```", "```py\nmkdir data\n```", "```py\n$ jupyter lab\n[I 11:27:00.606 LabApp] [jupyter_nbextensions_configurator] enabled 0.2.8\n[I 11:27:00.613 LabApp] JupyterLab beta preview extension loaded from /Users/parrt/anaconda3/lib/python3.6/site-packages/jupyterlab\n[I 11:27:00.613 LabApp] JupyterLab application directory is /Users/parrt/anaconda3/share/jupyter/lab\n[W 11:27:00.616 LabApp] JupyterLab server extension not enabled, manually loading...\n...\n```", "```py\nwith open(\"data/rent-ideal.csv\") as f:\n    for line in f.readlines()[0:5]:\n        print(line.strip())\n```", "```py\n$ python\nPython 3.6.6 |Anaconda custom (64-bit)| (default, Jun 28 2018, 11:07:29) \n[GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> with open(\"data/rent-ideal.csv\") as f:\n...     for line in f.readlines()[0:5]:\n...         print(line.strip())\n... \nbedrooms,bathrooms,latitude,longitude,price\n3,1.5,40.7145,-73.9425,3000\n2,1.0,40.7947,-73.9667,5465\n1,1.0,40.7388,-74.0018,2850\n1,1.0,40.7539,-73.9677,3275\n>>>\n```", "```py\n$ python dump.py\nbedrooms,bathrooms,latitude,longitude,price\n3,1.5,40.7145,-73.9425,3000\n2,1.0,40.7947,-73.9667,5465\n1,1.0,40.7388,-74.0018,2850\n1,1.0,40.7539,-73.9677,3275\n```", "```py\nimport pandas as pd\nimport matplotlib.pyplot as plt\ndf = pd.read_csv(\"data/rent-ideal.csv\")\nfig, ax = plt.subplots()\nax.hist(df.price, bins=45)\nplt.show()\n```", "```py\nimport pandas as pd   # import the library and give a short alias: pd\ndf = pd.read_csv(\"data/rent-ideal.csv\")\ndf.head()\n```", "```py\ndf.head(2).T\n```", "```py\ndf.info()\n\n```", "```py\nprint(df.columns)\n```", "```py\ndf.describe()\n```", "```py\nprint(df.mean())\n```", "```py\nprint(df.bedrooms.value_counts())\n```", "```py\ndf.sort_values('price', ascending=False).head()\n```", "```py\nprint(type(df.price))\nprint(df.price.head(5))\n```", "```py\nprices = df.price\nprint(prices.min(), prices.mean(), prices.max())\n\n```", "```py\nbedprice = df[['bathrooms','price']]\nprint(type(bedprice))\nbedprice.head()\n```", "```py\nX = df.drop('price', axis=1) # get all but price column\ny = df['price']\nX.head(3)\n```", "```py\nprint(type(df.iloc[0]))\nprint(df.iloc[0])\n```", "```py\ndf.iloc[0:2]\n```", "```py\nprint(df.iloc[0,:])\n```", "```py\nprint(df.iloc[0,[0,4]])\n```", "```py\nprint(df.iloc[0][['bedrooms','price']])\n```", "```py\ndf.head(3)\n```", "```py\nprint(df.loc[0])\n\n```", "```py\ndfi = df.set_index('bedrooms') # set_index() returns new view of df\ndfi.head()\n```", "```py\ndfi.loc[3].head()\n```", "```py\ndfi = dfi.reset_index() # overcome quirk in Pandas\ndfi.head(3)\n```", "```py\nbybaths = df.groupby(['bathrooms']).mean()\nbybaths\n```", "```py\nbybaths = bybaths.reset_index() # overcome quirk in Pandas\nbybaths\n```", "```py\nbybaths[['bathrooms','price']]\n```", "```py\nprint(df.price.isnull().head(3))\n```", "```py\ndf.isnull().head(3)\n```", "```py\nprint(df.isnull().any())\n```", "```py\nprint((df.price>3000).head())\n```", "```py\ndf[df.price>3000].head(3)\n```", "```py\ndf[(df.price>1000) & (df.price<3000)].head(3)\n```", "```py\ndf[(df.bedrooms>=2) & (df.price<3000)].head(3)\n```", "```py\ndf_aug = df.copy()\ndf_aug['junk'] = 0\ndf_aug.head(3)\n```", "```py\nimport numpy as np\ndf_aug['junk'] = np.random.random(size=len(df_aug))\ndf_aug.head(3)\n```", "```py\nbedsprices = df[['bedrooms','price']] # a view or a copy of df?\nbedsprices['beds_to_price_ratio'] = bedsprices.bedrooms / bedsprices.price\n```", "```py\nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n```", "```py\nbedsprices = df[['bedrooms','price']].copy() # make a copy of 2 cols of df\nbedsprices['price_to_beds_ratio'] = bedsprices.price / bedsprices.bedrooms\nbedsprices.head(3)\n```", "```py\ndf_raw = pd.read_csv(\"data/rent.csv\", parse_dates=['created'])\ndf_rent = df_raw[['created','features','bedrooms','bathrooms','price']]\ndf_rent.head()\n```", "```py\ndf_rent.info()\n\n```", "```py\ndf_aug = df_rent.copy()  # alter a copy of dataframe\ndf_aug['features'] = df_aug['features'].str.lower() # normalize to lower case\ndf_aug.head()\n```", "```py\ndf_aug['features'] = df_aug['features'].fillna('') # fill missing w/blanks\ndf_aug['features'] = df_aug['features'].replace('[]','') # fill empty w/blanks\ndf_aug.head()\n```", "```py\ndf_aug['doorman'] = df_aug['features'].str.contains(\"doorman\")\ndf_aug['laundry'] = df_aug['features'].str.contains(\"laundry|washer\")\ndf_aug.head()\n```", "```py\ndf_aug = df_raw[['created','interest_level']].copy()\nprint(f\"type of interest_level is {df_aug.interest_level.dtype}\")\ndf_aug.head()\n```", "```py\nm = {'low':1,'medium':2,'high':3}\ndf_aug['interest_level'] = df_aug['interest_level'].map(m)\nprint(f\"type of interest_level is {df_aug.interest_level.dtype}\")\ndf_aug.head()\n```", "```py\ndf_aug['interest_level'] = df_aug['interest_level'].astype('int8')\nprint(f\"type of interest_level is {df_aug.interest_level.dtype}\")\n\n```", "```py\ndf_aug['dayofweek'] = df_aug['created'].dt.dayofweek  # add dow column\ndf_aug['day'] = df_aug['created'].dt.day\ndf_aug['month'] = df_aug['created'].dt.month\ndf_aug[['created','dayofweek','day','month']].head()\n```", "```py\ndf_merged = df_sales.merge(df_prices, on='SalesID', how='left') # merge in prices\ndf_merged\n```", "```py\ndf_merged = df_sales.merge(df_prices, on='SalesID', how='right')\ndf_merged.sort_values('SalesID')\n```", "```py\ndf.to_feather(\"data/data.feather\")        # save df as feather file\ndf = pd.read_feather(\"data/data.feather\") # read it back\n```", "```py\nimport pandas as pd\nimport numpy as np\narr = np.random.randn(10000000)\narr[::10] = np.nan  # kill every 10th number\ndf = pd.DataFrame({'column_{0}'.format(i): arr for i in range(10)})\n%time df.to_csv('/tmp/foo.csv')\n%time df.to_feather('/tmp/foo.feather')\n%time df = pd.read_csv('/tmp/foo.csv')\n%time df = pd.read_feather('/tmp/foo.feather')\n```", "```py\nimport matplotlib.pyplot as plt\nfig, ax = plt.subplots()  # make one subplot (ax) on the figure\nplt.show()\n```", "```py\nbybeds = df.groupby(['bedrooms']).mean()\nbybeds = bybeds.reset_index() # make bedrooms column again\n\nfig, ax = plt.subplots()\nax.scatter(bybeds.bedrooms, bybeds.price, color='#4575b4')\nax.set_xlabel(\"Bedrooms\")\nax.set_ylabel(\"Price\")\nplt.show()\n```", "```py\nfig, ax = plt.subplots()\nax.plot(bybeds.bedrooms, bybeds.price, color='#4575b4')\nax.set_xlabel(\"Bedrooms\")\nax.set_ylabel(\"Price\")\nplt.show()\n```", "```py\nx = np.linspace(0.01, 100, 1000)\ny = np.log10(x) # apply log10 to each x value\nfig, ax = plt.subplots()\nax.plot(x, y, color='#4575b4')\nplt.ylabel('y = log_base_10(x)')\nplt.xlabel('x')\nplt.show()\n```", "```py\nfig, ax = plt.subplots()\nax.hist(df.price, color='#4575b4', bins=50)\nax.set_xlabel(\"Price\")\nax.set_ylabel(\"Count of apts\")\nplt.show()\n```", "```py\nfig, axes = plt.subplots(1,2,figsize=(6,2)) # 1 row, 2 columns\naxes[0].plot(bybeds.bedrooms, bybeds.price, color='#4575b4')\naxes[0].set_ylabel(\"Price\")\naxes[0].set_xlabel(\"Bedrooms\")\n\naxes[1].hist(df.price, color='#4575b4', bins=50)\naxes[1].set_ylabel(\"Count of apts\")\naxes[1].set_xlabel(\"Price\")\nplt.tight_layout()\nplt.show()\n```", "```py\nimport numpy as np    # import with commonly-used alias np\n\na = np.array([1,2,3,4,5]) # create 1D vector with 5 numbers\nprint(f\"type is {type(a)}\")\nprint(f\"dtype is {a.dtype}\")\nprint(f\"ndim is {a.ndim}\")\nprint(a)\n\n```", "```py\na = a.astype(np.int8)\nprint(a.dtype)\nprint(a)\n\n```", "```py\nz = np.zeros(shape=[5], dtype=np.int8)\nprint(z)\n```", "```py\nones = np.ones([5])\nprint(ones)\n```", "```py\nprint(np.arange(1,11))\n```", "```py\nprint(np.linspace(1,2,6))\n```", "```py\nprint(f\"{a} + {a} = {a+a}\")\nprint(f\"{a} - {ones} = {a-ones}\")\nprint(f\"{a} * {z} = {a*z}\") # element-wise multiplication\nprint(f\"np.dot({a}, {a}) = {np.dot(a,a)}\") # dot product\n\n```", "```py\nclass MyVec:\n    def __init__(self, values):\n        self.data = values\n    def __add__(self, other):\n        newdata = [x+y for x,y in zip(self.data,other.data)]\n        return MyVec(newdata)\n    def __str__(self):\n        return '['+', '.join([str(v) for v in self.data])+']'\n\na = MyVec([1,2,3])\nb = MyVec([3,4,5])\nprint(a + b)\nprint(a.__add__(b)) # how a+b is implemented\n\n```", "```py\nprices = np.random.randint(low=1, high=10, size=5)\nprint(np.log(prices))\nprint(np.mean(prices))\nprint(np.max(prices))\nprint(np.sum(prices))\n\n```", "```py\nnp.array([np.log(p) for p in prices])\n```", "```py\nt = np.array([[1,1,1,1,1],\n              [0,0,1,0,0],\n              [0,0,1,0,0],\n              [0,0,1,0,0]])\nu = np.array([[1,0,0,0,1],\n              [1,0,0,0,1],\n              [1,0,0,0,1],\n              [1,1,1,1,1]])\n\nprint(f\"type is {type(t)}\")\nprint(f\"dtype is {t.dtype}\")\nprint(f\"ndim is {t.ndim}\")\nprint(f\"shape is {t.shape}\")\nprint(t)\n\n```", "```py\nfig, axes = plt.subplots(1,2,figsize=(2,1)) # 1 row, 2 columns\naxes[0].axis('off')\naxes[1].axis('off')\naxes[0].imshow(t, cmap='binary')\naxes[1].imshow(u, cmap='binary')\nplt.show()\n```", "```py\nprint(np.zeros((3,4)))\n```", "```py\na = np.random.random((2,3)) # 2 rows, 3 columns\nprint(a)\n\n```", "```py\na = np.arange(1,6)\nprint(a)\nprint(a[0],a[4]) # 1st and 5th item\nprint(a[1:3])    # 2nd and 3rd items\nprint(a[[2,4]])  # 3rd and 5th item\n\n```", "```py\nprint(t[0,:])     # 1st row\nprint(t[:,2])     # middle column\nprint(t[2,3])     # element at 2,3\nprint(t[0:2,:])   # 1st two rows\nprint(t[:,[0,2]]) # 1st and 3rd columns\n\n```", "```py\na = np.random.random(5) # get 5 random numbers in 0..1\nprint(a)\nprint(a>0.3)\n\n```", "```py\nb = np.arange(1,6)\nprint(b[a>0.3])\n\n```", "```py\nprint(t+u)\n\n```", "```py\nu = np.array([[1,0,0,0,1],\n              [1,0,0,0,1],\n              [1,0,0,0,1],\n              [1,1,1,1,1]])\nX = np.array([t,u])\nprint(f\"type is {type(X)}\")\nprint(f\"dtype is {X.dtype}\")\nprint(f\"ndim is {X.ndim}\")\nprint(X)\n\n```", "```py\n# loop equivalent of np.sum(u.flat)\nn = 0\nfor v in u.flat:\n    n += v\nprint(n)\n\n```", "```py\nu_flat = u.ravel()       # flattens into new 1D array\nprint(np.sum(u.flat))    # flat is an iterator\nprint(u_flat)\n\n```", "```py\nfor i,row in enumerate(t):\n    print(f\"{i}: {row}\")\n\n```", "```py\na = np.arange(1,13)\nprint( \"4x3\\n\", a.reshape(4,3) )\nprint( \"3x4\\n\", a.reshape(3,4) )\nprint( \"2x6\\n\", a.reshape(2,6) )\n\n```", "```py\nprint( \"4x?\\n\", a.reshape(4,3) )\nprint( \"?x2\\n\", a.reshape(-1,2) )\n\n```", "```py\nimport pandas as pd\nfrom sklearn.ensemble import RandomForestRegressor\n\ndf = pd.read_csv(\"data/rent-ideal.csv\")\nX, y = df.drop('price', axis=1), df['price']\n\nrf = RandomForestRegressor(n_estimators=100, n_jobs=-1)\nrf.fit(X, y)\n\n```", "```py\ntest_vector = np.array([2,1,40.7947,-73.9957])\n\n```", "```py\nValueError: Expected 2D array, got 1D array instead:\narray=[  2\\.       1\\.      40.7947 -73.9957].\nReshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.\n```", "```py\ntest_vector = test_vector.reshape(1,-1)\npred = rf.predict(test_vector)\nprint(f\"{test_vector} -> {pred}\")\n\n```", "```py\nprint(df.price.values)\n```", "```py\nprint(df.iloc[0].values)\n```", "```py\nprint(df[['bedrooms','bathrooms']].values)\n```"]