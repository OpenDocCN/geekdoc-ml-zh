- en: Sync
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://rust-exercises.com/100-exercises/07_threads/14_sync.html](https://rust-exercises.com/100-exercises/07_threads/14_sync.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Before we wrap up this chapter, let''s talk about another key trait in Rust''s
    standard library: `Sync`.'
  prefs: []
  type: TYPE_NORMAL
- en: '`Sync` is an auto trait, just like `Send`.'
  prefs: []
  type: TYPE_NORMAL
- en: It is automatically implemented by all types that can be safely **shared** between
    threads.
  prefs: []
  type: TYPE_NORMAL
- en: 'In other words: `T` is Sync if `&T` is `Send`.'
  prefs: []
  type: TYPE_NORMAL
- en: '[`T: Sync` doesn''t imply `T: Send`](#t-sync-doesnt-imply-t-send)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It's important to note that `T` can be `Sync` without being `Send`.
  prefs: []
  type: TYPE_NORMAL
- en: 'For example: `MutexGuard` is not `Send`, but it is `Sync`.'
  prefs: []
  type: TYPE_NORMAL
- en: It isn't `Send` because the lock must be released on the same thread that acquired
    it, therefore we don't want `MutexGuard` to be dropped on a different thread.
  prefs: []
  type: TYPE_NORMAL
- en: But it is `Sync`, because giving a `&MutexGuard` to another thread has no impact
    on where the lock is released.
  prefs: []
  type: TYPE_NORMAL
- en: '[`T: Send` doesn''t imply `T: Sync`](#t-send-doesnt-imply-t-sync)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The opposite is also true: `T` can be `Send` without being `Sync`.'
  prefs: []
  type: TYPE_NORMAL
- en: 'For example: `RefCell<T>` is `Send` (if `T` is `Send`), but it is not `Sync`.'
  prefs: []
  type: TYPE_NORMAL
- en: '`RefCell<T>` performs runtime borrow checking, but the counters it uses to
    track borrows are not thread-safe. Therefore, having multiple threads holding
    a `&RefCell` would lead to a data race, with potentially multiple threads obtaining
    mutable references to the same data. Hence `RefCell` is not `Sync`.'
  prefs: []
  type: TYPE_NORMAL
- en: '`Send` is fine, instead, because when we send a `RefCell` to another thread
    we''re not leaving behind any references to the data it contains, hence no risk
    of concurrent mutable access.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Exercise](#exercise)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The exercise for this section is located in [`07_threads/14_sync`](https://github.com/mainmatter/100-exercises-to-learn-rust/tree/main/exercises/07_threads/14_sync)
  prefs: []
  type: TYPE_NORMAL
