- en: Decision Tree
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘
- en: åŸæ–‡ï¼š[https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_decision_tree.html](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_decision_tree.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_decision_tree.html](https://geostatsguy.github.io/MachineLearningDemos_Book/MachineLearning_decision_tree.html)
- en: Michael J. Pyrcz, Professor, The University of Texas at Austin
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: è¿ˆå…‹å°”Â·JÂ·çš®å°”èŒ¨ï¼Œæ•™æˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡
- en: '[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Geostatistics Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [Applied Machine Learning in Python e-book](https://geostatsguy.github.io/MachineLearningDemos_Book/)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [åœ°ç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python
    åœ°ç»Ÿè®¡å­¦åº”ç”¨ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python
    æœºå™¨å­¦ä¹ åº”ç”¨ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
- en: 'Chapter of e-book â€œApplied Machine Learning in Python: a Hands-on Guide with
    Codeâ€.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ç”µå­ä¹¦â€œPython æœºå™¨å­¦ä¹ åº”ç”¨ï¼šå¸¦ä»£ç çš„æ‰‹å†Œâ€çš„ä¸€ç« ã€‚
- en: 'Cite this e-Book as:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: å°†æ­¤ç”µå­ä¹¦å¼•ç”¨ä¸ºï¼š
- en: 'Pyrcz, M.J., 2024, *Applied Machine Learning in Python: A Hands-on Guide with
    Code* [e-book]. Zenodo. doi:10.5281/zenodo.15169138 [![DOI](../Images/7e4ea662f44af1eae87e87ecbb962ff4.png)](https://doi.org/10.5281/zenodo.15169138)'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: Pyrcz, M.J., 2024, *Python æœºå™¨å­¦ä¹ åº”ç”¨ï¼šå¸¦ä»£ç çš„æ‰‹å†Œ* [ç”µå­ä¹¦]. Zenodo. doi:10.5281/zenodo.15169138
    [![DOI](../Images/7e4ea662f44af1eae87e87ecbb962ff4.png)](https://doi.org/10.5281/zenodo.15169138)
- en: 'The workflows in this book and more are available here:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬ä¹¦ä¸­çš„å·¥ä½œæµç¨‹ä»¥åŠæ›´å¤šå†…å®¹éƒ½å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š
- en: 'Cite the MachineLearningDemos GitHub Repository as:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: å°† MachineLearningDemos GitHub ä»“åº“å¼•ç”¨ä¸ºï¼š
- en: 'Pyrcz, M.J., 2024, *MachineLearningDemos: Python Machine Learning Demonstration
    Workflows Repository* (0.0.3) [Software]. Zenodo. DOI: 10.5281/zenodo.13835312\.
    GitHub repository: [GeostatsGuy/MachineLearningDemos](https://github.com/GeostatsGuy/MachineLearningDemos)
    [![DOI](../Images/4e3a59c17d684b06a170c4af84e0f631.png)](https://zenodo.org/doi/10.5281/zenodo.13835312)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 'Pyrcz, M.J., 2024, *MachineLearningDemos: Python æœºå™¨å­¦ä¹ æ¼”ç¤ºå·¥ä½œæµç¨‹å­˜å‚¨åº“* (0.0.3) [è½¯ä»¶].
    Zenodo. DOI: 10.5281/zenodo.13835312\. GitHub ä»“åº“: [GeostatsGuy/MachineLearningDemos](https://github.com/GeostatsGuy/MachineLearningDemos)
    [![DOI](../Images/4e3a59c17d684b06a170c4af84e0f631.png)](https://zenodo.org/doi/10.5281/zenodo.13835312)'
- en: By Michael J. Pyrcz
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…ï¼šè¿ˆå…‹å°”Â·JÂ·çš®å°”èŒ¨
- en: Â© Copyright 2024.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: Â© ç‰ˆæƒæ‰€æœ‰ 2024.
- en: This chapter is a tutorial for / demonstration of **Decision Tree**.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬ç« æ˜¯å…³äº**å†³ç­–æ ‘**çš„æ•™ç¨‹å’Œæ¼”ç¤ºã€‚
- en: '**YouTube Lecture**: check out my lectures on:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '**YouTube è®²åº§**ï¼šæŸ¥çœ‹æˆ‘åœ¨ä»¥ä¸‹ä¸»é¢˜ä¸Šçš„è®²åº§ï¼š'
- en: '[Introduction to Machine Learning](https://youtu.be/zOUM_AnI1DQ?si=wzWdJ35qJ9n8O6Bl)'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[æœºå™¨å­¦ä¹ ç®€ä»‹](https://youtu.be/zOUM_AnI1DQ?si=wzWdJ35qJ9n8O6Bl)'
- en: '[Decision Tree](https://youtu.be/JUGo1Pu3QT4?si=ebQXv6Yglar0mYWp)'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[å†³ç­–æ ‘](https://youtu.be/JUGo1Pu3QT4?si=ebQXv6Yglar0mYWp)'
- en: '[Random Forest](https://youtu.be/m5_wk310fho?si=up-mzVPHvniXsYE6)'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[éšæœºæ£®æ—](https://youtu.be/m5_wk310fho?si=up-mzVPHvniXsYE6)'
- en: '[Gradient Boosting](https://youtu.be/___T8_ixIwc?si=ozHR_eIuMF3SPTxJ)'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[æ¢¯åº¦æå‡](https://youtu.be/___T8_ixIwc?si=ozHR_eIuMF3SPTxJ)'
- en: These lectures are all part of my [Machine Learning Course](https://youtube.com/playlist?list=PLG19vXLQHvSC2ZKFIkgVpI9fCjkN38kwf&si=XonjO2wHdXffMpeI)
    on YouTube with linked well-documented Python workflows and interactive dashboards.
    My goal is to share accessible, actionable, and repeatable educational content.
    If you want to know about my motivation, check out [Michaelâ€™s Story](https://michaelpyrcz.com/my-story).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›è®²åº§éƒ½æ˜¯æˆ‘ [Machine Learning Course](https://youtube.com/playlist?list=PLG19vXLQHvSC2ZKFIkgVpI9fCjkN38kwf&si=XonjO2wHdXffMpeI)
    çš„ä¸€éƒ¨åˆ†ï¼ŒYouTube ä¸Šçš„è¯¾ç¨‹é…æœ‰è¯¦ç»†è®°å½•çš„ Python å·¥ä½œæµç¨‹å’Œäº¤äº’å¼ä»ªè¡¨æ¿ã€‚æˆ‘çš„ç›®æ ‡æ˜¯åˆ†äº«æ˜“äºç†è§£ã€å¯æ“ä½œå’Œå¯é‡å¤çš„æ•™è‚²å†…å®¹ã€‚å¦‚æœä½ æƒ³çŸ¥é“æˆ‘çš„åŠ¨æœºï¼Œè¯·æŸ¥çœ‹
    [Michaelâ€™s Story](https://michaelpyrcz.com/my-story)ã€‚
- en: Motivation
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åŠ¨æœº
- en: Decision trees are not the most powerful, cutting edge method in machine learning,
    so why cover decision trees?
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘å¹¶ä¸æ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€ä¸ºå¼ºå¤§å’Œå‰æ²¿çš„æ–¹æ³•ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦ä»‹ç»å†³ç­–æ ‘ï¼Ÿ
- en: one of the most understandable, interpretable predictive machine learning models
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æœ€æ˜“äºç†è§£ã€å¯è§£é‡Šçš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ä¹‹ä¸€
- en: decision trees are enhanced with random forests, bagging and boosting to be
    one of the best machine learning predictive models in many cases
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘é€šè¿‡éšæœºæ£®æ—ã€è¢‹è£…å’Œæå‡æˆä¸ºè®¸å¤šæƒ…å†µä¸‹æœ€ä½³çš„æœºå™¨å­¦ä¹ é¢„æµ‹æ¨¡å‹ä¹‹ä¸€
- en: '![](../Images/90b8611f2db53bd1e441fa8eb6dce0d1.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/90b8611f2db53bd1e441fa8eb6dce0d1.png)'
- en: A single proud black spruce tree within the Boreal Forest in Alaska, similar
    to the northern region of my home province of Alberta. Crop of photo from https://www.britannica.com/plant/spruce#/media/1/561445/8933,
    access date May 1, 2025\.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: é˜¿æ‹‰æ–¯åŠ åŒ—ææ£®æ—ä¸­çš„ä¸€æ£µå•ç‹¬çš„å‚²ç„¶é»‘äº‘æ‰æ ‘ï¼Œç±»ä¼¼äºæˆ‘å®¶ä¹¡çœä»½é˜¿å°”ä¼¯å¡”çš„åŒ—éƒ¨åœ°åŒºã€‚ç…§ç‰‡æ¥æº https://www.britannica.com/plant/spruce#/media/1/561445/8933ï¼Œè®¿é—®æ—¥æœŸ
    2025 å¹´ 5 æœˆ 1 æ—¥
- en: Letâ€™s cover some key aspects of decision trees.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ¢è®¨å†³ç­–æ ‘çš„ä¸€äº›å…³é”®æ–¹é¢ã€‚
- en: Model Formulation
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ¨¡å‹å…¬å¼
- en: 'The prediction feature space is partitioned into \(J\) exhaustive, mutually
    exclusive regions \(R_1, R_2, \ldots, R_J\). For a given prediction case \(x_1,\ldots,x_m
    \in R_j\), the prediction is:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æµ‹ç‰¹å¾ç©ºé—´è¢«åˆ’åˆ†ä¸º \(J\) ä¸ªäº’æ–¥çš„ã€ç©·å°½çš„åŒºåŸŸ \(R_1, R_2, \ldots, R_J\)ã€‚å¯¹äºç»™å®šçš„é¢„æµ‹æ¡ˆä¾‹ \(x_1,\ldots,x_m
    \in R_j\)ï¼Œé¢„æµ‹å¦‚ä¸‹ï¼š
- en: '**Regression** - the average of the training data in the region, \(R_j\)'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '**å›å½’** - è¯¥åŒºåŸŸ \(R_j\) ä¸­è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼'
- en: \[ \hat{y} = \frac{1}{|R_j|} \sum_{\mathbf{x}_i \in R_j} y_i \]
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{y} = \frac{1}{|R_j|} \sum_{\mathbf{x}_i \in R_j} y_i \]
- en: where \(\hat{y}\) is the predicted value for input \(\mathbf{x}\), \(R_j\) is
    the region (leaf node) that \(\mathbf{x}\) falls into, \(|R_j|\) is the number
    of training samples in region \(R_j\), and \(y_i\) is the actual target values
    of those training samples in \(R_j\).
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(\hat{y}\) æ˜¯è¾“å…¥ \(\mathbf{x}\) çš„é¢„æµ‹å€¼ï¼Œ\(R_j\) æ˜¯ \(\mathbf{x}\) è½å…¥çš„åŒºåŸŸï¼ˆå¶èŠ‚ç‚¹ï¼‰ï¼Œ\(|R_j|\)
    æ˜¯åŒºåŸŸ \(R_j\) ä¸­è®­ç»ƒæ ·æœ¬çš„æ•°é‡ï¼Œ\(y_i\) æ˜¯ \(R_j\) ä¸­é‚£äº›è®­ç»ƒæ ·æœ¬çš„å®é™…ç›®æ ‡å€¼ã€‚
- en: '**Classification** - category with the plurality of training cases (most common
    case) in region \(R_j\):'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '**åˆ†ç±»** - åŒºåŸŸ \(R_j\) ä¸­è®­ç»ƒæ¡ˆä¾‹æ•°é‡æœ€å¤šçš„ç±»åˆ«ï¼ˆæœ€å¸¸è§çš„æƒ…å†µï¼‰ï¼š'
- en: \[ \hat{y} = \arg\max_{c \in C} \left( \frac{1}{|R_j|} \sum_{\mathbf{x}_i \in
    R_j} \mathbb{1}(y_i = c) \right) \]
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{y} = \arg\max_{c \in C} \left( \frac{1}{|R_j|} \sum_{\mathbf{x}_i \in
    R_j} \mathbb{1}(y_i = c) \right) \]
- en: where \(C\) is the set of all possible categories, \(\mathbb{1}(y_i = c)\) is
    indicator transform, 1 if \(y_i = c\), 0 otherwise, \(|R_j|\) is the number of
    training samples in region \(R_j\), and \(\hat{y}\) is the predicted class label.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(C\) æ˜¯æ‰€æœ‰å¯èƒ½ç±»åˆ«çš„é›†åˆï¼Œ\(\mathbb{1}(y_i = c)\) æ˜¯æŒ‡ç¤ºå˜æ¢ï¼Œå¦‚æœ \(y_i = c\) åˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0ï¼Œ\(|R_j|\)
    æ˜¯åŒºåŸŸ \(R_j\) ä¸­è®­ç»ƒæ ·æœ¬çš„æ•°é‡ï¼Œ\(\hat{y}\) æ˜¯é¢„æµ‹çš„ç±»åˆ«æ ‡ç­¾ã€‚
- en: The predictor space, \(ğ‘‹_1,\ldots,ğ‘‹_ğ‘š\), is segmented into \(J\) mutually exclusive,
    exhaustive regions, \(R_j, j = 1,\ldots,J\), where the regions are,
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æµ‹ç©ºé—´ \(ğ‘‹_1,\ldots,ğ‘‹_ğ‘š\) è¢«åˆ†å‰²æˆ \(J\) ä¸ªäº’æ–¥çš„ã€ç©·å°½çš„åŒºåŸŸ \(R_j, j = 1,\ldots,J\)ï¼Œå…¶ä¸­åŒºåŸŸä¸ºï¼Œ
- en: '**mutually exclusive** â€“ any combination of predictor features, \(x_1,\ldots,x_ğ‘š\),
    only belongs to a single region, \(R_j\)'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**äº’æ–¥** â€“ ä»»ä½•é¢„æµ‹ç‰¹å¾ \(x_1,\ldots,x_ğ‘š\) çš„ç»„åˆåªå±äºå•ä¸ªåŒºåŸŸ \(R_j\)'
- en: '**exhaustive** â€“ all combinations of predictor feature values belong a region,
    \(R_j\), i.e., all the regions, \(R_j, j = 1,\ldots,J\), cover entire predictor
    feature space'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç©·å°½** â€“ æ‰€æœ‰é¢„æµ‹ç‰¹å¾å€¼çš„ç»„åˆå±äºä¸€ä¸ªåŒºåŸŸ \(R_j\)ï¼Œå³æ‰€æœ‰åŒºåŸŸ \(R_j, j = 1,\ldots,J\) è¦†ç›–æ•´ä¸ªé¢„æµ‹ç‰¹å¾ç©ºé—´'
- en: All prediction cases, \(x_1,\ldots,x_m\) that fall in the same region, \(R_j\),
    are estimated with the same value.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€æœ‰è½åœ¨åŒä¸€åŒºåŸŸ \(R_j\) ä¸­çš„é¢„æµ‹æ¡ˆä¾‹ \(x_1,\ldots,x_m\) éƒ½ç”¨ç›¸åŒçš„å€¼è¿›è¡Œä¼°è®¡ã€‚
- en: the prediction model inherently discontinuous at the region boundaries
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é¢„æµ‹æ¨¡å‹åœ¨åŒºåŸŸè¾¹ç•Œå¤„æœ¬è´¨ä¸Šæ˜¯ä¸è¿ç»­çš„
- en: For example, consider this decision tree prediction model for the production
    response feature, \(\hat{Y}\)Â Ì‚from porosity, \(X_1\), predictor feature,
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œè€ƒè™‘è¿™ä¸ªç”¨äºç”Ÿäº§å“åº”ç‰¹å¾ \(\hat{Y}\) çš„å†³ç­–æ ‘é¢„æµ‹æ¨¡å‹ï¼Œä»å­”éš™ç‡ \(X_1\) é¢„æµ‹ç‰¹å¾ï¼Œ
- en: '![](../Images/98d8fb73fe41299a6a9b443163b47c96.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/98d8fb73fe41299a6a9b443163b47c96.png)'
- en: Four region decision tree with data and predictions, \(\hat{Y}(R_j) = \overline{Y}(R_j)\)
    by region, \(R_j, j=1,â€¦,4\). For example, given a predictor feature value of 13%
    porosity, the model predicts about 2,000 MCFPD for production.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: å››åŒºåŸŸå†³ç­–æ ‘ï¼ŒåŒ…å«æ•°æ®å’Œé¢„æµ‹ï¼Œ\(\hat{Y}(R_j) = \overline{Y}(R_j)\) æŒ‰åŒºåŸŸ \(R_j, j=1,â€¦,4\) è®¡ç®—ã€‚ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ª
    13% å­”éš™ç‡çš„é¢„æµ‹ç‰¹å¾å€¼ï¼Œæ¨¡å‹é¢„æµ‹ç”Ÿäº§å¤§çº¦ 2,000 MCFPDã€‚
- en: How do we segment the predictor feature space?
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¦‚ä½•å¯¹é¢„æµ‹ç‰¹å¾ç©ºé—´è¿›è¡Œåˆ†å‰²ï¼Ÿ
- en: Look at this example with predictor features porosity and brittleness to predict
    the production response feature.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: çœ‹è¿™ä¸ªä¾‹å­ï¼Œä½¿ç”¨å­”éš™ç‡å’Œè„†æ€§ä½œä¸ºé¢„æµ‹ç‰¹å¾æ¥é¢„æµ‹ç”Ÿäº§å“åº”ç‰¹å¾ã€‚
- en: '![](../Images/31b00c9edfa4f39d2ae71626df2cd687.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/31b00c9edfa4f39d2ae71626df2cd687.png)'
- en: A very complicated segmentation of the predictor feature space with 3 regions.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªéå¸¸å¤æ‚çš„é¢„æµ‹ç‰¹å¾ç©ºé—´åˆ†å‰²ï¼Œæœ‰ 3 ä¸ªåŒºåŸŸã€‚
- en: these are very efficient boundaries that would capture low, mid and high production
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™äº›æ˜¯éå¸¸æœ‰æ•ˆçš„è¾¹ç•Œï¼Œå¯ä»¥æ•æ‰åˆ°ä½ã€ä¸­ã€é«˜äº§é‡
- en: But, this model would be quite complicated,
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æ˜¯ï¼Œè¿™ä¸ªæ¨¡å‹å°†ä¼šç›¸å½“å¤æ‚ï¼Œ
- en: requiring a large number of model parameters
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: éœ€è¦å¤§é‡çš„æ¨¡å‹å‚æ•°
- en: difficult to train for a large number of prediction features, i.e., high dimensionality
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¯¹äºå¤§é‡é¢„æµ‹ç‰¹å¾æ¥è¯´ï¼Œè®­ç»ƒéš¾åº¦è¾ƒå¤§ï¼Œå³é«˜ç»´æ€§
- en: If I can convince you to accept these regions instead, then you would have a
    model that,
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘èƒ½è¯´æœä½ æ¥å—è¿™äº›åŒºåŸŸï¼Œé‚£ä¹ˆä½ å°†æ‹¥æœ‰ä¸€ä¸ªæ¨¡å‹ï¼Œ
- en: is very easy to train
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: éå¸¸å®¹æ˜“è®­ç»ƒ
- en: has very few parameters
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å…·æœ‰éå¸¸å°‘çš„å‚æ•°
- en: very compact and interpretable
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: éå¸¸ç´§å‡‘ä¸”å¯è§£é‡Š
- en: '![](../Images/13cf7080472834d100f0e7812be6d2d3.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/13cf7080472834d100f0e7812be6d2d3.png)'
- en: A simpler segmentation of the predictor feature space with 9 regions, but much
    fewer parameters and easy to train for any dimensionality.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªæ›´ç®€å•çš„é¢„æµ‹ç‰¹å¾ç©ºé—´åˆ†å‰²ï¼Œæœ‰ 9 ä¸ªåŒºåŸŸï¼Œä½†å‚æ•°æ›´å°‘ï¼Œä¸”æ˜“äºè®­ç»ƒä»»ä½•ç»´åº¦ã€‚
- en: This is a set of regions based on hierarchical, binary segmentation. Letâ€™s clarify
    the concept of predictor feature space and then explain this form of predictor
    feature segmentation.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªåŸºäºåˆ†å±‚ã€äºŒåˆ†åˆ†å‰²çš„åŒºåŸŸé›†åˆã€‚è®©æˆ‘ä»¬æ˜ç¡®é¢„æµ‹ç‰¹å¾ç©ºé—´çš„æ¦‚å¿µï¼Œç„¶åè§£é‡Šè¿™ç§é¢„æµ‹ç‰¹å¾åˆ†å‰²çš„å½¢å¼ã€‚
- en: Predictor Feature Space
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é¢„æµ‹ç‰¹å¾ç©ºé—´
- en: Letâ€™s step back and establish the concept of predictor feature space. We define
    it as,
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬é€€ä¸€æ­¥ï¼Œå»ºç«‹é¢„æµ‹ç‰¹å¾ç©ºé—´çš„è§‚å¿µã€‚æˆ‘ä»¬å°†å…¶å®šä¹‰ä¸ºï¼Œ
- en: the space that includes all possible estimation problems, i.e., the combination
    of all possible predictor feature values, \(x_1, x_2,\ldots,x_m\).
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŒ…å«æ‰€æœ‰å¯èƒ½çš„ä¼°è®¡é—®é¢˜çš„ç©ºé—´ï¼Œå³æ‰€æœ‰å¯èƒ½çš„é¢„æµ‹ç‰¹å¾å€¼çš„ç»„åˆï¼Œ\(x_1, x_2,\ldots,x_m\)ã€‚
- en: '![](../Images/2328290a847e59dd59f76c37a18c6df3.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2328290a847e59dd59f76c37a18c6df3.png)'
- en: Illustration of predictor feature space for the case of 3 predictor features
    with specified minimum and maximum values per feature resulting in a rectangular
    cuboid of possible predictions, $x_1, x_2, x_3$.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 3 ä¸ªé¢„æµ‹ç‰¹å¾ä¸”æ¯ä¸ªç‰¹å¾æŒ‡å®šæœ€å°å’Œæœ€å¤§å€¼çš„æƒ…å†µä¸‹çš„é¢„æµ‹ç‰¹å¾ç©ºé—´ç¤ºæ„å›¾ï¼Œç»“æœæ˜¯ä¸€ä¸ªå¯èƒ½çš„é¢„æµ‹çŸ©å½¢ç«‹æ–¹ä½“ï¼Œ\(x_1, x_2, x_3\)ã€‚
- en: Typically this is defined by the range of possible values, \(x_{\alpha} \in
    \left[X_{\alpha,\text{ğ‘šğ‘–ğ‘›}},ğ‘‹_{\alpha,\text{max}} \right]\)â€‹, resulting in,
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: é€šå¸¸è¿™ç”±å¯èƒ½å€¼çš„èŒƒå›´å®šä¹‰ï¼Œ\(x_{\alpha} \in \left[X_{\alpha,\text{ğ‘šğ‘–ğ‘›}},ğ‘‹_{\alpha,\text{max}}
    \right]\)ï¼Œä»è€Œå¾—åˆ°ï¼Œ
- en: 1 predictor feature \(\rightarrow\) line segment
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1 ä¸ªé¢„æµ‹ç‰¹å¾ \(\rightarrow\) çº¿æ®µ
- en: 2 predictor features \(\rightarrow\) rectangle
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2 ä¸ªé¢„æµ‹ç‰¹å¾ \(\rightarrow\) çŸ©å½¢
- en: 3 predictor features \(\rightarrow\) rectangular cuboid
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 3 ä¸ªé¢„æµ‹ç‰¹å¾ \(\rightarrow\) çŸ©å½¢ç«‹æ–¹ä½“
- en: \(>\)3 predictor features \(\rightarrow\) hyperrectangle
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: \(>\)3 ä¸ªé¢„æµ‹ç‰¹å¾ \(\rightarrow\) è¶…çŸ©å½¢
- en: While we define the predictor feature space with the ranges of the predictor
    features, I should provide a cautionary note.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬ç”¨é¢„æµ‹ç‰¹å¾çš„å–å€¼èŒƒå›´æ¥å®šä¹‰é¢„æµ‹ç‰¹å¾ç©ºé—´æ—¶ï¼Œæˆ‘åº”è¯¥æä¾›ä¸€æ¡è­¦å‘Šæ€§è¯´æ˜ã€‚
- en: Decision Trees have an Implicit Extrapolation Model
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘å…·æœ‰éšå¼å¤–æ¨æ¨¡å‹
- en: As you will see below, the regions along the exterior extend to infinity, effectively
    assuming a constant extrapolation model.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚ä½ ä¸‹é¢å°†çœ‹åˆ°çš„ï¼Œæ²¿ç€å¤–éƒ¨çš„åŒºåŸŸå»¶ä¼¸åˆ°æ— ç©·å¤§ï¼Œå®é™…ä¸Šå‡è®¾äº†ä¸€ä¸ªå¸¸æ•°å¤–æ¨æ¨¡å‹ã€‚
- en: Tree Loss Functions
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ ‘æŸå¤±å‡½æ•°
- en: For regression trees we minimize the residual sum of squares and for classification
    trees we minimize the weighted average Gini impurity.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºå›å½’æ ‘ï¼Œæˆ‘ä»¬æœ€å°åŒ–æ®‹å·®å¹³æ–¹å’Œï¼Œå¯¹äºåˆ†ç±»æ ‘ï¼Œæˆ‘ä»¬æœ€å°åŒ–åŠ æƒå¹³å‡ Gini ä¸çº¯åº¦ã€‚
- en: The Residual Sum of Squares (RSS) measures the total squared difference between
    the actual values and predicted values in a regression tree,
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: æ®‹å·®å¹³æ–¹å’Œï¼ˆRSSï¼‰è¡¡é‡å›å½’æ ‘ä¸­å®é™…å€¼ä¸é¢„æµ‹å€¼ä¹‹é—´æ€»å¹³æ–¹å·®çš„åº¦é‡ï¼Œ
- en: \[ \text{RSS} = \sum_{j=1}^{J} \sum_{i \in R_j} (y_i - \hat{y}_{R_j})^2 \]
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \text{RSS} = \sum_{j=1}^{J} \sum_{i \in R_j} (y_i - \hat{y}_{R_j})^2 \]
- en: where \(J\) is the total number of regions in the tree, \(R_j\) is the \(j\)
    region, \(y_i\) is the truth value of the response feature at observation the
    \(i\) training data, and \(\hat{y}_{R_j}\) is the predicted value for region \(R_j\),
    the mean of \(y_i \; \forall \; i \in R_j\).
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(J\) æ˜¯æ ‘ä¸­çš„åŒºåŸŸæ€»æ•°ï¼Œ\(R_j\) æ˜¯ç¬¬ \(j\) ä¸ªåŒºåŸŸï¼Œ\(y_i\) æ˜¯ç¬¬ \(i\) ä¸ªè®­ç»ƒæ•°æ®å“åº”ç‰¹å¾çš„çœŸå€¼ï¼Œ\(\hat{y}_{R_j}\)
    æ˜¯åŒºåŸŸ \(R_j\) çš„é¢„æµ‹å€¼ï¼Œå³ \(y_i \; \forall \; i \in R_j\) çš„å¹³å‡å€¼ã€‚
- en: 'When a parent node splits into two child nodes ( t_L ) and ( t_R ), the weighted
    Gini impurity is:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: å½“çˆ¶èŠ‚ç‚¹åˆ†è£‚æˆä¸¤ä¸ªå­èŠ‚ç‚¹ï¼ˆt_Lï¼‰å’Œï¼ˆt_Rï¼‰æ—¶ï¼ŒåŠ æƒ Gini ä¸çº¯åº¦ä¸ºï¼š
- en: \[ \text{Gini}_{\text{total}} = \sum_{j=1}^{J} \frac{N_j}{N} \cdot \text{Gini}(j)
    \]
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \text{Gini}_{\text{total}} = \sum_{j=1}^{J} \frac{N_j}{N} \cdot \text{Gini}(j)
    \]
- en: where \(J\) is the total number of regions in the tree, \(N\) is the total number
    of samples in the dataset, \(N_j\) is the number of samples in leaf node \(j\),
    and \(\text{Gini}(j)\) is the Gini impurity of leaf node \(j\).
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(J\) æ˜¯æ ‘ä¸­çš„åŒºåŸŸæ€»æ•°ï¼Œ\(N\) æ˜¯æ•°æ®é›†ä¸­çš„æ ·æœ¬æ€»æ•°ï¼Œ\(N_j\) æ˜¯å¶èŠ‚ç‚¹ \(j\) ä¸­çš„æ ·æœ¬æ•°ï¼Œ\(\text{Gini}(j)\)
    æ˜¯å¶èŠ‚ç‚¹ \(j\) çš„ Gini ä¸çº¯åº¦ã€‚
- en: The Gini impurity for a single decision tree node is calculated as,
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: å•ä¸ªå†³ç­–æ ‘èŠ‚ç‚¹çš„ Gini ä¸çº¯åº¦è®¡ç®—å¦‚ä¸‹ï¼Œ
- en: \[ \text{Gini}(j) = 1 - \sum_{c=1}^{C} p_{j,c}^2 \]
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \text{Gini}(j) = 1 - \sum_{c=1}^{C} p_{j,c}^2 \]
- en: where \(p_{j,c}\) is the proportion of class \(c\) samples in node \(j\).
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(p_{j,c}\) æ˜¯èŠ‚ç‚¹ \(j\) ä¸­ç±»åˆ« \(c\) æ ·æœ¬çš„æ¯”ä¾‹ã€‚
- en: For classification our loss function does not compare the predictions to the
    truth values like our regression loss!
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºåˆ†ç±»ï¼Œæˆ‘ä»¬çš„æŸå¤±å‡½æ•°ä¸æ¯”è¾ƒé¢„æµ‹å€¼ä¸çœŸå®å€¼ï¼Œå°±åƒæˆ‘ä»¬çš„å›å½’æŸå¤±ä¸€æ ·ï¼
- en: the Gini impurity penalizes mixtures of training data categories! A region of
    all one category of training data will have a Gini impurity of 0 to contribute
    to the over all loss.
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Giniä¸çº¯åº¦æƒ©ç½šè®­ç»ƒæ•°æ®ç±»åˆ«çš„æ··åˆï¼æ‰€æœ‰è®­ç»ƒæ•°æ®éƒ½æ˜¯åŒä¸€ç±»åˆ«çš„åŒºåŸŸå°†å…·æœ‰0çš„Giniä¸çº¯åº¦ï¼Œä»è€Œæœ‰åŠ©äºæ•´ä½“æŸå¤±ã€‚
- en: Note that the by-region Gini impurity is,
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼ŒæŒ‰åŒºåŸŸè®¡ç®—çš„Giniä¸çº¯åº¦æ˜¯ï¼Œ
- en: '**weighted** - by the number of training data in each regions, regions with
    more training data have greater impact on the overall loss'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**åŠ æƒ** - ç”±æ¯ä¸ªåŒºåŸŸä¸­çš„è®­ç»ƒæ•°æ®æ•°é‡å†³å®šï¼Œå…·æœ‰æ›´å¤šè®­ç»ƒæ•°æ®çš„åŒºåŸŸå¯¹æ•´ä½“æŸå¤±çš„å½±å“æ›´å¤§'
- en: '**averaged** - over all the regions to calculate the total Gini impurity of
    the decision tree'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å¹³å‡** - åœ¨æ‰€æœ‰åŒºåŸŸä¸Šè®¡ç®—å†³ç­–æ ‘çš„æ€»Giniä¸çº¯åº¦'
- en: These losses are calculated during,
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›æŸå¤±æ˜¯åœ¨è®¡ç®—æœŸé—´è®¡ç®—çš„ï¼Œ
- en: '**tree model training** - with respect to training data to grow the tree'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ ‘æ¨¡å‹è®­ç»ƒ** - æ ¹æ®è®­ç»ƒæ•°æ®æ¥ç”Ÿé•¿æ ‘'
- en: '**tree model tuning** - with respect to withheld testing data to select the
    optimum tree complexity.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ ‘æ¨¡å‹è°ƒä¼˜** - æ ¹æ®ä¿ç•™çš„æµ‹è¯•æ•°æ®æ¥é€‰æ‹©æœ€ä½³æ ‘å¤æ‚åº¦ã€‚'
- en: Letâ€™s talk about tree model training first and then tree model tuning.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆè®©æˆ‘ä»¬è°ˆè°ˆæ ‘æ¨¡å‹è®­ç»ƒï¼Œç„¶åå†è®¨è®ºæ ‘æ¨¡å‹è°ƒä¼˜ã€‚
- en: Training the Tree Model
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®­ç»ƒæ ‘æ¨¡å‹
- en: How do we calculate these mutually exclusive, exhaustive regions? This is accomplished
    through hierarchical binary segmentation of the predictor feature space.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¦‚ä½•è®¡ç®—è¿™äº›äº’æ–¥çš„ã€ç©·å°½çš„åŒºåŸŸï¼Ÿè¿™æ˜¯é€šè¿‡é¢„æµ‹ç‰¹å¾ç©ºé—´çš„åˆ†å±‚äºŒè¿›åˆ¶åˆ†å‰²æ¥å®ç°çš„ã€‚
- en: Training a decision tree model is both,
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: è®­ç»ƒå†³ç­–æ ‘æ¨¡å‹æ—¢æ˜¯ï¼Œ
- en: assigning the mutual exclusive, exhaustive regions
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åˆ†é…äº’æ–¥çš„ã€ç©·å°½çš„åŒºåŸŸ
- en: building a decision tree, each region is a terminal node, also known as a leaf
    node
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ„å»ºå†³ç­–æ ‘æ—¶ï¼Œæ¯ä¸ªåŒºåŸŸéƒ½æ˜¯ä¸€ä¸ªç»ˆç«¯èŠ‚ç‚¹ï¼Œä¹Ÿç§°ä¸ºå¶èŠ‚ç‚¹
- en: These are the same thing! Letâ€™s list the steps and then walk through a training
    a tree to demonstrate this.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›æ˜¯åŒä¸€ä»¶äº‹ï¼è®©æˆ‘ä»¬åˆ—å‡ºæ­¥éª¤ï¼Œç„¶åé€šè¿‡è®­ç»ƒä¸€æ£µæ ‘æ¥æ¼”ç¤ºè¿™ä¸€ç‚¹ã€‚
- en: '**Assign All Data to a Single Region** - this region covers the entire predictor
    feature space'
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**å°†æ‰€æœ‰æ•°æ®åˆ†é…åˆ°å•ä¸ªåŒºåŸŸ** - è¿™ä¸ªåŒºåŸŸè¦†ç›–äº†æ•´ä¸ªé¢„æµ‹ç‰¹å¾ç©ºé—´'
- en: '**Scan All Possible Splits** - over all regions and over all features'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**æ‰«ææ‰€æœ‰å¯èƒ½çš„åˆ†å‰²** - åœ¨æ‰€æœ‰åŒºåŸŸå’Œæ‰€æœ‰ç‰¹å¾ä¸Š'
- en: '**Select the Best Split** - this is greedy optimization, i.e., the best split
    minimizes the residual sum of squares of errors over all the training data \(y_i\)
    over all of the regions \(j = 1,\ldots,J\).'
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**é€‰æ‹©æœ€ä½³åˆ†å‰²** - è¿™æ˜¯ä¸€ç§è´ªå©ªä¼˜åŒ–ï¼Œå³æœ€ä½³åˆ†å‰²æœ€å°åŒ–æ‰€æœ‰è®­ç»ƒæ•°æ® \(y_i\) åœ¨æ‰€æœ‰åŒºåŸŸ \(j = 1,\ldots,J\) ä¸Šçš„æ®‹å·®å¹³æ–¹å’Œã€‚'
- en: '**Iterate Until Very Overfit** - return to step 1 for the next split until
    the tree is very overfit.'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**è¿­ä»£ç›´åˆ°è¿‡åº¦æ‹Ÿåˆ** - è¿”å›æ­¥éª¤1è¿›è¡Œä¸‹ä¸€æ¬¡åˆ†å‰²ï¼Œç›´åˆ°æ ‘éå¸¸è¿‡åº¦æ‹Ÿåˆã€‚'
- en: Note, this method for training a decision tree is a solution heuristic,
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œè¿™ç§è®­ç»ƒå†³ç­–æ ‘çš„æ–¹æ³•æ˜¯ä¸€ç§å¯å‘å¼è§£å†³æ–¹æ¡ˆï¼Œ
- en: there is no effort to jointly optimize all splits at once, for example, to select
    a suboptimal split to maximize training error reduction with a subsequent split
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ²¡æœ‰åŠªåŠ›åŒæ—¶ä¼˜åŒ–æ‰€æœ‰åˆ†å‰²ï¼Œä¾‹å¦‚ï¼Œé€‰æ‹©ä¸€ä¸ªæ¬¡ä¼˜åˆ†å‰²ä»¥æœ€å¤§åŒ–åç»­åˆ†å‰²çš„è®­ç»ƒè¯¯å·®å‡å°‘
- en: Also, the decision tree is constructed from the top down.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œå†³ç­–æ ‘æ˜¯ä»ä¸Šåˆ°ä¸‹æ„å»ºçš„ã€‚
- en: we begin with a single region that covers the entire predictor feature space
    and then proceed with a sequence of region splits / tree branches.
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä»ä¸€ä¸ªè¦†ç›–æ•´ä¸ªé¢„æµ‹ç‰¹å¾ç©ºé—´çš„å•ä¸ªåŒºåŸŸå¼€å§‹ï¼Œç„¶åè¿›è¡Œä¸€ç³»åˆ—çš„åŒºåŸŸåˆ†å‰²/æ ‘åˆ†æ”¯ã€‚
- en: Now letâ€™s illustrate this with an example, predicting natural gas production
    response feature with 2 predictor features,
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸€ç‚¹ï¼Œä½¿ç”¨2ä¸ªé¢„æµ‹ç‰¹å¾æ¥é¢„æµ‹å¤©ç„¶æ°”ç”Ÿäº§å“åº”ç‰¹å¾ï¼Œ
- en: porosity - impacting pore volume and flow
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å­”éš™ç‡ - å½±å“å­”éš™ä½“ç§¯å’ŒæµåŠ¨
- en: brittleness - impacting the ability to induce and hold open fractures
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ˜“ç¢æ€§ - å½±å“è¯±å¯¼å’Œä¿æŒå¼€æ”¾è£‚ç¼çš„èƒ½åŠ›
- en: We start with all our predictor feature space in a single region with the single
    possible prediction as the average of all the training data.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä»ä¸€ä¸ªåŒ…å«æ‰€æœ‰é¢„æµ‹ç‰¹å¾ç©ºé—´çš„å•ä¸ªåŒºåŸŸå¼€å§‹ï¼Œå°†æ‰€æœ‰è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼ä½œä¸ºå¯èƒ½çš„å”¯ä¸€é¢„æµ‹ã€‚
- en: '![](../Images/4a6be7714eba68f580cfee8421d15f61.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4a6be7714eba68f580cfee8421d15f61.png)'
- en: Initial data all in 1 region, i.e., hyperparameter number of leaf nodes of 1,
    predict with the global mean of the response feature.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: åˆå§‹æ•°æ®å…¨éƒ¨ä½äºä¸€ä¸ªåŒºåŸŸä¸­ï¼Œå³1ä¸ªå¶èŠ‚ç‚¹çš„è¶…å‚æ•°æ•°é‡ï¼Œä½¿ç”¨å“åº”ç‰¹å¾çš„å…¨çƒå‡å€¼è¿›è¡Œé¢„æµ‹ã€‚
- en: Next, we scan all features to find the first best split, porosity of 16.7%.
    This very simple decision tree with a single decision node and 2 regions or leaf
    nodes is known as a stump tree, i.e., the simplest possible decision tree model.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰«ææ‰€æœ‰ç‰¹å¾ä»¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ€ä½³åˆ†å‰²ï¼Œå­”éš™ç‡ä¸º16.7%ã€‚è¿™ä¸ªéå¸¸ç®€å•çš„å†³ç­–æ ‘åªæœ‰ä¸€ä¸ªå†³ç­–èŠ‚ç‚¹å’Œ2ä¸ªåŒºåŸŸæˆ–å¶å­èŠ‚ç‚¹ï¼Œè¢«ç§°ä¸ºæ ‘æ¡©æ ‘ï¼Œå³æœ€ç®€å•çš„å†³ç­–æ ‘æ¨¡å‹ã€‚
- en: '![](../Images/c418139a6f37dbda3462cd0ab2d519d6.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/c418139a6f37dbda3462cd0ab2d519d6.png)'
- en: Hyperparameter number of leaf nodes of 2, first best split resulting in a stump
    tree.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: å¶å­èŠ‚ç‚¹çš„è¶…å‚æ•°æ•°é‡ä¸º2ï¼Œç¬¬ä¸€ä¸ªæœ€ä½³åˆ†å‰²å¯¼è‡´æ ‘æ¡©æ ‘ã€‚
- en: Now we scan over both regions and over all predictor features to find the best
    next split, brittleness of 36.1 in the greater than or equal to porosity of 16.7%
    region.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æ‰«æä¸¤ä¸ªåŒºåŸŸä»¥åŠæ‰€æœ‰é¢„æµ‹ç‰¹å¾ï¼Œä»¥æ‰¾åˆ°æœ€ä½³ä¸‹ä¸€ä¸ªåˆ†å‰²ï¼Œåœ¨å­”éš™ç‡å¤§äºæˆ–ç­‰äº16.7%çš„åŒºåŸŸä¸­ï¼Œè„†æ€§ä¸º36.1ã€‚
- en: '![](../Images/5786413cc0e329c72793e1d2adf2a54b.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/5786413cc0e329c72793e1d2adf2a54b.png)'
- en: Hyperparameter number of leaf nodes of 3.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: å¶å­èŠ‚ç‚¹çš„è¶…å‚æ•°æ•°é‡ä¸º3ã€‚
- en: Continuing, we find our next split of porosity of 18.5% in the upper right region.
    We now have 4 regions. Our decision tree is starting to capture the increasing
    production with increasing porosity along with lower production for low brittleness.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: ç»§ç»­è¿›è¡Œï¼Œæˆ‘ä»¬åœ¨å³ä¸ŠåŒºåŸŸæ‰¾åˆ°ä¸‹ä¸€ä¸ªåˆ†å‰²ï¼Œå­”éš™ç‡ä¸º18.5%ã€‚ç°åœ¨æˆ‘ä»¬æœ‰4ä¸ªåŒºåŸŸã€‚æˆ‘ä»¬çš„å†³ç­–æ ‘å¼€å§‹æ•æ‰éšç€å­”éš™ç‡çš„å¢åŠ è€Œå¢åŠ çš„äº§é‡ï¼Œä»¥åŠä½è„†æ€§çš„ä½äº§é‡ã€‚
- en: '![](../Images/9931df51305b719f93fc51eecf44641d.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/9931df51305b719f93fc51eecf44641d.png)'
- en: Hyperparameter number of leaf nodes of 4.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: å¶å­èŠ‚ç‚¹çš„è¶…å‚æ•°æ•°é‡ä¸º4ã€‚
- en: Now the next best split is in the original lower porosity region from the stump
    tree with porosity of 13.2%.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ä¸‹ä¸€ä¸ªæœ€ä½³åˆ†å‰²æ˜¯åœ¨åŸå§‹ä½å­”éš™ç‡åŒºåŸŸï¼Œæ¥è‡ªå­”éš™ç‡ä¸º13.2%çš„æ ‘æ¡©æ ‘ã€‚
- en: '![](../Images/597e4adea071f8f67d71e82f4c1015f2.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/597e4adea071f8f67d71e82f4c1015f2.png)'
- en: Hyperparameter number of leaf nodes of 5.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: å¶å­èŠ‚ç‚¹çš„è¶…å‚æ•°æ•°é‡ä¸º5ã€‚
- en: The next best split divides the region in the middle of porosity, capturing
    the trend of low production for low brittleness, even with high porosity.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹ä¸€ä¸ªæœ€ä½³åˆ†å‰²å°†å­”éš™ç‡åŒºåŸŸä¸€åˆ†ä¸ºäºŒï¼Œæ•æ‰äº†ä½è„†æ€§ä½äº§å‡ºçš„è¶‹åŠ¿ï¼Œå³ä½¿åœ¨é«˜å­”éš™ç‡ä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚
- en: '![](../Images/b1024ff1d9be25d7b007a5ee890b6d8f.png)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/b1024ff1d9be25d7b007a5ee890b6d8f.png)'
- en: Hyperparameter number of leaf nodes of 6.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: å¶å­èŠ‚ç‚¹çš„è¶…å‚æ•°æ•°é‡ä¸º6ã€‚
- en: The next split is capturing the reduction in production with high brittleness,
    even with high porosity,
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹ä¸€ä¸ªåˆ†å‰²æ•æ‰äº†é«˜è„†æ€§ä¸‹çš„äº§é‡å‡å°‘ï¼Œå³ä½¿åœ¨é«˜å­”éš™ç‡ä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œ
- en: '![](../Images/782938df9c411d347bdc8e6e031a6d66.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/782938df9c411d347bdc8e6e031a6d66.png)'
- en: Hyperparameter number of leaf nodes of 7.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: å¶å­èŠ‚ç‚¹çš„è¶…å‚æ•°æ•°é‡ä¸º7ã€‚
- en: and this split continues to capture this same pattern in the data.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªåˆ†å‰²ç»§ç»­æ•æ‰æ•°æ®ä¸­çš„ç›¸åŒæ¨¡å¼ã€‚
- en: '![](../Images/c3401dcf9ca381bf65d39fada64ecde2.png)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/c3401dcf9ca381bf65d39fada64ecde2.png)'
- en: Hyperparameter number of leaf nodes of 8.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: å¶å­èŠ‚ç‚¹çš„è¶…å‚æ•°æ•°é‡ä¸º8ã€‚
- en: For brevity we stop here, and make these observations,
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œåœæ­¢ï¼Œå¹¶åšå‡ºä»¥ä¸‹è§‚å¯Ÿï¼Œ
- en: hierarchical, binary segmentation is the same as sequentially building a decision
    tree, each split adds a new decision node and increases the number of leaf nodes
    by one.
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å±‚æ¬¡äºŒåˆ†æ³•ä¸é¡ºåºæ„å»ºå†³ç­–æ ‘ç›¸åŒï¼Œæ¯æ¬¡åˆ†å‰²å¢åŠ ä¸€ä¸ªæ–°çš„å†³ç­–èŠ‚ç‚¹ï¼Œå¹¶å°†å¶å­èŠ‚ç‚¹æ•°é‡å¢åŠ ä¸€ä¸ªã€‚
- en: the simple decision trees are in the complicated decision tree, i.e., if we
    build an \(8\) leaf node model, we have the \(8, 7, \ldots, 2\) leaf node model
    by sequentially removing the decision nodes, in the order of last one is the first
    one to remove.
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç®€å•å†³ç­–æ ‘æ˜¯å¤æ‚å†³ç­–æ ‘çš„ä¸€éƒ¨åˆ†ï¼Œå³å¦‚æœæˆ‘ä»¬æ„å»ºä¸€ä¸ª8ä¸ªå¶å­èŠ‚ç‚¹çš„æ¨¡å‹ï¼Œæˆ‘ä»¬é€šè¿‡é¡ºåºç§»é™¤å†³ç­–èŠ‚ç‚¹ï¼Œä»¥æœ€åä¸€ä¸ªç§»é™¤çš„é¡ºåºï¼Œå¾—åˆ°8ã€7ã€...ã€2ä¸ªå¶å­èŠ‚ç‚¹çš„æ¨¡å‹ã€‚
- en: the ultimate overfit model is number of leaf nodes equal to the number of training
    data. In this case, the training error is 0.0 as have one region for each training
    data a we estimate with the training data response feature values for all the
    at the training data cases.
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æœ€ç»ˆè¿‡æ‹Ÿåˆæ¨¡å‹æ˜¯å¶å­èŠ‚ç‚¹æ•°é‡ç­‰äºè®­ç»ƒæ•°æ®æ•°é‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®­ç»ƒè¯¯å·®ä¸º0.0ï¼Œå› ä¸ºæ¯ä¸ªè®­ç»ƒæ•°æ®éƒ½æœ‰ä¸€ä¸ªåŒºåŸŸï¼Œæˆ‘ä»¬ä½¿ç”¨è®­ç»ƒæ•°æ®çš„å“åº”ç‰¹å¾å€¼æ¥ä¼°è®¡æ‰€æœ‰è®­ç»ƒæ•°æ®æ¡ˆä¾‹ã€‚
- en: Updating the Loss Function with a New Split
  id: totrans-135
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä½¿ç”¨æ–°çš„åˆ†å‰²æ›´æ–°æŸå¤±å‡½æ•°
- en: To find the next best split, we must scan over all regions, and over all features
    with the regions. This may sound like a lot of computation, but it is quite efficient.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ‰¾åˆ°ä¸‹ä¸€ä¸ªæœ€ä½³åˆ†å‰²ï¼Œæˆ‘ä»¬å¿…é¡»æ‰«ææ‰€æœ‰åŒºåŸŸä»¥åŠæ‰€æœ‰ä¸åŒºåŸŸç›¸å…³çš„ç‰¹å¾ã€‚è¿™å¬èµ·æ¥å¯èƒ½éœ€è¦å¤§é‡çš„è®¡ç®—ï¼Œä½†å®é™…ä¸Šéå¸¸é«˜æ•ˆã€‚
- en: we only need to check the midpoints between sorted training data for each feature
    in each region, because any split that does not change the region assignment of
    a training data will not change the training loss.
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åªéœ€è¦æ£€æŸ¥æ¯ä¸ªåŒºåŸŸä¸­æ¯ä¸ªç‰¹å¾çš„æ’åºè®­ç»ƒæ•°æ®çš„ä¸­ç‚¹ï¼Œå› ä¸ºä»»ä½•ä¸ä¼šæ”¹å˜è®­ç»ƒæ•°æ®åŒºåŸŸåˆ†é…çš„åˆ†å‰²éƒ½ä¸ä¼šæ”¹å˜è®­ç»ƒæŸå¤±ã€‚
- en: 'For a region \(R\) split into candidate regions \(R_L\) and \(R_R\), the RSS
    after the split is:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºä¸€ä¸ªè¢«åˆ†å‰²æˆå€™é€‰åŒºåŸŸ \(R_L\) å’Œ \(R_R\) çš„åŒºåŸŸ \(R\)ï¼Œåˆ†å‰²åçš„å‡æ–¹æ®‹å·®ï¼ˆRSSï¼‰ä¸ºï¼š
- en: \[ \text{RSS}_{\text{split}} = \sum_{i \in R_L} (y_i - \hat{y}_{R_L})^2 + \sum_{i
    \in R_R} (y_i - \hat{y}_{R_R})^2 \]
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \text{RSS}_{\text{split}} = \sum_{i \in R_L} (y_i - \hat{y}_{R_L})^2 + \sum_{i
    \in R_R} (y_i - \hat{y}_{R_R})^2 \]
- en: where, \(y_i\) is the actual response feature for training data observation
    \(i\), and \(\hat{y}_{R_L}\), \(\hat{y}_{R_R}\) is the mean of training data response
    feature in candidate regions \(R_L\) and \(R_R\).
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ï¼Œ\(y_i\) æ˜¯è®­ç»ƒæ•°æ®è§‚å¯Ÿ \(i\) çš„å®é™…å“åº”ç‰¹å¾ï¼Œè€Œ \(\hat{y}_{R_L}\)ï¼Œ\(\hat{y}_{R_R}\) æ˜¯å€™é€‰åŒºåŸŸ
    \(R_L\) å’Œ \(R_R\) ä¸­è®­ç»ƒæ•°æ®å“åº”ç‰¹å¾çš„å‡å€¼ã€‚
- en: Note, we add in the RSS components from all the other regions to get the total
    model RSS to find the best split over all the regions,
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰å…¶ä»–åŒºåŸŸçš„RSSåˆ†é‡æ·»åŠ è¿›æ¥ï¼Œä»¥è·å¾—æ€»æ¨¡å‹RSSï¼Œä»è€Œåœ¨æ•´ä¸ªåŒºåŸŸä¸­æ‰¾åˆ°æœ€ä½³åˆ†å‰²ï¼Œ
- en: the split with the lowest \(\text{RSS}_{\text{split}}\) is selected for the
    region and compared to all other best splits in the other regions to find the
    next best split, greedy solution.
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é€‰æ‹©å…·æœ‰æœ€ä½ \(\text{RSS}_{\text{split}}\) çš„åˆ†å‰²ä½œä¸ºåŒºåŸŸï¼Œå¹¶å°†å…¶ä¸å…¶ä»–åŒºåŸŸçš„æ‰€æœ‰æœ€ä½³åˆ†å‰²è¿›è¡Œæ¯”è¾ƒï¼Œä»¥æ‰¾åˆ°ä¸‹ä¸€ä¸ªæœ€ä½³åˆ†å‰²ï¼Œè¿™æ˜¯ä¸€ç§è´ªå©ªè§£æ³•ã€‚
- en: Now we are prepared for tuning a decision tree model.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½è°ƒæ•´å†³ç­–æ ‘æ¨¡å‹äº†ã€‚
- en: Tuning the Tree Model
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è°ƒæ•´æ ‘æ¨¡å‹
- en: To tune the decision tree we take the very overfit trained tree model,
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†è°ƒæ•´å†³ç­–æ ‘ï¼Œæˆ‘ä»¬é‡‡ç”¨éå¸¸è¿‡æ‹Ÿåˆçš„å·²è®­ç»ƒæ ‘æ¨¡å‹ï¼Œ
- en: sequentially cut the last decision node
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¾æ¬¡åˆ‡å‰²æœ€åä¸€ä¸ªå†³ç­–èŠ‚ç‚¹
- en: i.e., prune the last branch of the decision tree
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å³å‰ªæ‰å†³ç­–æ ‘çš„æœ€åä¸€ä¸ªåˆ†æ”¯
- en: Since the simpler trees are inside the complicated tree!
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: å› ä¸ºç®€å•çš„æ ‘åœ¨å¤æ‚çš„æ ‘å†…éƒ¨ï¼
- en: We can calculate test error as we prune and select tree with minimum test error
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥åœ¨å‰ªæçš„åŒæ—¶è®¡ç®—æµ‹è¯•é”™è¯¯ï¼Œå¹¶é€‰æ‹©å…·æœ‰æœ€å°æµ‹è¯•é”™è¯¯çš„æ ‘ã€‚
- en: We overfit the decision tree model, with a large number of leaf nodes and then
    we reduce the number of leaf nodes while tracking the test error.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯¹å†³ç­–æ ‘æ¨¡å‹è¿›è¡Œäº†è¿‡æ‹Ÿåˆï¼Œæ‹¥æœ‰å¤§é‡çš„å¶å­èŠ‚ç‚¹ï¼Œç„¶åæˆ‘ä»¬åœ¨è·Ÿè¸ªæµ‹è¯•é”™è¯¯çš„åŒæ—¶å‡å°‘äº†å¶å­èŠ‚ç‚¹çš„æ•°é‡ã€‚
- en: we select the number of leaf nodes that minimize the testing error.
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬é€‰æ‹©ä½¿æµ‹è¯•é”™è¯¯æœ€å°åŒ–çš„å¶å­èŠ‚ç‚¹æ•°é‡ã€‚
- en: since we are sequentially removing the last branch to simplify the tree, we
    call model tuning **pruning** for decision trees
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç”±äºæˆ‘ä»¬æ˜¯ä¾æ¬¡ç§»é™¤æœ€åä¸€ä¸ªåˆ†æ”¯ä»¥ç®€åŒ–æ ‘ï¼Œæ‰€ä»¥æˆ‘ä»¬ç§°æ¨¡å‹è°ƒæ•´ä¸ºå†³ç­–æ ‘çš„**å‰ªæ**ã€‚
- en: Here is an overfit decision tree with many, \(100\), leaf nodes.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæ˜¯ä¸€ä¸ªå…·æœ‰è®¸å¤šå¶å­èŠ‚ç‚¹ï¼ˆ100ä¸ªï¼‰çš„è¿‡æ‹Ÿåˆå†³ç­–æ ‘ã€‚
- en: '![](../Images/3383a81c81cdb9ed5c96432a485e7194.png)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3383a81c81cdb9ed5c96432a485e7194.png)'
- en: Very overfit decision tree, hyperparameter number of leaf nodes of 100 (left),
    train and test cross validation plot (center) and train and test error over number
    of leaf nodes (right).
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªéå¸¸è¿‡æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œå¶å­èŠ‚ç‚¹æ•°é‡ä¸º100ï¼ˆå·¦ï¼‰ï¼Œè®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯å›¾ï¼ˆä¸­å¿ƒï¼‰ä»¥åŠè®­ç»ƒå’Œæµ‹è¯•é”™è¯¯ä¸å¶å­èŠ‚ç‚¹æ•°é‡çš„å…³ç³»ï¼ˆå³ï¼‰ã€‚
- en: Since this tree is calculated with my interactive Python dashboard, I am able
    to easily reduce the number of regions from \(100, 99, 98, 96, 95, \ldots\) and
    visualize the tree to explore complicated to simple trees.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºè¿™æ£µæ ‘æ˜¯ç”¨æˆ‘çš„äº¤äº’å¼Pythonä»ªè¡¨æ¿è®¡ç®—çš„ï¼Œæ‰€ä»¥æˆ‘èƒ½å¤Ÿè½»æ¾åœ°å°†åŒºåŸŸæ•°é‡ä» \(100, 99, 98, 96, 95, \ldots\) å‡å°‘å¹¶å¯è§†åŒ–æ ‘ï¼Œä»¥æ¢ç´¢ä»å¤æ‚åˆ°ç®€å•çš„æ ‘ã€‚
- en: by doing this we can demonstrate that the simple trees are in the complicated
    tree.
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é€šè¿‡è¿™æ ·åšï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜ç®€å•çš„æ ‘åœ¨å¤æ‚çš„æ ‘ä¸­ã€‚
- en: For example, hereâ€™s the 5 region decision tree in the overfit 100 region decision
    tree,
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œè¿™é‡Œæ˜¯åœ¨è¿‡æ‹Ÿåˆçš„100ä¸ªåŒºåŸŸå†³ç­–æ ‘ä¸­çš„5ä¸ªåŒºåŸŸå†³ç­–æ ‘ï¼Œ
- en: '![](../Images/566f12da178143a07d17de9adc100684.png)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/566f12da178143a07d17de9adc100684.png)'
- en: The 5 leaf node tree in the very overfit 100 leaf node tree model.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨éå¸¸è¿‡æ‹Ÿåˆçš„100ä¸ªå¶å­èŠ‚ç‚¹æ ‘æ¨¡å‹ä¸­çš„5ä¸ªå¶å­èŠ‚ç‚¹æ ‘ã€‚
- en: and here is the 10 region decision tree in the overfit 100 region decision tree,
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæ˜¯åœ¨è¿‡æ‹Ÿåˆçš„100ä¸ªåŒºåŸŸå†³ç­–æ ‘ä¸­çš„10ä¸ªåŒºåŸŸå†³ç­–æ ‘ï¼Œ
- en: '![](../Images/96e18c15cb01e9558e4b2512a6b1ef20.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/96e18c15cb01e9558e4b2512a6b1ef20.png)'
- en: The 10 leaf node tree in the very overfit 100 leaf node tree model.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨éå¸¸è¿‡æ‹Ÿåˆçš„100ä¸ªå¶å­èŠ‚ç‚¹æ ‘æ¨¡å‹ä¸­çš„10ä¸ªå¶å­èŠ‚ç‚¹æ ‘ã€‚
- en: and finally, here is the 20 region decision tree in the overfit 100 region decision
    tree,
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œè¿™é‡Œæ˜¯åœ¨è¿‡æ‹Ÿåˆçš„100ä¸ªåŒºåŸŸå†³ç­–æ ‘ä¸­çš„20ä¸ªåŒºåŸŸå†³ç­–æ ‘ï¼Œ
- en: '![](../Images/19d39b48f3c129dc12099bd52c3bb546.png)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/19d39b48f3c129dc12099bd52c3bb546.png)'
- en: The 20 leaf node tree in the very overfit 100 leaf node tree model.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨éå¸¸è¿‡æ‹Ÿåˆçš„100ä¸ªå¶å­èŠ‚ç‚¹æ ‘æ¨¡å‹ä¸­çš„20ä¸ªå¶å­èŠ‚ç‚¹æ ‘ã€‚
- en: You might wonder, why I didnâ€™t just update the decision tree plot? scikit-learnâ€™s
    decision tree plotting function recales the plot and the geometry changes so much
    it is not easy to visualize the simple trees within the complicated tree.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯èƒ½ä¼šæƒ³çŸ¥é“ï¼Œä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰ç›´æ¥æ›´æ–°å†³ç­–æ ‘å›¾ï¼Ÿscikit-learnçš„å†³ç­–æ ‘ç»˜å›¾å‡½æ•°ä¼šé‡æ–°ç¼©æ”¾å›¾è¡¨ï¼Œå¹¶ä¸”å‡ ä½•å½¢çŠ¶å˜åŒ–å¾ˆå¤§ï¼Œè¿™ä½¿å¾—åœ¨å¤æ‚çš„æ ‘ä¸­å¯è§†åŒ–ç®€å•çš„æ ‘å˜å¾—å›°éš¾ã€‚
- en: I think this approach of visualizing the simple trees and drafting the polylines
    works well for educational purposes!
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘è®¤ä¸ºè¿™ç§é€šè¿‡å¯è§†åŒ–ç®€å•æ ‘å’Œç»˜åˆ¶å¤šè¾¹å½¢çš„å¯è§†åŒ–æ–¹æ³•å¯¹äºæ•™è‚²ç›®çš„æ¥è¯´æ•ˆæœå¾ˆå¥½ï¼
- en: Now letâ€™s return to our very overfit tree and demonstrate the hyperparameter
    tuning by tree pruning approach,
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„è¿‡åº¦æ‹Ÿåˆæ ‘ï¼Œå¹¶é€šè¿‡æ ‘å‰ªææ–¹æ³•æ¼”ç¤ºè¶…å‚æ•°è°ƒæ•´ï¼Œ
- en: '![](../Images/24f9e4745fc35d0cf9c039aec32684f0.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/24f9e4745fc35d0cf9c039aec32684f0.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚
- en: Now, we identify the last added branch and remove it to calculate the 99 region
    decision tree, a slightly simpler decision tree, and we calculate the test error.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæˆ‘ä»¬è¯†åˆ«å‡ºæœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—99åŒºåŸŸå†³ç­–æ ‘ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œç„¶åæˆ‘ä»¬è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/2c6ffbcc9634d3d3f7350cb0564380d1.png)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/2c6ffbcc9634d3d3f7350cb0564380d1.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚
- en: And we identify the last added branch again and remove it to calculate the 98
    region decision tree, once again a slightly simpler decision tree, and we calculate
    the test error.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å†æ¬¡è¯†åˆ«å‡ºæœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—98åŒºåŸŸå†³ç­–æ ‘ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œç„¶åæˆ‘ä»¬è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/efae49220a4ea118479dcc21d333e37a.png)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/efae49220a4ea118479dcc21d333e37a.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚
- en: And we identify the last added branch again and remove it to calculate the 97
    region decision tree, once again a slightly simpler decision tree, and we calculate
    the test error.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å†æ¬¡è¯†åˆ«å‡ºæœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—97åŒºåŸŸå†³ç­–æ ‘ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œç„¶åæˆ‘ä»¬è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/f4af3bd7dce90621152ff68c398bd578.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/f4af3bd7dce90621152ff68c398bd578.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚
- en: And we identify the last added branch again and remove it to calculate the 96
    region decision tree, once again a slightly simpler decision tree, and we calculate
    the test error.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å†æ¬¡è¯†åˆ«å‡ºæœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—96åŒºåŸŸå†³ç­–æ ‘ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œç„¶åæˆ‘ä»¬è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/eeea92714bf8b2f878a05ce7f50e9eae.png)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/eeea92714bf8b2f878a05ce7f50e9eae.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚
- en: And we identify the last added branch again and remove it to calculate the 95
    region decision tree, once again a slightly simpler decision tree, and we calculate
    the test error.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å†æ¬¡è¯†åˆ«å‡ºæœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—95åŒºåŸŸå†³ç­–æ ‘ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œç„¶åæˆ‘ä»¬è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/90180132c5183f3342f2051c501aee4a.png)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/90180132c5183f3342f2051c501aee4a.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚
- en: And we identify the last added branch again and remove it to calculate the 94
    region decision tree, once again a slightly simpler decision tree, and we calculate
    the test error.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å†æ¬¡è¯†åˆ«å‡ºæœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—94åŒºåŸŸå†³ç­–æ ‘ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œç„¶åæˆ‘ä»¬è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/53f087807a31ef6a8e1be0e1ec170292.png)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/53f087807a31ef6a8e1be0e1ec170292.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚
- en: Now letâ€™s return and look at the very overfit model and add some more information
    over different levels of complexity.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›åˆ°è¿™ä¸ªè¿‡åº¦æ‹Ÿåˆçš„æ¨¡å‹ï¼Œå¹¶åœ¨ä¸åŒå¤æ‚åº¦çº§åˆ«ä¸Šæ·»åŠ æ›´å¤šä¿¡æ¯ã€‚
- en: '![](../Images/ab38e613fbf8ad17fdab5bd4f89adaa6.png)'
  id: totrans-191
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/ab38e613fbf8ad17fdab5bd4f89adaa6.png)'
- en: Very overfit decision tree, hyperparameter number of leaf nodes of 100 (left),
    train and test cross validation plot (center) and train and test error over number
    of leaf nodes (right).
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œå¶èŠ‚ç‚¹æ•°é‡ä¸º100ï¼ˆå·¦ï¼‰ï¼Œè®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯å›¾ï¼ˆä¸­å¿ƒï¼‰ä»¥åŠè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸å¶èŠ‚ç‚¹æ•°é‡çš„å…³ç³»ï¼ˆå³ï¼‰ã€‚
- en: I include the,
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘åŒ…æ‹¬çš„ï¼Œ
- en: train and test cross validation plot with nearly perfect training prediction
    and very poor testing prediction for the 100 leaf node overfit decision tree
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯å›¾ï¼Œå¯¹äº100ä¸ªå¶èŠ‚ç‚¹çš„è¿‡åº¦æ‹Ÿåˆå†³ç­–æ ‘ï¼Œå‡ ä¹å®Œç¾çš„è®­ç»ƒé¢„æµ‹å’Œéå¸¸å·®çš„æµ‹è¯•é¢„æµ‹ã€‚
- en: train and test error versus number of leaf nodes.
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸å¶èŠ‚ç‚¹æ•°é‡çš„å…³ç³»ã€‚
- en: This demonstrates that the decision tree model is indeed very overfit, for example,
    see the falling training error and rising testing error.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™è¡¨æ˜å†³ç­–æ ‘æ¨¡å‹ç¡®å®éå¸¸è¿‡åº¦æ‹Ÿåˆï¼Œä¾‹å¦‚ï¼Œçœ‹åˆ°ä¸‹é™çš„è®­ç»ƒè¯¯å·®å’Œä¸Šå‡çš„æµ‹è¯•è¯¯å·®ã€‚
- en: Now we prune the decision nodes until we obtain the model with the minimum testing
    error at about 19 leaf nodes.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬ä¿®å‰ªå†³ç­–èŠ‚ç‚¹ï¼Œç›´åˆ°æˆ‘ä»¬è·å¾—åœ¨çº¦19ä¸ªå¶èŠ‚ç‚¹å¤„å…·æœ‰æœ€å°æµ‹è¯•è¯¯å·®çš„æ¨¡å‹ã€‚
- en: '![](../Images/064eac7331174101230aee9c413623f3.png)'
  id: totrans-198
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/064eac7331174101230aee9c413623f3.png)'
- en: Tuned decision tree, hyperparameter number of leaf nodes of 20 (left), train
    and test cross validation plot (center) and train and test error over number of
    leaf nodes indicating that testing error is minimized (right).
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: è°ƒæ•´åçš„å†³ç­–æ ‘ï¼Œå¶èŠ‚ç‚¹æ•°é‡ä¸º20ï¼ˆå·¦ï¼‰ï¼Œè®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯å›¾ï¼ˆä¸­å¿ƒï¼‰ä»¥åŠè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®éšå¶èŠ‚ç‚¹æ•°é‡çš„å˜åŒ–ï¼Œè¡¨æ˜æµ‹è¯•è¯¯å·®æœ€å°åŒ–ï¼ˆå³ï¼‰ã€‚
- en: For completeness, I have included an underfit model, i.e., if we prune our decision
    tree too much, with only 8 leaf nodes.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å®Œæ•´æ€§ï¼Œæˆ‘åŒ…æ‹¬äº†ä¸€ä¸ªæ¬ æ‹Ÿåˆæ¨¡å‹ï¼Œå³å¦‚æœæˆ‘ä»¬è¿‡åº¦ä¿®å‰ªæˆ‘ä»¬çš„å†³ç­–æ ‘ï¼Œåªæœ‰8ä¸ªå¶èŠ‚ç‚¹ã€‚
- en: '![](../Images/9d7b773b0de829f858763876c59a1c04.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/9d7b773b0de829f858763876c59a1c04.png)'
- en: Underfit decision tree, hyperparameter number of leaf nodes of 8 (left), train
    and test cross validation plot (center) and train and test error over number of
    leaf nodes indicating that testing error is minimized (right).
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: æ¬ æ‹Ÿåˆå†³ç­–æ ‘ï¼Œå¶èŠ‚ç‚¹æ•°é‡ä¸º8ï¼ˆå·¦ï¼‰ï¼Œè®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯å›¾ï¼ˆä¸­å¿ƒï¼‰ä»¥åŠè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®éšå¶èŠ‚ç‚¹æ•°é‡çš„å˜åŒ–ï¼Œè¡¨æ˜æµ‹è¯•è¯¯å·®æœ€å°åŒ–ï¼ˆå³ï¼‰ã€‚
- en: Note, that the train and test error are both very high with the underfit decision
    tree.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œè®­ç»ƒè¯¯å·®å’Œæµ‹è¯•è¯¯å·®éƒ½éå¸¸é«˜ï¼Œè¿™æ˜¯æ¬ æ‹Ÿåˆå†³ç­–æ ‘çš„è¡¨ç°ã€‚
- en: I prefer number of leaf nodes as my decision tree hyperparameter because it
    provides,
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æ›´å–œæ¬¢å°†å¶èŠ‚ç‚¹æ•°é‡ä½œä¸ºæˆ‘çš„å†³ç­–æ ‘è¶…å‚æ•°ï¼Œå› ä¸ºå®ƒæä¾›äº†ï¼Œ
- en: '**continuous, uniform increase in complexity** - equal steps in increased complexity
    without jumps'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**è¿ç»­ã€å‡åŒ€çš„å¤æ‚æ€§å¢åŠ ** - å¤æ‚æ€§å¢åŠ çš„æ­¥éª¤ç›¸ç­‰ï¼Œæ²¡æœ‰è·³è·ƒ'
- en: '**intuitive control on complexity** - we can understand and relate the \(2,
    3, \ldots, 100\) leaf node decision trees'
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç›´è§‚çš„å¤æ‚æ€§æ§åˆ¶** - æˆ‘ä»¬å¯ä»¥ç†è§£å’Œå…³è”\(2, 3, \ldots, 100\)ä¸ªå¶èŠ‚ç‚¹çš„å†³ç­–æ ‘'
- en: '**flexible complexity** - the tree is free to grow in any manner to reduce
    training error, including highly asymmetric decision trees'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**çµæ´»çš„å¤æ‚æ€§** - æ ‘å¯ä»¥è‡ªç”±åœ°ä»¥ä»»ä½•æ–¹å¼å¢é•¿ä»¥å‡å°‘è®­ç»ƒè¯¯å·®ï¼ŒåŒ…æ‹¬é«˜åº¦ä¸å¯¹ç§°çš„å†³ç­–æ ‘'
- en: There are other common decision tree hyperparameters including,
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä»–å¸¸è§çš„å†³ç­–æ ‘è¶…å‚æ•°åŒ…æ‹¬ï¼Œ
- en: '**Minimum reduction in RSS** â€“ related to the idea that incremental increase
    in complexity must be offset by sufficient reduction in training error. This could
    stop the model early, for example, a split with low reduction in training error
    could lead to a subsequent split with a much larger reduction in training error'
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æœ€å°å‡å°‘çš„RSS** â€“ ä¸å¢é‡å¢åŠ å¤æ‚æ€§å¿…é¡»ç”±è¶³å¤Ÿçš„è®­ç»ƒè¯¯å·®å‡å°‘æ¥æŠµæ¶ˆçš„æƒ³æ³•ç›¸å…³ã€‚è¿™å¯èƒ½å¯¼è‡´æ¨¡å‹æå‰åœæ­¢ï¼Œä¾‹å¦‚ï¼Œå…·æœ‰ä½è®­ç»ƒè¯¯å·®å‡å°‘çš„åˆ†å‰²å¯èƒ½å¯¼è‡´éšåçš„åˆ†å‰²å…·æœ‰æ›´å¤§çš„è®­ç»ƒè¯¯å·®å‡å°‘'
- en: '**Minimum number of training data in each region** â€“ related to the concept
    of accuracy of the by-region estimates, i.e., we need at least \(n\) data for
    a reliable mean and most common category'
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ¯ä¸ªåŒºåŸŸçš„æœ€å°è®­ç»ƒæ•°æ®é‡** â€“ ä¸åŒºåŸŸä¼°è®¡çš„å‡†ç¡®æ€§æ¦‚å¿µç›¸å…³ï¼Œå³æˆ‘ä»¬éœ€è¦è‡³å°‘\(n\)ä¸ªæ•°æ®æ¥è·å¾—å¯é çš„å‡å€¼å’Œæœ€å¸¸è§ç±»åˆ«'
- en: '**Maximum number of levels** â€“ forces symmetric trees, similar number of splits
    to get to each leaf node. There is a large change in model complexity with change
    in the hyperparameter.'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æœ€å¤§å±‚æ•°** â€“ å¼ºåˆ¶å¯¹ç§°æ ‘ï¼Œåˆ°è¾¾æ¯ä¸ªå¶èŠ‚ç‚¹çš„åˆ†å‰²æ•°ç›¸ä¼¼ã€‚æ¨¡å‹å¤æ‚åº¦éšç€è¶…å‚æ•°çš„å˜åŒ–è€Œæœ‰å¾ˆå¤§å˜åŒ–ã€‚'
- en: The Prediction Model
  id: totrans-212
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é¢„æµ‹æ¨¡å‹
- en: 'The decision tree prediction model is represented as **set of nested if statements**,
    for example:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘é¢„æµ‹æ¨¡å‹è¡¨ç¤ºä¸º**åµŒå¥—çš„ifè¯­å¥**ï¼Œä¾‹å¦‚ï¼š
- en: '[PRE0]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: and the predictions as stated above are either the,
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥åŠä¸Šè¿°é¢„æµ‹æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼Œ
- en: regression - average of the training data in the region
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å›å½’ - åŒºåŸŸå†…è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼
- en: classification - the plurality, most common category, of the training data in
    the region
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆ†ç±» - åŒºåŸŸå†…è®­ç»ƒæ•°æ®çš„å¤šæ•°ç±»åˆ«
- en: Shapley Values from Decision Trees
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘ä¸­çš„Shapleyå€¼
- en: Recall, we need to take a single model, for example, \(f(x_1,x_2,x_3,x_4)\),
    and make an estimate for all possible combinations of feature subsets, for example,
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: å›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ä¸€ä¸ªå•ä¸€æ¨¡å‹è¿›è¡Œä¼°è®¡ï¼Œä¾‹å¦‚ï¼Œ\(f(x_1,x_2,x_3,x_4)\)ï¼Œå¹¶å¯¹æ‰€æœ‰å¯èƒ½çš„ç‰¹å¾å­é›†ç»„åˆè¿›è¡Œä¼°è®¡ï¼Œä¾‹å¦‚ï¼Œ
- en: \[ f(x_1) \quad f(x_2,x_4) \quad f(x_1,x_2,x_3) \]
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f(x_1) \quad f(x_2,x_4) \quad f(x_1,x_2,x_3) \]
- en: note, the naÃ¯ve approach to calculate Shapley values is to train the full combinatorial
    of models with different predictor features, but we donâ€™t want to make new models
    if our goal is feature importance to diagnose our specific model, \(f\), to support
    model explainability.
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œè®¡ç®—Shapleyå€¼çš„æœ´ç´ æ–¹æ³•æ˜¯å¯¹å…·æœ‰ä¸åŒé¢„æµ‹ç‰¹å¾çš„æ¨¡å‹çš„å…¨ç»„åˆè¿›è¡Œè®­ç»ƒï¼Œä½†å¦‚æœæˆ‘ä»¬ç›®æ ‡æ˜¯ç‰¹å¾é‡è¦æ€§ä»¥è¯Šæ–­æˆ‘ä»¬çš„ç‰¹å®šæ¨¡å‹\(f\)ï¼Œæ”¯æŒæ¨¡å‹å¯è§£é‡Šæ€§ï¼Œæˆ‘ä»¬ä¸æƒ³åˆ›å»ºæ–°çš„æ¨¡å‹ã€‚
- en: One solution is to apply a variety of approaches, similar to imputation methods,
    including,
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯åº”ç”¨å¤šç§æ–¹æ³•ï¼Œç±»ä¼¼äºæ’è¡¥æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼Œ
- en: replace the excluded feature(s) with the expected value, global mean,
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç”¨æœŸæœ›å€¼ï¼Œå³å…¨å±€å¹³å‡å€¼æ›¿æ¢è¢«æ’é™¤çš„ç‰¹å¾ï¼Œ
- en: \[ f(x_1,x_2,x_3) = f(x_1,x_2,x_3,x_4=E[x_4]) \]
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f(x_1,x_2,x_3) = f(x_1,x_2,x_3,x_4=E[x_4]) \]
- en: replace the excluded feature(s) with the median value, the 50th percentile,
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç”¨ä¸­ä½æ•°ï¼Œå³ç¬¬50ç™¾åˆ†ä½æ•°æ›¿æ¢è¢«æ’é™¤çš„ç‰¹å¾ï¼Œ
- en: \[ f(x_1,x_2,x_3) = f(x_1,x_2,x_3,x_4=P50_{x_4}) \]
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f(x_1,x_2,x_3) = f(x_1,x_2,x_3,x_4=P50_{x_4}) \]
- en: There is a more accurate, unique method with tree-based models, we can actually
    remove the influence of any of the features from the decision tree after the model
    is trained, for example,
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºåŸºäºæ ‘çš„æ¨¡å‹ï¼Œæœ‰ä¸€ä¸ªæ›´å‡†ç¡®ã€ç‹¬ç‰¹çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥åœ¨æ¨¡å‹è®­ç»ƒåç§»é™¤ä»»ä½•ç‰¹å¾å¯¹å†³ç­–æ ‘çš„å½±å“ï¼Œä¾‹å¦‚ï¼Œ
- en: remove all \(x_4\) branches, and then the model does not use \(x_4\) to make
    the prediction
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç§»é™¤æ‰€æœ‰\(x_4\)åˆ†æ”¯ï¼Œç„¶åæ¨¡å‹ä¸ä¼šä½¿ç”¨\(x_4\)è¿›è¡Œé¢„æµ‹
- en: Of course, we cannot just remove branches and â€˜wood glueâ€™ the tree back together!
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ç„¶ï¼Œæˆ‘ä»¬ä¸å¯èƒ½åªæ˜¯ç§»é™¤åˆ†æ”¯ï¼Œç„¶åç”¨â€œèƒ¶æ°´â€å°†æ ‘é‡æ–°ç²˜åˆåœ¨ä¸€èµ·ï¼
- en: we must make new predictions that donâ€™t introduce bias.
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¿…é¡»åšå‡ºæ–°çš„é¢„æµ‹ï¼Œè¿™äº›é¢„æµ‹ä¸ä¼šå¼•å…¥åå·®ã€‚
- en: Letâ€™s demonstrate the procedure for removing a feature from a decision tree,
    with a couple of prediction cases,
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªé¢„æµ‹æ¡ˆä¾‹æ¥æ¼”ç¤ºä»å†³ç­–æ ‘ä¸­ç§»é™¤ç‰¹å¾çš„è¿‡ç¨‹ï¼Œ
- en: Here is a prediction case that does not encounter the removed feature, \(x_2\)
    is removed and,
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è¿™é‡Œæ˜¯ä¸€ä¸ªæ²¡æœ‰é‡åˆ°è¢«ç§»é™¤ç‰¹å¾çš„é¢„æµ‹æ¡ˆä¾‹ï¼Œç§»é™¤\(x_2\)åï¼Œ
- en: \[ x_1=25 \]
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: \[ x_1=25 \]
- en: the prediction is made as usual.
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é¢„æµ‹é€šå¸¸è¿›è¡Œã€‚
- en: '![](../Images/a9783a200ab476bb3a92cb2cfec12d63.png)'
  id: totrans-235
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/a9783a200ab476bb3a92cb2cfec12d63.png)'
- en: Prediction case that does not encounter the removed feature is made as usual.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºæ²¡æœ‰é‡åˆ°è¢«ç§»é™¤ç‰¹å¾çš„é¢„æµ‹æ¡ˆä¾‹ï¼Œé€šå¸¸è¿›è¡Œé¢„æµ‹ã€‚
- en: \[ f(x_1=25) = 20 \]
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f(x_1=25) = 20 \]
- en: A prediction case that does encounter the removed feature, \(x_1\) is removed
    and,
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªé‡åˆ°è¢«ç§»é™¤ç‰¹å¾\(x_1\)çš„é¢„æµ‹æ¡ˆä¾‹ï¼Œç§»é™¤\(x_1\)åï¼Œ
- en: \[ x_2 = 60 \]
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: \[ x_2 = 60 \]
- en: we effectively go down both paths, by weighting, by number of training data,
    the solution over both paths!
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å®é™…ä¸Šé€šè¿‡åŠ æƒï¼ŒæŒ‰è®­ç»ƒæ•°æ®æ•°é‡åŠ æƒï¼Œæ²¿ç€ä¸¤æ¡è·¯å¾„éƒ½æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆï¼
- en: '![](../Images/8152951b8a3c920f03825528d98c5ae7.png)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/8152951b8a3c920f03825528d98c5ae7.png)'
- en: Prediction case that does encounter the removed feature is made by weighting
    both paths by the number of training data.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºé‡åˆ°è¢«ç§»é™¤ç‰¹å¾çš„é¢„æµ‹æ¡ˆä¾‹ï¼Œé€šè¿‡æŒ‰è®­ç»ƒæ•°æ®æ•°é‡åŠ æƒä¸¤æ¡è·¯å¾„æ¥è¿›è¡Œé¢„æµ‹ã€‚
- en: \[ f(x_2=60) = \frac{60}{100} \left[ \frac{15}{60} \times 20 + \frac{45}{60}
    \times 70 \right] + \frac{40}{100} \left[130\right] = 86.5 \]\[ f(x_2=60) = 86.5
    \]
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f(x_2=60) = \frac{60}{100} \left[ \frac{15}{60} \times 20 + \frac{45}{60}
    \times 70 \right] + \frac{40}{100} \left[130\right] = 86.5 \]\[ f(x_2=60) = 86.5
    \]
- en: Load the Required Libraries
  id: totrans-244
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åŠ è½½æ‰€éœ€çš„åº“
- en: We will also need some standard packages. These should have been installed with
    Anaconda 3.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›æ ‡å‡†åŒ…ã€‚è¿™äº›åº”è¯¥å·²ç»ä¸Anaconda 3ä¸€èµ·å®‰è£…ã€‚
- en: '[PRE1]'
  id: totrans-246
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: If you get a package import error, you may have to first install some of these
    packages. This can usually be accomplished by opening up a command window on Windows
    and then typing â€˜python -m pip install [package-name]â€™. More assistance is available
    with the respective package docs.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ é‡åˆ°åŒ…å¯¼å…¥é”™è¯¯ï¼Œä½ å¯èƒ½éœ€è¦é¦–å…ˆå®‰è£…è¿™äº›åŒ…ä¸­çš„å‡ ä¸ªã€‚è¿™é€šå¸¸å¯ä»¥é€šè¿‡åœ¨Windowsä¸Šæ‰“å¼€å‘½ä»¤çª—å£ç„¶åè¾“å…¥â€˜python -m pip install
    [package-name]â€™æ¥å®Œæˆã€‚æ›´å¤šå¸®åŠ©å¯ä»¥åœ¨ç›¸åº”åŒ…çš„æ–‡æ¡£ä¸­æ‰¾åˆ°ã€‚
- en: Declare Functions
  id: totrans-248
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å£°æ˜å‡½æ•°
- en: Letâ€™s define a couple of functions to streamline plotting correlation matrices
    and visualization of a decision tree regression model.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å®šä¹‰å‡ ä¸ªå‡½æ•°æ¥ç®€åŒ–ç›¸å…³çŸ©é˜µçš„ç»˜åˆ¶å’Œå†³ç­–æ ‘å›å½’æ¨¡å‹çš„å¯è§†åŒ–ã€‚
- en: '[PRE2]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Set the Working Directory
  id: totrans-251
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¾ç½®å·¥ä½œç›®å½•
- en: I always like to do this so I donâ€™t lose files and to simplify subsequent read
    and writes (avoid including the full address each time).
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æ€»æ˜¯å–œæ¬¢è¿™æ ·åšï¼Œè¿™æ ·æˆ‘å°±ä¸ä¼šä¸¢å¤±æ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥ç®€åŒ–åç»­çš„è¯»å–å’Œå†™å…¥ï¼ˆæ¯æ¬¡éƒ½é¿å…åŒ…å«å®Œæ•´åœ°å€ï¼‰ã€‚
- en: '[PRE3]'
  id: totrans-253
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: You will have to update the part in quotes with your own working directory and
    the format is different on a Mac (e.g. â€œ~/PGEâ€).
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å°†ä¸å¾—ä¸æ›´æ–°å¼•å·å†…çš„éƒ¨åˆ†ä»¥åŒ…å«ä½ è‡ªå·±çš„å·¥ä½œç›®å½•ï¼Œå¹¶ä¸”åœ¨Macä¸Šæ ¼å¼ä¸åŒï¼ˆä¾‹å¦‚ï¼Œâ€œ~/PGEâ€ï¼‰ã€‚
- en: Loading Data
  id: totrans-255
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åŠ è½½æ•°æ®
- en: 'Letâ€™s load the provided multivariate, spatial dataset [unconv_MV.csv](https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/unconv_MV.csv)
    available in my GeoDataSet repo. It is a comma delimited file with:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åŠ è½½æä¾›çš„å¤šå…ƒã€ç©ºé—´æ•°æ®é›†[unconv_MV.csv](https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/unconv_MV.csv)ï¼Œå®ƒåœ¨æˆ‘çš„GeoDataSetä»“åº“ä¸­å¯ç”¨ã€‚å®ƒæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„æ–‡ä»¶ï¼ŒåŒ…å«ï¼š
- en: well index (integer)
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: äº•æŒ‡æ•°ï¼ˆæ•´æ•°ï¼‰
- en: porosity (%)
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å­”éš™ç‡ (%)
- en: permeability (\(mD\))
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¸—é€ç‡ (\(mD\))
- en: acoustic impedance (\(\frac{kg}{m^3} \cdot \frac{m}{s} \cdot 10^6\)).
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å£°æ³¢é˜»æŠ— (\(\frac{kg}{m^3} \cdot \frac{m}{s} \cdot 10^6\))ã€‚
- en: brittleness (%)
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'å‰ªåˆ‡ç‡ (%) '
- en: total organic carbon (%)
  id: totrans-262
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'æ€»æœ‰æœºç¢³å«é‡ (%) '
- en: vitrinite reflectance (%)
  id: totrans-263
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'ç»ç’ƒå…‰æ³½ç‡ (%) '
- en: initial gas production (90 day average) (MCFPD)
  id: totrans-264
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆå§‹æ°”ä½“äº§é‡ï¼ˆ90å¤©å¹³å‡ï¼‰(MCFPD)
- en: We load it with the pandas â€˜read_csvâ€™ function into a data frame we called â€˜dfâ€™
    and then preview it to make sure it loaded correctly.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä½¿ç”¨pandasçš„â€˜read_csvâ€™å‡½æ•°å°†å…¶åŠ è½½åˆ°æˆ‘ä»¬ç§°ä¸ºâ€˜dfâ€™çš„æ•°æ®æ¡†ä¸­ï¼Œç„¶åé¢„è§ˆå®ƒä»¥ç¡®ä¿æ­£ç¡®åŠ è½½ã€‚
- en: '**Python Tip: using functions from a package** just type the label for the
    package that we declared at the beginning:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: '**PythonæŠ€å·§ï¼šä½¿ç”¨åŒ…ä¸­çš„å‡½æ•°**åªéœ€è¾“å…¥æˆ‘ä»¬åœ¨å¼€å¤´å£°æ˜çš„åŒ…çš„æ ‡ç­¾ï¼š'
- en: '[PRE4]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'so we can access the pandas function â€˜read_csvâ€™ with the command:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è®¿é—®pandaså‡½æ•°â€˜read_csvâ€™ï¼š
- en: '[PRE5]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: but read csv has required input parameters. The essential one is the name of
    the file. For our circumstance all the other default parameters are fine. If you
    want to see all the possible parameters for this function, just go to the docs
    [here](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html).
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†è¯»å–csvæ–‡ä»¶éœ€è¦è¾“å…¥å‚æ•°ã€‚å…¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªæ˜¯æ–‡ä»¶åã€‚å¯¹äºæˆ‘ä»¬çš„æƒ…å†µï¼Œæ‰€æœ‰å…¶ä»–é»˜è®¤å‚æ•°éƒ½å¾ˆå¥½ã€‚å¦‚æœæ‚¨æƒ³æŸ¥çœ‹æ­¤å‡½æ•°çš„æ‰€æœ‰å¯èƒ½å‚æ•°ï¼Œè¯·è®¿é—®[è¿™é‡Œ](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html)çš„æ–‡æ¡£ã€‚
- en: The docs are always helpful
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ–‡æ¡£æ€»æ˜¯å¾ˆæœ‰å¸®åŠ©ã€‚
- en: There is often a lot of flexibility for Python functions, possible through using
    various inputs parameters
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Pythonå‡½æ•°é€šå¸¸æœ‰å¾ˆå¤šçµæ´»æ€§ï¼Œè¿™å¯ä»¥é€šè¿‡ä½¿ç”¨å„ç§è¾“å…¥å‚æ•°æ¥å®ç°ã€‚
- en: also, the program has an output, a pandas DataFrame loaded from the data. So
    we have to specify the name / variable representing that new object.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œç¨‹åºæœ‰ä¸€ä¸ªè¾“å‡ºï¼Œä¸€ä¸ªä»æ•°æ®åŠ è½½çš„pandas DataFrameã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®šä»£è¡¨è¿™ä¸ªæ–°å¯¹è±¡çš„åå­—/å˜é‡ã€‚
- en: '[PRE6]'
  id: totrans-274
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Letâ€™s run this command to load the data and then this command to extract a random
    subset of the data.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬è¿è¡Œè¿™ä¸ªå‘½ä»¤æ¥åŠ è½½æ•°æ®ï¼Œç„¶åè¿è¡Œè¿™ä¸ªå‘½ä»¤æ¥æå–æ•°æ®çš„ä¸€ä¸ªéšæœºå­é›†ã€‚
- en: '[PRE7]'
  id: totrans-276
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Feature Engineering
  id: totrans-277
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç‰¹å¾å·¥ç¨‹
- en: 'Letâ€™s make some changes to the data to improve the workflow:'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œä¸€äº›ä¿®æ”¹ä»¥æ”¹è¿›å·¥ä½œæµç¨‹ï¼š
- en: '**Select the predictor features (x2) and the response feature (x1)**, make
    sure the metadata is also consistent.'
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**é€‰æ‹©é¢„æµ‹ç‰¹å¾ï¼ˆx2ï¼‰å’Œå“åº”ç‰¹å¾ï¼ˆx1ï¼‰**ï¼Œç¡®ä¿å…ƒæ•°æ®ä¹Ÿä¿æŒä¸€è‡´ã€‚'
- en: '**Metadata** encoding such as the units, labels and display ranges for each
    feature.'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å…ƒæ•°æ®**ç¼–ç ï¼Œå¦‚æ¯ä¸ªç‰¹å¾çš„å•ä½ã€æ ‡ç­¾å’Œæ˜¾ç¤ºèŒƒå›´ã€‚'
- en: '**Reduce the number of data** for ease of visualization (hard to see if too
    many points on our plots).'
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å‡å°‘æ•°æ®æ•°é‡**ä»¥æ–¹ä¾¿å¯è§†åŒ–ï¼ˆå¦‚æœå›¾è¡¨ä¸Šçš„ç‚¹å¤ªå¤šï¼Œåˆ™éš¾ä»¥çœ‹æ¸…ï¼‰ã€‚'
- en: '**Train and test data split** to demonstrate and visualize simple hyperparameter
    tuning.'
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²**ä»¥æ¼”ç¤ºå’Œå¯è§†åŒ–ç®€å•çš„è¶…å‚æ•°è°ƒæ•´ã€‚'
- en: '**Add random noise to the data** to demonstrate model overfit. The original
    data is error free and does not readily demonstrate overfit.'
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å‘æ•°æ®æ·»åŠ éšæœºå™ªå£°**ä»¥æ¼”ç¤ºæ¨¡å‹è¿‡æ‹Ÿåˆã€‚åŸå§‹æ•°æ®æ— è¯¯å·®ï¼Œä¸æ˜“å±•ç¤ºè¿‡æ‹Ÿåˆã€‚'
- en: Given this is properly set, one should be able to use any dataset and features
    for this demonstration.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœè®¾ç½®æ­£ç¡®ï¼Œåº”è¯¥èƒ½å¤Ÿä½¿ç”¨ä»»ä½•æ•°æ®é›†å’Œç‰¹å¾è¿›è¡Œæ­¤æ¼”ç¤ºã€‚
- en: for brevity we donâ€™t show any feature selection here. Previous chapter, e.g.,
    k-nearest neighbours include some feature selection methods, but see the feature
    selection chapter for many possible methods with codes for feature selection.
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸ºäº†ç®€æ´ï¼Œæˆ‘ä»¬è¿™é‡Œæ²¡æœ‰å±•ç¤ºä»»ä½•ç‰¹å¾é€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œå‰ä¸€ç« ä¸­æåˆ°çš„k-æœ€è¿‘é‚»ç®—æ³•åŒ…æ‹¬ä¸€äº›ç‰¹å¾é€‰æ‹©æ–¹æ³•ï¼Œä½†æ›´å¤šå¯èƒ½çš„æ–¹æ³•å’Œç‰¹å¾é€‰æ‹©ä»£ç è¯·å‚é˜…ç‰¹å¾é€‰æ‹©ç« èŠ‚ã€‚
- en: 'Optional: Add Random Noise to the Response Feature'
  id: totrans-286
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯é€‰ï¼šå‘å“åº”ç‰¹å¾æ·»åŠ éšæœºå™ªå£°
- en: We can do this to observe the impact of data noise on overfit and hyperparameter
    tuning.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿæ•°æ®å™ªå£°å¯¹è¿‡æ‹Ÿåˆå’Œè¶…å‚æ•°è°ƒæ•´çš„å½±å“æ¥åšè¿™ä»¶äº‹ã€‚
- en: This is for experiential learning, of course we wouldnâ€™t add random noise to
    our data
  id: totrans-288
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸ºäº†ç»éªŒå­¦ä¹ ï¼Œå½“ç„¶æˆ‘ä»¬ä¸ä¼šå‘æ•°æ®ä¸­æ·»åŠ éšæœºå™ªå£°ã€‚
- en: We set the random number seed for reproducibility
  id: totrans-289
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è®¾ç½®äº†éšæœºæ•°ç§å­ä»¥ç¡®ä¿å¯é‡å¤æ€§
- en: '[PRE8]'
  id: totrans-290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Letâ€™s make sure that we have selected reasonable features to build a model
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ç¡®ä¿æˆ‘ä»¬å·²ç»é€‰æ‹©äº†åˆç†çš„ç‰¹å¾æ¥æ„å»ºæ¨¡å‹ã€‚
- en: the 2 predictor features are not collinear, as this would result in an unstable
    prediction model
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸¤ä¸ªé¢„æµ‹ç‰¹å¾ä¸å…±çº¿ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´é¢„æµ‹æ¨¡å‹ä¸ç¨³å®šã€‚
- en: each of the features are related to the response feature, the predictor features
    inform the response
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¯ä¸ªç‰¹å¾éƒ½ä¸å“åº”ç‰¹å¾ç›¸å…³ï¼Œé¢„æµ‹ç‰¹å¾å‘ŠçŸ¥å“åº”ã€‚
- en: Calculate the Correlation Matrix and Correlation with Response Ranking
  id: totrans-294
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¡ç®—ç›¸å…³çŸ©é˜µå’Œä¸å“åº”æ’åçš„ç›¸å…³æ€§
- en: Letâ€™s start with correlation analysis. We can calculate and view the correlation
    matrix and correlation to the response features with these previously declared
    functions.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»ç›¸å…³æ€§åˆ†æå¼€å§‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¹‹å‰å£°æ˜çš„å‡½æ•°è®¡ç®—å¹¶æŸ¥çœ‹ç›¸å…³çŸ©é˜µä»¥åŠä¸å“åº”ç‰¹å¾çš„å…³è”ã€‚
- en: correlation analysis is based on the assumption of linear relationships, but
    it is a good start
  id: totrans-296
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç›¸å…³æ€§åˆ†æåŸºäºçº¿æ€§å…³ç³»çš„å‡è®¾ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªè‰¯å¥½çš„å¼€å§‹
- en: '[PRE9]'
  id: totrans-297
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![_images/152d837d72f43ba9a48527a444d81b3bbc73a2ba553d2760d27f5c20206ea0b2.png](../Images/fe078f42023f81da1972474b1d3bbf26.png)'
  id: totrans-298
  prefs: []
  type: TYPE_IMG
  zh: '![_images/152d837d72f43ba9a48527a444d81b3bbc73a2ba553d2760d27f5c20206ea0b2.png](../Images/fe078f42023f81da1972474b1d3bbf26.png)'
- en: Note the 1.0 diagonal resulting from the correlation of each variable with themselves.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ç”±äºæ¯ä¸ªå˜é‡ä¸å…¶è‡ªèº«çš„ç›¸å…³æ€§è€Œäº§ç”Ÿçš„ 1.0 å¯¹è§’çº¿ã€‚
- en: This looks good. There is a mix of correlation magnitudes. Of course, correlation
    coefficients are limited to degree of linear correlations.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™çœ‹èµ·æ¥ä¸é”™ã€‚å­˜åœ¨å¤šç§ç›¸å…³æ€§çš„å¤§å°ã€‚å½“ç„¶ï¼Œç›¸å…³ç³»æ•°ä»…é™äºçº¿æ€§ç›¸å…³æ€§çš„ç¨‹åº¦ã€‚
- en: Letâ€™s look at the matrix scatter plot to see the pairwise relationship between
    the features.
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æŸ¥çœ‹çŸ©é˜µæ•£ç‚¹å›¾ï¼Œä»¥æŸ¥çœ‹ç‰¹å¾ä¹‹é—´çš„æˆå¯¹å…³ç³»ã€‚
- en: '[PRE10]'
  id: totrans-302
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![_images/8d03fa748bcc76aea92c8e57b5fb8071473e84b910d1402f5fd62dd21b102145.png](../Images/515a70a53d49c49c9ecf98249cd67b5d.png)'
  id: totrans-303
  prefs: []
  type: TYPE_IMG
  zh: '![_images/8d03fa748bcc76aea92c8e57b5fb8071473e84b910d1402f5fd62dd21b102145.png](../Images/515a70a53d49c49c9ecf98249cd67b5d.png)'
- en: Train and Test Split
  id: totrans-304
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Train and Test Split
- en: For convenience and simplicity we use scikit-learnâ€™s random train and test split.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ–¹ä¾¿å’Œç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨ scikit-learn çš„éšæœºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²ã€‚
- en: '[PRE11]'
  id: totrans-306
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Visualize the DataFrame
  id: totrans-307
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯è§†åŒ– DataFrame
- en: Visualizing the train and test DataFrame is useful check before we build our
    models.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æˆ‘ä»¬æ„å»ºæ¨¡å‹ä¹‹å‰ï¼Œå¯è§†åŒ–è®­ç»ƒå’Œæµ‹è¯• DataFrame æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„æ£€æŸ¥ã€‚
- en: many things can go wrong, e.g., we loaded the wrong data, all the features did
    not load, etc.
  id: totrans-309
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®¸å¤šäº‹æƒ…å¯èƒ½ä¼šå‡ºé”™ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬åŠ è½½äº†é”™è¯¯çš„æ•°æ®ï¼Œæ‰€æœ‰ç‰¹å¾éƒ½æ²¡æœ‰åŠ è½½ç­‰ã€‚
- en: We can preview by utilizing the â€˜headâ€™ DataFrame member function (with a nice
    and clean format, see below).
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨ 'head' DataFrame æˆå‘˜å‡½æ•°æ¥é¢„è§ˆï¼ˆæ ¼å¼æ•´æ´ï¼Œè§ä¸‹æ–‡ï¼‰ã€‚
- en: '[PRE12]'
  id: totrans-311
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-312
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '|  | Por | Brittle | Production |'
  id: totrans-313
  prefs: []
  type: TYPE_TB
  zh: '|  | Por | Brittle | Production |'
- en: '| --- | --- | --- | --- |'
  id: totrans-314
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| 86 | 12.83 | 29.87 | 2089.258307 |'
  id: totrans-315
  prefs: []
  type: TYPE_TB
  zh: '| 86 | 12.83 | 29.87 | 2089.258307 |'
- en: '| 35 | 17.39 | 56.43 | 5803.596379 |'
  id: totrans-316
  prefs: []
  type: TYPE_TB
  zh: '| 35 | 17.39 | 56.43 | 5803.596379 |'
- en: '| 75 | 12.23 | 40.67 | 3511.348151 |'
  id: totrans-317
  prefs: []
  type: TYPE_TB
  zh: '| 75 | 12.23 | 40.67 | 3511.348151 |'
- en: '| 36 | 13.72 | 40.24 | 4004.849870 |'
  id: totrans-318
  prefs: []
  type: TYPE_TB
  zh: '| 36 | 13.72 | 40.24 | 4004.849870 |'
- en: '| 126 | 12.83 | 17.20 | 2712.836372 |'
  id: totrans-319
  prefs: []
  type: TYPE_TB
  zh: '| 126 | 12.83 | 17.20 | 2712.836372 |'
- en: '|  | Por | Brittle | Production |'
  id: totrans-320
  prefs: []
  type: TYPE_TB
  zh: '|  | Por | Brittle | Production |'
- en: '| --- | --- | --- | --- |'
  id: totrans-321
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| 5 | 15.55 | 58.25 | 5353.761093 |'
  id: totrans-322
  prefs: []
  type: TYPE_TB
  zh: '| 5 | 15.55 | 58.25 | 5353.761093 |'
- en: '| 46 | 20.21 | 23.78 | 4387.577571 |'
  id: totrans-323
  prefs: []
  type: TYPE_TB
  zh: '| 46 | 20.21 | 23.78 | 4387.577571 |'
- en: '| 96 | 15.07 | 39.39 | 4412.135054 |'
  id: totrans-324
  prefs: []
  type: TYPE_TB
  zh: '| 96 | 15.07 | 39.39 | 4412.135054 |'
- en: '| 45 | 12.10 | 63.24 | 3654.779704 |'
  id: totrans-325
  prefs: []
  type: TYPE_TB
  zh: '| 45 | 12.10 | 63.24 | 3654.779704 |'
- en: '| 105 | 19.54 | 37.40 | 5251.551624 |'
  id: totrans-326
  prefs: []
  type: TYPE_TB
  zh: '| 105 | 19.54 | 37.40 | 5251.551624 |'
- en: Summary Statistics for Tabular Data
  id: totrans-327
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è¡¨æ ¼æ•°æ®çš„æ‘˜è¦ç»Ÿè®¡
- en: There are a lot of efficient methods to calculate summary statistics from tabular
    data in DataFrames.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ DataFrame ä¸­ï¼Œæœ‰è®¸å¤šé«˜æ•ˆçš„æ–¹æ³•å¯ä»¥è®¡ç®—è¡¨æ ¼æ•°æ®çš„æ‘˜è¦ç»Ÿè®¡ã€‚
- en: The describe command provides count, mean, minimum, maximum in a nice data table.
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: The describe command provides count, mean, minimum, maximum in a nice data table.
- en: '[PRE14]'
  id: totrans-330
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[PRE15]'
  id: totrans-331
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '|  | Por | Brittle | Production |'
  id: totrans-332
  prefs: []
  type: TYPE_TB
  zh: '|  | Por | Brittle | Production |'
- en: '| --- | --- | --- | --- |'
  id: totrans-333
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| count | 105.000000 | 105.000000 | 105.000000 |'
  id: totrans-334
  prefs: []
  type: TYPE_TB
  zh: '| count | 105.000000 | 105.000000 | 105.000000 |'
- en: '| mean | 14.859238 | 48.861143 | 4238.554591 |'
  id: totrans-335
  prefs: []
  type: TYPE_TB
  zh: '| mean | 14.859238 | 48.861143 | 4238.554591 |'
- en: '| std | 3.057228 | 14.432050 | 1087.707113 |'
  id: totrans-336
  prefs: []
  type: TYPE_TB
  zh: '| std | 3.057228 | 14.432050 | 1087.707113 |'
- en: '| min | 7.220000 | 10.940000 | 1517.373571 |'
  id: totrans-337
  prefs: []
  type: TYPE_TB
  zh: '| min | 7.220000 | 10.940000 | 1517.373571 |'
- en: '| max | 23.550000 | 84.330000 | 6907.632261 |'
  id: totrans-338
  prefs: []
  type: TYPE_TB
  zh: '| max | 23.550000 | 84.330000 | 6907.632261 |'
- en: '|  | Por | Brittle | Production |'
  id: totrans-339
  prefs: []
  type: TYPE_TB
  zh: '|  | Por | Brittle | Production |'
- en: '| --- | --- | --- | --- |'
  id: totrans-340
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| count | 35.000000 | 35.000000 | 35.000000 |'
  id: totrans-341
  prefs: []
  type: TYPE_TB
  zh: '| count | 35.000000 | 35.000000 | 35.000000 |'
- en: '| mean | 15.011714 | 46.798286 | 4378.913131 |'
  id: totrans-342
  prefs: []
  type: TYPE_TB
  zh: '| mean | 15.011714 | 46.798286 | 4378.913131 |'
- en: '| std | 3.574467 | 13.380910 | 1290.216113 |'
  id: totrans-343
  prefs: []
  type: TYPE_TB
  zh: '| std | 3.574467 | 13.380910 | 1290.216113 |'
- en: '| min | 6.550000 | 20.120000 | 1846.027145 |'
  id: totrans-344
  prefs: []
  type: TYPE_TB
  zh: '| min | 6.550000 | 20.120000 | 1846.027145 |'
- en: '| max | 20.860000 | 68.760000 | 6593.447893 |'
  id: totrans-345
  prefs: []
  type: TYPE_TB
  zh: '| max | 20.860000 | 68.760000 | 6593.447893 |'
- en: It is good that we checked the summary statistics.
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ£€æŸ¥äº†æ‘˜è¦ç»Ÿè®¡æ˜¯ä»¶å¥½äº‹ã€‚
- en: there are no obvious issues
  id: totrans-347
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ²¡æœ‰æ˜æ˜¾çš„é”™è¯¯
- en: check out the range of values for each feature to set up and adjust plotting
    limits. See above.
  id: totrans-348
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ£€æŸ¥æ¯ä¸ªç‰¹å¾çš„å€¼èŒƒå›´ï¼Œä»¥è®¾ç½®å’Œè°ƒæ•´ç»˜å›¾é™åˆ¶ã€‚è§ä¸Šæ–‡ã€‚
- en: Visualize the Train and Test Splits
  id: totrans-349
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯è§†åŒ–è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²
- en: Letâ€™s check the consistency and coverage of training and testing with histograms
    and scatter plots.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä½¿ç”¨ç›´æ–¹å›¾å’Œæ•£ç‚¹å›¾æ¥æ£€æŸ¥è®­ç»ƒå’Œæµ‹è¯•æ•°æ®çš„ä¸€è‡´æ€§å’Œè¦†ç›–ç‡ã€‚
- en: check to make sure the training and testing cover the range of possible feature
    combinations
  id: totrans-351
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ£€æŸ¥ä»¥ç¡®ä¿è®­ç»ƒå’Œæµ‹è¯•è¦†ç›–äº†å¯èƒ½çš„ç‰¹å¾ç»„åˆèŒƒå›´
- en: ensure we are not extrapolating beyond the training data with the testing cases
  id: totrans-352
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç¡®ä¿æµ‹è¯•ç”¨ä¾‹ä¸ä¼šè¶…å‡ºè®­ç»ƒæ•°æ®èŒƒå›´è¿›è¡Œå¤–æ¨
- en: '[PRE16]'
  id: totrans-353
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '![_images/7f95232f4bccd970cd69b500c8930cfffaf4ffd9a243b7aea1e184337ba9175d.png](../Images/3e84676c9f7f37dcabed4194a238047f.png)'
  id: totrans-354
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/3e84676c9f7f37dcabed4194a238047f.png)'
- en: Sometimes I find it more convenient to compare distributions by looking at CDFâ€™s
    instead of histograms.
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰æ—¶æˆ‘å‘ç°é€šè¿‡æŸ¥çœ‹CDFè€Œä¸æ˜¯ç›´æ–¹å›¾æ¥æ¯”è¾ƒåˆ†å¸ƒæ›´æ–¹ä¾¿ã€‚
- en: we avoid the arbitrary choice of histogram bin size, because CDFâ€™s are at the
    data resolution.
  id: totrans-356
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬é¿å…é€‰æ‹©ä»»æ„ç›´æ–¹å›¾åˆ†ç®±å¤§å°ï¼Œå› ä¸ºç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰ä¸æ•°æ®åˆ†è¾¨ç‡ä¸€è‡´ã€‚
- en: '[PRE17]'
  id: totrans-357
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '![_images/846daf6f4bcdece7bb39d2b1b9c385e351fbcf923d9599f41f5c7a4c3639c3dc.png](../Images/89d70d18d70c546bb0ac8c55112e894e.png)'
  id: totrans-358
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/89d70d18d70c546bb0ac8c55112e894e.png)'
- en: Once again, the distributions are well behaved,
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: å†æ¬¡å¼ºè°ƒï¼Œåˆ†å¸ƒè¡¨ç°è‰¯å¥½ï¼Œ
- en: we cannot observe obvious gaps nor truncations.
  id: totrans-360
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ— æ³•è§‚å¯Ÿåˆ°æ˜æ˜¾çš„é—´éš™æˆ–æˆªæ–­ã€‚
- en: check coverage of the train and test data
  id: totrans-361
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ£€æŸ¥è®­ç»ƒå’Œæµ‹è¯•æ•°æ®çš„è¦†ç›–ç‡
- en: Letâ€™s look at a scatter plot of Porosity vs. Brittleness with points colored
    by Production.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹çœ‹å­”éš™ç‡ä¸è„†æ€§ä¹‹é—´çš„æ•£ç‚¹å›¾ï¼Œç‚¹æ ¹æ®äº§é‡ç€è‰²ã€‚
- en: '[PRE18]'
  id: totrans-363
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![_images/a0a42ff41b36629afd1b47ee725006868db8d0038504ccf72d1f966ac5e69281.png](../Images/3ec3d66453c69d41e8b4c7a2508530a0.png)'
  id: totrans-364
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/3ec3d66453c69d41e8b4c7a2508530a0.png)'
- en: This problem looks complicated and could not be modeled with simple linear regression.
    It appears that there are non-linearities. Letâ€™s use a simple nonparametric model,
    decision tree.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªé—®é¢˜çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œæ— æ³•ç”¨ç®€å•çš„çº¿æ€§å›å½’å»ºæ¨¡ã€‚ä¼¼ä¹å­˜åœ¨éçº¿æ€§ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„éå‚æ•°æ¨¡å‹ï¼Œå³å†³ç­–æ ‘ã€‚
- en: Instantiate, Fit and Predict with scikit-learn
  id: totrans-366
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Instantiate, Fit and Predict with scikit-learn
- en: Letâ€™s build our predictive machine learning model, by instantiate, fit and predict
    with scikit-learn.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬é€šè¿‡å®ä¾‹åŒ–ã€æ‹Ÿåˆå’Œé¢„æµ‹æ¥æ„å»ºæˆ‘ä»¬çš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä½¿ç”¨scikit-learnã€‚
- en: '**instantiate** the model object with the hyperparameters, k-nearest neighbours'
  id: totrans-368
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**instantiate** æ¨¡å‹å¯¹è±¡ï¼Œä½¿ç”¨è¶…å‚æ•°ï¼Œk-æœ€è¿‘é‚»'
- en: '**fit** by training the model with the training data, we use the member function
    fit'
  id: totrans-369
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**fit** é€šè¿‡ç”¨è®­ç»ƒæ•°æ®è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨fitæˆå‘˜å‡½æ•°'
- en: '**predict** with the trained model. After fit is run, predict is available
    to make predictions'
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**predict** ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹ã€‚åœ¨fitè¿è¡Œåï¼Œpredictå¯ç”¨äºè¿›è¡Œé¢„æµ‹'
- en: Training a Decision Tree (Regression Tree)
  id: totrans-371
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®­ç»ƒå†³ç­–æ ‘ï¼ˆå›å½’æ ‘ï¼‰
- en: Now we are ready to run the DecisionTreeRegressor command to build our regression
    tree to predict our response feature given our 2 predictor features (recall we
    limit ourselves here to 2 predictor features for ease of visualization).
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½è¿è¡ŒDecisionTreeRegressorå‘½ä»¤æ¥æ„å»ºæˆ‘ä»¬çš„å›å½’æ ‘ï¼Œä»¥é¢„æµ‹æˆ‘ä»¬çš„å“åº”ç‰¹å¾ï¼Œç»™å®šæˆ‘ä»¬çš„ä¸¤ä¸ªé¢„æµ‹ç‰¹å¾ï¼ˆè®°ä½ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œé™åˆ¶è‡ªå·±ä½¿ç”¨ä¸¤ä¸ªé¢„æµ‹ç‰¹å¾ä»¥ç®€åŒ–å¯è§†åŒ–ï¼‰ã€‚
- en: We will use our two functions defined above to visualize the decision tree prediction
    over the feature space and the cross plot of actual and estimated production for
    the training data along with three model metrics from the sklearn.metric module.
  id: totrans-373
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ä¸¤ä¸ªå‡½æ•°æ¥å¯è§†åŒ–å†³ç­–æ ‘åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„é¢„æµ‹ï¼Œä»¥åŠè®­ç»ƒæ•°æ®çš„å®é™…äº§é‡å’Œä¼°è®¡äº§é‡çš„äº¤å‰å›¾ï¼Œä»¥åŠæ¥è‡ªsklearn.metricsæ¨¡å—çš„ä¸‰ä¸ªæ¨¡å‹åº¦é‡ã€‚
- en: '**Hyper Parameters** - we constrain our tree complexity with:'
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: '**è¶…å‚æ•°** - æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹æ–¹å¼çº¦æŸæ ‘å¤æ‚åº¦ï¼š'
- en: '*max_leaf_nodes* - maximum number of regions, also called terminal or lead
    nodes in the decision tree'
  id: totrans-375
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*max_leaf_nodes* - æœ€å¤§åŒºåŸŸæ•°ï¼Œä¹Ÿç§°ä¸ºå†³ç­–æ ‘ä¸­çš„ç»ˆç«¯æˆ–å¼•å¯¼èŠ‚ç‚¹'
- en: '*max_depth* - maximum number of levels, e.g., max_depth = 1 is a stump tree
    with only 1 decision and two regions'
  id: totrans-376
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*max_depth* - æœ€å¤§å±‚æ•°ï¼Œä¾‹å¦‚ï¼Œmax_depth = 1 æ˜¯ä¸€ä¸ªåªæœ‰1ä¸ªå†³ç­–å’Œä¸¤ä¸ªåŒºåŸŸçš„æ ‘æ¡©æ ‘'
- en: '*min_samples_leaf* - minimum number of data in a new region, good constraint
    to ensure each region has enough data to make a reasonable estimate'
  id: totrans-377
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*min_samples_leaf* - æ–°åŒºåŸŸä¸­çš„æœ€å°æ•°æ®é‡ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„çº¦æŸæ¡ä»¶ï¼Œä»¥ç¡®ä¿æ¯ä¸ªåŒºåŸŸéƒ½æœ‰è¶³å¤Ÿçš„æ•°æ®æ¥åšå‡ºåˆç†çš„ä¼°è®¡'
- en: For now lets just try out some hyperparameters.
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰æˆ‘ä»¬åªå°è¯•ä¸€äº›è¶…å‚æ•°ã€‚
- en: Underfit Decision Tree Model
  id: totrans-379
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ¬ æ‹Ÿåˆå†³ç­–æ ‘æ¨¡å‹
- en: Letâ€™s use too few regions, set max_leaf_nodes too small and see the resulting
    decision tree model.
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä½¿ç”¨å¤ªå°‘çš„åŒºåŸŸï¼Œè®¾ç½®max_leaf_nodeså¤ªå°ï¼Œçœ‹çœ‹ç»“æœå†³ç­–æ ‘æ¨¡å‹ã€‚
- en: '[PRE19]'
  id: totrans-381
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '![_images/de9bb85033f26085feea46a1ec5a5786ccbe3d092bb940c53d319584063a39c7.png](../Images/be259c4cb62524490823c4f4d2d09c0c.png)'
  id: totrans-382
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/be259c4cb62524490823c4f4d2d09c0c.png)'
- en: This model is very much underfit, it is too simple to fit the shape of the prediction
    problem. Hereâ€™s some more information on the plot.
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªæ¨¡å‹éå¸¸æ¬ æ‹Ÿåˆï¼Œå®ƒå¤ªç®€å•äº†ï¼Œæ— æ³•æ‹Ÿåˆé¢„æµ‹é—®é¢˜çš„å½¢çŠ¶ã€‚ä»¥ä¸‹æ˜¯å…³äºå›¾è¡¨çš„ä¸€äº›æ›´å¤šä¿¡æ¯ã€‚
- en: See the horizontal lines on the plot of estimated vs. actual production (plot
    on the bottom)?
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: çœ‹çœ‹ä¼°è®¡ç”Ÿäº§ä¸å®é™…ç”Ÿäº§ï¼ˆåº•éƒ¨å›¾è¡¨ï¼‰çš„å›¾ä¸­æ°´å¹³çº¿ï¼Ÿ
- en: That is expected as the regression tree estimates with the average of the data
    in each region of the feature space (terminal node).
  id: totrans-385
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™æ˜¯å¯ä»¥é¢„æ–™çš„ï¼Œå› ä¸ºå›å½’æ ‘ä½¿ç”¨ç‰¹å¾ç©ºé—´æ¯ä¸ªåŒºåŸŸï¼ˆç»ˆç«¯èŠ‚ç‚¹ï¼‰ä¸­çš„æ•°æ®å¹³å‡å€¼è¿›è¡Œä¼°è®¡ã€‚
- en: To further assess the model performance, I have included the actual response
    P10, mean and P90 for each leaf node, region for both training and testing.
  id: totrans-386
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸ºäº†è¿›ä¸€æ­¥è¯„ä¼°æ¨¡å‹æ€§èƒ½ï¼Œæˆ‘åŒ…æ‹¬äº†æ¯ä¸ªç»ˆç«¯èŠ‚ç‚¹ã€åŒºåŸŸåœ¨è®­ç»ƒå’Œæµ‹è¯•ä¸­çš„å®é™…å“åº”P10ã€å¹³å‡å€¼å’ŒP90ã€‚
- en: underfit predictive machine learning models have poor accuracy and training
    and testing.
  id: totrans-387
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½æ‹Ÿåˆé¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹åœ¨è®­ç»ƒå’Œæµ‹è¯•ä¸­éƒ½æœ‰è¾ƒå·®çš„å‡†ç¡®åº¦ã€‚
- en: If we have a more complicated tree with more terminal nodes then there would
    be more lines.
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªæ›´å¤æ‚çš„æ ‘ï¼Œæœ‰æ›´å¤šçš„ç»ˆç«¯èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰æ›´å¤šçš„çº¿æ¡ã€‚
- en: Overfit Decision Tree Model
  id: totrans-389
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: è¿‡æ‹Ÿåˆå†³ç­–æ ‘æ¨¡å‹ã€‚
- en: Letâ€™s use too many regions, set max_leaf_nodes too large and see the resulting
    decision tree model.
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä½¿ç”¨å¤ªå¤šçš„åŒºåŸŸï¼Œè®¾ç½®max_leaf_nodeså¤ªå¤§ï¼Œçœ‹çœ‹ç»“æœå†³ç­–æ ‘æ¨¡å‹ã€‚
- en: '[PRE20]'
  id: totrans-391
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '![_images/b64f9666026f63544dd4662412c50db7132cd58f19c828937a4e3bbfa9366dc6.png](../Images/c28519e97623d45a6f72540a6b408c6d.png)'
  id: totrans-392
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/c28519e97623d45a6f72540a6b408c6d.png)'
- en: Now we have an overfit predictive machine learning model.
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªè¿‡æ‹Ÿåˆçš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚
- en: too much complexity and flexibility
  id: totrans-394
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿‡å¤šçš„å¤æ‚æ€§å’Œçµæ´»æ€§ã€‚
- en: we are fitting the noise in the data
  id: totrans-395
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ­£åœ¨æ‹Ÿåˆæ•°æ®ä¸­çš„å™ªå£°ã€‚
- en: good accuracy in training, but poor accuracy in testing
  id: totrans-396
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®­ç»ƒæ—¶å‡†ç¡®åº¦å¥½ï¼Œä½†æµ‹è¯•æ—¶å‡†ç¡®åº¦å·®ã€‚
- en: It is instructive to observe the decision tree model over the feature space
    as we incrementally add terminal nodes. We can graphically observe the hierarchical
    binary splitting quite clearly.
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: éšç€æˆ‘ä»¬é€æ­¥æ·»åŠ ç»ˆç«¯èŠ‚ç‚¹ï¼Œè§‚å¯Ÿå†³ç­–æ ‘æ¨¡å‹åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„è¡¨ç°æ˜¯æœ‰æ•™è‚²æ„ä¹‰çš„ã€‚æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°å›¾å½¢åŒ–åœ°è§‚å¯Ÿåˆ°åˆ†å±‚äºŒåˆ†åˆ†è£‚ã€‚
- en: Letâ€™s visualize from simple complicated models.
  id: totrans-398
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»ç®€å•çš„å¤æ‚æ¨¡å‹å¼€å§‹å¯è§†åŒ–ã€‚
- en: '[PRE21]'
  id: totrans-399
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '![_images/b066c86d94043d639bf7b5305f612745b8a64d2920e129e3f924e8deaac2ab67.png](../Images/43008585fa66e722cde17f42284274b4.png)'
  id: totrans-400
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/43008585fa66e722cde17f42284274b4.png)'
- en: It may be useful to look at a decision tree model and the associated decision
    tree, side-by-side.
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: å¯èƒ½ä¼šæœ‰ç”¨çš„æ˜¯å¹¶æ’æŸ¥çœ‹å†³ç­–æ ‘æ¨¡å‹å’Œç›¸å…³çš„å†³ç­–æ ‘ã€‚
- en: '[PRE22]'
  id: totrans-402
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '![_images/fbf5427fe1d098a17a235d28fdd24ff7b7b442c21b958df2b2855e4ffeb66011.png](../Images/de575bff5cbcf3e18e0bc1c385400e3e.png)'
  id: totrans-403
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/de575bff5cbcf3e18e0bc1c385400e3e.png)'
- en: How do we find the best hyperparameters, for the best complexity for optimum
    prediction accuracy for testing? That is hyperparameter tuning.
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°æœ€ä½³è¶…å‚æ•°ï¼Œä»¥å®ç°æœ€ä½³å¤æ‚æ€§å’Œæµ‹è¯•é¢„æµ‹ç²¾åº¦çš„æœ€ä½³åŒ–ï¼Ÿè¿™å°±æ˜¯è¶…å‚æ•°è°ƒæ•´ã€‚
- en: Tuning a Decision Tree (Regression Tree)
  id: totrans-405
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è°ƒæ•´å†³ç­–æ ‘ï¼ˆå›å½’æ ‘ï¼‰ã€‚
- en: Letâ€™s perform hyperparameter tuning. To do this we,
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬è¿›è¡Œè¶…å‚æ•°è°ƒæ•´ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ï¼Œ
- en: See the range of possible hyperparameter values.
  id: totrans-407
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: çœ‹çœ‹å¯èƒ½çš„è¶…å‚æ•°å€¼èŒƒå›´ã€‚
- en: Loop over the range of possible hyperparameter values.
  id: totrans-408
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: éå†å¯èƒ½è¶…å‚æ•°å€¼çš„èŒƒå›´ã€‚
- en: Train on the training data with the current hyperparameter values.
  id: totrans-409
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨å½“å‰è¶…å‚æ•°å€¼åœ¨è®­ç»ƒæ•°æ®ä¸Šè®­ç»ƒã€‚
- en: Predict at the testing data
  id: totrans-410
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: åœ¨æµ‹è¯•æ•°æ®ä¸Šé¢„æµ‹ã€‚
- en: Summarize the error over all the testing data
  id: totrans-411
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ€»ç»“æ‰€æœ‰æµ‹è¯•æ•°æ®çš„é”™è¯¯ã€‚
- en: Select the hyperparameters that minimize the error at for the testing data
  id: totrans-412
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: é€‰æ‹©æµ‹è¯•æ•°æ®é›†ä¸Šæœ€å°åŒ–è¯¯å·®çš„è¶…å‚æ•°ã€‚
- en: When I teach this to my students, I suggest that this is a model dress rehearsal.
    We add value by making predictions for cases not used to train the model. We want
    the model that performs best for cases not in the training, so we are simulating
    real world use of the model!
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘æŠŠè¿™ä¸ªæ•™ç»™æˆ‘çš„å­¦ç”Ÿæ—¶ï¼Œæˆ‘å»ºè®®è¿™æ˜¯ä¸€ä¸ªæ¨¡å‹å½©æ’ã€‚æˆ‘ä»¬é€šè¿‡ä¸ºæœªç”¨äºè®­ç»ƒæ¨¡å‹çš„æ¡ˆä¾‹åšå‡ºé¢„æµ‹æ¥å¢åŠ ä»·å€¼ã€‚æˆ‘ä»¬å¸Œæœ›æ¨¡å‹åœ¨æœªè®­ç»ƒçš„æ¡ˆä¾‹ä¸Šè¡¨ç°æœ€å¥½ï¼Œå› æ­¤æˆ‘ä»¬æ­£åœ¨æ¨¡æ‹Ÿæ¨¡å‹åœ¨ç°å®ä¸–ç•Œä¸­çš„ä½¿ç”¨ï¼
- en: Now letâ€™s do hyperparameter tuning â€˜by-handâ€™, by varying the decision tree complexity
    and find the complexity that minimizes MSE in testing
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ‰‹åŠ¨è¿›è¡Œè¶…å‚æ•°è°ƒæ•´ï¼Œé€šè¿‡æ”¹å˜å†³ç­–æ ‘å¤æ‚æ€§ï¼Œæ‰¾åˆ°æœ€å°åŒ–æµ‹è¯•ä¸­å‡æ–¹è¯¯å·®çš„å¤æ‚æ€§ã€‚
- en: for simplicity the code below loops only over the maximum leaf nodes hyperparameter
  id: totrans-415
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸ºäº†ç®€å•èµ·è§ï¼Œä¸‹é¢çš„ä»£ç åªéå†æœ€å¤§å¶èŠ‚ç‚¹è¶…å‚æ•°ã€‚
- en: we set minimum number of samples to 1, and maximum depth to 9 to ensure that
    these hyperparameters will not have any impact (we set them to very complicated
    so they donâ€™t limit the model complexity)
  id: totrans-416
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†æœ€å°æ ·æœ¬æ•°è®¾ç½®ä¸º1ï¼Œæœ€å¤§æ·±åº¦è®¾ç½®ä¸º9ï¼Œä»¥ç¡®ä¿è¿™äº›è¶…å‚æ•°ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ï¼ˆæˆ‘ä»¬å°†å®ƒä»¬è®¾ç½®å¾—éå¸¸å¤æ‚ï¼Œè¿™æ ·å°±ä¸ä¼šé™åˆ¶æ¨¡å‹å¤æ‚æ€§ï¼‰ã€‚
- en: '[PRE23]'
  id: totrans-417
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '![_images/27a521f2cbd01b3caec37b95530d68674a6785fa6c061acdac71ea6326a9fe6b.png](../Images/f43c9ad2b759692c2b199e397c735352.png)'
  id: totrans-418
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/f43c9ad2b759692c2b199e397c735352.png)'
- en: It is useful to evaluate the performance of our tree by observing the accuracy
    vs. complexity, with a minimum due to the model variance and model bias trade-off.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡è§‚å¯Ÿå‡†ç¡®ç‡ä¸å¤æ‚åº¦ä¹‹é—´çš„å…³ç³»ï¼Œè¯„ä¼°æˆ‘ä»¬æ ‘çš„è¡¨ç°æ˜¯æœ‰ç”¨çš„ï¼Œæœ€å°å€¼æ˜¯ç”±äºæ¨¡å‹æ–¹å·®å’Œæ¨¡å‹åå·®ä¹‹é—´çš„æƒè¡¡ã€‚
- en: 'For a more robust result, letâ€™s try k-fold cross validation. sklearn has a
    built in cross validation method called cross_val_score that we can use to:'
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å¾—åˆ°æ›´ç¨³å¥çš„ç»“æœï¼Œè®©æˆ‘ä»¬å°è¯• k æŠ˜äº¤å‰éªŒè¯ã€‚sklearn æœ‰ä¸€ä¸ªå†…ç½®çš„äº¤å‰éªŒè¯æ–¹æ³•ï¼Œåä¸º cross_val_scoreï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥ï¼š
- en: Apply k-fold approach with iterative separation of training and testing data
  id: totrans-421
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åº”ç”¨ k æŠ˜æ³•ï¼Œé€šè¿‡è¿­ä»£åˆ†ç¦»è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ã€‚
- en: With k=5, we have 20% withheld for testing for each fold
  id: totrans-422
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å½“ k=5 æ—¶ï¼Œæ¯ä¸ªæŠ˜ä¿ç•™ 20% çš„æ•°æ®ç”¨äºæµ‹è¯•ã€‚
- en: Automate the model construction, looping over folds and averaging the metric
    of interest
  id: totrans-423
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è‡ªåŠ¨åŒ–æ¨¡å‹æ„å»ºï¼Œå¾ªç¯éå†æŠ˜ï¼Œå¹¶å¹³å‡æ„Ÿå…´è¶£çš„æŒ‡æ ‡ã€‚
- en: Letâ€™s try it out on our trees with variable number of terminal nodes. Note the
    cross validation is set to use 4 processors, but still will likely take a couple
    of minutes to run.
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åœ¨å…·æœ‰ä¸åŒç»ˆç«¯èŠ‚ç‚¹æ•°é‡çš„æ ‘ä¸Šå°è¯•ä¸€ä¸‹ã€‚æ³¨æ„ï¼Œäº¤å‰éªŒè¯è®¾ç½®ä¸ºä½¿ç”¨ 4 ä¸ªå¤„ç†å™¨ï¼Œä½†ä»å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ‰èƒ½è¿è¡Œã€‚
- en: '[PRE24]'
  id: totrans-425
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '![_images/35821438b0adbe9ae455b2e6731dab92e05cf7dfb2dcbaaa8d296ac1c9a18b39.png](../Images/2df3cfa16f6fb36c7bd2a52fe7d20a6d.png)'
  id: totrans-426
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/2df3cfa16f6fb36c7bd2a52fe7d20a6d.png)'
- en: The k-fold cross validation provides a smoother plot of MSE vs. the hyperparameter.
  id: totrans-427
  prefs: []
  type: TYPE_NORMAL
  zh: k æŠ˜äº¤å‰éªŒè¯æä¾›äº† MSE ä¸è¶…å‚æ•°ä¹‹é—´çš„æ›´å¹³æ»‘çš„å›¾è¡¨ã€‚
- en: this is accomplished by averaging the MSE over all the folds to reduce sensitivity
    of the metric to specific assignment of training and testing data
  id: totrans-428
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é€šè¿‡å¯¹æ‰€æœ‰æŠ˜çš„å¹³å‡ MSE æ¥å‡å°‘è¯¥æŒ‡æ ‡å¯¹ç‰¹å®šè®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†é…çš„æ•æ„Ÿæ€§ã€‚
- en: all our train and test cross validation or k-fold cross validation was to get
    this one value, the model **hyperparameter**
  id: totrans-429
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿›è¡Œçš„æ‰€æœ‰è®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯æˆ– k æŠ˜äº¤å‰éªŒè¯éƒ½æ˜¯ä¸ºäº†å¾—åˆ°è¿™ä¸ªå•ä¸€å€¼ï¼Œå³æ¨¡å‹çš„**è¶…å‚æ•°**ã€‚
- en: Build the Final Model
  id: totrans-430
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ„å»ºæœ€ç»ˆæ¨¡å‹ã€‚
- en: Now letâ€™s take that hyperparameter and train on all the data, this is our **final
    model**
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨è¿™ä¸ªè¶…å‚æ•°åœ¨æ‰€æœ‰æ•°æ®ä¸Šè®­ç»ƒï¼Œè¿™æ˜¯æˆ‘ä»¬**æœ€ç»ˆæ¨¡å‹**ã€‚
- en: '[PRE25]'
  id: totrans-432
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '![_images/e85bbd71cc280b9a057d106524b0d1dfca28c6500e32ece594637cde5b8b1dba.png](../Images/608907e2a0d015a0d611204bfa6c41e5.png)'
  id: totrans-433
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/608907e2a0d015a0d611204bfa6c41e5.png)'
- en: We have completed our predictive machine learning model. Now letâ€™s cover a couple
    more decision tree diagnostics.
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å·²ç»å®Œæˆäº†æˆ‘ä»¬çš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚ç°åœ¨è®©æˆ‘ä»¬å†è®¨è®ºä¸€äº›å†³ç­–æ ‘çš„è¯Šæ–­ã€‚
- en: Interrogating Decision Trees
  id: totrans-435
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æŸ¥è¯¢å†³ç­–æ ‘ã€‚
- en: It may be useful to evaluate for any possible feature combination, the order
    of decision nodes that resulted in the specific prediction. The following function
    provides the list of nodes that the prediction cases passes.
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: è¯„ä¼°ä»»ä½•å¯èƒ½çš„ç‰¹å¾ç»„åˆï¼Œä»¥åŠå¯¼è‡´ç‰¹å®šé¢„æµ‹çš„å†³ç­–èŠ‚ç‚¹é¡ºåºå¯èƒ½ä¹Ÿå¾ˆæœ‰ç”¨ã€‚ä»¥ä¸‹å‡½æ•°æä¾›äº†é¢„æµ‹æ¡ˆä¾‹é€šè¿‡çš„èŠ‚ç‚¹åˆ—è¡¨ã€‚
- en: '[PRE26]'
  id: totrans-437
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '[PRE27]'
  id: totrans-438
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Extracting the Decision Tree Prediction Model as a Function
  id: totrans-439
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æå–å†³ç­–æ ‘é¢„æµ‹æ¨¡å‹ä½œä¸ºå‡½æ•°ã€‚
- en: Furthermore it may be useful to convert the decision tree to code, a nested
    set of â€˜ifâ€™ statements.
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œå°†å†³ç­–æ ‘è½¬æ¢ä¸ºä»£ç ï¼Œå³åµŒå¥—çš„â€œifâ€è¯­å¥é›†ï¼Œå¯èƒ½ä¹Ÿå¾ˆæœ‰ç”¨ã€‚
- en: This creates a portable model that could be copied and applied as a standalone
    function.
  id: totrans-441
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™åˆ›å»ºäº†ä¸€ä¸ªå¯ç§»æ¤çš„æ¨¡å‹ï¼Œå¯ä»¥å¤åˆ¶å¹¶ä½œä¸ºç‹¬ç«‹å‡½æ•°åº”ç”¨ã€‚
- en: Also, one could conveniently interrogate the code version of the tree.
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿åœ°æŸ¥è¯¢æ ‘çš„ä»£ç ç‰ˆæœ¬ã€‚
- en: We use the previously defined function to do this with our pruned tree.
  id: totrans-443
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä½¿ç”¨å…ˆå‰å®šä¹‰çš„å‡½æ•°æ¥å¤„ç†æˆ‘ä»¬çš„å‰ªææ ‘ã€‚
- en: '[PRE28]'
  id: totrans-444
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '[PRE29]'
  id: totrans-445
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Decision Tree-based Feature Importance
  id: totrans-446
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åŸºäºå†³ç­–æ ‘çš„ç‰¹æ€§é‡è¦æ€§ã€‚
- en: 'Feature importance is calculated from a decision trees by summarizing the reduction
    in mean square error through inclusion of each feature and is summarized as:'
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: ç‰¹æ€§é‡è¦æ€§æ˜¯é€šè¿‡å†³ç­–æ ‘è®¡ç®—å¾—å‡ºçš„ï¼Œé€šè¿‡æ€»ç»“åŒ…å«æ¯ä¸ªç‰¹å¾æ—¶çš„å¹³å‡å¹³æ–¹è¯¯å·®æ¥è®¡ç®—ï¼Œå¹¶æ€»ç»“å¦‚ä¸‹ï¼š
- en: \[ FI(x) = \sum_{t \in T_f} \frac{N_t}{N} \Delta_{MSE_t} \]
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: \[ FI(x) = \sum_{t \in T_f} \frac{N_t}{N} \Delta_{MSE_t} \]
- en: where \(T_f\) are all nodes with feature \(x\) as the split, \(N_t\) is the
    number of training samples reaching node \(t\), \(N\) is the total number of samples
    in the dataset and \(\Delta_{MSE_t}\) is the reduction in MSE with the \(t\) split.
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: \(T_f\) ä»£è¡¨æ‰€æœ‰ä»¥ç‰¹å¾ \(x\) ä½œä¸ºåˆ†å‰²ç‚¹çš„èŠ‚ç‚¹ï¼Œ\(N_t\) æ˜¯è¾¾åˆ°èŠ‚ç‚¹ \(t\) çš„è®­ç»ƒæ ·æœ¬æ•°é‡ï¼Œ\(N\) æ˜¯æ•°æ®é›†ä¸­æ ·æœ¬çš„æ€»æ•°ï¼Œ\(\Delta_{MSE_t}\)
    æ˜¯ \(t\) åˆ†å‰²ç‚¹å¤„ MSE çš„å‡å°‘é‡ã€‚
- en: Note, feature importance can be calculated in a similar manner to MSE above
    for the case of classification trees with **Gini Impurity**.
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œç‰¹å¾é‡è¦æ€§å¯ä»¥åƒä¸Šé¢çš„ MSE ä¸€æ ·è®¡ç®—ï¼Œé€‚ç”¨äºå…·æœ‰**åŸºå°¼ä¸çº¯åº¦**çš„åˆ†ç±»æ ‘ã€‚
- en: '[PRE30]'
  id: totrans-451
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '![_images/8fcae780c3b59534e28863b5aa7a46545ac1a9e556ab9950e41495b87e7bee49.png](../Images/e7672512b746dfc82482f39bc8c78ddc.png)'
  id: totrans-452
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/e7672512b746dfc82482f39bc8c78ddc.png)'
- en: Visualize the Model
  id: totrans-453
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯è§†åŒ–æ¨¡å‹ã€‚
- en: Letâ€™s take a last look at the graphical representation of our pruned tree.
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æœ€åçœ‹çœ‹æˆ‘ä»¬ä¿®å‰ªåçš„æ ‘çš„å›¾å½¢è¡¨ç¤ºã€‚
- en: '[PRE31]'
  id: totrans-455
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: '![_images/67fb9697896ebccb3d2ba5fce562153c671634fd57bdc8739c47227f04785578.png](../Images/dceac0eb1f800b2c21d5e490c1248210.png)'
  id: totrans-456
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/dceac0eb1f800b2c21d5e490c1248210.png)'
- en: Simple Code to Make a Decision Tree Machine and Calculate a Prediction
  id: totrans-457
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç®€å•ä»£ç åˆ¶ä½œå†³ç­–æ ‘æœºå™¨å¹¶è®¡ç®—é¢„æµ‹
- en: 'To support those just getting started, hereâ€™s a minimal amount of code to:'
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ”¯æŒé‚£äº›åˆšå¼€å§‹çš„äººï¼Œä»¥ä¸‹æ˜¯ä¸€å°æ®µä»£ç æ¥ï¼š
- en: load the scikit-learn package for decision trees
  id: totrans-459
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŠ è½½ç”¨äºå†³ç­–æ ‘çš„ scikit-learn åŒ…
- en: load data
  id: totrans-460
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŠ è½½æ•°æ®
- en: instantiate a decision tree with hyperparameters (no tuning is shown)
  id: totrans-461
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å®ä¾‹åŒ–ä¸€ä¸ªå…·æœ‰è¶…å‚æ•°çš„å†³ç­–æ ‘ï¼ˆæœªæ˜¾ç¤ºè°ƒæ•´ï¼‰
- en: train the decision tree with the training data
  id: totrans-462
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è®­ç»ƒæ•°æ®è®­ç»ƒå†³ç­–æ ‘
- en: make a prediction with the decision tree
  id: totrans-463
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨å†³ç­–æ ‘è¿›è¡Œé¢„æµ‹
- en: '[PRE32]'
  id: totrans-464
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '[PRE33]'
  id: totrans-465
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: Machine Learning Pipelines for Clean, Compact Machine Learning Code
  id: totrans-466
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ¸…æ´ã€ç´§å‡‘çš„æœºå™¨å­¦ä¹ ä»£ç çš„æœºå™¨å­¦ä¹ ç®¡é“
- en: Pipelines are a scikit-learn class that allows for the encapsulation of a sequence
    of data preparation and modeling steps
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
  zh: ç®¡é“æ˜¯ scikit-learn ç±»ï¼Œå…è®¸å°è£…ä¸€ç³»åˆ—æ•°æ®å‡†å¤‡å’Œå»ºæ¨¡æ­¥éª¤
- en: then we can treat the pipeline as an object in our much condensed workflow
  id: totrans-468
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†ç®¡é“è§†ä¸ºæˆ‘ä»¬é«˜åº¦æµ“ç¼©çš„å·¥ä½œæµç¨‹ä¸­çš„ä¸€ä¸ªå¯¹è±¡
- en: 'The pipeline class allows us to:'
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: ç®¡é“ç±»å…è®¸æˆ‘ä»¬ï¼š
- en: improve code readability and to keep everything straight
  id: totrans-470
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æé«˜ä»£ç å¯è¯»æ€§å¹¶ä¿æŒä¸€åˆ‡äº•ç„¶æœ‰åº
- en: build complete workflows with very few lines of readable code
  id: totrans-471
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç”¨å¾ˆå°‘çš„ä»£ç è¡Œæ„å»ºå®Œæ•´çš„æµç¨‹
- en: avoid common workflow problems like data leakage, testing data informing model
    parameter training
  id: totrans-472
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é¿å…å¸¸è§çš„æµç¨‹é—®é¢˜ï¼Œå¦‚æ•°æ®æ³„éœ²ã€æµ‹è¯•æ•°æ®å‘ŠçŸ¥æ¨¡å‹å‚æ•°è®­ç»ƒ
- en: abstract common machine learning modeling and focus on building the best model
    possible
  id: totrans-473
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æŠ½è±¡å¸¸è§çš„æœºå™¨å­¦ä¹ å»ºæ¨¡ï¼Œä¸“æ³¨äºæ„å»ºå°½å¯èƒ½å¥½çš„æ¨¡å‹
- en: The fundamental philosophy is to treat machine learning as a combinatorial search
    to find the best model (AutoML)
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
  zh: åŸºæœ¬å“²å­¦æ˜¯å°†æœºå™¨å­¦ä¹ è§†ä¸ºç»„åˆæœç´¢ä»¥æ‰¾åˆ°æœ€ä½³æ¨¡å‹ï¼ˆAutoMLï¼‰
- en: For more information see my recorded lecture on [Machine Learning Pipelines](https://www.youtube.com/watch?v=tYrPs8s1l9U&list=PLG19vXLQHvSAufDFgZEFAYQEwMJXklnQV&index=5)
    and a well-documented demonstration [Machine Learning Pipeline Workflow](http://localhost:8892/notebooks/OneDrive%20-%20The%20University%20of%20Texas%20at%20Austin/Courses/Workflows/PythonDataBasics_Pipelines.ipynb).
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
  zh: æ›´å¤šä¿¡æ¯è¯·å‚é˜…æˆ‘å…³äº [æœºå™¨å­¦ä¹ ç®¡é“](https://www.youtube.com/watch?v=tYrPs8s1l9U&list=PLG19vXLQHvSAufDFgZEFAYQEwMJXklnQV&index=5)
    çš„å½•éŸ³è®²åº§å’Œè¯¦ç»†è®°å½•çš„æ¼”ç¤º [æœºå™¨å­¦ä¹ ç®¡é“å·¥ä½œæµç¨‹](http://localhost:8892/notebooks/OneDrive%20-%20The%20University%20of%20Texas%20at%20Austin/Courses/Workflows/PythonDataBasics_Pipelines.ipynb)ã€‚
- en: '[PRE34]'
  id: totrans-476
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '[PRE35]'
  id: totrans-477
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Practice on a New Dataset
  id: totrans-478
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åœ¨æ–°æ•°æ®é›†ä¸Šè¿›è¡Œå®è·µ
- en: Ok, time to get to work. Letâ€™s load up a dataset and build a decision tree prediction
    model with,
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: å¥½çš„ï¼Œæ˜¯æ—¶å€™å¼€å§‹å·¥ä½œäº†ã€‚è®©æˆ‘ä»¬åŠ è½½æ•°æ®é›†å¹¶ä½¿ç”¨ä»¥ä¸‹å†…å®¹æ„å»ºå†³ç­–æ ‘é¢„æµ‹æ¨¡å‹ï¼Œ
- en: compact code
  id: totrans-480
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç´§å‡‘çš„ä»£ç 
- en: basic visaulizations
  id: totrans-481
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŸºæœ¬å¯è§†åŒ–
- en: save the output
  id: totrans-482
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¿å­˜è¾“å‡º
- en: You can select any of these datasets or modify the code and add your own to
    do this.
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨å¯ä»¥é€‰æ‹©è¿™äº›æ•°æ®é›†ä¹‹ä¸€æˆ–ä¿®æ”¹ä»£ç å¹¶æ·»åŠ æ‚¨è‡ªå·±çš„æ•°æ®é›†æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚
- en: Dataset 0, Unconventional Multivariate v4
  id: totrans-484
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ•°æ®é›† 0ï¼Œéå¸¸è§„å¤šå…ƒå˜é‡ v4
- en: 'Letâ€™s load the provided multivariate, dataset [unconv_MV.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/unconv_MV_v4.csv).
    This dataset has variables from 1,000 unconventional wells including:'
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åŠ è½½æä¾›çš„å¤šå…ƒæ•°æ®é›† [unconv_MV.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/unconv_MV_v4.csv)ã€‚æ­¤æ•°æ®é›†åŒ…å«æ¥è‡ª
    1,000 ä¸ªéå¸¸è§„äº•çš„å˜é‡ï¼ŒåŒ…æ‹¬ï¼š
- en: well average porosity
  id: totrans-486
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: äº•å¹³å‡å­”éš™ç‡
- en: log transform of permeability (to linearize the relationships with other variables)
  id: totrans-487
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¸—é€ç‡çš„å¯¹æ•°å˜æ¢ï¼ˆä»¥çº¿æ€§åŒ–ä¸å…¶ä»–å˜é‡çš„å…³ç³»ï¼‰
- en: acoustic impedance (kg/m^3 x m/s x 10^6)
  id: totrans-488
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å£°é˜»æŠ—ï¼ˆkg/m^3 x m/s x 10^6ï¼‰
- en: brittleness ratio (%)
  id: totrans-489
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å²©è„†æ€§æ¯” (%)
- en: total organic carbon (%)
  id: totrans-490
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ€»æœ‰æœºç¢³ (%)
- en: vitrinite reflectance (%)
  id: totrans-491
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç»ç’ƒå…‰æ³½åå°„ç‡ (%)
- en: initial production 90 day average (MCFPD).
  id: totrans-492
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆå§‹ç”Ÿäº§ 90 å¤©å¹³å‡ (MCFPD)ã€‚
- en: Dataset 2, Reservoir 21
  id: totrans-493
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ•°æ®é›† 2ï¼Œå‚¨å±‚ 21
- en: 'Letâ€™s load the provided multivariate, 3D spatial dataset [res21_wells.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_wells.csv).
    This dataset has variables from 73 vertical wells over a 10,000m x 10,000m x 50
    m reservoir unit:'
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åŠ è½½æä¾›çš„å¤šå…ƒï¼Œ3D ç©ºé—´æ•°æ®é›† [res21_wells.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_wells.csv)ã€‚æ­¤æ•°æ®é›†åŒ…å«æ¥è‡ª
    73 ä¸ªå‚ç›´äº•åœ¨ 10,000m x 10,000m x 50 m å‚¨å±‚å•å…ƒçš„å˜é‡ï¼š
- en: well (ID)
  id: totrans-495
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: äº•ï¼ˆIDï¼‰
- en: X (m), Y (m), Depth (m) location coordinates
  id: totrans-496
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: X (m), Y (m), æ·±åº¦ (m) ä½ç½®åæ ‡
- en: Porosity (%) after units conversion
  id: totrans-497
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å•ä½è½¬æ¢åçš„å­”éš™ç‡ (%)
- en: Permeability (mD)
  id: totrans-498
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¸—é€ç‡ (mD)
- en: Acoustic Impedance (kg/m2s*10^6) after units conversion
  id: totrans-499
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å£°é˜»æŠ—ï¼ˆkg/m2s*10^6ï¼‰å•ä½è½¬æ¢å
- en: Facies (categorical) - ordinal with ordering from Shale, Sandy Shale, Shaley
    Sand, to Sandstone.
  id: totrans-500
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å²©æ€§ï¼ˆåˆ†ç±»ï¼‰ - æœ‰åºçš„ï¼Œä»é¡µå²©ã€ç ‚è´¨é¡µå²©ã€é¡µå²©ç ‚åˆ°ç ‚å²©ã€‚
- en: Density (g/cm^3)
  id: totrans-501
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¯†åº¦ (g/cm^3)
- en: Compressible velocity (m/s)
  id: totrans-502
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¯å‹ç¼©é€Ÿåº¦ï¼ˆm/sï¼‰
- en: Youngs modulus (GPa)
  id: totrans-503
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Youngsæ¨¡é‡ï¼ˆGPaï¼‰
- en: Shear velocity (m/s)
  id: totrans-504
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰ªåˆ‡é€Ÿåº¦ï¼ˆm/sï¼‰
- en: Shear modulus (GPa)
  id: totrans-505
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰ªåˆ‡æ¨¡é‡ï¼ˆGPaï¼‰
- en: 3 year cumulative oil production (Mbbl)
  id: totrans-506
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 3å¹´ç´¯è®¡æ²¹äº§é‡ï¼ˆç™¾ä¸‡æ¡¶ï¼‰
- en: We load the tabular data with the pandas â€˜read_csvâ€™ function into a DataFrame
    we called â€˜my_dataâ€™ and then preview it to make sure it loaded correctly.
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä½¿ç”¨pandasçš„â€˜read_csvâ€™å‡½æ•°å°†è¡¨æ ¼æ•°æ®åŠ è½½åˆ°æˆ‘ä»¬ç§°ä¸ºâ€˜my_dataâ€™çš„DataFrameä¸­ï¼Œç„¶åé¢„è§ˆå®ƒä»¥ç¡®ä¿æ­£ç¡®åŠ è½½ã€‚
- en: we also populate lists with data ranges and labels for ease of plotting
  id: totrans-508
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜ç”¨æ•°æ®èŒƒå›´å’Œæ ‡ç­¾å¡«å……åˆ—è¡¨ï¼Œä»¥ä¾¿äºç»˜å›¾
- en: Load and format the data,
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: åŠ è½½æ•°æ®å¹¶æ ¼å¼åŒ–ï¼Œ
- en: drop the response feature
  id: totrans-510
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆ é™¤å“åº”ç‰¹å¾
- en: reformate the features as needed
  id: totrans-511
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ ¹æ®éœ€è¦é‡æ–°æ ¼å¼åŒ–ç‰¹å¾
- en: also, I like to store the metadata in lists
  id: totrans-512
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œæˆ‘è¿˜å–œæ¬¢å°†å…ƒæ•°æ®å­˜å‚¨åœ¨åˆ—è¡¨ä¸­
- en: '[PRE36]'
  id: totrans-513
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '|  | Por | Perm | AI | Density | PVel | Youngs | SVel | Shear | CumulativeOil
    |'
  id: totrans-514
  prefs: []
  type: TYPE_TB
  zh: '|  | Por | Perm | AI | å¯†åº¦ | PVel | Youngs | SVel | å‰ªåˆ‡ | ç´¯è®¡æ²¹é‡ |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-515
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| 1 | 12.907730 | 133.910637 | 7.308846 | 2.146360 | 3563.549461 | 25.688560
    | 1673.770439 | 6.429229 | 1201.20 |'
  id: totrans-516
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 12.907730 | 133.910637 | 7.308846 | 2.146360 | 3563.549461 | 25.688560
    | 1673.770439 | 6.429229 | 1201.20 |'
- en: '| 7 | 12.647965 | 114.359667 | 7.343836 | 2.188597 | 3570.094553 | 25.444064
    | 1670.043495 | 6.100984 | 683.92 |'
  id: totrans-517
  prefs: []
  type: TYPE_TB
  zh: '| 7 | 12.647965 | 114.359667 | 7.343836 | 2.188597 | 3570.094553 | 25.444064
    | 1670.043495 | 6.100984 | 683.92 |'
- en: '| 10 | 12.998469 | 129.332122 | 7.282051 | 2.131121 | 3524.448615 | 25.985734
    | 1681.960101 | 6.203527 | 978.14 |'
  id: totrans-518
  prefs: []
  type: TYPE_TB
  zh: '| 10 | 12.998469 | 129.332122 | 7.282051 | 2.131121 | 3524.448615 | 25.985734
    | 1681.960101 | 6.203527 | 978.14 |'
- en: '| 15 | 12.426141 | 123.227677 | 7.351795 | 2.203026 | 3417.596818 | 25.976462
    | 1675.355860 | 6.288040 | 608.09 |'
  id: totrans-519
  prefs: []
  type: TYPE_TB
  zh: '| 15 | 12.426141 | 123.227677 | 7.351795 | 2.203026 | 3417.596818 | 25.976462
    | 1675.355860 | 6.288040 | 608.09 |'
- en: '| 16 | 13.507371 | 147.562087 | 7.300360 | 2.210916 | 3476.167397 | 24.817767
    | 1656.890690 | 6.222528 | 1062.10 |'
  id: totrans-520
  prefs: []
  type: TYPE_TB
  zh: '| 16 | 13.507371 | 147.562087 | 7.300360 | 2.210916 | 3476.167397 | 24.817767
    | 1656.890690 | 6.222528 | 1062.10 |'
- en: '| 36 | 13.309477 | 122.818961 | 7.345220 | 2.178749 | 3346.347661 | 25.436579
    | 1651.679529 | 6.334308 | 539.98 |'
  id: totrans-521
  prefs: []
  type: TYPE_TB
  zh: '| 36 | 13.309477 | 122.818961 | 7.345220 | 2.178749 | 3346.347661 | 25.436579
    | 1651.679529 | 6.334308 | 539.98 |'
- en: '| 49 | 11.822910 | 98.168307 | 7.386212 | 2.301552 | 3250.020705 | 24.340656
    | 1662.438742 | 6.617267 | 1095.30 |'
  id: totrans-522
  prefs: []
  type: TYPE_TB
  zh: '| 49 | 11.822910 | 98.168307 | 7.386212 | 2.301552 | 3250.020705 | 24.340656
    | 1662.438742 | 6.617267 | 1095.30 |'
- en: '| 51 | 13.986616 | 132.575456 | 7.194749 | 2.108986 | 3415.255945 | 26.253236
    | 1712.017629 | 5.583251 | 805.49 |'
  id: totrans-523
  prefs: []
  type: TYPE_TB
  zh: '| 51 | 13.986616 | 132.575456 | 7.194749 | 2.108986 | 3415.255945 | 26.253236
    | 1712.017629 | 5.583251 | 805.49 |'
- en: '| 61 | 14.735895 | 128.201000 | 7.172693 | 1.841786 | 3886.950307 | 28.289950
    | 1672.370150 | 5.044439 | 1146.00 |'
  id: totrans-524
  prefs: []
  type: TYPE_TB
  zh: '| 61 | 14.735895 | 128.201000 | 7.172693 | 1.841786 | 3886.950307 | 28.289950
    | 1672.370150 | 5.044439 | 1146.00 |'
- en: Build and Check Model
  id: totrans-525
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ„å»ºå’Œæ£€æŸ¥æ¨¡å‹
- en: We apply the follow steps,
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼Œ
- en: specify the K-fold method
  id: totrans-527
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æŒ‡å®šKæŠ˜æ–¹æ³•
- en: loop over number of leaf nodes, instantiate, fit and record the error
  id: totrans-528
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: éå†å¶èŠ‚ç‚¹æ•°é‡ï¼Œå®ä¾‹åŒ–ã€æ‹Ÿåˆå¹¶è®°å½•è¯¯å·®
- en: plot the test error vs. number of leaf nodes, select the hyperparameter that
    minimizes test error
  id: totrans-529
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç»˜åˆ¶æµ‹è¯•è¯¯å·®ä¸å¶èŠ‚ç‚¹æ•°é‡çš„å…³ç³»å›¾ï¼Œé€‰æ‹©æœ€å°åŒ–æµ‹è¯•è¯¯å·®çš„è¶…å‚æ•°
- en: retrain the model with the tuned hyperparameter and all of the data
  id: totrans-530
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è°ƒæ•´å¥½çš„è¶…å‚æ•°å’Œæ‰€æœ‰æ•°æ®é‡æ–°è®­ç»ƒæ¨¡å‹
- en: '[PRE37]'
  id: totrans-531
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: '![_images/800e93156a21d23fb27ec3b349cbd0c234a2789e27a8582567a80abbbf0e08b0.png](../Images/a3d66d6b8f851c5edb5b770a5393116c.png)'
  id: totrans-532
  prefs: []
  type: TYPE_IMG
  zh: '![_images/800e93156a21d23fb27ec3b349cbd0c234a2789e27a8582567a80abbbf0e08b0.png](../Images/a3d66d6b8f851c5edb5b770a5393116c.png)'
- en: Comments
  id: totrans-533
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è¯„è®º
- en: This was a basic treatment of decision tree. Much more could be done and discussed,
    I have many more resources. Check out my [shared resource inventory](https://michaelpyrcz.com/my-resources)
    and the YouTube lecture links at the start of this chapter with resource links
    in the videosâ€™ descriptions.
  id: totrans-534
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯å¯¹å†³ç­–æ ‘çš„åŸºæœ¬å¤„ç†ã€‚å¯ä»¥åšå’Œè®¨è®ºçš„è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘æœ‰å¾ˆå¤šæ›´å¤šçš„èµ„æºã€‚æŸ¥çœ‹æˆ‘çš„[å…±äº«èµ„æºæ¸…å•](https://michaelpyrcz.com/my-resources)ä»¥åŠæœ¬ç« å¼€å¤´å¸¦æœ‰èµ„æºé“¾æ¥çš„è§†é¢‘è®²åº§é“¾æ¥ã€‚
- en: I hope this is helpful,
  id: totrans-535
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å¸Œæœ›è¿™ä¼šæœ‰æ‰€å¸®åŠ©ï¼Œ
- en: '*Michael*'
  id: totrans-536
  prefs: []
  type: TYPE_NORMAL
  zh: '*Michael*'
- en: About the Author
  id: totrans-537
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å…³äºä½œè€…
- en: '![](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
  id: totrans-538
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
- en: Professor Michael Pyrcz in his office on the 40 acres, campus of The University
    of Texas at Austin.
  id: totrans-539
  prefs: []
  type: TYPE_NORMAL
  zh: å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡æ ¡å›­å†…40è‹±äº©åœŸåœ°ä¸Šï¼Œè¿ˆå…‹å°”Â·çš®å°”èŒ¨æ•™æˆåœ¨ä»–çš„åŠå…¬å®¤ã€‚
- en: Michael Pyrcz is a professor in the [Cockrell School of Engineering](https://cockrell.utexas.edu/faculty-directory/alphabetical/p),
    and the [Jackson School of Geosciences](https://www.jsg.utexas.edu/researcher/michael_pyrcz/),
    at [The University of Texas at Austin](https://www.utexas.edu/), where he researches
    and teaches subsurface, spatial data analytics, geostatistics, and machine learning.
    Michael is also,
  id: totrans-540
  prefs: []
  type: TYPE_NORMAL
  zh: è¿ˆå…‹å°”Â·çš®å°”å¥‡å…¹æ˜¯å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡[ç§‘å…‹é›·å°”å·¥ç¨‹å­¦é™¢](https://cockrell.utexas.edu/faculty-directory/alphabetical/p)å’Œ[æ°å…‹é€Šåœ°çƒç§‘å­¦å­¦é™¢](https://www.jsg.utexas.edu/researcher/michael_pyrcz/)çš„æ•™æˆï¼Œä»–åœ¨[å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡](https://www.utexas.edu/)ä»äº‹å’Œæ•™æˆåœ°ä¸‹ã€ç©ºé—´æ•°æ®åˆ†æã€åœ°ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ã€‚è¿ˆå…‹å°”è¿˜æ˜¯ï¼Œ
- en: the principal investigator of the [Energy Analytics](https://fri.cns.utexas.edu/energy-analytics)
    freshmen research initiative and a core faculty in the Machine Learn Laboratory
    in the College of Natural Sciences, The University of Texas at Austin
  id: totrans-541
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¯¥[èƒ½æºåˆ†æ](https://fri.cns.utexas.edu/energy-analytics)æ–°ç”Ÿç ”ç©¶é¡¹ç›®çš„è´Ÿè´£äººï¼Œä»¥åŠå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡è‡ªç„¶ç§‘å­¦é™¢æœºå™¨å­¦ä¹ å®éªŒå®¤çš„æ ¸å¿ƒæ•™å‘˜
- en: an associate editor for [Computers and Geosciences](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board),
    and a board member for [Mathematical Geosciences](https://link.springer.com/journal/11004/editorial-board),
    the International Association for Mathematical Geosciences.
  id: totrans-542
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[è®¡ç®—æœºä¸åœ°çƒç§‘å­¦](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board)çš„å‰¯ç¼–è¾‘ï¼Œä»¥åŠå›½é™…æ•°å­¦åœ°çƒç§‘å­¦åä¼š[æ•°å­¦åœ°çƒç§‘å­¦](https://link.springer.com/journal/11004/editorial-board)çš„è‘£äº‹ä¼šæˆå‘˜ã€‚'
- en: 'Michael has written over 70 [peer-reviewed publications](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en),
    a [Python package](https://pypi.org/project/geostatspy/) for spatial data analytics,
    co-authored a textbook on spatial data analytics, [Geostatistical Reservoir Modeling](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    and author of two recently released e-books, [Applied Geostatistics in Python:
    a Hands-on Guide with GeostatsPy](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    and [Applied Machine Learning in Python: a Hands-on Guide with Code](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html).'
  id: totrans-543
  prefs: []
  type: TYPE_NORMAL
  zh: è¿ˆå…‹å°”å·²ç»æ’°å†™äº†è¶…è¿‡70ç¯‡[åŒè¡Œè¯„å®¡çš„å‡ºç‰ˆç‰©](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en)ï¼Œä¸€ä¸ªç”¨äºç©ºé—´æ•°æ®åˆ†æçš„[PythonåŒ…](https://pypi.org/project/geostatspy/)ï¼Œåˆè‘—äº†ä¸€æœ¬å…³äºç©ºé—´æ•°æ®åˆ†æçš„æ•™ç§‘ä¹¦ã€Š[åœ°ç»Ÿè®¡å­¦å‚¨å±‚å»ºæ¨¡](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)ã€‹ï¼Œå¹¶æ˜¯ä¸¤æœ¬è¿‘æœŸå‘å¸ƒçš„ç”µå­ä¹¦çš„ä½œè€…ï¼Œåˆ†åˆ«æ˜¯ã€Š[Pythonåº”ç”¨åœ°ç»Ÿè®¡å­¦ï¼šGeostatsPyå®è·µæŒ‡å—](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)ã€‹å’Œã€Š[Pythonåº”ç”¨æœºå™¨å­¦ä¹ ï¼šä»£ç å®è·µæŒ‡å—](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html)ã€‹ã€‚
- en: All of Michaelâ€™s university lectures are available on his [YouTube Channel](https://www.youtube.com/@GeostatsGuyLectures)
    with links to 100s of Python interactive dashboards and well-documented workflows
    in over 40 repositories on his [GitHub account](https://github.com/GeostatsGuy),
    to support any interested students and working professionals with evergreen content.
    To find out more about Michaelâ€™s work and shared educational resources visit his
    Website.
  id: totrans-544
  prefs: []
  type: TYPE_NORMAL
  zh: è¿ˆå…‹å°”çš„æ‰€æœ‰å¤§å­¦è®²åº§éƒ½å¯åœ¨ä»–çš„[YouTubeé¢‘é“](https://www.youtube.com/@GeostatsGuyLectures)ä¸Šæ‰¾åˆ°ï¼Œé™„æœ‰100å¤šä¸ªPythonäº¤äº’å¼ä»ªè¡¨æ¿å’Œ40å¤šä¸ªå­˜å‚¨åº“ä¸­çš„è¯¦ç»†å·¥ä½œæµç¨‹é“¾æ¥ï¼Œè¿™äº›å­˜å‚¨åº“ä½äºä»–çš„[GitHubè´¦æˆ·](https://github.com/GeostatsGuy)ï¼Œä»¥æ”¯æŒä»»ä½•æœ‰å…´è¶£çš„å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«ã€‚æƒ³äº†è§£æ›´å¤šå…³äºè¿ˆå…‹å°”çš„å·¥ä½œå’Œå…±äº«æ•™è‚²èµ„æºï¼Œè¯·è®¿é—®ä»–çš„ç½‘ç«™ã€‚
- en: Want to Work Together?
  id: totrans-545
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æƒ³ä¸€èµ·å·¥ä½œå—ï¼Ÿ
- en: I hope this content is helpful to those that want to learn more about subsurface
    modeling, data analytics and machine learning. Students and working professionals
    are welcome to participate.
  id: totrans-546
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å¸Œæœ›è¿™äº›å†…å®¹å¯¹é‚£äº›æƒ³äº†è§£æ›´å¤šå…³äºåœ°ä¸‹å»ºæ¨¡ã€æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ çš„äººæœ‰æ‰€å¸®åŠ©ã€‚å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«éƒ½æ¬¢è¿å‚åŠ ã€‚
- en: Want to invite me to visit your company for training, mentoring, project review,
    workflow design and / or consulting? Iâ€™d be happy to drop by and work with you!
  id: totrans-547
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æƒ³é‚€è¯·æˆ‘åˆ°è´µå…¬å¸è¿›è¡ŒåŸ¹è®­ã€è¾…å¯¼ã€é¡¹ç›®å®¡æŸ¥ã€å·¥ä½œæµç¨‹è®¾è®¡å’Œ/æˆ–å’¨è¯¢å—ï¼Ÿæˆ‘å¾ˆä¹æ„æ‹œè®¿å¹¶ä¸æ‚¨åˆä½œï¼
- en: Interested in partnering, supporting my graduate student research or my Subsurface
    Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)?
    My research combines data analytics, stochastic modeling and machine learning
    theory with practice to develop novel methods and workflows to add value. We are
    solving challenging subsurface problems!
  id: totrans-548
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ„¿æ„åˆä½œï¼Œæ”¯æŒæˆ‘çš„ç ”ç©¶ç”Ÿç ”ç©¶æˆ–æˆ‘çš„åœ°ä¸‹æ•°æ®åˆ†æä¸æœºå™¨å­¦ä¹ è”ç›Ÿï¼ˆå…±åŒè´Ÿè´£äººæ˜¯çº¦ç¿°Â·ç¦æ–¯ç‰¹æ•™æˆï¼‰å—ï¼Ÿæˆ‘çš„ç ”ç©¶å°†æ•°æ®åˆ†æã€éšæœºå»ºæ¨¡å’Œæœºå™¨å­¦ä¹ ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œä»¥å¼€å‘æ–°çš„æ–¹æ³•å’Œå·¥ä½œæµç¨‹ï¼Œå¢åŠ ä»·å€¼ã€‚æˆ‘ä»¬æ­£åœ¨è§£å†³å…·æœ‰æŒ‘æˆ˜æ€§çš„åœ°ä¸‹é—®é¢˜ï¼
- en: I can be reached at [mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu).
  id: totrans-549
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ‚¨å¯ä»¥é€šè¿‡[mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu)è”ç³»åˆ°æˆ‘ã€‚
- en: Iâ€™m always happy to discuss,
  id: totrans-550
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æ€»æ˜¯å¾ˆé«˜å…´è®¨è®ºï¼Œ
- en: '*Michael*'
  id: totrans-551
  prefs: []
  type: TYPE_NORMAL
  zh: '*è¿ˆå…‹å°”*'
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The
    Jackson School of Geosciences, The University of Texas at Austin
  id: totrans-552
  prefs: []
  type: TYPE_NORMAL
  zh: è¿ˆå…‹å°”Â·çš®å°”èŒ¨ï¼Œåšå£«ï¼ŒP.Eng. æ•™æˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ Cockrell å·¥ç¨‹å­¦é™¢å’Œ Jackson åœ°è´¨å­¦é™¢
- en: 'More Resources Available at: [Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Geostatistics Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [Applied Machine Learning in Python e-book](https://geostatsguy.github.io/MachineLearningDemos_Book/)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  id: totrans-553
  prefs: []
  type: TYPE_NORMAL
  zh: æ›´å¤šèµ„æºè¯·è®¿é—®ï¼š[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [åœ°ç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python
    ä¸­åº”ç”¨åœ°ç»Ÿè®¡å­¦ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python
    ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)
- en: Motivation
  id: totrans-554
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åŠ¨æœº
- en: Decision trees are not the most powerful, cutting edge method in machine learning,
    so why cover decision trees?
  id: totrans-555
  prefs: []
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘ä¸æ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€ä¸ºå¼ºå¤§ã€æœ€å‰æ²¿çš„æ–¹æ³•ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦ä»‹ç»å†³ç­–æ ‘ï¼Ÿ
- en: one of the most understandable, interpretable predictive machine learning models
  id: totrans-556
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æœ€æ˜“äºç†è§£ã€å¯è§£é‡Šçš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ä¹‹ä¸€
- en: decision trees are enhanced with random forests, bagging and boosting to be
    one of the best machine learning predictive models in many cases
  id: totrans-557
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘é€šè¿‡éšæœºæ£®æ—ã€è¢‹è£…å’Œæå‡è¢«å¢å¼ºï¼Œæˆä¸ºè®¸å¤šæƒ…å†µä¸‹æœ€ä½³çš„æœºå™¨å­¦ä¹ é¢„æµ‹æ¨¡å‹ä¹‹ä¸€
- en: '![](../Images/90b8611f2db53bd1e441fa8eb6dce0d1.png)'
  id: totrans-558
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/90b8611f2db53bd1e441fa8eb6dce0d1.png)'
- en: A single proud black spruce tree within the Boreal Forest in Alaska, similar
    to the northern region of my home province of Alberta. Crop of photo from https://www.britannica.com/plant/spruce#/media/1/561445/8933,
    access date May 1, 2025\.
  id: totrans-559
  prefs: []
  type: TYPE_NORMAL
  zh: é˜¿æ‹‰æ–¯åŠ åŒ—éƒ¨çš„é’ˆå¶æ—ä¸­çš„ä¸€æ£µé«˜å‚²çš„é»‘è‰²äº‘æ‰æ ‘ï¼Œä¸æˆ‘å®¶ä¹¡é˜¿å°”ä¼¯å¡”çœåŒ—éƒ¨åœ°åŒºç›¸ä¼¼ã€‚ç…§ç‰‡æ¥è‡ª https://www.britannica.com/plant/spruce#/media/1/561445/8933ï¼Œè®¿é—®æ—¥æœŸ
    2025 å¹´ 5 æœˆ 1 æ—¥ã€‚
- en: Letâ€™s cover some key aspects of decision trees.
  id: totrans-560
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ¢è®¨å†³ç­–æ ‘çš„ä¸€äº›å…³é”®æ–¹é¢ã€‚
- en: Model Formulation
  id: totrans-561
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ¨¡å‹å…¬å¼
- en: 'The prediction feature space is partitioned into \(J\) exhaustive, mutually
    exclusive regions \(R_1, R_2, \ldots, R_J\). For a given prediction case \(x_1,\ldots,x_m
    \in R_j\), the prediction is:'
  id: totrans-562
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æµ‹ç‰¹å¾ç©ºé—´è¢«åˆ†å‰²æˆ \(J\) ä¸ªç©·å°½ã€äº’æ–¥çš„åŒºåŸŸ \(R_1, R_2, \ldots, R_J\)ã€‚å¯¹äºç»™å®šçš„é¢„æµ‹æ¡ˆä¾‹ \(x_1,\ldots,x_m
    \in R_j\)ï¼Œé¢„æµ‹æ˜¯ï¼š
- en: '**Regression** - the average of the training data in the region, \(R_j\)'
  id: totrans-563
  prefs: []
  type: TYPE_NORMAL
  zh: '**å›å½’** - åŒºåŸŸ \(R_j\) ä¸­è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼ï¼Œ\(R_j\)'
- en: \[ \hat{y} = \frac{1}{|R_j|} \sum_{\mathbf{x}_i \in R_j} y_i \]
  id: totrans-564
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{y} = \frac{1}{|R_j|} \sum_{\mathbf{x}_i \in R_j} y_i \]
- en: where \(\hat{y}\) is the predicted value for input \(\mathbf{x}\), \(R_j\) is
    the region (leaf node) that \(\mathbf{x}\) falls into, \(|R_j|\) is the number
    of training samples in region \(R_j\), and \(y_i\) is the actual target values
    of those training samples in \(R_j\).
  id: totrans-565
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(\hat{y}\) æ˜¯è¾“å…¥ \(\mathbf{x}\) çš„é¢„æµ‹å€¼ï¼Œ\(R_j\) æ˜¯ \(\mathbf{x}\) è½å…¥çš„åŒºåŸŸï¼ˆå¶èŠ‚ç‚¹ï¼‰ï¼Œ\(|R_j|\)
    æ˜¯åŒºåŸŸ \(R_j\) ä¸­è®­ç»ƒæ ·æœ¬çš„æ•°é‡ï¼Œ\(y_i\) æ˜¯è¿™äº›è®­ç»ƒæ ·æœ¬åœ¨ \(R_j\) ä¸­çš„å®é™…ç›®æ ‡å€¼ã€‚
- en: '**Classification** - category with the plurality of training cases (most common
    case) in region \(R_j\):'
  id: totrans-566
  prefs: []
  type: TYPE_NORMAL
  zh: '**åˆ†ç±»** - åŒºåŸŸ \(R_j\) ä¸­è®­ç»ƒæ¡ˆä¾‹æ•°é‡æœ€å¤šçš„ç±»åˆ«ï¼ˆæœ€å¸¸è§çš„æƒ…å†µï¼‰ï¼š'
- en: \[ \hat{y} = \arg\max_{c \in C} \left( \frac{1}{|R_j|} \sum_{\mathbf{x}_i \in
    R_j} \mathbb{1}(y_i = c) \right) \]
  id: totrans-567
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{y} = \arg\max_{c \in C} \left( \frac{1}{|R_j|} \sum_{\mathbf{x}_i \in
    R_j} \mathbb{1}(y_i = c) \right) \]
- en: where \(C\) is the set of all possible categories, \(\mathbb{1}(y_i = c)\) is
    indicator transform, 1 if \(y_i = c\), 0 otherwise, \(|R_j|\) is the number of
    training samples in region \(R_j\), and \(\hat{y}\) is the predicted class label.
  id: totrans-568
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(C\) æ˜¯æ‰€æœ‰å¯èƒ½ç±»åˆ«çš„é›†åˆï¼Œ\(\mathbb{1}(y_i = c)\) æ˜¯æŒ‡ç¤ºå˜æ¢ï¼Œå¦‚æœ \(y_i = c\) åˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0ï¼Œ\(|R_j|\)
    æ˜¯åŒºåŸŸ \(R_j\) ä¸­è®­ç»ƒæ ·æœ¬çš„æ•°é‡ï¼Œ\(\hat{y}\) æ˜¯é¢„æµ‹çš„ç±»åˆ«æ ‡ç­¾ã€‚
- en: The predictor space, \(ğ‘‹_1,\ldots,ğ‘‹_ğ‘š\), is segmented into \(J\) mutually exclusive,
    exhaustive regions, \(R_j, j = 1,\ldots,J\), where the regions are,
  id: totrans-569
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æµ‹ç©ºé—´ \(ğ‘‹_1,\ldots,ğ‘‹_ğ‘š\) è¢«åˆ†å‰²æˆ \(J\) ä¸ªäº’æ–¥ã€ç©·å°½çš„åŒºåŸŸï¼Œ\(R_j, j = 1,\ldots,J\)ï¼Œå…¶ä¸­åŒºåŸŸæ˜¯ï¼Œ
- en: '**mutually exclusive** â€“ any combination of predictor features, \(x_1,\ldots,x_ğ‘š\),
    only belongs to a single region, \(R_j\)'
  id: totrans-570
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**äº’æ–¥** â€“ ä»»ä½•é¢„æµ‹ç‰¹å¾ç»„åˆ \(x_1,\ldots,x_ğ‘š\) åªå±äºå•ä¸ªåŒºåŸŸ \(R_j\)'
- en: '**exhaustive** â€“ all combinations of predictor feature values belong a region,
    \(R_j\), i.e., all the regions, \(R_j, j = 1,\ldots,J\), cover entire predictor
    feature space'
  id: totrans-571
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**è¯¦å°½æ— é—** â€“ æ‰€æœ‰é¢„æµ‹ç‰¹å¾å€¼çš„ç»„åˆéƒ½å±äºä¸€ä¸ªåŒºåŸŸï¼Œ\(R_j\)ï¼Œå³æ‰€æœ‰åŒºåŸŸï¼Œ\(R_j, j = 1,\ldots,J\)ï¼Œè¦†ç›–æ•´ä¸ªé¢„æµ‹ç‰¹å¾ç©ºé—´'
- en: All prediction cases, \(x_1,\ldots,x_m\) that fall in the same region, \(R_j\),
    are estimated with the same value.
  id: totrans-572
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€æœ‰è½åœ¨åŒä¸€åŒºåŸŸï¼Œ\(R_j\)ï¼Œçš„é¢„æµ‹æ¡ˆä¾‹ï¼Œ\(x_1,\ldots,x_m\)ï¼Œéƒ½ä½¿ç”¨ç›¸åŒçš„å€¼è¿›è¡Œä¼°è®¡ã€‚
- en: the prediction model inherently discontinuous at the region boundaries
  id: totrans-573
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é¢„æµ‹æ¨¡å‹åœ¨åŒºåŸŸè¾¹ç•Œå†…åœ¨æœ¬è´¨ä¸Šæ˜¯ä¸è¿ç»­çš„
- en: For example, consider this decision tree prediction model for the production
    response feature, \(\hat{Y}\)Â Ì‚from porosity, \(X_1\), predictor feature,
  id: totrans-574
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œè€ƒè™‘è¿™ä¸ªç”¨äºç”Ÿäº§å“åº”ç‰¹å¾ï¼Œ\(\hat{Y}\)çš„å†³ç­–æ ‘é¢„æµ‹æ¨¡å‹ï¼Œä»å­”éš™ç‡ï¼Œ\(X_1\)é¢„æµ‹ç‰¹å¾ï¼Œ
- en: '![](../Images/98d8fb73fe41299a6a9b443163b47c96.png)'
  id: totrans-575
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/98d8fb73fe41299a6a9b443163b47c96.png)'
- en: Four region decision tree with data and predictions, \(\hat{Y}(R_j) = \overline{Y}(R_j)\)
    by region, \(R_j, j=1,â€¦,4\). For example, given a predictor feature value of 13%
    porosity, the model predicts about 2,000 MCFPD for production.
  id: totrans-576
  prefs: []
  type: TYPE_NORMAL
  zh: æ•°æ®å’Œé¢„æµ‹çš„å››åŒºåŸŸå†³ç­–æ ‘ï¼Œ\(\hat{Y}(R_j) = \overline{Y}(R_j)\)æŒ‰åŒºåŸŸï¼Œ\(R_j, j=1,â€¦,4\)ã€‚ä¾‹å¦‚ï¼Œç»™å®š13%çš„å­”éš™ç‡é¢„æµ‹ç‰¹å¾å€¼ï¼Œæ¨¡å‹é¢„æµ‹ç”Ÿäº§å¤§çº¦2,000
    MCFPDã€‚
- en: How do we segment the predictor feature space?
  id: totrans-577
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¦‚ä½•åˆ†å‰²é¢„æµ‹ç‰¹å¾ç©ºé—´ï¼Ÿ
- en: Look at this example with predictor features porosity and brittleness to predict
    the production response feature.
  id: totrans-578
  prefs: []
  type: TYPE_NORMAL
  zh: çœ‹è¿™ä¸ªä¾‹å­ï¼Œä½¿ç”¨é¢„æµ‹ç‰¹å¾å­”éš™ç‡å’Œè„†æ€§æ¥é¢„æµ‹ç”Ÿäº§å“åº”ç‰¹å¾ã€‚
- en: '![](../Images/31b00c9edfa4f39d2ae71626df2cd687.png)'
  id: totrans-579
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/31b00c9edfa4f39d2ae71626df2cd687.png)'
- en: A very complicated segmentation of the predictor feature space with 3 regions.
  id: totrans-580
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æµ‹ç‰¹å¾ç©ºé—´çš„ä¸€ä¸ªéå¸¸å¤æ‚çš„3åŒºåŸŸåˆ†å‰²ã€‚
- en: these are very efficient boundaries that would capture low, mid and high production
  id: totrans-581
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™äº›æ˜¯éå¸¸é«˜æ•ˆçš„è¾¹ç•Œï¼Œå¯ä»¥æ•æ‰ä½ã€ä¸­ã€é«˜äº§é‡
- en: But, this model would be quite complicated,
  id: totrans-582
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æ˜¯ï¼Œè¿™ä¸ªæ¨¡å‹å°†ä¼šç›¸å½“å¤æ‚ï¼Œ
- en: requiring a large number of model parameters
  id: totrans-583
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: éœ€è¦å¤§é‡çš„æ¨¡å‹å‚æ•°
- en: difficult to train for a large number of prediction features, i.e., high dimensionality
  id: totrans-584
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¯¹äºå¤§é‡é¢„æµ‹ç‰¹å¾ï¼Œå³é«˜ç»´åº¦ï¼Œéš¾ä»¥è®­ç»ƒã€‚
- en: If I can convince you to accept these regions instead, then you would have a
    model that,
  id: totrans-585
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘èƒ½è¯´æœä½ æ¥å—è¿™äº›åŒºåŸŸï¼Œé‚£ä¹ˆä½ å°†æœ‰ä¸€ä¸ªæ¨¡å‹ï¼Œ
- en: is very easy to train
  id: totrans-586
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: éå¸¸å®¹æ˜“è®­ç»ƒ
- en: has very few parameters
  id: totrans-587
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‚æ•°éå¸¸å°‘
- en: very compact and interpretable
  id: totrans-588
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: éå¸¸ç´§å‡‘ä¸”å¯è§£é‡Š
- en: '![](../Images/13cf7080472834d100f0e7812be6d2d3.png)'
  id: totrans-589
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/13cf7080472834d100f0e7812be6d2d3.png)'
- en: A simpler segmentation of the predictor feature space with 9 regions, but much
    fewer parameters and easy to train for any dimensionality.
  id: totrans-590
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨9ä¸ªåŒºåŸŸçš„æ›´ç®€å•é¢„æµ‹ç‰¹å¾ç©ºé—´åˆ†å‰²ï¼Œä½†å‚æ•°è¾ƒå°‘ï¼Œä¸”æ˜“äºè®­ç»ƒä»»ä½•ç»´åº¦ã€‚
- en: This is a set of regions based on hierarchical, binary segmentation. Letâ€™s clarify
    the concept of predictor feature space and then explain this form of predictor
    feature segmentation.
  id: totrans-591
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªåŸºäºåˆ†å±‚äºŒåˆ†åˆ†å‰²çš„åŒºåŸŸé›†ã€‚è®©æˆ‘ä»¬å…ˆæ˜ç¡®é¢„æµ‹ç‰¹å¾ç©ºé—´çš„æ¦‚å¿µï¼Œç„¶åè§£é‡Šè¿™ç§é¢„æµ‹ç‰¹å¾åˆ†å‰²å½¢å¼ã€‚
- en: Predictor Feature Space
  id: totrans-592
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é¢„æµ‹ç‰¹å¾ç©ºé—´
- en: Letâ€™s step back and establish the concept of predictor feature space. We define
    it as,
  id: totrans-593
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å›é¡¾å¹¶å»ºç«‹é¢„æµ‹ç‰¹å¾ç©ºé—´çš„æ¦‚å¿µã€‚æˆ‘ä»¬å°†å…¶å®šä¹‰ä¸ºï¼Œ
- en: the space that includes all possible estimation problems, i.e., the combination
    of all possible predictor feature values, \(x_1, x_2,\ldots,x_m\).
  id: totrans-594
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŒ…å«æ‰€æœ‰å¯èƒ½çš„ä¼°è®¡é—®é¢˜ï¼Œå³æ‰€æœ‰å¯èƒ½çš„é¢„æµ‹ç‰¹å¾å€¼çš„ç»„åˆï¼Œ\(x_1, x_2,\ldots,x_m\)ã€‚
- en: '![](../Images/2328290a847e59dd59f76c37a18c6df3.png)'
  id: totrans-595
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/2328290a847e59dd59f76c37a18c6df3.png)'
- en: Illustration of predictor feature space for the case of 3 predictor features
    with specified minimum and maximum values per feature resulting in a rectangular
    cuboid of possible predictions, $x_1, x_2, x_3$.
  id: totrans-596
  prefs: []
  type: TYPE_NORMAL
  zh: 3ä¸ªé¢„æµ‹ç‰¹å¾ï¼Œæ¯ä¸ªç‰¹å¾æœ‰æŒ‡å®šæœ€å°å’Œæœ€å¤§å€¼çš„æƒ…å†µä¸‹çš„é¢„æµ‹ç‰¹å¾ç©ºé—´ç¤ºæ„å›¾ï¼Œç»“æœæ˜¯ä¸€ä¸ªå¯èƒ½çš„é¢„æµ‹çŸ©å½¢ç«‹æ–¹ä½“ï¼Œ\(x_1, x_2, x_3\)ã€‚
- en: Typically this is defined by the range of possible values, \(x_{\alpha} \in
    \left[X_{\alpha,\text{ğ‘šğ‘–ğ‘›}},ğ‘‹_{\alpha,\text{max}} \right]\)â€‹, resulting in,
  id: totrans-597
  prefs: []
  type: TYPE_NORMAL
  zh: é€šå¸¸è¿™ç”±å¯èƒ½å€¼çš„èŒƒå›´å®šä¹‰ï¼Œ\(x_{\alpha} \in \left[X_{\alpha,\text{ğ‘šğ‘–ğ‘›}},ğ‘‹_{\alpha,\text{max}}
    \right]\)ï¼Œç»“æœä¸ºï¼Œ
- en: 1 predictor feature \(\rightarrow\) line segment
  id: totrans-598
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1ä¸ªé¢„æµ‹ç‰¹å¾ \(\rightarrow\) çº¿æ®µ
- en: 2 predictor features \(\rightarrow\) rectangle
  id: totrans-599
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2ä¸ªé¢„æµ‹ç‰¹å¾ \(\rightarrow\) çŸ©å½¢
- en: 3 predictor features \(\rightarrow\) rectangular cuboid
  id: totrans-600
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 3ä¸ªé¢„æµ‹ç‰¹å¾ \(\rightarrow\) çŸ©å½¢ç«‹æ–¹ä½“
- en: \(>\)3 predictor features \(\rightarrow\) hyperrectangle
  id: totrans-601
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: \(>\)3ä¸ªé¢„æµ‹ç‰¹å¾ \(\rightarrow\) è¶…çŸ©å½¢
- en: While we define the predictor feature space with the ranges of the predictor
    features, I should provide a cautionary note.
  id: totrans-602
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬ä½¿ç”¨é¢„æµ‹ç‰¹å¾çš„å–å€¼èŒƒå›´å®šä¹‰é¢„æµ‹ç‰¹å¾ç©ºé—´æ—¶ï¼Œæˆ‘åº”è¯¥æä¾›ä¸€äº›æ³¨æ„äº‹é¡¹ã€‚
- en: Decision Trees have an Implicit Extrapolation Model
  id: totrans-603
  prefs: []
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘å…·æœ‰éšå¼å¤–æ¨æ¨¡å‹
- en: As you will see below, the regions along the exterior extend to infinity, effectively
    assuming a constant extrapolation model.
  id: totrans-604
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚ä½ ä¸‹é¢å°†çœ‹åˆ°çš„ï¼Œæ²¿å¤–éƒ¨çš„åŒºåŸŸå»¶ä¼¸åˆ°æ— ç©·å¤§ï¼Œå®é™…ä¸Šå‡è®¾äº†ä¸€ä¸ªæ’å®šçš„å¤–æ¨æ¨¡å‹ã€‚
- en: Tree Loss Functions
  id: totrans-605
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ ‘æŸå¤±å‡½æ•°
- en: For regression trees we minimize the residual sum of squares and for classification
    trees we minimize the weighted average Gini impurity.
  id: totrans-606
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºå›å½’æ ‘ï¼Œæˆ‘ä»¬æœ€å°åŒ–æ®‹å·®å¹³æ–¹å’Œï¼Œå¯¹äºåˆ†ç±»æ ‘ï¼Œæˆ‘ä»¬æœ€å°åŒ–åŠ æƒå¹³å‡åŸºå°¼ä¸çº¯åº¦ã€‚
- en: The Residual Sum of Squares (RSS) measures the total squared difference between
    the actual values and predicted values in a regression tree,
  id: totrans-607
  prefs: []
  type: TYPE_NORMAL
  zh: æ®‹å·®å¹³æ–¹å’Œï¼ˆRSSï¼‰è¡¡é‡å›å½’æ ‘ä¸­å®é™…å€¼ä¸é¢„æµ‹å€¼ä¹‹é—´çš„æ€»å¹³æ–¹å·®ï¼Œ
- en: \[ \text{RSS} = \sum_{j=1}^{J} \sum_{i \in R_j} (y_i - \hat{y}_{R_j})^2 \]
  id: totrans-608
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \text{RSS} = \sum_{j=1}^{J} \sum_{i \in R_j} (y_i - \hat{y}_{R_j})^2 \]
- en: where \(J\) is the total number of regions in the tree, \(R_j\) is the \(j\)
    region, \(y_i\) is the truth value of the response feature at observation the
    \(i\) training data, and \(\hat{y}_{R_j}\) is the predicted value for region \(R_j\),
    the mean of \(y_i \; \forall \; i \in R_j\).
  id: totrans-609
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(J\) æ˜¯æ ‘ä¸­çš„åŒºåŸŸæ€»æ•°ï¼Œ\(R_j\) æ˜¯ \(j\) åŒºåŸŸï¼Œ\(y_i\) æ˜¯ç¬¬ \(i\) ä¸ªè®­ç»ƒæ•°æ®å“åº”ç‰¹å¾çš„çœŸå€¼ï¼Œ\(\hat{y}_{R_j}\)
    æ˜¯åŒºåŸŸ \(R_j\) çš„é¢„æµ‹å€¼ï¼Œå³ \(y_i \; \forall \; i \in R_j\) çš„å¹³å‡å€¼ã€‚
- en: 'When a parent node splits into two child nodes ( t_L ) and ( t_R ), the weighted
    Gini impurity is:'
  id: totrans-610
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ä¸€ä¸ªçˆ¶èŠ‚ç‚¹åˆ†è£‚æˆä¸¤ä¸ªå­èŠ‚ç‚¹ï¼ˆt_Lï¼‰å’Œï¼ˆt_Rï¼‰æ—¶ï¼ŒåŠ æƒåŸºå°¼ä¸çº¯åº¦ä¸ºï¼š
- en: \[ \text{Gini}_{\text{total}} = \sum_{j=1}^{J} \frac{N_j}{N} \cdot \text{Gini}(j)
    \]
  id: totrans-611
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \text{Gini}_{\text{total}} = \sum_{j=1}^{J} \frac{N_j}{N} \cdot \text{Gini}(j)
    \]
- en: where \(J\) is the total number of regions in the tree, \(N\) is the total number
    of samples in the dataset, \(N_j\) is the number of samples in leaf node \(j\),
    and \(\text{Gini}(j)\) is the Gini impurity of leaf node \(j\).
  id: totrans-612
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(J\) æ˜¯æ ‘ä¸­çš„åŒºåŸŸæ€»æ•°ï¼Œ\(N\) æ˜¯æ•°æ®é›†ä¸­çš„æ ·æœ¬æ€»æ•°ï¼Œ\(N_j\) æ˜¯å¶èŠ‚ç‚¹ \(j\) ä¸­çš„æ ·æœ¬æ•°é‡ï¼Œ\(\text{Gini}(j)\)
    æ˜¯å¶èŠ‚ç‚¹ \(j\) çš„åŸºå°¼ä¸çº¯åº¦ã€‚
- en: The Gini impurity for a single decision tree node is calculated as,
  id: totrans-613
  prefs: []
  type: TYPE_NORMAL
  zh: å•ä¸ªå†³ç­–æ ‘èŠ‚ç‚¹çš„åŸºå°¼ä¸çº¯åº¦è®¡ç®—å¦‚ä¸‹ï¼Œ
- en: \[ \text{Gini}(j) = 1 - \sum_{c=1}^{C} p_{j,c}^2 \]
  id: totrans-614
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \text{Gini}(j) = 1 - \sum_{c=1}^{C} p_{j,c}^2 \]
- en: where \(p_{j,c}\) is the proportion of class \(c\) samples in node \(j\).
  id: totrans-615
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(p_{j,c}\) æ˜¯èŠ‚ç‚¹ \(j\) ä¸­ç±»åˆ« \(c\) æ ·æœ¬çš„æ¯”ä¾‹ã€‚
- en: For classification our loss function does not compare the predictions to the
    truth values like our regression loss!
  id: totrans-616
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºåˆ†ç±»ï¼Œæˆ‘ä»¬çš„æŸå¤±å‡½æ•°ä¸æ¯”è¾ƒé¢„æµ‹å€¼ä¸çœŸå€¼ï¼Œå°±åƒæˆ‘ä»¬çš„å›å½’æŸå¤±ä¸€æ ·ï¼
- en: the Gini impurity penalizes mixtures of training data categories! A region of
    all one category of training data will have a Gini impurity of 0 to contribute
    to the over all loss.
  id: totrans-617
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŸºå°¼ä¸çº¯åº¦æƒ©ç½šè®­ç»ƒæ•°æ®ç±»åˆ«æ··åˆï¼æ‰€æœ‰è®­ç»ƒæ•°æ®ä¸ºåŒä¸€ç±»åˆ«çš„åŒºåŸŸå°†å…·æœ‰åŸºå°¼ä¸çº¯åº¦ä¸º 0ï¼Œä»è€Œå¯¹æ•´ä½“æŸå¤±åšå‡ºè´¡çŒ®ã€‚
- en: Note that the by-region Gini impurity is,
  id: totrans-618
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼ŒæŒ‰åŒºåŸŸè®¡ç®—çš„åŸºå°¼ä¸çº¯åº¦æ˜¯ï¼Œ
- en: '**weighted** - by the number of training data in each regions, regions with
    more training data have greater impact on the overall loss'
  id: totrans-619
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**åŠ æƒ** - ç”±æ¯ä¸ªåŒºåŸŸçš„è®­ç»ƒæ•°æ®æ•°é‡å†³å®šï¼Œè®­ç»ƒæ•°æ®è¾ƒå¤šçš„åŒºåŸŸå¯¹æ•´ä½“æŸå¤±çš„å½±å“æ›´å¤§'
- en: '**averaged** - over all the regions to calculate the total Gini impurity of
    the decision tree'
  id: totrans-620
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å¹³å‡** - åœ¨æ‰€æœ‰åŒºåŸŸä¸Šè®¡ç®—å†³ç­–æ ‘çš„æ€»åŸºå°¼ä¸çº¯åº¦'
- en: These losses are calculated during,
  id: totrans-621
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›æŸå¤±åœ¨ä»¥ä¸‹è¿‡ç¨‹ä¸­è®¡ç®—ï¼Œ
- en: '**tree model training** - with respect to training data to grow the tree'
  id: totrans-622
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ ‘æ¨¡å‹è®­ç»ƒ** - æ ¹æ®è®­ç»ƒæ•°æ®æ¥ç”Ÿé•¿æ ‘'
- en: '**tree model tuning** - with respect to withheld testing data to select the
    optimum tree complexity.'
  id: totrans-623
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ ‘æ¨¡å‹è°ƒæ•´** - æ ¹æ®ä¿ç•™çš„æµ‹è¯•æ•°æ®é€‰æ‹©æœ€ä½³æ ‘å¤æ‚åº¦ã€‚'
- en: Letâ€™s talk about tree model training first and then tree model tuning.
  id: totrans-624
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å…ˆè°ˆè°ˆæ ‘æ¨¡å‹è®­ç»ƒï¼Œç„¶åå†è°ˆæ ‘æ¨¡å‹è°ƒæ•´ã€‚
- en: Training the Tree Model
  id: totrans-625
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®­ç»ƒæ ‘æ¨¡å‹
- en: How do we calculate these mutually exclusive, exhaustive regions? This is accomplished
    through hierarchical binary segmentation of the predictor feature space.
  id: totrans-626
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¦‚ä½•è®¡ç®—è¿™äº›äº’æ–¥ä¸”ç©·å°½çš„åŒºåŸŸï¼Ÿè¿™æ˜¯é€šè¿‡é¢„æµ‹ç‰¹å¾ç©ºé—´çš„åˆ†å±‚äºŒåˆ†åˆ†å‰²æ¥å®ç°çš„ã€‚
- en: Training a decision tree model is both,
  id: totrans-627
  prefs: []
  type: TYPE_NORMAL
  zh: è®­ç»ƒå†³ç­–æ ‘æ¨¡å‹æ˜¯æ—¢ï¼Œ
- en: assigning the mutual exclusive, exhaustive regions
  id: totrans-628
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åˆ†é…äº’æ–¥ä¸”ç©·å°½çš„åŒºåŸŸ
- en: building a decision tree, each region is a terminal node, also known as a leaf
    node
  id: totrans-629
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ„å»ºå†³ç­–æ ‘æ—¶ï¼Œæ¯ä¸ªåŒºåŸŸéƒ½æ˜¯ä¸€ä¸ªç»ˆç«¯èŠ‚ç‚¹ï¼Œä¹Ÿç§°ä¸ºå¶èŠ‚ç‚¹
- en: These are the same thing! Letâ€™s list the steps and then walk through a training
    a tree to demonstrate this.
  id: totrans-630
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›æ˜¯åŒä¸€ä»¶äº‹ï¼è®©æˆ‘ä»¬åˆ—å‡ºæ­¥éª¤ï¼Œç„¶åé€šè¿‡è®­ç»ƒä¸€ä¸ªæ ‘æ¥æ¼”ç¤ºè¿™ä¸€ç‚¹ã€‚
- en: '**Assign All Data to a Single Region** - this region covers the entire predictor
    feature space'
  id: totrans-631
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**å°†æ‰€æœ‰æ•°æ®åˆ†é…åˆ°å•ä¸ªåŒºåŸŸ** - è¿™ä¸ªåŒºåŸŸè¦†ç›–äº†æ•´ä¸ªé¢„æµ‹ç‰¹å¾ç©ºé—´'
- en: '**Scan All Possible Splits** - over all regions and over all features'
  id: totrans-632
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**æ‰«ææ‰€æœ‰å¯èƒ½çš„åˆ†å‰²** - åœ¨æ‰€æœ‰åŒºåŸŸå’Œæ‰€æœ‰ç‰¹å¾ä¸Š'
- en: '**Select the Best Split** - this is greedy optimization, i.e., the best split
    minimizes the residual sum of squares of errors over all the training data \(y_i\)
    over all of the regions \(j = 1,\ldots,J\).'
  id: totrans-633
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**é€‰æ‹©æœ€ä½³åˆ†å‰²** - è¿™æ˜¯è´ªå©ªä¼˜åŒ–ï¼Œå³æœ€ä½³åˆ†å‰²æœ€å°åŒ–äº†æ‰€æœ‰è®­ç»ƒæ•°æ® \(y_i\) åœ¨æ‰€æœ‰åŒºåŸŸ \(j = 1,\ldots,J\) ä¸Šçš„æ®‹å·®å¹³æ–¹å’Œã€‚'
- en: '**Iterate Until Very Overfit** - return to step 1 for the next split until
    the tree is very overfit.'
  id: totrans-634
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**è¿­ä»£è‡³è¿‡åº¦æ‹Ÿåˆ** - è¿”å›æ­¥éª¤1è¿›è¡Œä¸‹ä¸€ä¸ªåˆ†å‰²ï¼Œç›´åˆ°æ ‘è¿‡åº¦æ‹Ÿåˆã€‚'
- en: Note, this method for training a decision tree is a solution heuristic,
  id: totrans-635
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œè¿™ç§è®­ç»ƒå†³ç­–æ ‘çš„æ–¹æ³•æ˜¯ä¸€ç§å¯å‘å¼è§£å†³æ–¹æ¡ˆï¼Œ
- en: there is no effort to jointly optimize all splits at once, for example, to select
    a suboptimal split to maximize training error reduction with a subsequent split
  id: totrans-636
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ²¡æœ‰åŠªåŠ›åŒæ—¶ä¼˜åŒ–æ‰€æœ‰åˆ†å‰²ï¼Œä¾‹å¦‚ï¼Œä¸ºäº†é€‰æ‹©æ¬¡ä¼˜åˆ†å‰²ä»¥æœ€å¤§åŒ–è®­ç»ƒè¯¯å·®çš„å‡å°‘ï¼Œéšåè¿›è¡Œåˆ†å‰²
- en: Also, the decision tree is constructed from the top down.
  id: totrans-637
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œå†³ç­–æ ‘æ˜¯ä»ä¸Šåˆ°ä¸‹æ„å»ºçš„ã€‚
- en: we begin with a single region that covers the entire predictor feature space
    and then proceed with a sequence of region splits / tree branches.
  id: totrans-638
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä»ä¸€ä¸ªè¦†ç›–æ•´ä¸ªé¢„æµ‹ç‰¹å¾ç©ºé—´çš„å•ä¸€åŒºåŸŸå¼€å§‹ï¼Œç„¶åè¿›è¡Œä¸€ç³»åˆ—çš„åŒºåŸŸåˆ†å‰²/æ ‘åˆ†æ”¯ã€‚
- en: Now letâ€™s illustrate this with an example, predicting natural gas production
    response feature with 2 predictor features,
  id: totrans-639
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸€ç‚¹ï¼Œä½¿ç”¨2ä¸ªé¢„æµ‹ç‰¹å¾é¢„æµ‹å¤©ç„¶æ°”ç”Ÿäº§å“åº”ç‰¹å¾ã€‚
- en: porosity - impacting pore volume and flow
  id: totrans-640
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å­”éš™ç‡ - å½±å“å­”éš™ä½“ç§¯å’ŒæµåŠ¨
- en: brittleness - impacting the ability to induce and hold open fractures
  id: totrans-641
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è„†æ€§ - å½±å“è¯±å¯¼å’Œä¿æŒå¼€æ”¾è£‚ç¼çš„èƒ½åŠ›
- en: We start with all our predictor feature space in a single region with the single
    possible prediction as the average of all the training data.
  id: totrans-642
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä»æ‰€æœ‰é¢„æµ‹ç‰¹å¾ç©ºé—´çš„ä¸€ä¸ªå•ä¸€åŒºåŸŸå¼€å§‹ï¼Œå”¯ä¸€çš„é¢„æµ‹æ˜¯æ‰€æœ‰è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼ã€‚
- en: '![](../Images/4a6be7714eba68f580cfee8421d15f61.png)'
  id: totrans-643
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/4a6be7714eba68f580cfee8421d15f61.png)'
- en: Initial data all in 1 region, i.e., hyperparameter number of leaf nodes of 1,
    predict with the global mean of the response feature.
  id: totrans-644
  prefs: []
  type: TYPE_NORMAL
  zh: åˆå§‹æ•°æ®å…¨éƒ¨åœ¨1ä¸ªåŒºåŸŸï¼Œå³å¶èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º1ï¼Œä½¿ç”¨å“åº”ç‰¹å¾çš„å…¨çƒå‡å€¼è¿›è¡Œé¢„æµ‹ã€‚
- en: Next, we scan all features to find the first best split, porosity of 16.7%.
    This very simple decision tree with a single decision node and 2 regions or leaf
    nodes is known as a stump tree, i.e., the simplest possible decision tree model.
  id: totrans-645
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰«ææ‰€æœ‰ç‰¹å¾ä»¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ€ä½³åˆ†å‰²ï¼Œå­”éš™ç‡ä¸º16.7%ã€‚è¿™ä¸ªåªæœ‰ä¸€ä¸ªå†³ç­–èŠ‚ç‚¹å’Œ2ä¸ªåŒºåŸŸæˆ–å¶èŠ‚ç‚¹çš„éå¸¸ç®€å•çš„å†³ç­–æ ‘è¢«ç§°ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå³æœ€ç®€å•çš„å†³ç­–æ ‘æ¨¡å‹ã€‚
- en: '![](../Images/c418139a6f37dbda3462cd0ab2d519d6.png)'
  id: totrans-646
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/c418139a6f37dbda3462cd0ab2d519d6.png)'
- en: Hyperparameter number of leaf nodes of 2, first best split resulting in a stump
    tree.
  id: totrans-647
  prefs: []
  type: TYPE_NORMAL
  zh: å¶èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º2ï¼Œç¬¬ä¸€ä¸ªæœ€ä½³åˆ†å‰²å¯¼è‡´ä¸€ä¸ªå•èŠ‚ç‚¹æ ‘ã€‚
- en: Now we scan over both regions and over all predictor features to find the best
    next split, brittleness of 36.1 in the greater than or equal to porosity of 16.7%
    region.
  id: totrans-648
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æ‰«æä¸¤ä¸ªåŒºåŸŸä»¥åŠæ‰€æœ‰é¢„æµ‹ç‰¹å¾ï¼Œä»¥æ‰¾åˆ°æœ€ä½³ä¸‹ä¸€ä¸ªåˆ†å‰²ï¼Œåœ¨å­”éš™ç‡å¤§äºæˆ–ç­‰äº16.7%çš„åŒºåŸŸï¼Œè„†æ€§ä¸º36.1ã€‚
- en: '![](../Images/5786413cc0e329c72793e1d2adf2a54b.png)'
  id: totrans-649
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/5786413cc0e329c72793e1d2adf2a54b.png)'
- en: Hyperparameter number of leaf nodes of 3.
  id: totrans-650
  prefs: []
  type: TYPE_NORMAL
  zh: å¶èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º3ã€‚
- en: Continuing, we find our next split of porosity of 18.5% in the upper right region.
    We now have 4 regions. Our decision tree is starting to capture the increasing
    production with increasing porosity along with lower production for low brittleness.
  id: totrans-651
  prefs: []
  type: TYPE_NORMAL
  zh: ç»§ç»­è¿›è¡Œï¼Œæˆ‘ä»¬åœ¨å³ä¸ŠåŒºåŸŸæ‰¾åˆ°ä¸‹ä¸€ä¸ªå­”éš™ç‡ä¸º18.5%çš„åˆ†å‰²ã€‚æˆ‘ä»¬ç°åœ¨æœ‰4ä¸ªåŒºåŸŸã€‚æˆ‘ä»¬çš„å†³ç­–æ ‘å¼€å§‹æ•æ‰éšç€å­”éš™ç‡çš„å¢åŠ è€Œå¢åŠ çš„ç”Ÿäº§é‡ï¼Œä»¥åŠä½è„†æ€§æ—¶çš„ä½ç”Ÿäº§é‡ã€‚
- en: '![](../Images/9931df51305b719f93fc51eecf44641d.png)'
  id: totrans-652
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/9931df51305b719f93fc51eecf44641d.png)'
- en: Hyperparameter number of leaf nodes of 4.
  id: totrans-653
  prefs: []
  type: TYPE_NORMAL
  zh: å¶èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º4ã€‚
- en: Now the next best split is in the original lower porosity region from the stump
    tree with porosity of 13.2%.
  id: totrans-654
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ä¸‹ä¸€ä¸ªæœ€ä½³åˆ†å‰²æ˜¯åœ¨åŸå§‹çš„ä½å­”éš™ç‡åŒºåŸŸï¼Œæ¥è‡ªå­”éš™ç‡ä¸º13.2%çš„å•èŠ‚ç‚¹æ ‘ã€‚
- en: '![](../Images/597e4adea071f8f67d71e82f4c1015f2.png)'
  id: totrans-655
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/597e4adea071f8f67d71e82f4c1015f2.png)'
- en: Hyperparameter number of leaf nodes of 5.
  id: totrans-656
  prefs: []
  type: TYPE_NORMAL
  zh: å¶èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º5ã€‚
- en: The next best split divides the region in the middle of porosity, capturing
    the trend of low production for low brittleness, even with high porosity.
  id: totrans-657
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹ä¸€ä¸ªæœ€ä½³åˆ†å‰²å°†å­”éš™ç‡ä¸­é—´çš„åŒºåŸŸåˆ†å‰²å¼€ï¼Œæ•æ‰äº†ä½è„†æ€§ä½ç”Ÿäº§é‡çš„è¶‹åŠ¿ï¼Œå³ä½¿åœ¨é«˜å­”éš™ç‡çš„æƒ…å†µä¸‹ã€‚
- en: '![](../Images/b1024ff1d9be25d7b007a5ee890b6d8f.png)'
  id: totrans-658
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/b1024ff1d9be25d7b007a5ee890b6d8f.png)'
- en: Hyperparameter number of leaf nodes of 6.
  id: totrans-659
  prefs: []
  type: TYPE_NORMAL
  zh: å¶èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º6ã€‚
- en: The next split is capturing the reduction in production with high brittleness,
    even with high porosity,
  id: totrans-660
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹ä¸€ä¸ªåˆ†å‰²æ•æ‰äº†ç”Ÿäº§é‡å› é«˜è„†æ€§è€Œå‡å°‘çš„æƒ…å†µï¼Œå³ä½¿åœ¨é«˜å­”éš™ç‡çš„æƒ…å†µä¸‹ï¼Œ
- en: '![](../Images/782938df9c411d347bdc8e6e031a6d66.png)'
  id: totrans-661
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/782938df9c411d347bdc8e6e031a6d66.png)'
- en: Hyperparameter number of leaf nodes of 7.
  id: totrans-662
  prefs: []
  type: TYPE_NORMAL
  zh: å¶èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º7ã€‚
- en: and this split continues to capture this same pattern in the data.
  id: totrans-663
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶ä¸”è¿™ä¸ªåˆ†å‰²ç»§ç»­æ•æ‰æ•°æ®ä¸­çš„ç›¸åŒæ¨¡å¼ã€‚
- en: '![](../Images/c3401dcf9ca381bf65d39fada64ecde2.png)'
  id: totrans-664
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c3401dcf9ca381bf65d39fada64ecde2.png)'
- en: Hyperparameter number of leaf nodes of 8.
  id: totrans-665
  prefs: []
  type: TYPE_NORMAL
  zh: å¶å­èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º8ã€‚
- en: For brevity we stop here, and make these observations,
  id: totrans-666
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œåœæ­¢ï¼Œå¹¶åšå‡ºä»¥ä¸‹è§‚å¯Ÿï¼Œ
- en: hierarchical, binary segmentation is the same as sequentially building a decision
    tree, each split adds a new decision node and increases the number of leaf nodes
    by one.
  id: totrans-667
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆ†å±‚ï¼ŒäºŒè¿›åˆ¶åˆ†å‰²ä¸é¡ºåºæ„å»ºå†³ç­–æ ‘ç›¸åŒï¼Œæ¯æ¬¡åˆ†å‰²æ·»åŠ ä¸€ä¸ªæ–°çš„å†³ç­–èŠ‚ç‚¹ï¼Œå¹¶ä½¿å¶å­èŠ‚ç‚¹æ•°é‡å¢åŠ ä¸€ä¸ªã€‚
- en: the simple decision trees are in the complicated decision tree, i.e., if we
    build an \(8\) leaf node model, we have the \(8, 7, \ldots, 2\) leaf node model
    by sequentially removing the decision nodes, in the order of last one is the first
    one to remove.
  id: totrans-668
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç®€å•çš„å†³ç­–æ ‘åŒ…å«åœ¨å¤æ‚çš„å†³ç­–æ ‘ä¸­ï¼Œå³ï¼Œå¦‚æœæˆ‘ä»¬æ„å»ºä¸€ä¸ª\(8\)å¶å­èŠ‚ç‚¹æ¨¡å‹ï¼Œæˆ‘ä»¬é€šè¿‡ä¾æ¬¡ç§»é™¤å†³ç­–èŠ‚ç‚¹ï¼Œä»¥æœ€åä¸€ä¸ªç§»é™¤çš„èŠ‚ç‚¹ä¸ºé¡ºåºï¼Œå¯ä»¥å¾—åˆ°\(8, 7,
    \ldots, 2\)å¶å­èŠ‚ç‚¹æ¨¡å‹ã€‚
- en: the ultimate overfit model is number of leaf nodes equal to the number of training
    data. In this case, the training error is 0.0 as have one region for each training
    data a we estimate with the training data response feature values for all the
    at the training data cases.
  id: totrans-669
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æœ€ç»ˆè¿‡åº¦æ‹Ÿåˆçš„æ¨¡å‹æ˜¯å¶å­èŠ‚ç‚¹æ•°é‡ç­‰äºè®­ç»ƒæ•°æ®æ•°é‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®­ç»ƒè¯¯å·®ä¸º0.0ï¼Œå› ä¸ºæ¯ä¸ªè®­ç»ƒæ•°æ®éƒ½æœ‰ä¸€ä¸ªåŒºåŸŸï¼Œæˆ‘ä»¬ä½¿ç”¨è®­ç»ƒæ•°æ®å“åº”ç‰¹å¾å€¼æ¥ä¼°è®¡æ‰€æœ‰è®­ç»ƒæ•°æ®æ¡ˆä¾‹ã€‚
- en: Updating the Loss Function with a New Split
  id: totrans-670
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä½¿ç”¨æ–°çš„åˆ†å‰²æ›´æ–°æŸå¤±å‡½æ•°
- en: To find the next best split, we must scan over all regions, and over all features
    with the regions. This may sound like a lot of computation, but it is quite efficient.
  id: totrans-671
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ‰¾åˆ°ä¸‹ä¸€ä¸ªæœ€ä½³åˆ†å‰²ï¼Œæˆ‘ä»¬å¿…é¡»æ‰«ææ‰€æœ‰åŒºåŸŸï¼Œä»¥åŠæ‰€æœ‰å…·æœ‰åŒºåŸŸçš„ç‰¹å¾ã€‚è¿™å¬èµ·æ¥å¯èƒ½éœ€è¦å¤§é‡çš„è®¡ç®—ï¼Œä½†å®é™…ä¸Šéå¸¸é«˜æ•ˆã€‚
- en: we only need to check the midpoints between sorted training data for each feature
    in each region, because any split that does not change the region assignment of
    a training data will not change the training loss.
  id: totrans-672
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¯¹äºæ¯ä¸ªåŒºåŸŸä¸­çš„æ¯ä¸ªç‰¹å¾ï¼Œæˆ‘ä»¬åªéœ€è¦æ£€æŸ¥æ’åºåçš„è®­ç»ƒæ•°æ®çš„ä¸­ç‚¹ï¼Œå› ä¸ºä»»ä½•ä¸ä¼šæ”¹å˜è®­ç»ƒæ•°æ®åŒºåŸŸåˆ†é…çš„åˆ†å‰²éƒ½ä¸ä¼šæ”¹å˜è®­ç»ƒæŸå¤±ã€‚
- en: 'For a region \(R\) split into candidate regions \(R_L\) and \(R_R\), the RSS
    after the split is:'
  id: totrans-673
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºåˆ†å‰²æˆå€™é€‰åŒºåŸŸ\(R_L\)å’Œ\(R_R\)çš„åŒºåŸŸ\(R\)ï¼Œåˆ†å‰²åçš„RSSä¸ºï¼š
- en: \[ \text{RSS}_{\text{split}} = \sum_{i \in R_L} (y_i - \hat{y}_{R_L})^2 + \sum_{i
    \in R_R} (y_i - \hat{y}_{R_R})^2 \]
  id: totrans-674
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \text{RSS}_{\text{split}} = \sum_{i \in R_L} (y_i - \hat{y}_{R_L})^2 + \sum_{i
    \in R_R} (y_i - \hat{y}_{R_R})^2 \]
- en: where, \(y_i\) is the actual response feature for training data observation
    \(i\), and \(\hat{y}_{R_L}\), \(\hat{y}_{R_R}\) is the mean of training data response
    feature in candidate regions \(R_L\) and \(R_R\).
  id: totrans-675
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ï¼Œ\(y_i\)æ˜¯è®­ç»ƒæ•°æ®è§‚å¯Ÿ\(i\)çš„å®é™…å“åº”ç‰¹å¾ï¼Œè€Œ\(\hat{y}_{R_L}\)ï¼Œ\(\hat{y}_{R_R}\)æ˜¯å€™é€‰åŒºåŸŸ\(R_L\)å’Œ\(R_R\)ä¸­è®­ç»ƒæ•°æ®å“åº”ç‰¹å¾çš„å‡å€¼ã€‚
- en: Note, we add in the RSS components from all the other regions to get the total
    model RSS to find the best split over all the regions,
  id: totrans-676
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬æ·»åŠ äº†æ‰€æœ‰å…¶ä»–åŒºåŸŸçš„RSSæˆåˆ†ï¼Œä»¥è·å¾—æ‰€æœ‰åŒºåŸŸçš„æ€»ä½“æ¨¡å‹RSSï¼Œä»¥åœ¨æ‰€æœ‰åŒºåŸŸä¸­æ‰¾åˆ°æœ€ä½³åˆ†å‰²ï¼Œ
- en: the split with the lowest \(\text{RSS}_{\text{split}}\) is selected for the
    region and compared to all other best splits in the other regions to find the
    next best split, greedy solution.
  id: totrans-677
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å…·æœ‰æœ€ä½\(\text{RSS}_{\text{split}}\)çš„åˆ†å‰²è¢«é€‰ä¸ºåŒºåŸŸï¼Œå¹¶ä¸å…¶ä»–åŒºåŸŸçš„æ‰€æœ‰æœ€ä½³åˆ†å‰²è¿›è¡Œæ¯”è¾ƒï¼Œä»¥æ‰¾åˆ°ä¸‹ä¸€ä¸ªæœ€ä½³åˆ†å‰²ï¼Œè´ªå©ªè§£æ³•ã€‚
- en: Now we are prepared for tuning a decision tree model.
  id: totrans-678
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½è°ƒæ•´å†³ç­–æ ‘æ¨¡å‹ã€‚
- en: Tuning the Tree Model
  id: totrans-679
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è°ƒæ•´æ ‘æ¨¡å‹
- en: To tune the decision tree we take the very overfit trained tree model,
  id: totrans-680
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†è°ƒæ•´å†³ç­–æ ‘ï¼Œæˆ‘ä»¬é‡‡ç”¨éå¸¸è¿‡åº¦æ‹Ÿåˆçš„å·²è®­ç»ƒæ ‘æ¨¡å‹ï¼Œ
- en: sequentially cut the last decision node
  id: totrans-681
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¾æ¬¡åˆ‡å‰²æœ€åä¸€ä¸ªå†³ç­–èŠ‚ç‚¹
- en: i.e., prune the last branch of the decision tree
  id: totrans-682
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å³ï¼Œä¿®å‰ªå†³ç­–æ ‘çš„æœ€æœ«åˆ†æ”¯
- en: Since the simpler trees are inside the complicated tree!
  id: totrans-683
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºç®€å•çš„æ ‘åœ¨å¤æ‚çš„æ ‘å†…éƒ¨ï¼
- en: We can calculate test error as we prune and select tree with minimum test error
  id: totrans-684
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥åœ¨ä¿®å‰ªå’Œé€‰æ‹©å…·æœ‰æœ€å°æµ‹è¯•è¯¯å·®çš„æ ‘æ—¶è®¡ç®—æµ‹è¯•è¯¯å·®
- en: We overfit the decision tree model, with a large number of leaf nodes and then
    we reduce the number of leaf nodes while tracking the test error.
  id: totrans-685
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿‡åº¦æ‹Ÿåˆäº†å†³ç­–æ ‘æ¨¡å‹ï¼Œå…·æœ‰å¤§é‡å¶å­èŠ‚ç‚¹ï¼Œç„¶åæˆ‘ä»¬åœ¨è·Ÿè¸ªæµ‹è¯•è¯¯å·®çš„åŒæ—¶å‡å°‘å¶å­èŠ‚ç‚¹æ•°é‡ã€‚
- en: we select the number of leaf nodes that minimize the testing error.
  id: totrans-686
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬é€‰æ‹©æœ€å°åŒ–æµ‹è¯•è¯¯å·®çš„å¶å­èŠ‚ç‚¹æ•°é‡ã€‚
- en: since we are sequentially removing the last branch to simplify the tree, we
    call model tuning **pruning** for decision trees
  id: totrans-687
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç”±äºæˆ‘ä»¬æ˜¯ä¾æ¬¡ç§»é™¤æœ€åä¸€ä¸ªåˆ†æ”¯ä»¥ç®€åŒ–æ ‘ï¼Œæ‰€ä»¥æˆ‘ä»¬ç§°æ¨¡å‹è°ƒæ•´**ä¿®å‰ª**ä¸ºå†³ç­–æ ‘
- en: Here is an overfit decision tree with many, \(100\), leaf nodes.
  id: totrans-688
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæ˜¯ä¸€ä¸ªè¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œæ‹¥æœ‰è®¸å¤šï¼Œ\(100\)ï¼Œå¶å­èŠ‚ç‚¹ã€‚
- en: '![](../Images/3383a81c81cdb9ed5c96432a485e7194.png)'
  id: totrans-689
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3383a81c81cdb9ed5c96432a485e7194.png)'
- en: Very overfit decision tree, hyperparameter number of leaf nodes of 100 (left),
    train and test cross validation plot (center) and train and test error over number
    of leaf nodes (right).
  id: totrans-690
  prefs: []
  type: TYPE_NORMAL
  zh: æåº¦è¿‡æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œå¶èŠ‚ç‚¹æ•°ä¸º100çš„è¶…å‚æ•°ï¼ˆå·¦ï¼‰ï¼Œè®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯å›¾ï¼ˆä¸­å¿ƒï¼‰å’Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸å¶èŠ‚ç‚¹æ•°çš„å…³ç³»ï¼ˆå³ï¼‰ã€‚
- en: Since this tree is calculated with my interactive Python dashboard, I am able
    to easily reduce the number of regions from \(100, 99, 98, 96, 95, \ldots\) and
    visualize the tree to explore complicated to simple trees.
  id: totrans-691
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºè¿™æ£µæ ‘æ˜¯ç”¨æˆ‘çš„äº¤äº’å¼Pythonä»ªè¡¨æ¿è®¡ç®—çš„ï¼Œæˆ‘èƒ½å¤Ÿè½»æ¾åœ°å°†åŒºåŸŸæ•°ä»\(100, 99, 98, 96, 95, \ldots\)å‡å°‘ï¼Œå¹¶å¯è§†åŒ–æ ‘ä»¥æ¢ç´¢ä»å¤æ‚åˆ°ç®€å•çš„æ ‘ã€‚
- en: by doing this we can demonstrate that the simple trees are in the complicated
    tree.
  id: totrans-692
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é€šè¿‡è¿™æ ·åšï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜ç®€å•çš„æ ‘åŒ…å«åœ¨å¤æ‚çš„æ ‘ä¸­ã€‚
- en: For example, hereâ€™s the 5 region decision tree in the overfit 100 region decision
    tree,
  id: totrans-693
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œè¿™é‡Œæ˜¯è¿‡æ‹Ÿåˆçš„100åŒºåŸŸå†³ç­–æ ‘ä¸­çš„5åŒºåŸŸå†³ç­–æ ‘ï¼Œ
- en: '![](../Images/566f12da178143a07d17de9adc100684.png)'
  id: totrans-694
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/566f12da178143a07d17de9adc100684.png)'
- en: The 5 leaf node tree in the very overfit 100 leaf node tree model.
  id: totrans-695
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æåº¦è¿‡æ‹Ÿåˆçš„100å¶èŠ‚ç‚¹æ ‘æ¨¡å‹ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ª5å¶èŠ‚ç‚¹çš„æ ‘ã€‚
- en: and here is the 10 region decision tree in the overfit 100 region decision tree,
  id: totrans-696
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæ˜¯è¿‡æ‹Ÿåˆçš„100åŒºåŸŸå†³ç­–æ ‘ä¸­çš„10åŒºåŸŸå†³ç­–æ ‘ï¼Œ
- en: '![](../Images/96e18c15cb01e9558e4b2512a6b1ef20.png)'
  id: totrans-697
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/96e18c15cb01e9558e4b2512a6b1ef20.png)'
- en: The 10 leaf node tree in the very overfit 100 leaf node tree model.
  id: totrans-698
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æåº¦è¿‡æ‹Ÿåˆçš„100å¶èŠ‚ç‚¹æ ‘æ¨¡å‹ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ª10å¶èŠ‚ç‚¹çš„æ ‘ã€‚
- en: and finally, here is the 20 region decision tree in the overfit 100 region decision
    tree,
  id: totrans-699
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œè¿™é‡Œæ˜¯è¿‡æ‹Ÿåˆçš„100åŒºåŸŸå†³ç­–æ ‘ä¸­çš„20åŒºåŸŸå†³ç­–æ ‘ï¼Œ
- en: '![](../Images/19d39b48f3c129dc12099bd52c3bb546.png)'
  id: totrans-700
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/19d39b48f3c129dc12099bd52c3bb546.png)'
- en: The 20 leaf node tree in the very overfit 100 leaf node tree model.
  id: totrans-701
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æåº¦è¿‡æ‹Ÿåˆçš„100å¶èŠ‚ç‚¹æ ‘æ¨¡å‹ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ª20å¶èŠ‚ç‚¹çš„æ ‘ã€‚
- en: You might wonder, why I didnâ€™t just update the decision tree plot? scikit-learnâ€™s
    decision tree plotting function recales the plot and the geometry changes so much
    it is not easy to visualize the simple trees within the complicated tree.
  id: totrans-702
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯èƒ½ä¼šæƒ³çŸ¥é“ï¼Œä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰åªæ˜¯æ›´æ–°å†³ç­–æ ‘å›¾ï¼Ÿscikit-learnçš„å†³ç­–æ ‘ç»˜å›¾å‡½æ•°é‡æ–°ç¼©æ”¾å›¾è¡¨ï¼Œå‡ ä½•å½¢çŠ¶å˜åŒ–å¾ˆå¤§ï¼Œè¿™ä½¿å¾—åœ¨å¤æ‚æ ‘ä¸­å¯è§†åŒ–ç®€å•æ ‘å˜å¾—å›°éš¾ã€‚
- en: I think this approach of visualizing the simple trees and drafting the polylines
    works well for educational purposes!
  id: totrans-703
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘è®¤ä¸ºè¿™ç§å°†ç®€å•æ ‘å¯è§†åŒ–å¹¶ç»˜åˆ¶å¤šè¾¹å½¢çš„åšæ³•åœ¨æ•™è‚²ç›®çš„ä¸Šæ•ˆæœå¾ˆå¥½ï¼
- en: Now letâ€™s return to our very overfit tree and demonstrate the hyperparameter
    tuning by tree pruning approach,
  id: totrans-704
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„æåº¦è¿‡æ‹Ÿåˆçš„æ ‘ï¼Œå¹¶é€šè¿‡æ ‘å‰ªææ–¹æ³•æ¼”ç¤ºè¶…å‚æ•°è°ƒæ•´ï¼Œ
- en: '![](../Images/24f9e4745fc35d0cf9c039aec32684f0.png)'
  id: totrans-705
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/24f9e4745fc35d0cf9c039aec32684f0.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-706
  prefs: []
  type: TYPE_NORMAL
  zh: æåº¦è¿‡æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰ã€‚
- en: Now, we identify the last added branch and remove it to calculate the 99 region
    decision tree, a slightly simpler decision tree, and we calculate the test error.
  id: totrans-707
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæˆ‘ä»¬å†æ¬¡è¯†åˆ«æœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—99åŒºåŸŸçš„å†³ç­–æ ‘ï¼Œä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œå¹¶è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/2c6ffbcc9634d3d3f7350cb0564380d1.png)'
  id: totrans-708
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/2c6ffbcc9634d3d3f7350cb0564380d1.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-709
  prefs: []
  type: TYPE_NORMAL
  zh: æåº¦è¿‡æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰ã€‚
- en: And we identify the last added branch again and remove it to calculate the 98
    region decision tree, once again a slightly simpler decision tree, and we calculate
    the test error.
  id: totrans-710
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å†æ¬¡è¯†åˆ«æœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—98åŒºåŸŸçš„å†³ç­–æ ‘ï¼Œå†æ¬¡æ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œå¹¶è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/efae49220a4ea118479dcc21d333e37a.png)'
  id: totrans-711
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/efae49220a4ea118479dcc21d333e37a.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-712
  prefs: []
  type: TYPE_NORMAL
  zh: æåº¦è¿‡æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰ã€‚
- en: And we identify the last added branch again and remove it to calculate the 97
    region decision tree, once again a slightly simpler decision tree, and we calculate
    the test error.
  id: totrans-713
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å†æ¬¡è¯†åˆ«æœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—97åŒºåŸŸçš„å†³ç­–æ ‘ï¼Œå†æ¬¡æ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œå¹¶è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/f4af3bd7dce90621152ff68c398bd578.png)'
  id: totrans-714
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/f4af3bd7dce90621152ff68c398bd578.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-715
  prefs: []
  type: TYPE_NORMAL
  zh: æåº¦è¿‡æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰ã€‚
- en: And we identify the last added branch again and remove it to calculate the 96
    region decision tree, once again a slightly simpler decision tree, and we calculate
    the test error.
  id: totrans-716
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å†æ¬¡è¯†åˆ«æœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—96åŒºåŸŸçš„å†³ç­–æ ‘ï¼Œå†æ¬¡æ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œå¹¶è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/eeea92714bf8b2f878a05ce7f50e9eae.png)'
  id: totrans-717
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/eeea92714bf8b2f878a05ce7f50e9eae.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-718
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚
- en: And we identify the last added branch again and remove it to calculate the 95
    region decision tree, once again a slightly simpler decision tree, and we calculate
    the test error.
  id: totrans-719
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å†æ¬¡è¯†åˆ«å‡ºæœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—95ä¸ªåŒºåŸŸçš„å†³ç­–æ ‘ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œç„¶åæˆ‘ä»¬è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/90180132c5183f3342f2051c501aee4a.png)'
  id: totrans-720
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/90180132c5183f3342f2051c501aee4a.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-721
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚
- en: And we identify the last added branch again and remove it to calculate the 94
    region decision tree, once again a slightly simpler decision tree, and we calculate
    the test error.
  id: totrans-722
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å†æ¬¡è¯†åˆ«å‡ºæœ€åæ·»åŠ çš„åˆ†æ”¯å¹¶å°†å…¶ç§»é™¤ï¼Œä»¥è®¡ç®—94ä¸ªåŒºåŸŸçš„å†³ç­–æ ‘ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªç¨å¾®ç®€å•çš„å†³ç­–æ ‘ï¼Œç„¶åæˆ‘ä»¬è®¡ç®—æµ‹è¯•è¯¯å·®ã€‚
- en: '![](../Images/53f087807a31ef6a8e1be0e1ec170292.png)'
  id: totrans-723
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/53f087807a31ef6a8e1be0e1ec170292.png)'
- en: Very overfit decision tree, train and test error vs. model complexity (left)
    and decision tree (right).
  id: totrans-724
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸æ¨¡å‹å¤æ‚åº¦ï¼ˆå·¦ï¼‰å’Œå†³ç­–æ ‘ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚
- en: Now letâ€™s return and look at the very overfit model and add some more information
    over different levels of complexity.
  id: totrans-725
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬è¿”å›å¹¶æŸ¥çœ‹è¿‡åº¦æ‹Ÿåˆçš„æ¨¡å‹ï¼Œå¹¶åœ¨ä¸åŒå¤æ‚åº¦çº§åˆ«ä¸Šæ·»åŠ ä¸€äº›æ›´å¤šä¿¡æ¯ã€‚
- en: '![](../Images/ab38e613fbf8ad17fdab5bd4f89adaa6.png)'
  id: totrans-726
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/ab38e613fbf8ad17fdab5bd4f89adaa6.png)'
- en: Very overfit decision tree, hyperparameter number of leaf nodes of 100 (left),
    train and test cross validation plot (center) and train and test error over number
    of leaf nodes (right).
  id: totrans-727
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œå¶èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º100ï¼ˆå·¦ï¼‰ï¼Œè®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯å›¾ï¼ˆä¸­å¿ƒï¼‰ä»¥åŠè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸å¶èŠ‚ç‚¹æ•°é‡çš„å…³ç³»ï¼ˆå³ï¼‰ã€‚
- en: I include the,
  id: totrans-728
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘åŒ…æ‹¬çš„ï¼Œ
- en: train and test cross validation plot with nearly perfect training prediction
    and very poor testing prediction for the 100 leaf node overfit decision tree
  id: totrans-729
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯å›¾ï¼Œå¯¹äº100ä¸ªå¶èŠ‚ç‚¹çš„è¿‡åº¦æ‹Ÿåˆå†³ç­–æ ‘ï¼Œå‡ ä¹å®Œç¾çš„è®­ç»ƒé¢„æµ‹å’Œéå¸¸å·®çš„æµ‹è¯•é¢„æµ‹
- en: train and test error versus number of leaf nodes.
  id: totrans-730
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸å¶èŠ‚ç‚¹æ•°é‡çš„å…³ç³»ã€‚
- en: This demonstrates that the decision tree model is indeed very overfit, for example,
    see the falling training error and rising testing error.
  id: totrans-731
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™è¡¨æ˜å†³ç­–æ ‘æ¨¡å‹ç¡®å®éå¸¸è¿‡åº¦æ‹Ÿåˆï¼Œä¾‹å¦‚ï¼Œå¯ä»¥çœ‹åˆ°è®­ç»ƒè¯¯å·®ä¸‹é™å’Œæµ‹è¯•è¯¯å·®ä¸Šå‡ã€‚
- en: Now we prune the decision nodes until we obtain the model with the minimum testing
    error at about 19 leaf nodes.
  id: totrans-732
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬ä¿®å‰ªå†³ç­–èŠ‚ç‚¹ï¼Œç›´åˆ°æˆ‘ä»¬è·å¾—å¤§çº¦19ä¸ªå¶èŠ‚ç‚¹çš„æœ€å°æµ‹è¯•è¯¯å·®çš„æ¨¡å‹ã€‚
- en: '![](../Images/064eac7331174101230aee9c413623f3.png)'
  id: totrans-733
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/064eac7331174101230aee9c413623f3.png)'
- en: Tuned decision tree, hyperparameter number of leaf nodes of 20 (left), train
    and test cross validation plot (center) and train and test error over number of
    leaf nodes indicating that testing error is minimized (right).
  id: totrans-734
  prefs: []
  type: TYPE_NORMAL
  zh: è°ƒæ•´åçš„å†³ç­–æ ‘ï¼Œå¶èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º20ï¼ˆå·¦ï¼‰ï¼Œè®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯å›¾ï¼ˆä¸­å¿ƒï¼‰ä»¥åŠè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸å¶èŠ‚ç‚¹æ•°é‡çš„å…³ç³»ï¼Œè¡¨æ˜æµ‹è¯•è¯¯å·®æœ€å°åŒ–ï¼ˆå³ï¼‰ã€‚
- en: For completeness, I have included an underfit model, i.e., if we prune our decision
    tree too much, with only 8 leaf nodes.
  id: totrans-735
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å®Œæ•´æ€§ï¼Œæˆ‘åŒ…æ‹¬äº†ä¸€ä¸ªæ¬ æ‹Ÿåˆæ¨¡å‹ï¼Œå³å¦‚æœæˆ‘ä»¬è¿‡åº¦ä¿®å‰ªæˆ‘ä»¬çš„å†³ç­–æ ‘ï¼Œåªæœ‰8ä¸ªå¶èŠ‚ç‚¹ã€‚
- en: '![](../Images/9d7b773b0de829f858763876c59a1c04.png)'
  id: totrans-736
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/9d7b773b0de829f858763876c59a1c04.png)'
- en: Underfit decision tree, hyperparameter number of leaf nodes of 8 (left), train
    and test cross validation plot (center) and train and test error over number of
    leaf nodes indicating that testing error is minimized (right).
  id: totrans-737
  prefs: []
  type: TYPE_NORMAL
  zh: æ¬ æ‹Ÿåˆçš„å†³ç­–æ ‘ï¼Œå¶èŠ‚ç‚¹æ•°é‡çš„è¶…å‚æ•°ä¸º8ï¼ˆå·¦ï¼‰ï¼Œè®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯å›¾ï¼ˆä¸­å¿ƒï¼‰ä»¥åŠè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®ä¸å¶èŠ‚ç‚¹æ•°é‡çš„å…³ç³»ï¼Œè¡¨æ˜æµ‹è¯•è¯¯å·®æœ€å°åŒ–ï¼ˆå³ï¼‰ã€‚
- en: Note, that the train and test error are both very high with the underfit decision
    tree.
  id: totrans-738
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œåœ¨æ¬ æ‹Ÿåˆçš„å†³ç­–æ ‘ä¸­ï¼Œè®­ç»ƒå’Œæµ‹è¯•è¯¯å·®éƒ½éå¸¸é«˜ã€‚
- en: I prefer number of leaf nodes as my decision tree hyperparameter because it
    provides,
  id: totrans-739
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æ›´å–œæ¬¢å°†å¶èŠ‚ç‚¹æ•°é‡ä½œä¸ºæˆ‘çš„å†³ç­–æ ‘è¶…å‚æ•°ï¼Œå› ä¸ºå®ƒæä¾›äº†ï¼Œ
- en: '**continuous, uniform increase in complexity** - equal steps in increased complexity
    without jumps'
  id: totrans-740
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**è¿ç»­ã€å‡åŒ€çš„å¤æ‚åº¦å¢åŠ ** - å¤æ‚åº¦å¢åŠ çš„æ­¥éª¤ç›¸ç­‰ï¼Œæ²¡æœ‰è·³è·ƒ'
- en: '**intuitive control on complexity** - we can understand and relate the \(2,
    3, \ldots, 100\) leaf node decision trees'
  id: totrans-741
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç›´è§‚çš„å¤æ‚åº¦æ§åˆ¶** - æˆ‘ä»¬å¯ä»¥ç†è§£å’Œå…³è”\(2, 3, \ldots, 100\)ä¸ªå¶èŠ‚ç‚¹çš„å†³ç­–æ ‘'
- en: '**flexible complexity** - the tree is free to grow in any manner to reduce
    training error, including highly asymmetric decision trees'
  id: totrans-742
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**çµæ´»çš„å¤æ‚åº¦** - æ ‘å¯ä»¥è‡ªç”±åœ°ä»¥ä»»ä½•æ–¹å¼ç”Ÿé•¿ä»¥å‡å°‘è®­ç»ƒè¯¯å·®ï¼ŒåŒ…æ‹¬é«˜åº¦ä¸å¯¹ç§°çš„å†³ç­–æ ‘'
- en: There are other common decision tree hyperparameters including,
  id: totrans-743
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä»–å¸¸è§çš„å†³ç­–æ ‘è¶…å‚æ•°åŒ…æ‹¬ï¼Œ
- en: '**Minimum reduction in RSS** â€“ related to the idea that incremental increase
    in complexity must be offset by sufficient reduction in training error. This could
    stop the model early, for example, a split with low reduction in training error
    could lead to a subsequent split with a much larger reduction in training error'
  id: totrans-744
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æœ€å°åŒ–RSSå‡å°‘** â€“ ä¸å¢é‡å¢åŠ å¤æ‚æ€§å¿…é¡»ç”±è¶³å¤Ÿçš„è®­ç»ƒé”™è¯¯å‡å°‘æ¥æŠµæ¶ˆçš„æƒ³æ³•ç›¸å…³ã€‚è¿™å¯èƒ½å¯¼è‡´æ¨¡å‹æå‰åœæ­¢ï¼Œä¾‹å¦‚ï¼Œè®­ç»ƒé”™è¯¯å‡å°‘è¾ƒå°çš„åˆ†å‰²å¯èƒ½å¯¼è‡´éšåçš„åˆ†å‰²æœ‰æ›´å¤§çš„è®­ç»ƒé”™è¯¯å‡å°‘'
- en: '**Minimum number of training data in each region** â€“ related to the concept
    of accuracy of the by-region estimates, i.e., we need at least \(n\) data for
    a reliable mean and most common category'
  id: totrans-745
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ¯ä¸ªåŒºåŸŸçš„æœ€å°è®­ç»ƒæ•°æ®æ•°é‡** â€“ ä¸åŒºåŸŸä¼°è®¡çš„å‡†ç¡®æ€§æ¦‚å¿µç›¸å…³ï¼Œå³æˆ‘ä»¬éœ€è¦è‡³å°‘ \(n\) ä¸ªæ•°æ®æ¥è·å¾—å¯é çš„å‡å€¼å’Œæœ€å¸¸è§çš„ç±»åˆ«'
- en: '**Maximum number of levels** â€“ forces symmetric trees, similar number of splits
    to get to each leaf node. There is a large change in model complexity with change
    in the hyperparameter.'
  id: totrans-746
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æœ€å¤§å±‚æ•°** â€“ å¼ºåˆ¶å¯¹ç§°æ ‘ï¼Œåˆ°è¾¾æ¯ä¸ªå¶èŠ‚ç‚¹çš„åˆ†å‰²æ•°é‡ç›¸ä¼¼ã€‚æ¨¡å‹å¤æ‚åº¦éšç€è¶…å‚æ•°çš„å˜åŒ–è€Œå¤§å¹…å˜åŒ–ã€‚'
- en: The Prediction Model
  id: totrans-747
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é¢„æµ‹æ¨¡å‹
- en: 'The decision tree prediction model is represented as **set of nested if statements**,
    for example:'
  id: totrans-748
  prefs: []
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘é¢„æµ‹æ¨¡å‹è¡¨ç¤ºä¸º**åµŒå¥—çš„ifè¯­å¥é›†åˆ**ï¼Œä¾‹å¦‚ï¼š
- en: '[PRE38]'
  id: totrans-749
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: and the predictions as stated above are either the,
  id: totrans-750
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥åŠä¸Šè¿°é¢„æµ‹è¦ä¹ˆæ˜¯ï¼Œ
- en: regression - average of the training data in the region
  id: totrans-751
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å›å½’ - è¯¥åŒºåŸŸå†…è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼
- en: classification - the plurality, most common category, of the training data in
    the region
  id: totrans-752
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆ†ç±» - è¯¥åŒºåŸŸå†…è®­ç»ƒæ•°æ®çš„å¤šæ•°ï¼Œæœ€å¸¸è§çš„ç±»åˆ«
- en: Shapley Values from Decision Trees
  id: totrans-753
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘ä¸­çš„Shapleyå€¼
- en: Recall, we need to take a single model, for example, \(f(x_1,x_2,x_3,x_4)\),
    and make an estimate for all possible combinations of feature subsets, for example,
  id: totrans-754
  prefs: []
  type: TYPE_NORMAL
  zh: å›æƒ³ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å•ä¸ªæ¨¡å‹ï¼Œä¾‹å¦‚ï¼Œ\(f(x_1,x_2,x_3,x_4)\)ï¼Œå¯¹æ‰€æœ‰å¯èƒ½çš„ç‰¹å¾å­é›†ç»„åˆè¿›è¡Œä¼°è®¡ï¼Œä¾‹å¦‚ï¼Œ
- en: \[ f(x_1) \quad f(x_2,x_4) \quad f(x_1,x_2,x_3) \]
  id: totrans-755
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f(x_1) \quad f(x_2,x_4) \quad f(x_1,x_2,x_3) \]
- en: note, the naÃ¯ve approach to calculate Shapley values is to train the full combinatorial
    of models with different predictor features, but we donâ€™t want to make new models
    if our goal is feature importance to diagnose our specific model, \(f\), to support
    model explainability.
  id: totrans-756
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œè®¡ç®—Shapleyå€¼çš„æœ´ç´ æ–¹æ³•æ˜¯è®­ç»ƒå…·æœ‰ä¸åŒé¢„æµ‹ç‰¹å¾çš„å®Œæ•´ç»„åˆæ¨¡å‹ï¼Œä½†å¦‚æœæˆ‘ä»¬ç›®æ ‡æ˜¯ç‰¹å¾é‡è¦æ€§ä»¥è¯Šæ–­æˆ‘ä»¬çš„ç‰¹å®šæ¨¡å‹ \(f\)ï¼Œä»¥æ”¯æŒæ¨¡å‹å¯è§£é‡Šæ€§ï¼Œæˆ‘ä»¬ä¸æƒ³åˆ›å»ºæ–°çš„æ¨¡å‹ã€‚
- en: One solution is to apply a variety of approaches, similar to imputation methods,
    including,
  id: totrans-757
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯åº”ç”¨å¤šç§æ–¹æ³•ï¼Œç±»ä¼¼äºæ’è¡¥æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼Œ
- en: replace the excluded feature(s) with the expected value, global mean,
  id: totrans-758
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†æ’é™¤çš„ç‰¹å¾æ›¿æ¢ä¸ºæœŸæœ›å€¼ï¼Œå…¨å±€å‡å€¼ï¼Œ
- en: \[ f(x_1,x_2,x_3) = f(x_1,x_2,x_3,x_4=E[x_4]) \]
  id: totrans-759
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f(x_1,x_2,x_3) = f(x_1,x_2,x_3,x_4=E[x_4]) \]
- en: replace the excluded feature(s) with the median value, the 50th percentile,
  id: totrans-760
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†æ’é™¤çš„ç‰¹å¾æ›¿æ¢ä¸ºä¸­ä½æ•°ï¼Œå³ç¬¬50ç™¾åˆ†ä½æ•°ï¼Œ
- en: \[ f(x_1,x_2,x_3) = f(x_1,x_2,x_3,x_4=P50_{x_4}) \]
  id: totrans-761
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f(x_1,x_2,x_3) = f(x_1,x_2,x_3,x_4=P50_{x_4}) \]
- en: There is a more accurate, unique method with tree-based models, we can actually
    remove the influence of any of the features from the decision tree after the model
    is trained, for example,
  id: totrans-762
  prefs: []
  type: TYPE_NORMAL
  zh: åŸºäºæ ‘æ¨¡å‹çš„æ¨¡å‹æœ‰æ›´å‡†ç¡®ã€ç‹¬ç‰¹çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥åœ¨æ¨¡å‹è®­ç»ƒåç§»é™¤ä»»ä½•ç‰¹å¾çš„å½±å“ï¼Œä¾‹å¦‚ï¼Œ
- en: remove all \(x_4\) branches, and then the model does not use \(x_4\) to make
    the prediction
  id: totrans-763
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç§»é™¤æ‰€æœ‰ \(x_4\) åˆ†æ”¯ï¼Œç„¶åæ¨¡å‹ä¸ä¼šä½¿ç”¨ \(x_4\) è¿›è¡Œé¢„æµ‹
- en: Of course, we cannot just remove branches and â€˜wood glueâ€™ the tree back together!
  id: totrans-764
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ç„¶ï¼Œæˆ‘ä»¬ä¸èƒ½åªæ˜¯ç§»é™¤åˆ†æ”¯ï¼Œç„¶åç”¨â€œæœ¨èƒ¶â€å°†æ ‘é‡æ–°ç²˜åˆåœ¨ä¸€èµ·ï¼
- en: we must make new predictions that donâ€™t introduce bias.
  id: totrans-765
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¿…é¡»åšå‡ºæ–°çš„é¢„æµ‹ï¼Œè¿™äº›é¢„æµ‹ä¸ä¼šå¼•å…¥åå·®ã€‚
- en: Letâ€™s demonstrate the procedure for removing a feature from a decision tree,
    with a couple of prediction cases,
  id: totrans-766
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªé¢„æµ‹æ¡ˆä¾‹æ¥æ¼”ç¤ºä»å†³ç­–æ ‘ä¸­ç§»é™¤ç‰¹å¾çš„è¿‡ç¨‹ï¼Œ
- en: Here is a prediction case that does not encounter the removed feature, \(x_2\)
    is removed and,
  id: totrans-767
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è¿™é‡Œæ˜¯ä¸€ä¸ªä¸é‡åˆ°ç§»é™¤ç‰¹å¾çš„é¢„æµ‹æƒ…å†µï¼Œ\(x_2\) è¢«ç§»é™¤ï¼Œ
- en: \[ x_1=25 \]
  id: totrans-768
  prefs: []
  type: TYPE_NORMAL
  zh: \[ x_1=25 \]
- en: the prediction is made as usual.
  id: totrans-769
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é¢„æµ‹é€šå¸¸è¿›è¡Œã€‚
- en: '![](../Images/a9783a200ab476bb3a92cb2cfec12d63.png)'
  id: totrans-770
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a9783a200ab476bb3a92cb2cfec12d63.png)'
- en: Prediction case that does not encounter the removed feature is made as usual.
  id: totrans-771
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸é‡åˆ°ç§»é™¤ç‰¹å¾çš„é¢„æµ‹æƒ…å†µï¼Œé€šå¸¸è¿›è¡Œé¢„æµ‹ã€‚
- en: \[ f(x_1=25) = 20 \]
  id: totrans-772
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f(x_1=25) = 20 \]
- en: A prediction case that does encounter the removed feature, \(x_1\) is removed
    and,
  id: totrans-773
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: é‡åˆ°ç§»é™¤ç‰¹å¾çš„é¢„æµ‹æƒ…å†µï¼Œ\(x_1\) è¢«ç§»é™¤ï¼Œ
- en: \[ x_2 = 60 \]
  id: totrans-774
  prefs: []
  type: TYPE_NORMAL
  zh: \[ x_2 = 60 \]
- en: we effectively go down both paths, by weighting, by number of training data,
    the solution over both paths!
  id: totrans-775
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å®é™…ä¸Šé€šè¿‡åŠ æƒï¼Œé€šè¿‡è®­ç»ƒæ•°æ®æ•°é‡ï¼Œåœ¨ä¸¤æ¡è·¯å¾„ä¸Šéƒ½æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆï¼
- en: '![](../Images/8152951b8a3c920f03825528d98c5ae7.png)'
  id: totrans-776
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8152951b8a3c920f03825528d98c5ae7.png)'
- en: Prediction case that does encounter the removed feature is made by weighting
    both paths by the number of training data.
  id: totrans-777
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æµ‹æ¡ˆä¾‹é‡åˆ°å·²åˆ é™¤ç‰¹å¾æ—¶ï¼Œé€šè¿‡åŠ æƒè®­ç»ƒæ•°æ®æ•°é‡æ¥åˆ¶ä½œä¸¤ä¸ªè·¯å¾„ã€‚
- en: \[ f(x_2=60) = \frac{60}{100} \left[ \frac{15}{60} \times 20 + \frac{45}{60}
    \times 70 \right] + \frac{40}{100} \left[130\right] = 86.5 \]\[ f(x_2=60) = 86.5
    \]
  id: totrans-778
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f(x_2=60) = \frac{60}{100} \left[ \frac{15}{60} \times 20 + \frac{45}{60}
    \times 70 \right] + \frac{40}{100} \left[130\right] = 86.5 \]\[ f(x_2=60) = 86.5
    \]
- en: Load the Required Libraries
  id: totrans-779
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åŠ è½½æ‰€éœ€çš„åº“
- en: We will also need some standard packages. These should have been installed with
    Anaconda 3.
  id: totrans-780
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›æ ‡å‡†åŒ…ã€‚è¿™äº›åº”è¯¥å·²ç»ä¸ Anaconda 3 ä¸€èµ·å®‰è£…ã€‚
- en: '[PRE39]'
  id: totrans-781
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: If you get a package import error, you may have to first install some of these
    packages. This can usually be accomplished by opening up a command window on Windows
    and then typing â€˜python -m pip install [package-name]â€™. More assistance is available
    with the respective package docs.
  id: totrans-782
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ‚¨é‡åˆ°åŒ…å¯¼å…¥é”™è¯¯ï¼Œæ‚¨å¯èƒ½å¿…é¡»é¦–å…ˆå®‰è£…è¿™äº›åŒ…ä¸­çš„ä¸€äº›ã€‚è¿™é€šå¸¸å¯ä»¥é€šè¿‡åœ¨ Windows ä¸Šæ‰“å¼€å‘½ä»¤çª—å£ç„¶åè¾“å…¥ â€˜python -m pip install
    [package-name]â€™ æ¥å®Œæˆã€‚æœ‰å…³ç›¸åº”åŒ…çš„æ›´å¤šå¸®åŠ©ï¼Œè¯·å‚é˜…å„è‡ªçš„åŒ…æ–‡æ¡£ã€‚
- en: Declare Functions
  id: totrans-783
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å£°æ˜å‡½æ•°
- en: Letâ€™s define a couple of functions to streamline plotting correlation matrices
    and visualization of a decision tree regression model.
  id: totrans-784
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å®šä¹‰å‡ ä¸ªå‡½æ•°æ¥ç®€åŒ–ç»˜åˆ¶ç›¸å…³çŸ©é˜µå’Œå†³ç­–æ ‘å›å½’æ¨¡å‹çš„å¯è§†åŒ–ã€‚
- en: '[PRE40]'
  id: totrans-785
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Set the Working Directory
  id: totrans-786
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¾ç½®å·¥ä½œç›®å½•
- en: I always like to do this so I donâ€™t lose files and to simplify subsequent read
    and writes (avoid including the full address each time).
  id: totrans-787
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æ€»æ˜¯å–œæ¬¢è¿™æ ·åšï¼Œè¿™æ ·æˆ‘å°±ä¸ä¼šä¸¢å¤±æ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥ç®€åŒ–åç»­çš„è¯»å–å’Œå†™å…¥ï¼ˆæ¯æ¬¡éƒ½é¿å…åŒ…å«å®Œæ•´åœ°å€ï¼‰ã€‚
- en: '[PRE41]'
  id: totrans-788
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: You will have to update the part in quotes with your own working directory and
    the format is different on a Mac (e.g. â€œ~/PGEâ€).
  id: totrans-789
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨å°†ä¸å¾—ä¸æ›´æ–°å¼•å·ä¸­çš„éƒ¨åˆ†ä»¥åŒ…å«æ‚¨è‡ªå·±çš„å·¥ä½œç›®å½•ï¼Œå¹¶ä¸”æ ¼å¼åœ¨ Mac ä¸Šä¸åŒï¼ˆä¾‹å¦‚ï¼Œâ€œ~/PGEâ€ï¼‰ã€‚
- en: Loading Data
  id: totrans-790
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åŠ è½½æ•°æ®
- en: 'Letâ€™s load the provided multivariate, spatial dataset [unconv_MV.csv](https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/unconv_MV.csv)
    available in my GeoDataSet repo. It is a comma delimited file with:'
  id: totrans-791
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åŠ è½½æä¾›çš„å¤šå…ƒã€ç©ºé—´æ•°æ®é›† [unconv_MV.csv](https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/unconv_MV.csv)ï¼Œå®ƒåœ¨æˆ‘çš„
    GeoDataSet ä»“åº“ä¸­å¯ç”¨ã€‚å®ƒæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„æ–‡ä»¶ï¼ŒåŒ…å«ï¼š
- en: well index (integer)
  id: totrans-792
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: äº•æŒ‡æ•°ï¼ˆæ•´æ•°ï¼‰
- en: porosity (%)
  id: totrans-793
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å­”éš™ç‡ï¼ˆ%ï¼‰
- en: permeability (\(mD\))
  id: totrans-794
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¸—é€ç‡ (\(mD\))
- en: acoustic impedance (\(\frac{kg}{m^3} \cdot \frac{m}{s} \cdot 10^6\)).
  id: totrans-795
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å£°æ³¢é˜»æŠ— (\(\frac{kg}{m^3} \cdot \frac{m}{s} \cdot 10^6\))
- en: brittleness (%)
  id: totrans-796
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å²©è„†æ€§ï¼ˆ%ï¼‰
- en: total organic carbon (%)
  id: totrans-797
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ€»æœ‰æœºç¢³ï¼ˆ%ï¼‰
- en: vitrinite reflectance (%)
  id: totrans-798
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç»ç’ƒè´¨åå°„ç‡ï¼ˆ%ï¼‰
- en: initial gas production (90 day average) (MCFPD)
  id: totrans-799
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆå§‹æ°”ä½“äº§é‡ï¼ˆ90 å¤©å¹³å‡ï¼‰(MCFPD)
- en: We load it with the pandas â€˜read_csvâ€™ function into a data frame we called â€˜dfâ€™
    and then preview it to make sure it loaded correctly.
  id: totrans-800
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä½¿ç”¨ pandas çš„ â€˜read_csvâ€™ å‡½æ•°å°†å…¶åŠ è½½åˆ°æˆ‘ä»¬ç§°ä¸º â€˜dfâ€™ çš„æ•°æ®æ¡†ä¸­ï¼Œç„¶åé¢„è§ˆå®ƒä»¥ç¡®ä¿æ­£ç¡®åŠ è½½ã€‚
- en: '**Python Tip: using functions from a package** just type the label for the
    package that we declared at the beginning:'
  id: totrans-801
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python å°è´´å£«ï¼šä½¿ç”¨åŒ…ä¸­çš„å‡½æ•°**åªéœ€è¾“å…¥æˆ‘ä»¬åœ¨å¼€å¤´å£°æ˜çš„åŒ…çš„æ ‡ç­¾ï¼š'
- en: '[PRE42]'
  id: totrans-802
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'so we can access the pandas function â€˜read_csvâ€™ with the command:'
  id: totrans-803
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤è®¿é—® pandas å‡½æ•° â€˜read_csvâ€™ï¼š
- en: '[PRE43]'
  id: totrans-804
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: but read csv has required input parameters. The essential one is the name of
    the file. For our circumstance all the other default parameters are fine. If you
    want to see all the possible parameters for this function, just go to the docs
    [here](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html).
  id: totrans-805
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æ˜¯ï¼Œread csv éœ€è¦è¾“å…¥å‚æ•°ã€‚æœ€é‡è¦çš„æ˜¯æ–‡ä»¶çš„åç§°ã€‚åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å…¶ä»–é»˜è®¤å‚æ•°éƒ½å¾ˆå¥½ã€‚å¦‚æœæ‚¨æƒ³æŸ¥çœ‹æ­¤å‡½æ•°çš„æ‰€æœ‰å¯èƒ½å‚æ•°ï¼Œè¯·è®¿é—®[æ­¤å¤„](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html)çš„æ–‡æ¡£ã€‚
- en: The docs are always helpful
  id: totrans-806
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ–‡æ¡£æ€»æ˜¯å¾ˆæœ‰å¸®åŠ©
- en: There is often a lot of flexibility for Python functions, possible through using
    various inputs parameters
  id: totrans-807
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python å‡½æ•°é€šå¸¸æœ‰å¾ˆå¤šçµæ´»æ€§ï¼Œè¿™å¾—ç›Šäºä½¿ç”¨å„ç§è¾“å…¥å‚æ•°
- en: also, the program has an output, a pandas DataFrame loaded from the data. So
    we have to specify the name / variable representing that new object.
  id: totrans-808
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œç¨‹åºè¿˜æœ‰ä¸€ä¸ªè¾“å‡ºï¼Œä¸€ä¸ªä»æ•°æ®åŠ è½½çš„ pandas DataFrameã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®šä»£è¡¨è¯¥æ–°å¯¹è±¡çš„åç§°/å˜é‡ã€‚
- en: '[PRE44]'
  id: totrans-809
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: Letâ€™s run this command to load the data and then this command to extract a random
    subset of the data.
  id: totrans-810
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬è¿è¡Œè¿™ä¸ªå‘½ä»¤æ¥åŠ è½½æ•°æ®ï¼Œç„¶åè¿è¡Œè¿™ä¸ªå‘½ä»¤æ¥æå–æ•°æ®çš„ä¸€ä¸ªéšæœºå­é›†ã€‚
- en: '[PRE45]'
  id: totrans-811
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Feature Engineering
  id: totrans-812
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç‰¹å¾å·¥ç¨‹
- en: 'Letâ€™s make some changes to the data to improve the workflow:'
  id: totrans-813
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œä¸€äº›ä¿®æ”¹ä»¥æ”¹è¿›å·¥ä½œæµç¨‹ï¼š
- en: '**Select the predictor features (x2) and the response feature (x1)**, make
    sure the metadata is also consistent.'
  id: totrans-814
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**é€‰æ‹©é¢„æµ‹ç‰¹å¾ï¼ˆx2ï¼‰å’Œå“åº”ç‰¹å¾ï¼ˆx1ï¼‰**ï¼Œç¡®ä¿å…ƒæ•°æ®ä¹Ÿä¸€è‡´ã€‚'
- en: '**Metadata** encoding such as the units, labels and display ranges for each
    feature.'
  id: totrans-815
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å…ƒæ•°æ®**ç¼–ç ï¼Œä¾‹å¦‚æ¯ä¸ªç‰¹å¾çš„å•ä½ã€æ ‡ç­¾å’Œæ˜¾ç¤ºèŒƒå›´ã€‚'
- en: '**Reduce the number of data** for ease of visualization (hard to see if too
    many points on our plots).'
  id: totrans-816
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å‡å°‘æ•°æ®æ•°é‡**ä»¥æ–¹ä¾¿å¯è§†åŒ–ï¼ˆå¦‚æœå›¾è¡¨ä¸Šç‚¹å¤ªå¤šï¼Œåˆ™éš¾ä»¥çœ‹æ¸…ï¼‰ã€‚'
- en: '**Train and test data split** to demonstrate and visualize simple hyperparameter
    tuning.'
  id: totrans-817
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²**ä»¥æ¼”ç¤ºå’Œå¯è§†åŒ–ç®€å•çš„è¶…å‚æ•°è°ƒæ•´ã€‚'
- en: '**Add random noise to the data** to demonstrate model overfit. The original
    data is error free and does not readily demonstrate overfit.'
  id: totrans-818
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å‘æ•°æ®æ·»åŠ éšæœºå™ªå£°**ä»¥æ¼”ç¤ºæ¨¡å‹è¿‡æ‹Ÿåˆã€‚åŸå§‹æ•°æ®æ˜¯æ— é”™è¯¯çš„ï¼Œå¹¶ä¸”ä¸èƒ½å¾ˆå¥½åœ°å±•ç¤ºè¿‡æ‹Ÿåˆã€‚'
- en: Given this is properly set, one should be able to use any dataset and features
    for this demonstration.
  id: totrans-819
  prefs: []
  type: TYPE_NORMAL
  zh: ç»™å®šè¿™æ˜¯æ­£ç¡®è®¾ç½®çš„ï¼Œåº”è¯¥èƒ½å¤Ÿä½¿ç”¨ä»»ä½•æ•°æ®é›†å’Œç‰¹å¾è¿›è¡Œæ­¤æ¼”ç¤ºã€‚
- en: for brevity we donâ€™t show any feature selection here. Previous chapter, e.g.,
    k-nearest neighbours include some feature selection methods, but see the feature
    selection chapter for many possible methods with codes for feature selection.
  id: totrans-820
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬è¿™é‡Œä¸å±•ç¤ºä»»ä½•ç‰¹å¾é€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œå‰ä¸€ç« ä¸­çš„k-æœ€è¿‘é‚»åŒ…æ‹¬ä¸€äº›ç‰¹å¾é€‰æ‹©æ–¹æ³•ï¼Œä½†è¯·å‚é˜…ç‰¹å¾é€‰æ‹©ç« èŠ‚ï¼Œä»¥äº†è§£è®¸å¤šå¯èƒ½çš„ç‰¹å¾é€‰æ‹©æ–¹æ³•åŠå…¶ä»£ç ã€‚
- en: 'Optional: Add Random Noise to the Response Feature'
  id: totrans-821
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯é€‰ï¼šå‘å“åº”ç‰¹å¾æ·»åŠ éšæœºå™ªå£°
- en: We can do this to observe the impact of data noise on overfit and hyperparameter
    tuning.
  id: totrans-822
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥è¿™æ ·åšæ¥è§‚å¯Ÿæ•°æ®å™ªå£°å¯¹è¿‡æ‹Ÿåˆå’Œè¶…å‚æ•°è°ƒæ•´çš„å½±å“ã€‚
- en: This is for experiential learning, of course we wouldnâ€™t add random noise to
    our data
  id: totrans-823
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸ºäº†ç»éªŒå­¦ä¹ ï¼Œå½“ç„¶æˆ‘ä»¬ä¸ä¼šå‘æˆ‘ä»¬çš„æ•°æ®æ·»åŠ éšæœºå™ªå£°
- en: We set the random number seed for reproducibility
  id: totrans-824
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è®¾ç½®äº†éšæœºæ•°ç§å­ä»¥ç¡®ä¿å¯é‡å¤æ€§
- en: '[PRE46]'
  id: totrans-825
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: Letâ€™s make sure that we have selected reasonable features to build a model
  id: totrans-826
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ç¡®ä¿æˆ‘ä»¬å·²é€‰æ‹©äº†åˆç†çš„ç‰¹å¾æ¥æ„å»ºæ¨¡å‹
- en: the 2 predictor features are not collinear, as this would result in an unstable
    prediction model
  id: totrans-827
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸¤ä¸ªé¢„æµ‹ç‰¹å¾ä¸å…±çº¿æ€§ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´é¢„æµ‹æ¨¡å‹ä¸ç¨³å®š
- en: each of the features are related to the response feature, the predictor features
    inform the response
  id: totrans-828
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¯ä¸ªç‰¹å¾éƒ½ä¸å“åº”ç‰¹å¾ç›¸å…³ï¼Œé¢„æµ‹ç‰¹å¾é€šçŸ¥å“åº”
- en: Calculate the Correlation Matrix and Correlation with Response Ranking
  id: totrans-829
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¡ç®—ç›¸å…³çŸ©é˜µå’Œç›¸å…³å“åº”æ’å
- en: Letâ€™s start with correlation analysis. We can calculate and view the correlation
    matrix and correlation to the response features with these previously declared
    functions.
  id: totrans-830
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»ç›¸å…³æ€§åˆ†æå¼€å§‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¹‹å‰å£°æ˜çš„å‡½æ•°è®¡ç®—å¹¶æŸ¥çœ‹ç›¸å…³çŸ©é˜µå’Œå“åº”ç‰¹å¾çš„ç›¸å…³æ€§ã€‚
- en: correlation analysis is based on the assumption of linear relationships, but
    it is a good start
  id: totrans-831
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç›¸å…³æ€§åˆ†æåŸºäºçº¿æ€§å…³ç³»çš„å‡è®¾ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªè‰¯å¥½çš„èµ·ç‚¹
- en: '[PRE47]'
  id: totrans-832
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: '![_images/152d837d72f43ba9a48527a444d81b3bbc73a2ba553d2760d27f5c20206ea0b2.png](../Images/fe078f42023f81da1972474b1d3bbf26.png)'
  id: totrans-833
  prefs: []
  type: TYPE_IMG
  zh: '![_images/152d837d72f43ba9a48527a444d81b3bbc73a2ba553d2760d27f5c20206ea0b2.png](../Images/fe078f42023f81da1972474b1d3bbf26.png)'
- en: Note the 1.0 diagonal resulting from the correlation of each variable with themselves.
  id: totrans-834
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ç”±äºæ¯ä¸ªå˜é‡ä¸å…¶è‡ªèº«ç›¸å…³è€Œäº§ç”Ÿçš„1.0å¯¹è§’çº¿ã€‚
- en: This looks good. There is a mix of correlation magnitudes. Of course, correlation
    coefficients are limited to degree of linear correlations.
  id: totrans-835
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™çœ‹èµ·æ¥ä¸é”™ã€‚å­˜åœ¨ä¸åŒç¨‹åº¦çš„ç›¸å…³æ€§ã€‚å½“ç„¶ï¼Œç›¸å…³ç³»æ•°ä»…é™äºçº¿æ€§ç›¸å…³ç¨‹åº¦ã€‚
- en: Letâ€™s look at the matrix scatter plot to see the pairwise relationship between
    the features.
  id: totrans-836
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹çœ‹çŸ©é˜µæ•£ç‚¹å›¾ï¼Œä»¥äº†è§£ç‰¹å¾ä¹‹é—´çš„æˆå¯¹å…³ç³»ã€‚
- en: '[PRE48]'
  id: totrans-837
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '![_images/8d03fa748bcc76aea92c8e57b5fb8071473e84b910d1402f5fd62dd21b102145.png](../Images/515a70a53d49c49c9ecf98249cd67b5d.png)'
  id: totrans-838
  prefs: []
  type: TYPE_IMG
  zh: '![_images/8d03fa748bcc76aea92c8e57b5fb8071473e84b910d1402f5fd62dd21b102145.png](../Images/515a70a53d49c49c9ecf98249cd67b5d.png)'
- en: Train and Test Split
  id: totrans-839
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²
- en: For convenience and simplicity we use scikit-learnâ€™s random train and test split.
  id: totrans-840
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ–¹ä¾¿å’Œç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨scikit-learnçš„éšæœºè®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²ã€‚
- en: '[PRE49]'
  id: totrans-841
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Visualize the DataFrame
  id: totrans-842
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯è§†åŒ–DataFrame
- en: Visualizing the train and test DataFrame is useful check before we build our
    models.
  id: totrans-843
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æˆ‘ä»¬æ„å»ºæ¨¡å‹ä¹‹å‰ï¼Œå¯è§†åŒ–è®­ç»ƒå’Œæµ‹è¯•DataFrameæ˜¯æœ‰ç”¨çš„æ£€æŸ¥ã€‚
- en: many things can go wrong, e.g., we loaded the wrong data, all the features did
    not load, etc.
  id: totrans-844
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®¸å¤šäº‹æƒ…å¯èƒ½ä¼šå‡ºé”™ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬åŠ è½½äº†é”™è¯¯çš„æ•°æ®ï¼Œæ‰€æœ‰ç‰¹å¾éƒ½æ²¡æœ‰åŠ è½½ç­‰ã€‚
- en: We can preview by utilizing the â€˜headâ€™ DataFrame member function (with a nice
    and clean format, see below).
  id: totrans-845
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨â€˜headâ€™ DataFrameæˆå‘˜å‡½æ•°ï¼ˆæ ¼å¼æ•´æ´ã€ç¾è§‚ï¼Œè§ä¸‹æ–‡ï¼‰æ¥é¢„è§ˆã€‚
- en: '[PRE50]'
  id: totrans-846
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: '[PRE51]'
  id: totrans-847
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: '|  | Por | Brittle | Production |'
  id: totrans-848
  prefs: []
  type: TYPE_TB
  zh: '|  | Por | Brittle | Production |'
- en: '| --- | --- | --- | --- |'
  id: totrans-849
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| 86 | 12.83 | 29.87 | 2089.258307 |'
  id: totrans-850
  prefs: []
  type: TYPE_TB
  zh: '| 86 | 12.83 | 29.87 | 2089.258307 |'
- en: '| 35 | 17.39 | 56.43 | 5803.596379 |'
  id: totrans-851
  prefs: []
  type: TYPE_TB
  zh: '| 35 | 17.39 | 56.43 | 5803.596379 |'
- en: '| 75 | 12.23 | 40.67 | 3511.348151 |'
  id: totrans-852
  prefs: []
  type: TYPE_TB
  zh: '| 75 | 12.23 | 40.67 | 3511.348151 |'
- en: '| 36 | 13.72 | 40.24 | 4004.849870 |'
  id: totrans-853
  prefs: []
  type: TYPE_TB
  zh: '| 36 | 13.72 | 40.24 | 4004.849870 |'
- en: '| 126 | 12.83 | 17.20 | 2712.836372 |'
  id: totrans-854
  prefs: []
  type: TYPE_TB
  zh: '| 126 | 12.83 | 17.20 | 2712.836372 |'
- en: '|  | Por | Brittle | Production |'
  id: totrans-855
  prefs: []
  type: TYPE_TB
  zh: '|  | Por | Brittle | Production |'
- en: '| --- | --- | --- | --- |'
  id: totrans-856
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| 5 | 15.55 | 58.25 | 5353.761093 |'
  id: totrans-857
  prefs: []
  type: TYPE_TB
  zh: '| 5 | 15.55 | 58.25 | 5353.761093 |'
- en: '| 46 | 20.21 | 23.78 | 4387.577571 |'
  id: totrans-858
  prefs: []
  type: TYPE_TB
  zh: '| 46 | 20.21 | 23.78 | 4387.577571 |'
- en: '| 96 | 15.07 | 39.39 | 4412.135054 |'
  id: totrans-859
  prefs: []
  type: TYPE_TB
  zh: '| 96 | 15.07 | 39.39 | 4412.135054 |'
- en: '| 45 | 12.10 | 63.24 | 3654.779704 |'
  id: totrans-860
  prefs: []
  type: TYPE_TB
  zh: '| 45 | 12.10 | 63.24 | 3654.779704 |'
- en: '| 105 | 19.54 | 37.40 | 5251.551624 |'
  id: totrans-861
  prefs: []
  type: TYPE_TB
  zh: '| 105 | 19.54 | 37.40 | 5251.551624 |'
- en: Summary Statistics for Tabular Data
  id: totrans-862
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è¡¨æ ¼æ•°æ®çš„æ‘˜è¦ç»Ÿè®¡ã€‚
- en: There are a lot of efficient methods to calculate summary statistics from tabular
    data in DataFrames.
  id: totrans-863
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰å¾ˆå¤šæœ‰æ•ˆçš„æ–¹æ³•å¯ä»¥ä»DataFrameä¸­çš„è¡¨æ ¼æ•°æ®è®¡ç®—æ‘˜è¦ç»Ÿè®¡ã€‚
- en: The describe command provides count, mean, minimum, maximum in a nice data table.
  id: totrans-864
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: describeå‘½ä»¤æä¾›äº†ä¸€ä¸ªç¾è§‚çš„æ•°æ®è¡¨ï¼Œæä¾›äº†è®¡æ•°ã€å¹³å‡å€¼ã€æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚
- en: '[PRE52]'
  id: totrans-865
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: '[PRE53]'
  id: totrans-866
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: '|  | Por | Brittle | Production |'
  id: totrans-867
  prefs: []
  type: TYPE_TB
  zh: '|  | Por | Brittle | Production |'
- en: '| --- | --- | --- | --- |'
  id: totrans-868
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| count | 105.000000 | 105.000000 | 105.000000 |'
  id: totrans-869
  prefs: []
  type: TYPE_TB
  zh: '| è®¡æ•° | 105.000000 | 105.000000 | 105.000000 |'
- en: '| mean | 14.859238 | 48.861143 | 4238.554591 |'
  id: totrans-870
  prefs: []
  type: TYPE_TB
  zh: '| å¹³å‡å€¼ | 14.859238 | 48.861143 | 4238.554591 |'
- en: '| std | 3.057228 | 14.432050 | 1087.707113 |'
  id: totrans-871
  prefs: []
  type: TYPE_TB
  zh: '| æ ‡å‡†å·® | 3.057228 | 14.432050 | 1087.707113 |'
- en: '| min | 7.220000 | 10.940000 | 1517.373571 |'
  id: totrans-872
  prefs: []
  type: TYPE_TB
  zh: '| æœ€å°å€¼ | 7.220000 | 10.940000 | 1517.373571 |'
- en: '| max | 23.550000 | 84.330000 | 6907.632261 |'
  id: totrans-873
  prefs: []
  type: TYPE_TB
  zh: '| æœ€å¤§å€¼ | 23.550000 | 84.330000 | 6907.632261 |'
- en: '|  | Por | Brittle | Production |'
  id: totrans-874
  prefs: []
  type: TYPE_TB
  zh: '|  | Por | Brittle | Production |'
- en: '| --- | --- | --- | --- |'
  id: totrans-875
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| count | 35.000000 | 35.000000 | 35.000000 |'
  id: totrans-876
  prefs: []
  type: TYPE_TB
  zh: '| è®¡æ•° | 35.000000 | 35.000000 | 35.000000 |'
- en: '| mean | 15.011714 | 46.798286 | 4378.913131 |'
  id: totrans-877
  prefs: []
  type: TYPE_TB
  zh: '| å¹³å‡å€¼ | 15.011714 | 46.798286 | 4378.913131 |'
- en: '| std | 3.574467 | 13.380910 | 1290.216113 |'
  id: totrans-878
  prefs: []
  type: TYPE_TB
  zh: '| æ ‡å‡†å·® | 3.574467 | 13.380910 | 1290.216113 |'
- en: '| min | 6.550000 | 20.120000 | 1846.027145 |'
  id: totrans-879
  prefs: []
  type: TYPE_TB
  zh: '| æœ€å°å€¼ | 6.550000 | 20.120000 | 1846.027145 |'
- en: '| max | 20.860000 | 68.760000 | 6593.447893 |'
  id: totrans-880
  prefs: []
  type: TYPE_TB
  zh: '| æœ€å¤§å€¼ | 20.860000 | 68.760000 | 6593.447893 |'
- en: It is good that we checked the summary statistics.
  id: totrans-881
  prefs: []
  type: TYPE_NORMAL
  zh: æ£€æŸ¥æ‘˜è¦ç»Ÿè®¡æ˜¯ä»¶å¥½äº‹ã€‚
- en: there are no obvious issues
  id: totrans-882
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ²¡æœ‰æ˜æ˜¾çš„å¼‚å¸¸ã€‚
- en: check out the range of values for each feature to set up and adjust plotting
    limits. See above.
  id: totrans-883
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ£€æŸ¥æ¯ä¸ªç‰¹å¾å€¼çš„èŒƒå›´ï¼Œä»¥è®¾ç½®å’Œè°ƒæ•´ç»˜å›¾é™åˆ¶ã€‚è§ä¸Šæ–‡ã€‚
- en: Visualize the Train and Test Splits
  id: totrans-884
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯è§†åŒ–è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²ã€‚
- en: Letâ€™s check the consistency and coverage of training and testing with histograms
    and scatter plots.
  id: totrans-885
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬é€šè¿‡ç›´æ–¹å›¾å’Œæ•£ç‚¹å›¾æ£€æŸ¥è®­ç»ƒå’Œæµ‹è¯•çš„ä¸€è‡´æ€§å’Œè¦†ç›–ç‡ã€‚
- en: check to make sure the training and testing cover the range of possible feature
    combinations
  id: totrans-886
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ£€æŸ¥ä»¥ç¡®ä¿è®­ç»ƒå’Œæµ‹è¯•æ¶µç›–äº†å¯èƒ½çš„ç‰¹å¾ç»„åˆèŒƒå›´ã€‚
- en: ensure we are not extrapolating beyond the training data with the testing cases
  id: totrans-887
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç¡®ä¿æµ‹è¯•æ¡ˆä¾‹ä¸ä¼šè¶…å‡ºè®­ç»ƒæ•°æ®çš„èŒƒå›´è¿›è¡Œå¤–æ¨ã€‚
- en: '[PRE54]'
  id: totrans-888
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: '![_images/7f95232f4bccd970cd69b500c8930cfffaf4ffd9a243b7aea1e184337ba9175d.png](../Images/3e84676c9f7f37dcabed4194a238047f.png)'
  id: totrans-889
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/3e84676c9f7f37dcabed4194a238047f.png)'
- en: Sometimes I find it more convenient to compare distributions by looking at CDFâ€™s
    instead of histograms.
  id: totrans-890
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰æ—¶æˆ‘å‘ç°é€šè¿‡æŸ¥çœ‹ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰è€Œä¸æ˜¯ç›´æ–¹å›¾æ¥æ¯”è¾ƒåˆ†å¸ƒæ›´æ–¹ä¾¿ã€‚
- en: we avoid the arbitrary choice of histogram bin size, because CDFâ€™s are at the
    data resolution.
  id: totrans-891
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬é¿å…é€‰æ‹©ç›´æ–¹å›¾æŸ±çŠ¶å¤§å°çš„ä»»æ„æ€§ï¼Œå› ä¸ºç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰ä¸æ•°æ®åˆ†è¾¨ç‡ä¸€è‡´ã€‚
- en: '[PRE55]'
  id: totrans-892
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: '![_images/846daf6f4bcdece7bb39d2b1b9c385e351fbcf923d9599f41f5c7a4c3639c3dc.png](../Images/89d70d18d70c546bb0ac8c55112e894e.png)'
  id: totrans-893
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/89d70d18d70c546bb0ac8c55112e894e.png)'
- en: Once again, the distributions are well behaved,
  id: totrans-894
  prefs: []
  type: TYPE_NORMAL
  zh: å†æ¬¡å¼ºè°ƒï¼Œåˆ†å¸ƒæƒ…å†µè‰¯å¥½ï¼Œ
- en: we cannot observe obvious gaps nor truncations.
  id: totrans-895
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ— æ³•è§‚å¯Ÿåˆ°æ˜æ˜¾çš„é—´éš™æˆ–æˆªæ–­ã€‚
- en: check coverage of the train and test data
  id: totrans-896
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ£€æŸ¥è®­ç»ƒå’Œæµ‹è¯•æ•°æ®çš„è¦†ç›–ç‡ã€‚
- en: Letâ€™s look at a scatter plot of Porosity vs. Brittleness with points colored
    by Production.
  id: totrans-897
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹çœ‹å­”éš™ç‡ä¸è„†æ€§ä¹‹é—´çš„æ•£ç‚¹å›¾ï¼Œç‚¹æ ¹æ®ç”Ÿäº§é‡ç€è‰²ã€‚
- en: '[PRE56]'
  id: totrans-898
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: '![_images/a0a42ff41b36629afd1b47ee725006868db8d0038504ccf72d1f966ac5e69281.png](../Images/3ec3d66453c69d41e8b4c7a2508530a0.png)'
  id: totrans-899
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/3ec3d66453c69d41e8b4c7a2508530a0.png)'
- en: This problem looks complicated and could not be modeled with simple linear regression.
    It appears that there are non-linearities. Letâ€™s use a simple nonparametric model,
    decision tree.
  id: totrans-900
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªé—®é¢˜çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œæ— æ³•ç”¨ç®€å•çš„çº¿æ€§å›å½’å»ºæ¨¡ã€‚ä¼¼ä¹å­˜åœ¨éçº¿æ€§ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„éå‚æ•°æ¨¡å‹ï¼Œå†³ç­–æ ‘ã€‚
- en: Instantiate, Fit and Predict with scikit-learn
  id: totrans-901
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä½¿ç”¨scikit-learnå®ä¾‹åŒ–ã€æ‹Ÿåˆå’Œé¢„æµ‹ã€‚
- en: Letâ€™s build our predictive machine learning model, by instantiate, fit and predict
    with scikit-learn.
  id: totrans-902
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬é€šè¿‡å®ä¾‹åŒ–ã€æ‹Ÿåˆå’Œé¢„æµ‹æ¥æ„å»ºæˆ‘ä»¬çš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä½¿ç”¨scikit-learnã€‚
- en: '**instantiate** the model object with the hyperparameters, k-nearest neighbours'
  id: totrans-903
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å®ä¾‹åŒ–**æ¨¡å‹å¯¹è±¡ï¼Œä½¿ç”¨è¶…å‚æ•°ï¼Œk-æœ€è¿‘é‚»ã€‚'
- en: '**fit** by training the model with the training data, we use the member function
    fit'
  id: totrans-904
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ‹Ÿåˆ**é€šè¿‡ä½¿ç”¨è®­ç»ƒæ•°æ®è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æˆå‘˜å‡½æ•°fitã€‚'
- en: '**predict** with the trained model. After fit is run, predict is available
    to make predictions'
  id: totrans-905
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**é¢„æµ‹**ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹ã€‚è¿è¡Œfitåï¼Œpredictå¯ç”¨äºè¿›è¡Œé¢„æµ‹ã€‚'
- en: Training a Decision Tree (Regression Tree)
  id: totrans-906
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®­ç»ƒå†³ç­–æ ‘ï¼ˆå›å½’æ ‘ï¼‰ã€‚
- en: Now we are ready to run the DecisionTreeRegressor command to build our regression
    tree to predict our response feature given our 2 predictor features (recall we
    limit ourselves here to 2 predictor features for ease of visualization).
  id: totrans-907
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½è¿è¡Œ DecisionTreeRegressor å‘½ä»¤æ¥æ„å»ºæˆ‘ä»¬çš„å›å½’æ ‘ï¼Œä»¥é¢„æµ‹æˆ‘ä»¬çš„å“åº”ç‰¹å¾ï¼Œç»™å®šæˆ‘ä»¬çš„ 2 ä¸ªé¢„æµ‹ç‰¹å¾ï¼ˆè®°ä½ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œé™åˆ¶è‡ªå·±ä½¿ç”¨
    2 ä¸ªé¢„æµ‹ç‰¹å¾ä»¥ç®€åŒ–å¯è§†åŒ–ï¼‰ã€‚
- en: We will use our two functions defined above to visualize the decision tree prediction
    over the feature space and the cross plot of actual and estimated production for
    the training data along with three model metrics from the sklearn.metric module.
  id: totrans-908
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ä¸¤ä¸ªå‡½æ•°æ¥å¯è§†åŒ–å†³ç­–æ ‘åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„é¢„æµ‹ä»¥åŠè®­ç»ƒæ•°æ®çš„å®é™…å’Œä¼°è®¡ç”Ÿäº§çš„äº¤å‰å›¾ï¼Œä»¥åŠæ¥è‡ª sklearn.metric æ¨¡å—çš„ä¸‰ç§æ¨¡å‹åº¦é‡ã€‚
- en: '**Hyper Parameters** - we constrain our tree complexity with:'
  id: totrans-909
  prefs: []
  type: TYPE_NORMAL
  zh: '**è¶…å‚æ•°** - æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹æ–¹å¼é™åˆ¶æ ‘çš„å¤æ‚æ€§ï¼š'
- en: '*max_leaf_nodes* - maximum number of regions, also called terminal or lead
    nodes in the decision tree'
  id: totrans-910
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*max_leaf_nodes* - æœ€å¤§åŒºåŸŸæ•°ï¼Œä¹Ÿç§°ä¸ºå†³ç­–æ ‘ä¸­çš„ç»ˆç«¯æˆ–é¢†å…ˆèŠ‚ç‚¹'
- en: '*max_depth* - maximum number of levels, e.g., max_depth = 1 is a stump tree
    with only 1 decision and two regions'
  id: totrans-911
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*max_depth* - æœ€å¤§å±‚æ•°ï¼Œä¾‹å¦‚ï¼Œmax_depth = 1 æ˜¯ä¸€ä¸ªåªæœ‰ 1 ä¸ªå†³ç­–å’Œä¸¤ä¸ªåŒºåŸŸçš„æ ‘æ¡©æ ‘'
- en: '*min_samples_leaf* - minimum number of data in a new region, good constraint
    to ensure each region has enough data to make a reasonable estimate'
  id: totrans-912
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*min_samples_leaf* - æ–°åŒºåŸŸä¸­çš„æœ€å°æ•°æ®é‡ï¼Œæ˜¯ç¡®ä¿æ¯ä¸ªåŒºåŸŸæœ‰è¶³å¤Ÿæ•°æ®åšå‡ºåˆç†ä¼°è®¡çš„è‰¯å¥½çº¦æŸ'
- en: For now lets just try out some hyperparameters.
  id: totrans-913
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰ï¼Œè®©æˆ‘ä»¬å°è¯•ä¸€äº›è¶…å‚æ•°ã€‚
- en: Underfit Decision Tree Model
  id: totrans-914
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ¬ æ‹Ÿåˆå†³ç­–æ ‘æ¨¡å‹
- en: Letâ€™s use too few regions, set max_leaf_nodes too small and see the resulting
    decision tree model.
  id: totrans-915
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä½¿ç”¨å¤ªå°‘çš„åŒºåŸŸï¼Œè®¾ç½® max_leaf_nodes å¤ªå°ï¼Œçœ‹çœ‹ç»“æœå†³ç­–æ ‘æ¨¡å‹ã€‚
- en: '[PRE57]'
  id: totrans-916
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: '![_images/de9bb85033f26085feea46a1ec5a5786ccbe3d092bb940c53d319584063a39c7.png](../Images/be259c4cb62524490823c4f4d2d09c0c.png)'
  id: totrans-917
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/be259c4cb62524490823c4f4d2d09c0c.png)'
- en: This model is very much underfit, it is too simple to fit the shape of the prediction
    problem. Hereâ€™s some more information on the plot.
  id: totrans-918
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªæ¨¡å‹éå¸¸æ¬ æ‹Ÿåˆï¼Œå®ƒå¤ªç®€å•äº†ï¼Œæ— æ³•æ‹Ÿåˆé¢„æµ‹é—®é¢˜çš„å½¢çŠ¶ã€‚ä»¥ä¸‹æ˜¯å…³äºå›¾è¡¨çš„ä¸€äº›æ›´å¤šä¿¡æ¯ã€‚
- en: See the horizontal lines on the plot of estimated vs. actual production (plot
    on the bottom)?
  id: totrans-919
  prefs: []
  type: TYPE_NORMAL
  zh: è¯·çœ‹ä¼°è®¡ç”Ÿäº§ä¸å®é™…ç”Ÿäº§å¯¹æ¯”å›¾ï¼ˆåº•éƒ¨å›¾è¡¨ï¼‰ä¸Šçš„æ°´å¹³çº¿ï¼Ÿ
- en: That is expected as the regression tree estimates with the average of the data
    in each region of the feature space (terminal node).
  id: totrans-920
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™æ˜¯å¯ä»¥é¢„æ–™çš„ï¼Œå› ä¸ºå›å½’æ ‘ä½¿ç”¨ç‰¹å¾ç©ºé—´æ¯ä¸ªåŒºåŸŸï¼ˆç»ˆç«¯èŠ‚ç‚¹ï¼‰çš„æ•°æ®çš„å¹³å‡å€¼è¿›è¡Œä¼°è®¡ã€‚
- en: To further assess the model performance, I have included the actual response
    P10, mean and P90 for each leaf node, region for both training and testing.
  id: totrans-921
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸ºäº†è¿›ä¸€æ­¥è¯„ä¼°æ¨¡å‹æ€§èƒ½ï¼Œæˆ‘åŒ…æ‹¬äº†æ¯ä¸ªå¶èŠ‚ç‚¹ã€åŒºåŸŸçš„å®é™…å“åº” P10ã€å¹³å‡å€¼å’Œ P90ï¼Œå¯¹äºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®ã€‚
- en: underfit predictive machine learning models have poor accuracy and training
    and testing.
  id: totrans-922
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¬ æ‹Ÿåˆçš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹åœ¨è®­ç»ƒå’Œæµ‹è¯•ä¸­å‡†ç¡®åº¦éƒ½å·®ã€‚
- en: If we have a more complicated tree with more terminal nodes then there would
    be more lines.
  id: totrans-923
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªæ›´å¤æ‚çš„æ ‘ï¼Œæœ‰æ›´å¤šçš„ç»ˆç«¯èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰æ›´å¤šçš„çº¿ã€‚
- en: Overfit Decision Tree Model
  id: totrans-924
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: è¿‡åº¦æ‹Ÿåˆå†³ç­–æ ‘æ¨¡å‹
- en: Letâ€™s use too many regions, set max_leaf_nodes too large and see the resulting
    decision tree model.
  id: totrans-925
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä½¿ç”¨å¤ªå¤šçš„åŒºåŸŸï¼Œè®¾ç½® max_leaf_nodes å¤ªå¤§ï¼Œçœ‹çœ‹ç»“æœå†³ç­–æ ‘æ¨¡å‹ã€‚
- en: '[PRE58]'
  id: totrans-926
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: '![_images/b64f9666026f63544dd4662412c50db7132cd58f19c828937a4e3bbfa9366dc6.png](../Images/c28519e97623d45a6f72540a6b408c6d.png)'
  id: totrans-927
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/c28519e97623d45a6f72540a6b408c6d.png)'
- en: Now we have an overfit predictive machine learning model.
  id: totrans-928
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¬ æ‹Ÿåˆçš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚
- en: too much complexity and flexibility
  id: totrans-929
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿‡å¤šçš„å¤æ‚æ€§å’Œçµæ´»æ€§
- en: we are fitting the noise in the data
  id: totrans-930
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ­£åœ¨æ‹Ÿåˆæ•°æ®ä¸­çš„å™ªå£°
- en: good accuracy in training, but poor accuracy in testing
  id: totrans-931
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®­ç»ƒæ—¶å‡†ç¡®åº¦è‰¯å¥½ï¼Œä½†æµ‹è¯•æ—¶å‡†ç¡®åº¦å·®
- en: It is instructive to observe the decision tree model over the feature space
    as we incrementally add terminal nodes. We can graphically observe the hierarchical
    binary splitting quite clearly.
  id: totrans-932
  prefs: []
  type: TYPE_NORMAL
  zh: éšç€æˆ‘ä»¬é€æ­¥æ·»åŠ ç»ˆç«¯èŠ‚ç‚¹ï¼Œè§‚å¯Ÿå†³ç­–æ ‘æ¨¡å‹åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„è¡¨ç°æ˜¯æœ‰æ•™è‚²æ„ä¹‰çš„ã€‚æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°å›¾å½¢åŒ–åœ°è§‚å¯Ÿåˆ°åˆ†å±‚äºŒåˆ†åˆ†å‰²ã€‚
- en: Letâ€™s visualize from simple complicated models.
  id: totrans-933
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»ç®€å•çš„å¤æ‚æ¨¡å‹å¼€å§‹å¯è§†åŒ–ã€‚
- en: '[PRE59]'
  id: totrans-934
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: '![_images/b066c86d94043d639bf7b5305f612745b8a64d2920e129e3f924e8deaac2ab67.png](../Images/43008585fa66e722cde17f42284274b4.png)'
  id: totrans-935
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/43008585fa66e722cde17f42284274b4.png)'
- en: It may be useful to look at a decision tree model and the associated decision
    tree, side-by-side.
  id: totrans-936
  prefs: []
  type: TYPE_NORMAL
  zh: å¯èƒ½æœ‰å¿…è¦å¹¶æ’æŸ¥çœ‹å†³ç­–æ ‘æ¨¡å‹å’Œç›¸å…³å†³ç­–æ ‘ã€‚
- en: '[PRE60]'
  id: totrans-937
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: '![_images/fbf5427fe1d098a17a235d28fdd24ff7b7b442c21b958df2b2855e4ffeb66011.png](../Images/de575bff5cbcf3e18e0bc1c385400e3e.png)'
  id: totrans-938
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/de575bff5cbcf3e18e0bc1c385400e3e.png)'
- en: How do we find the best hyperparameters, for the best complexity for optimum
    prediction accuracy for testing? That is hyperparameter tuning.
  id: totrans-939
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°æœ€ä½³çš„è¶…å‚æ•°ï¼Œä»¥è·å¾—æœ€ä½³å¤æ‚æ€§å’Œæµ‹è¯•é¢„æµ‹å‡†ç¡®æ€§çš„æœ€ä½³å€¼ï¼Ÿè¿™å°±æ˜¯è¶…å‚æ•°è°ƒæ•´ã€‚
- en: Underfit Decision Tree Model
  id: totrans-940
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ¬ æ‹Ÿåˆçš„å†³ç­–æ ‘æ¨¡å‹
- en: Letâ€™s use too few regions, set max_leaf_nodes too small and see the resulting
    decision tree model.
  id: totrans-941
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä½¿ç”¨å¤ªå°‘çš„åŒºåŸŸï¼Œè®¾ç½®max_leaf_nodeså¤ªå°ï¼Œçœ‹çœ‹ç»“æœå†³ç­–æ ‘æ¨¡å‹ã€‚
- en: '[PRE61]'
  id: totrans-942
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: '![_images/de9bb85033f26085feea46a1ec5a5786ccbe3d092bb940c53d319584063a39c7.png](../Images/be259c4cb62524490823c4f4d2d09c0c.png)'
  id: totrans-943
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/be259c4cb62524490823c4f4d2d09c0c.png)'
- en: This model is very much underfit, it is too simple to fit the shape of the prediction
    problem. Hereâ€™s some more information on the plot.
  id: totrans-944
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªæ¨¡å‹éå¸¸æ¬ æ‹Ÿåˆï¼Œå®ƒå¤ªç®€å•äº†ï¼Œæ— æ³•æ‹Ÿåˆé¢„æµ‹é—®é¢˜çš„å½¢çŠ¶ã€‚ä»¥ä¸‹æ˜¯å›¾è¡¨ä¸Šçš„æ›´å¤šä¿¡æ¯ã€‚
- en: See the horizontal lines on the plot of estimated vs. actual production (plot
    on the bottom)?
  id: totrans-945
  prefs: []
  type: TYPE_NORMAL
  zh: çœ‹çœ‹ä¼°è®¡å€¼ä¸å®é™…ç”Ÿäº§ï¼ˆåº•éƒ¨å›¾ä¸Šçš„å›¾ï¼‰çš„å¯¹æ¯”å›¾ä¸Šçš„æ°´å¹³çº¿ï¼Ÿ
- en: That is expected as the regression tree estimates with the average of the data
    in each region of the feature space (terminal node).
  id: totrans-946
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™æ˜¯é¢„æœŸçš„ï¼Œå› ä¸ºå›å½’æ ‘ä½¿ç”¨ç‰¹å¾ç©ºé—´ä¸­æ¯ä¸ªåŒºåŸŸçš„å¹³å‡æ•°æ®ï¼ˆç»ˆç«¯èŠ‚ç‚¹ï¼‰è¿›è¡Œä¼°è®¡ã€‚
- en: To further assess the model performance, I have included the actual response
    P10, mean and P90 for each leaf node, region for both training and testing.
  id: totrans-947
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸ºäº†è¿›ä¸€æ­¥è¯„ä¼°æ¨¡å‹æ€§èƒ½ï¼Œæˆ‘åŒ…æ‹¬äº†æ¯ä¸ªå¶èŠ‚ç‚¹ã€åŒºåŸŸåœ¨è®­ç»ƒå’Œæµ‹è¯•ä¸­çš„å®é™…å“åº”P10ã€å¹³å‡å€¼å’ŒP90ã€‚
- en: underfit predictive machine learning models have poor accuracy and training
    and testing.
  id: totrans-948
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¬ æ‹Ÿåˆçš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹åœ¨è®­ç»ƒå’Œæµ‹è¯•ä¸­å‡†ç¡®æ€§å·®ã€‚
- en: If we have a more complicated tree with more terminal nodes then there would
    be more lines.
  id: totrans-949
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªæ›´å¤æ‚çš„æ ‘ï¼Œæœ‰æ›´å¤šçš„ç»ˆç«¯èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰æ›´å¤šçš„çº¿ã€‚
- en: Overfit Decision Tree Model
  id: totrans-950
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: è¿‡æ‹Ÿåˆçš„å†³ç­–æ ‘æ¨¡å‹
- en: Letâ€™s use too many regions, set max_leaf_nodes too large and see the resulting
    decision tree model.
  id: totrans-951
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä½¿ç”¨å¤ªå¤šçš„åŒºåŸŸï¼Œè®¾ç½®max_leaf_nodeså¤ªå¤§ï¼Œçœ‹çœ‹ç»“æœå†³ç­–æ ‘æ¨¡å‹ã€‚
- en: '[PRE62]'
  id: totrans-952
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: '![_images/b64f9666026f63544dd4662412c50db7132cd58f19c828937a4e3bbfa9366dc6.png](../Images/c28519e97623d45a6f72540a6b408c6d.png)'
  id: totrans-953
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/c28519e97623d45a6f72540a6b408c6d.png)'
- en: Now we have an overfit predictive machine learning model.
  id: totrans-954
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªè¿‡åº¦æ‹Ÿåˆçš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚
- en: too much complexity and flexibility
  id: totrans-955
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿‡å¤šçš„å¤æ‚æ€§å’Œçµæ´»æ€§
- en: we are fitting the noise in the data
  id: totrans-956
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ­£åœ¨æ‹Ÿåˆæ•°æ®ä¸­çš„å™ªå£°
- en: good accuracy in training, but poor accuracy in testing
  id: totrans-957
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®­ç»ƒæ—¶çš„å‡†ç¡®æ€§å¥½ï¼Œä½†æµ‹è¯•æ—¶çš„å‡†ç¡®æ€§å·®
- en: It is instructive to observe the decision tree model over the feature space
    as we incrementally add terminal nodes. We can graphically observe the hierarchical
    binary splitting quite clearly.
  id: totrans-958
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬é€æ­¥æ·»åŠ ç»ˆç«¯èŠ‚ç‚¹æ—¶ï¼Œè§‚å¯Ÿå†³ç­–æ ‘æ¨¡å‹åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„å˜åŒ–æ˜¯æœ‰æ•™è‚²æ„ä¹‰çš„ã€‚æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°å›¾å½¢åŒ–åœ°è§‚å¯Ÿåˆ°åˆ†å±‚äºŒåˆ†åˆ†å‰²ã€‚
- en: Letâ€™s visualize from simple complicated models.
  id: totrans-959
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»ç®€å•çš„å¤æ‚æ¨¡å‹å¼€å§‹å¯è§†åŒ–ã€‚
- en: '[PRE63]'
  id: totrans-960
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: '![_images/b066c86d94043d639bf7b5305f612745b8a64d2920e129e3f924e8deaac2ab67.png](../Images/43008585fa66e722cde17f42284274b4.png)'
  id: totrans-961
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/43008585fa66e722cde17f42284274b4.png)'
- en: It may be useful to look at a decision tree model and the associated decision
    tree, side-by-side.
  id: totrans-962
  prefs: []
  type: TYPE_NORMAL
  zh: å¯èƒ½ä¼šæœ‰ç”¨ï¼Œçœ‹çœ‹å†³ç­–æ ‘æ¨¡å‹å’Œç›¸å…³çš„å†³ç­–æ ‘å¹¶æ’ã€‚
- en: '[PRE64]'
  id: totrans-963
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: '![_images/fbf5427fe1d098a17a235d28fdd24ff7b7b442c21b958df2b2855e4ffeb66011.png](../Images/de575bff5cbcf3e18e0bc1c385400e3e.png)'
  id: totrans-964
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/de575bff5cbcf3e18e0bc1c385400e3e.png)'
- en: How do we find the best hyperparameters, for the best complexity for optimum
    prediction accuracy for testing? That is hyperparameter tuning.
  id: totrans-965
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°æœ€ä½³çš„è¶…å‚æ•°ï¼Œä»¥è·å¾—æœ€ä½³å¤æ‚æ€§å’Œæµ‹è¯•é¢„æµ‹å‡†ç¡®æ€§çš„æœ€ä½³å€¼ï¼Ÿè¿™å°±æ˜¯è¶…å‚æ•°è°ƒæ•´ã€‚
- en: Tuning a Decision Tree (Regression Tree)
  id: totrans-966
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è°ƒæ•´å†³ç­–æ ‘ï¼ˆå›å½’æ ‘ï¼‰
- en: Letâ€™s perform hyperparameter tuning. To do this we,
  id: totrans-967
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬è¿›è¡Œè¶…å‚æ•°è°ƒæ•´ã€‚ä¸ºæ­¤æˆ‘ä»¬ï¼Œ
- en: See the range of possible hyperparameter values.
  id: totrans-968
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: çœ‹çœ‹å¯èƒ½çš„è¶…å‚æ•°å€¼èŒƒå›´ã€‚
- en: Loop over the range of possible hyperparameter values.
  id: totrans-969
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åœ¨å¯èƒ½çš„è¶…å‚æ•°å€¼èŒƒå›´å†…å¾ªç¯ã€‚
- en: Train on the training data with the current hyperparameter values.
  id: totrans-970
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨å½“å‰è¶…å‚æ•°å€¼åœ¨è®­ç»ƒæ•°æ®ä¸Šè®­ç»ƒã€‚
- en: Predict at the testing data
  id: totrans-971
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: åœ¨æµ‹è¯•æ•°æ®ä¸Šé¢„æµ‹
- en: Summarize the error over all the testing data
  id: totrans-972
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ€»ç»“æ‰€æœ‰æµ‹è¯•æ•°æ®çš„é”™è¯¯
- en: Select the hyperparameters that minimize the error at for the testing data
  id: totrans-973
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: é€‰æ‹©æœ€å°åŒ–æµ‹è¯•æ•°æ®é”™è¯¯çš„è¶…å‚æ•°
- en: When I teach this to my students, I suggest that this is a model dress rehearsal.
    We add value by making predictions for cases not used to train the model. We want
    the model that performs best for cases not in the training, so we are simulating
    real world use of the model!
  id: totrans-974
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘å‘æˆ‘çš„å­¦ç”Ÿæ•™æˆè¿™ä¸ªæ—¶ï¼Œæˆ‘å»ºè®®è¿™æ˜¯ä¸€ä¸ªæ¨¡å‹å½©æ’ã€‚æˆ‘ä»¬é€šè¿‡ä¸ºæœªç”¨äºè®­ç»ƒæ¨¡å‹çš„æ¡ˆä¾‹åšå‡ºé¢„æµ‹æ¥å¢åŠ ä»·å€¼ã€‚æˆ‘ä»¬å¸Œæœ›æ¨¡å‹åœ¨æœªåœ¨è®­ç»ƒä¸­ä½¿ç”¨çš„æ¡ˆä¾‹ä¸­è¡¨ç°æœ€ä½³ï¼Œå› æ­¤æˆ‘ä»¬æ­£åœ¨æ¨¡æ‹Ÿæ¨¡å‹çš„å®é™…ä¸–ç•Œä½¿ç”¨ï¼
- en: Now letâ€™s do hyperparameter tuning â€˜by-handâ€™, by varying the decision tree complexity
    and find the complexity that minimizes MSE in testing
  id: totrans-975
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡æ‰‹åŠ¨è°ƒæ•´å†³ç­–æ ‘å¤æ‚æ€§æ¥æ‰§è¡Œè¶…å‚æ•°è°ƒæ•´ï¼Œæ‰¾åˆ°ä½¿æµ‹è¯•ä¸­çš„MSEæœ€å°åŒ–çš„å¤æ‚æ€§ã€‚
- en: for simplicity the code below loops only over the maximum leaf nodes hyperparameter
  id: totrans-976
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸ºäº†ç®€å•èµ·è§ï¼Œä¸‹é¢çš„ä»£ç åªéå†æœ€å¤§å¶èŠ‚ç‚¹è¶…å‚æ•°
- en: we set minimum number of samples to 1, and maximum depth to 9 to ensure that
    these hyperparameters will not have any impact (we set them to very complicated
    so they donâ€™t limit the model complexity)
  id: totrans-977
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†æ ·æœ¬çš„æœ€å°æ•°é‡è®¾ç½®ä¸º1ï¼Œæœ€å¤§æ·±åº¦è®¾ç½®ä¸º9ï¼Œä»¥ç¡®ä¿è¿™äº›è¶…å‚æ•°ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ï¼ˆæˆ‘ä»¬å°†å®ƒä»¬è®¾ç½®å¾—éå¸¸å¤æ‚ï¼Œè¿™æ ·å®ƒä»¬å°±ä¸ä¼šé™åˆ¶æ¨¡å‹å¤æ‚æ€§ï¼‰
- en: '[PRE65]'
  id: totrans-978
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: '![_images/27a521f2cbd01b3caec37b95530d68674a6785fa6c061acdac71ea6326a9fe6b.png](../Images/f43c9ad2b759692c2b199e397c735352.png)'
  id: totrans-979
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/f43c9ad2b759692c2b199e397c735352.png)'
- en: It is useful to evaluate the performance of our tree by observing the accuracy
    vs. complexity, with a minimum due to the model variance and model bias trade-off.
  id: totrans-980
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡è§‚å¯Ÿå‡†ç¡®æ€§ä¸å¤æ‚æ€§çš„å…³ç³»ï¼Œè¯„ä¼°æˆ‘ä»¬æ ‘çš„è¡¨ç°æ˜¯æœ‰ç”¨çš„ï¼Œæœ€å°å€¼æ˜¯ç”±äºæ¨¡å‹æ–¹å·®å’Œæ¨¡å‹åå·®æƒè¡¡ã€‚
- en: 'For a more robust result, letâ€™s try k-fold cross validation. sklearn has a
    built in cross validation method called cross_val_score that we can use to:'
  id: totrans-981
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å¾—åˆ°æ›´ç¨³å¥çš„ç»“æœï¼Œè®©æˆ‘ä»¬å°è¯•kæŠ˜äº¤å‰éªŒè¯ã€‚sklearnæœ‰ä¸€ä¸ªå†…ç½®çš„äº¤å‰éªŒè¯æ–¹æ³•ï¼Œç§°ä¸ºcross_val_scoreï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥ï¼š
- en: Apply k-fold approach with iterative separation of training and testing data
  id: totrans-982
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åº”ç”¨kæŠ˜æ–¹æ³•ï¼Œé€šè¿‡è¿­ä»£åˆ†ç¦»è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®
- en: With k=5, we have 20% withheld for testing for each fold
  id: totrans-983
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å½“k=5æ—¶ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªæŠ˜å ä¿ç•™äº†20%çš„æ•°æ®ç”¨äºæµ‹è¯•ã€‚
- en: Automate the model construction, looping over folds and averaging the metric
    of interest
  id: totrans-984
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è‡ªåŠ¨åŒ–æ¨¡å‹æ„å»ºï¼Œéå†æŠ˜å å¹¶å¹³å‡æ„Ÿå…´è¶£çš„æŒ‡æ ‡
- en: Letâ€™s try it out on our trees with variable number of terminal nodes. Note the
    cross validation is set to use 4 processors, but still will likely take a couple
    of minutes to run.
  id: totrans-985
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åœ¨å…·æœ‰å¯å˜ç»ˆç«¯èŠ‚ç‚¹æ•°é‡çš„æ ‘ä¸Šå°è¯•å®ƒã€‚æ³¨æ„äº¤å‰éªŒè¯è®¾ç½®ä¸ºä½¿ç”¨4ä¸ªå¤„ç†å™¨ï¼Œä½†ä»å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ‰èƒ½è¿è¡Œã€‚
- en: '[PRE66]'
  id: totrans-986
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: '![_images/35821438b0adbe9ae455b2e6731dab92e05cf7dfb2dcbaaa8d296ac1c9a18b39.png](../Images/2df3cfa16f6fb36c7bd2a52fe7d20a6d.png)'
  id: totrans-987
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/2df3cfa16f6fb36c7bd2a52fe7d20a6d.png)'
- en: The k-fold cross validation provides a smoother plot of MSE vs. the hyperparameter.
  id: totrans-988
  prefs: []
  type: TYPE_NORMAL
  zh: kæŠ˜äº¤å‰éªŒè¯æä¾›äº†MSEä¸è¶…å‚æ•°çš„æ›´å¹³æ»‘çš„å›¾è¡¨ã€‚
- en: this is accomplished by averaging the MSE over all the folds to reduce sensitivity
    of the metric to specific assignment of training and testing data
  id: totrans-989
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™æ˜¯é€šè¿‡åœ¨æ‰€æœ‰æŠ˜å ä¸Šå¹³å‡MSEæ¥å®Œæˆçš„ï¼Œä»¥å‡å°‘æŒ‡æ ‡å¯¹ç‰¹å®šè®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†é…çš„æ•æ„Ÿæ€§ã€‚
- en: all our train and test cross validation or k-fold cross validation was to get
    this one value, the model **hyperparameter**
  id: totrans-990
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ‰€æœ‰çš„è®­ç»ƒå’Œæµ‹è¯•äº¤å‰éªŒè¯æˆ–kæŠ˜äº¤å‰éªŒè¯éƒ½æ˜¯ä¸ºäº†å¾—åˆ°è¿™ä¸ªå€¼ï¼Œå³æ¨¡å‹çš„**è¶…å‚æ•°**
- en: Build the Final Model
  id: totrans-991
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ„å»ºæœ€ç»ˆæ¨¡å‹
- en: Now letâ€™s take that hyperparameter and train on all the data, this is our **final
    model**
  id: totrans-992
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨è¿™ä¸ªè¶…å‚æ•°åœ¨æ‰€æœ‰æ•°æ®ä¸Šè®­ç»ƒï¼Œè¿™æ˜¯æˆ‘ä»¬**æœ€ç»ˆæ¨¡å‹**
- en: '[PRE67]'
  id: totrans-993
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: '![_images/e85bbd71cc280b9a057d106524b0d1dfca28c6500e32ece594637cde5b8b1dba.png](../Images/608907e2a0d015a0d611204bfa6c41e5.png)'
  id: totrans-994
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/608907e2a0d015a0d611204bfa6c41e5.png)'
- en: We have completed our predictive machine learning model. Now letâ€™s cover a couple
    more decision tree diagnostics.
  id: totrans-995
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å·²ç»å®Œæˆäº†æˆ‘ä»¬çš„é¢„æµ‹æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚ç°åœ¨è®©æˆ‘ä»¬å†ä»‹ç»ä¸€äº›å†³ç­–æ ‘è¯Šæ–­ã€‚
- en: Interrogating Decision Trees
  id: totrans-996
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è¯¢é—®å†³ç­–æ ‘
- en: It may be useful to evaluate for any possible feature combination, the order
    of decision nodes that resulted in the specific prediction. The following function
    provides the list of nodes that the prediction cases passes.
  id: totrans-997
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰å¿…è¦è¯„ä¼°ä»»ä½•å¯èƒ½çš„ç‰¹å¾ç»„åˆï¼Œä»¥åŠå¯¼è‡´ç‰¹å®šé¢„æµ‹çš„å†³ç­–èŠ‚ç‚¹é¡ºåºã€‚ä»¥ä¸‹å‡½æ•°æä¾›äº†é¢„æµ‹æ¡ˆä¾‹é€šè¿‡çš„èŠ‚ç‚¹åˆ—è¡¨ã€‚
- en: '[PRE68]'
  id: totrans-998
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: '[PRE69]'
  id: totrans-999
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: Extracting the Decision Tree Prediction Model as a Function
  id: totrans-1000
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å°†å†³ç­–æ ‘é¢„æµ‹æ¨¡å‹æå–ä¸ºå‡½æ•°
- en: Furthermore it may be useful to convert the decision tree to code, a nested
    set of â€˜ifâ€™ statements.
  id: totrans-1001
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œå°†å†³ç­–æ ‘è½¬æ¢ä¸ºä»£ç ï¼Œä¸€ä¸ªåµŒå¥—çš„â€œifâ€è¯­å¥é›†åˆå¯èƒ½ä¹Ÿå¾ˆæœ‰ç”¨ã€‚
- en: This creates a portable model that could be copied and applied as a standalone
    function.
  id: totrans-1002
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™åˆ›å»ºäº†ä¸€ä¸ªå¯ç§»æ¤çš„æ¨¡å‹ï¼Œå¯ä»¥å¤åˆ¶å¹¶ä½œä¸ºç‹¬ç«‹å‡½æ•°åº”ç”¨ã€‚
- en: Also, one could conveniently interrogate the code version of the tree.
  id: totrans-1003
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿åœ°è¯¢é—®æ ‘çš„ä»£ç ç‰ˆæœ¬ã€‚
- en: We use the previously defined function to do this with our pruned tree.
  id: totrans-1004
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä½¿ç”¨ä¹‹å‰å®šä¹‰çš„å‡½æ•°æ¥å¯¹æˆ‘ä»¬çš„å‰ªææ ‘æ‰§è¡Œæ­¤æ“ä½œã€‚
- en: '[PRE70]'
  id: totrans-1005
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: '[PRE71]'
  id: totrans-1006
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: Decision Tree-based Feature Importance
  id: totrans-1007
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åŸºäºå†³ç­–æ ‘çš„ç‰¹å¾é‡è¦æ€§
- en: 'Feature importance is calculated from a decision trees by summarizing the reduction
    in mean square error through inclusion of each feature and is summarized as:'
  id: totrans-1008
  prefs: []
  type: TYPE_NORMAL
  zh: ç‰¹å¾é‡è¦æ€§æ˜¯é€šè¿‡å†³ç­–æ ‘è®¡ç®—çš„ï¼Œé€šè¿‡åŒ…å«æ¯ä¸ªç‰¹å¾æ¥æ€»ç»“å‡æ–¹è¯¯å·®çš„å‡å°‘ï¼Œå¹¶æ€»ç»“å¦‚ä¸‹ï¼š
- en: \[ FI(x) = \sum_{t \in T_f} \frac{N_t}{N} \Delta_{MSE_t} \]
  id: totrans-1009
  prefs: []
  type: TYPE_NORMAL
  zh: \[ FI(x) = \sum_{t \in T_f} \frac{N_t}{N} \Delta_{MSE_t} \]
- en: where \(T_f\) are all nodes with feature \(x\) as the split, \(N_t\) is the
    number of training samples reaching node \(t\), \(N\) is the total number of samples
    in the dataset and \(\Delta_{MSE_t}\) is the reduction in MSE with the \(t\) split.
  id: totrans-1010
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ \(T_f\) æ˜¯æ‰€æœ‰ä»¥ç‰¹å¾ \(x\) ä½œä¸ºåˆ†å‰²çš„èŠ‚ç‚¹ï¼Œ\(N_t\) æ˜¯è¾¾åˆ°èŠ‚ç‚¹ \(t\) çš„è®­ç»ƒæ ·æœ¬æ•°é‡ï¼Œ\(N\) æ˜¯æ•°æ®é›†ä¸­æ ·æœ¬çš„æ€»æ•°ï¼Œ\(\Delta_{MSE_t}\)
    æ˜¯ \(t\) åˆ†å‰²å¸¦æ¥çš„ MSE å‡å°‘é‡ã€‚
- en: Note, feature importance can be calculated in a similar manner to MSE above
    for the case of classification trees with **Gini Impurity**.
  id: totrans-1011
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œå¯¹äºå…·æœ‰ **Gini ä¸çº¯åº¦**çš„åˆ†ç±»æ ‘ï¼Œç‰¹å¾é‡è¦æ€§å¯ä»¥ä»¥ç±»ä¼¼äºä¸Šè¿° MSE çš„æ–¹å¼è®¡ç®—ã€‚
- en: '[PRE72]'
  id: totrans-1012
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: '![_images/8fcae780c3b59534e28863b5aa7a46545ac1a9e556ab9950e41495b87e7bee49.png](../Images/e7672512b746dfc82482f39bc8c78ddc.png)'
  id: totrans-1013
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/e7672512b746dfc82482f39bc8c78ddc.png)'
- en: Visualize the Model
  id: totrans-1014
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯è§†åŒ–æ¨¡å‹
- en: Letâ€™s take a last look at the graphical representation of our pruned tree.
  id: totrans-1015
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æœ€åçœ‹çœ‹æˆ‘ä»¬ä¿®å‰ªåçš„æ ‘çš„å›¾å½¢è¡¨ç¤ºã€‚
- en: '[PRE73]'
  id: totrans-1016
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: '![_images/67fb9697896ebccb3d2ba5fce562153c671634fd57bdc8739c47227f04785578.png](../Images/dceac0eb1f800b2c21d5e490c1248210.png)'
  id: totrans-1017
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/dceac0eb1f800b2c21d5e490c1248210.png)'
- en: Simple Code to Make a Decision Tree Machine and Calculate a Prediction
  id: totrans-1018
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç®€å•ä»£ç åˆ›å»ºå†³ç­–æ ‘æœºå™¨å¹¶è®¡ç®—é¢„æµ‹
- en: 'To support those just getting started, hereâ€™s a minimal amount of code to:'
  id: totrans-1019
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ”¯æŒåˆå­¦è€…ï¼Œä»¥ä¸‹æ˜¯ä¸€æ®µæœ€å°åŒ–ä»£ç ï¼Œä»¥ï¼š
- en: load the scikit-learn package for decision trees
  id: totrans-1020
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŠ è½½ç”¨äºå†³ç­–æ ‘çš„scikit-learnåŒ…
- en: load data
  id: totrans-1021
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŠ è½½æ•°æ®
- en: instantiate a decision tree with hyperparameters (no tuning is shown)
  id: totrans-1022
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è¶…å‚æ•°å®ä¾‹åŒ–ä¸€ä¸ªå†³ç­–æ ‘ï¼ˆæœªæ˜¾ç¤ºè°ƒæ•´ï¼‰
- en: train the decision tree with the training data
  id: totrans-1023
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è®­ç»ƒæ•°æ®è®­ç»ƒå†³ç­–æ ‘
- en: make a prediction with the decision tree
  id: totrans-1024
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨å†³ç­–æ ‘è¿›è¡Œé¢„æµ‹
- en: '[PRE74]'
  id: totrans-1025
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: '[PRE75]'
  id: totrans-1026
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: Machine Learning Pipelines for Clean, Compact Machine Learning Code
  id: totrans-1027
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ¸…æ´ã€ç´§å‡‘çš„æœºå™¨å­¦ä¹ ä»£ç çš„æœºå™¨å­¦ä¹ ç®¡é“
- en: Pipelines are a scikit-learn class that allows for the encapsulation of a sequence
    of data preparation and modeling steps
  id: totrans-1028
  prefs: []
  type: TYPE_NORMAL
  zh: ç®¡é“æ˜¯scikit-learnä¸­çš„ä¸€ä¸ªç±»ï¼Œå®ƒå…è®¸å°è£…ä¸€ç³»åˆ—æ•°æ®å‡†å¤‡å’Œå»ºæ¨¡æ­¥éª¤
- en: then we can treat the pipeline as an object in our much condensed workflow
  id: totrans-1029
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†ç®¡é“ä½œä¸ºæˆ‘ä»¬é«˜åº¦ç²¾ç®€çš„å·¥ä½œæµç¨‹ä¸­çš„ä¸€ä¸ªå¯¹è±¡æ¥å¤„ç†
- en: 'The pipeline class allows us to:'
  id: totrans-1030
  prefs: []
  type: TYPE_NORMAL
  zh: ç®¡é“ç±»å…è®¸æˆ‘ä»¬ï¼š
- en: improve code readability and to keep everything straight
  id: totrans-1031
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æé«˜ä»£ç å¯è¯»æ€§å¹¶ä¿æŒä¸€åˆ‡äº•ç„¶æœ‰åº
- en: build complete workflows with very few lines of readable code
  id: totrans-1032
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨éå¸¸å°‘çš„å¯è¯»ä»£ç è¡Œæ„å»ºå®Œæ•´çš„æµç¨‹
- en: avoid common workflow problems like data leakage, testing data informing model
    parameter training
  id: totrans-1033
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é¿å…å¸¸è§çš„æµç¨‹é—®é¢˜ï¼Œå¦‚æ•°æ®æ³„éœ²ã€æµ‹è¯•æ•°æ®å½±å“æ¨¡å‹å‚æ•°è®­ç»ƒ
- en: abstract common machine learning modeling and focus on building the best model
    possible
  id: totrans-1034
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æŠ½è±¡å‡ºå¸¸è§çš„æœºå™¨å­¦ä¹ å»ºæ¨¡ï¼Œä¸“æ³¨äºæ„å»ºå°½å¯èƒ½å¥½çš„æ¨¡å‹
- en: The fundamental philosophy is to treat machine learning as a combinatorial search
    to find the best model (AutoML)
  id: totrans-1035
  prefs: []
  type: TYPE_NORMAL
  zh: åŸºæœ¬å“²å­¦æ˜¯å°†æœºå™¨å­¦ä¹ è§†ä¸ºä¸€ç§ç»„åˆæœç´¢ï¼Œä»¥æ‰¾åˆ°æœ€ä½³æ¨¡å‹ï¼ˆAutoMLï¼‰
- en: For more information see my recorded lecture on [Machine Learning Pipelines](https://www.youtube.com/watch?v=tYrPs8s1l9U&list=PLG19vXLQHvSAufDFgZEFAYQEwMJXklnQV&index=5)
    and a well-documented demonstration [Machine Learning Pipeline Workflow](http://localhost:8892/notebooks/OneDrive%20-%20The%20University%20of%20Texas%20at%20Austin/Courses/Workflows/PythonDataBasics_Pipelines.ipynb).
  id: totrans-1036
  prefs: []
  type: TYPE_NORMAL
  zh: æ›´å¤šä¿¡æ¯è¯·å‚é˜…æˆ‘å…³äº [æœºå™¨å­¦ä¹ ç®¡é“](https://www.youtube.com/watch?v=tYrPs8s1l9U&list=PLG19vXLQHvSAufDFgZEFAYQEwMJXklnQV&index=5)
    çš„å½•éŸ³è®²åº§å’Œè¯¦ç»†è®°å½•çš„æ¼”ç¤º [æœºå™¨å­¦ä¹ ç®¡é“å·¥ä½œæµç¨‹](http://localhost:8892/notebooks/OneDrive%20-%20The%20University%20of%20Texas%20at%20Austin/Courses/Workflows/PythonDataBasics_Pipelines.ipynb)ã€‚
- en: '[PRE76]'
  id: totrans-1037
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: '[PRE77]'
  id: totrans-1038
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: Practice on a New Dataset
  id: totrans-1039
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åœ¨æ–°æ•°æ®é›†ä¸Šç»ƒä¹ 
- en: Ok, time to get to work. Letâ€™s load up a dataset and build a decision tree prediction
    model with,
  id: totrans-1040
  prefs: []
  type: TYPE_NORMAL
  zh: å¥½çš„ï¼Œæ˜¯æ—¶å€™å¼€å§‹å·¥ä½œäº†ã€‚è®©æˆ‘ä»¬åŠ è½½ä¸€ä¸ªæ•°æ®é›†å¹¶ä½¿ç”¨ä»¥ä¸‹å†…å®¹æ„å»ºä¸€ä¸ªå†³ç­–æ ‘é¢„æµ‹æ¨¡å‹ï¼Œ
- en: compact code
  id: totrans-1041
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç´§å‡‘çš„ä»£ç 
- en: basic visaulizations
  id: totrans-1042
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åŸºæœ¬å¯è§†åŒ–
- en: save the output
  id: totrans-1043
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¿å­˜è¾“å‡º
- en: You can select any of these datasets or modify the code and add your own to
    do this.
  id: totrans-1044
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨å¯ä»¥é€‰æ‹©è¿™äº›æ•°æ®é›†ä¹‹ä¸€ï¼Œæˆ–ä¿®æ”¹ä»£ç å¹¶æ·»åŠ æ‚¨è‡ªå·±çš„å†…å®¹æ¥å®Œæˆæ­¤æ“ä½œã€‚
- en: Dataset 0, Unconventional Multivariate v4
  id: totrans-1045
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ•°æ®é›† 0ï¼Œéå¸¸è§„å¤šå…ƒ v4
- en: 'Letâ€™s load the provided multivariate, dataset [unconv_MV.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/unconv_MV_v4.csv).
    This dataset has variables from 1,000 unconventional wells including:'
  id: totrans-1046
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åŠ è½½æä¾›çš„å¤šå…ƒæ•°æ®é›† [unconv_MV.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/unconv_MV_v4.csv)ã€‚æ­¤æ•°æ®é›†åŒ…å«æ¥è‡ª1,000ä¸ªéå¸¸è§„äº•çš„å˜é‡ï¼ŒåŒ…æ‹¬ï¼š
- en: well average porosity
  id: totrans-1047
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: äº•å¹³å‡å­”éš™ç‡
- en: log transform of permeability (to linearize the relationships with other variables)
  id: totrans-1048
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¸—é€ç‡çš„å¯¹æ•°å˜æ¢ï¼ˆä»¥çº¿æ€§åŒ–ä¸å…¶ä»–å˜é‡çš„å…³ç³»ï¼‰
- en: acoustic impedance (kg/m^3 x m/s x 10^6)
  id: totrans-1049
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å£°æ³¢é˜»æŠ—ï¼ˆkg/m^3 x m/s x 10^6ï¼‰
- en: brittleness ratio (%)
  id: totrans-1050
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰ªåˆ‡æ¯”ï¼ˆ%ï¼‰
- en: total organic carbon (%)
  id: totrans-1051
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ€»æœ‰æœºç¢³ï¼ˆ%ï¼‰
- en: vitrinite reflectance (%)
  id: totrans-1052
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: çƒƒåå°„ç‡ï¼ˆ%ï¼‰
- en: initial production 90 day average (MCFPD).
  id: totrans-1053
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆå§‹ç”Ÿäº§90å¤©å¹³å‡ï¼ˆMCFPDï¼‰ã€‚
- en: Dataset 2, Reservoir 21
  id: totrans-1054
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ•°æ®é›†2ï¼Œå‚¨å±‚21
- en: 'Letâ€™s load the provided multivariate, 3D spatial dataset [res21_wells.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_wells.csv).
    This dataset has variables from 73 vertical wells over a 10,000m x 10,000m x 50
    m reservoir unit:'
  id: totrans-1055
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åŠ è½½æä¾›çš„å¤šå…ƒï¼Œ3Dç©ºé—´æ•°æ®é›†[res21_wells.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_wells.csv)ã€‚æ­¤æ•°æ®é›†åŒ…å«æ¥è‡ª73å£å‚ç›´äº•åœ¨ä¸€ä¸ª10,000m
    x 10,000m x 50 må‚¨å±‚å•å…ƒçš„å˜é‡ï¼š
- en: well (ID)
  id: totrans-1056
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: äº•ï¼ˆIDï¼‰
- en: X (m), Y (m), Depth (m) location coordinates
  id: totrans-1057
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Xï¼ˆmï¼‰ï¼ŒYï¼ˆmï¼‰ï¼Œæ·±åº¦ï¼ˆmï¼‰ä½ç½®åæ ‡
- en: Porosity (%) after units conversion
  id: totrans-1058
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å•ä½è½¬æ¢åçš„å­”éš™ç‡ï¼ˆ%ï¼‰
- en: Permeability (mD)
  id: totrans-1059
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¸—é€ç‡ï¼ˆmDï¼‰
- en: Acoustic Impedance (kg/m2s*10^6) after units conversion
  id: totrans-1060
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å•ä½è½¬æ¢åçš„å£°é˜»æŠ—ï¼ˆkg/m2s*10^6ï¼‰
- en: Facies (categorical) - ordinal with ordering from Shale, Sandy Shale, Shaley
    Sand, to Sandstone.
  id: totrans-1061
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç›¸ï¼ˆåˆ†ç±»ï¼‰ - æœ‰åºï¼Œä»é¡µå²©ã€æ²™è´¨é¡µå²©ã€é¡µå²©ç ‚åˆ°ç ‚å²©ã€‚
- en: Density (g/cm^3)
  id: totrans-1062
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¯†åº¦ï¼ˆg/cm^3ï¼‰
- en: Compressible velocity (m/s)
  id: totrans-1063
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‹ç¼©é€Ÿåº¦ï¼ˆm/sï¼‰
- en: Youngs modulus (GPa)
  id: totrans-1064
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¨æ°æ¨¡é‡ï¼ˆGPaï¼‰
- en: Shear velocity (m/s)
  id: totrans-1065
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰ªåˆ‡é€Ÿåº¦ï¼ˆm/sï¼‰
- en: Shear modulus (GPa)
  id: totrans-1066
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰ªåˆ‡æ¨¡é‡ï¼ˆGPaï¼‰
- en: 3 year cumulative oil production (Mbbl)
  id: totrans-1067
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 3å¹´ç´¯è®¡æ²¹äº§é‡ï¼ˆMbblï¼‰
- en: We load the tabular data with the pandas â€˜read_csvâ€™ function into a DataFrame
    we called â€˜my_dataâ€™ and then preview it to make sure it loaded correctly.
  id: totrans-1068
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä½¿ç”¨pandasçš„â€˜read_csvâ€™å‡½æ•°å°†è¡¨æ ¼æ•°æ®åŠ è½½åˆ°æˆ‘ä»¬ç§°ä¸ºâ€˜my_dataâ€™çš„DataFrameä¸­ï¼Œç„¶åé¢„è§ˆå®ƒä»¥ç¡®ä¿æ­£ç¡®åŠ è½½ã€‚
- en: we also populate lists with data ranges and labels for ease of plotting
  id: totrans-1069
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜ç”¨æ•°æ®èŒƒå›´å’Œæ ‡ç­¾å¡«å……åˆ—è¡¨ï¼Œä»¥ä¾¿äºç»˜å›¾
- en: Load and format the data,
  id: totrans-1070
  prefs: []
  type: TYPE_NORMAL
  zh: åŠ è½½æ•°æ®å¹¶æ ¼å¼åŒ–ï¼Œ
- en: drop the response feature
  id: totrans-1071
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆ é™¤å“åº”ç‰¹å¾
- en: reformate the features as needed
  id: totrans-1072
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ ¹æ®éœ€è¦é‡æ–°æ ¼å¼åŒ–ç‰¹å¾
- en: also, I like to store the metadata in lists
  id: totrans-1073
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œæˆ‘è¿˜å–œæ¬¢å°†å…ƒæ•°æ®å­˜å‚¨åœ¨åˆ—è¡¨ä¸­
- en: '[PRE78]'
  id: totrans-1074
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: '|  | Por | Perm | AI | Density | PVel | Youngs | SVel | Shear | CumulativeOil
    |'
  id: totrans-1075
  prefs: []
  type: TYPE_TB
  zh: '|  | å­”éš™ç‡ | æ¸—é€ç‡ | AI | å¯†åº¦ | PVel | Youngs | SVel | å‰ªåˆ‡ | ç´¯è®¡æ²¹ |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-1076
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| 1 | 12.907730 | 133.910637 | 7.308846 | 2.146360 | 3563.549461 | 25.688560
    | 1673.770439 | 6.429229 | 1201.20 |'
  id: totrans-1077
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 12.907730 | 133.910637 | 7.308846 | 2.146360 | 3563.549461 | 25.688560
    | 1673.770439 | 6.429229 | 1201.20 |'
- en: '| 7 | 12.647965 | 114.359667 | 7.343836 | 2.188597 | 3570.094553 | 25.444064
    | 1670.043495 | 6.100984 | 683.92 |'
  id: totrans-1078
  prefs: []
  type: TYPE_TB
  zh: '| 7 | 12.647965 | 114.359667 | 7.343836 | 2.188597 | 3570.094553 | 25.444064
    | 1670.043495 | 6.100984 | 683.92 |'
- en: '| 10 | 12.998469 | 129.332122 | 7.282051 | 2.131121 | 3524.448615 | 25.985734
    | 1681.960101 | 6.203527 | 978.14 |'
  id: totrans-1079
  prefs: []
  type: TYPE_TB
  zh: '| 10 | 12.998469 | 129.332122 | 7.282051 | 2.131121 | 3524.448615 | 25.985734
    | 1681.960101 | 6.203527 | 978.14 |'
- en: '| 15 | 12.426141 | 123.227677 | 7.351795 | 2.203026 | 3417.596818 | 25.976462
    | 1675.355860 | 6.288040 | 608.09 |'
  id: totrans-1080
  prefs: []
  type: TYPE_TB
  zh: '| 15 | 12.426141 | 123.227677 | 7.351795 | 2.203026 | 3417.596818 | 25.976462
    | 1675.355860 | 6.288040 | 608.09 |'
- en: '| 16 | 13.507371 | 147.562087 | 7.300360 | 2.210916 | 3476.167397 | 24.817767
    | 1656.890690 | 6.222528 | 1062.10 |'
  id: totrans-1081
  prefs: []
  type: TYPE_TB
  zh: '| 16 | 13.507371 | 147.562087 | 7.300360 | 2.210916 | 3476.167397 | 24.817767
    | 1656.890690 | 6.222528 | 1062.10 |'
- en: '| 36 | 13.309477 | 122.818961 | 7.345220 | 2.178749 | 3346.347661 | 25.436579
    | 1651.679529 | 6.334308 | 539.98 |'
  id: totrans-1082
  prefs: []
  type: TYPE_TB
  zh: '| 36 | 13.309477 | 122.818961 | 7.345220 | 2.178749 | 3346.347661 | 25.436579
    | 1651.679529 | 6.334308 | 539.98 |'
- en: '| 49 | 11.822910 | 98.168307 | 7.386212 | 2.301552 | 3250.020705 | 24.340656
    | 1662.438742 | 6.617267 | 1095.30 |'
  id: totrans-1083
  prefs: []
  type: TYPE_TB
  zh: '| 49 | 11.822910 | 98.168307 | 7.386212 | 2.301552 | 3250.020705 | 24.340656
    | 1662.438742 | 6.617267 | 1095.30 |'
- en: '| 51 | 13.986616 | 132.575456 | 7.194749 | 2.108986 | 3415.255945 | 26.253236
    | 1712.017629 | 5.583251 | 805.49 |'
  id: totrans-1084
  prefs: []
  type: TYPE_TB
  zh: '| 51 | 13.986616 | 132.575456 | 7.194749 | 2.108986 | 3415.255945 | 26.253236
    | 1712.017629 | 5.583251 | 805.49 |'
- en: '| 61 | 14.735895 | 128.201000 | 7.172693 | 1.841786 | 3886.950307 | 28.289950
    | 1672.370150 | 5.044439 | 1146.00 |'
  id: totrans-1085
  prefs: []
  type: TYPE_TB
  zh: '| 61 | 14.735895 | 128.201000 | 7.172693 | 1.841786 | 3886.950307 | 28.289950
    | 1672.370150 | 5.044439 | 1146.00 |'
- en: Build and Check Model
  id: totrans-1086
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ„å»ºå’Œæ£€æŸ¥æ¨¡å‹
- en: We apply the follow steps,
  id: totrans-1087
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åº”ç”¨ä»¥ä¸‹æ­¥éª¤ï¼Œ
- en: specify the K-fold method
  id: totrans-1088
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æŒ‡å®šKæŠ˜æ–¹æ³•
- en: loop over number of leaf nodes, instantiate, fit and record the error
  id: totrans-1089
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: éå†å¶èŠ‚ç‚¹æ•°ï¼Œå®ä¾‹åŒ–ã€æ‹Ÿåˆå¹¶è®°å½•é”™è¯¯
- en: plot the test error vs. number of leaf nodes, select the hyperparameter that
    minimizes test error
  id: totrans-1090
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç»˜åˆ¶æµ‹è¯•è¯¯å·®ä¸å¶èŠ‚ç‚¹æ•°çš„å…³ç³»å›¾ï¼Œé€‰æ‹©æœ€å°åŒ–æµ‹è¯•è¯¯å·®çš„è¶…å‚æ•°
- en: retrain the model with the tuned hyperparameter and all of the data
  id: totrans-1091
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è°ƒæ•´åçš„è¶…å‚æ•°å’Œæ‰€æœ‰æ•°æ®é‡æ–°è®­ç»ƒæ¨¡å‹
- en: '[PRE79]'
  id: totrans-1092
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: '![_images/800e93156a21d23fb27ec3b349cbd0c234a2789e27a8582567a80abbbf0e08b0.png](../Images/a3d66d6b8f851c5edb5b770a5393116c.png)'
  id: totrans-1093
  prefs: []
  type: TYPE_IMG
  zh: '![_images/800e93156a21d23fb27ec3b349cbd0c234a2789e27a8582567a80abbbf0e08b0.png](../Images/a3d66d6b8f851c5edb5b770a5393116c.png)'
- en: Dataset 0, Unconventional Multivariate v4
  id: totrans-1094
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ•°æ®é›†0ï¼Œéå¸¸è§„å¤šå…ƒv4
- en: 'Letâ€™s load the provided multivariate, dataset [unconv_MV.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/unconv_MV_v4.csv).
    This dataset has variables from 1,000 unconventional wells including:'
  id: totrans-1095
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åŠ è½½æä¾›çš„å¤šå…ƒï¼Œ3Dç©ºé—´æ•°æ®é›†[unconv_MV.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/unconv_MV_v4.csv)ã€‚æ­¤æ•°æ®é›†åŒ…å«æ¥è‡ª1,000ä¸ªéå¸¸è§„äº•çš„å˜é‡ï¼š
- en: well average porosity
  id: totrans-1096
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: äº•å¹³å‡å­”éš™ç‡
- en: log transform of permeability (to linearize the relationships with other variables)
  id: totrans-1097
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¸—é€ç‡çš„å¯¹æ•°å˜æ¢ï¼ˆä»¥çº¿æ€§åŒ–ä¸å…¶ä»–å˜é‡çš„å…³ç³»ï¼‰
- en: acoustic impedance (kg/m^3 x m/s x 10^6)
  id: totrans-1098
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å£°é˜»æŠ— (kg/m^3 x m/s x 10^6)
- en: brittleness ratio (%)
  id: totrans-1099
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰ªåˆ‡æ¯” (%)
- en: total organic carbon (%)
  id: totrans-1100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'æ€»æœ‰æœºç¢³ (%) '
- en: vitrinite reflectance (%)
  id: totrans-1101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç»ç’ƒå…‰æ³½ç‡ (%)
- en: initial production 90 day average (MCFPD).
  id: totrans-1102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆå§‹ç”Ÿäº§ 90 å¤©å¹³å‡ (MCFPD)ã€‚
- en: Dataset 2, Reservoir 21
  id: totrans-1103
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ•°æ®é›† 2ï¼Œå‚¨å±‚ 21
- en: 'Letâ€™s load the provided multivariate, 3D spatial dataset [res21_wells.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_wells.csv).
    This dataset has variables from 73 vertical wells over a 10,000m x 10,000m x 50
    m reservoir unit:'
  id: totrans-1104
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åŠ è½½æä¾›çš„å¤šå…ƒã€3D ç©ºé—´æ•°æ®é›† [res21_wells.csv](https://github.com/GeostatsGuy/GeoDataSets/blob/master/res21_wells.csv)ã€‚æ­¤æ•°æ®é›†åŒ…å«æ¥è‡ª
    73 ä¸ªå‚ç›´äº•åœ¨ 10,000m x 10,000m x 50 m å‚¨å±‚å•å…ƒçš„å˜é‡ï¼š
- en: well (ID)
  id: totrans-1105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: äº• (ID)
- en: X (m), Y (m), Depth (m) location coordinates
  id: totrans-1106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: X (m), Y (m), æ·±åº¦ (m) ä½ç½®åæ ‡
- en: Porosity (%) after units conversion
  id: totrans-1107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å•ä½è½¬æ¢åçš„å­”éš™ç‡ (%)
- en: Permeability (mD)
  id: totrans-1108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¸—é€ç‡ (mD)
- en: Acoustic Impedance (kg/m2s*10^6) after units conversion
  id: totrans-1109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å•ä½è½¬æ¢åçš„å£°é˜»æŠ— (kg/m2s*10^6)
- en: Facies (categorical) - ordinal with ordering from Shale, Sandy Shale, Shaley
    Sand, to Sandstone.
  id: totrans-1110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç›¸ (åˆ†ç±») - ä»é¡µå²©ã€ç ‚è´¨é¡µå²©ã€é¡µå²©ç ‚åˆ°ç ‚å²©çš„é¡ºåºã€‚
- en: Density (g/cm^3)
  id: totrans-1111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¯†åº¦ (g/cm^3)
- en: Compressible velocity (m/s)
  id: totrans-1112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¯å‹ç¼©é€Ÿåº¦ (m/s)
- en: Youngs modulus (GPa)
  id: totrans-1113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¨æ°æ¨¡é‡ (GPa)
- en: Shear velocity (m/s)
  id: totrans-1114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰ªåˆ‡é€Ÿåº¦ (m/s)
- en: Shear modulus (GPa)
  id: totrans-1115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰ªåˆ‡æ¨¡é‡ (GPa)
- en: 3 year cumulative oil production (Mbbl)
  id: totrans-1116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 3 å¹´ç´¯è®¡çŸ³æ²¹äº§é‡ (Mbbl)
- en: We load the tabular data with the pandas â€˜read_csvâ€™ function into a DataFrame
    we called â€˜my_dataâ€™ and then preview it to make sure it loaded correctly.
  id: totrans-1117
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä½¿ç”¨ pandas çš„ 'read_csv' å‡½æ•°å°†è¡¨æ ¼æ•°æ®åŠ è½½åˆ°æˆ‘ä»¬ç§°ä¸º 'my_data' çš„ DataFrame ä¸­ï¼Œç„¶åé¢„è§ˆå®ƒä»¥ç¡®ä¿æ­£ç¡®åŠ è½½ã€‚
- en: we also populate lists with data ranges and labels for ease of plotting
  id: totrans-1118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜ç”¨æ•°æ®èŒƒå›´å’Œæ ‡ç­¾å¡«å……åˆ—è¡¨ï¼Œä»¥ä¾¿äºç»˜å›¾
- en: Load and format the data,
  id: totrans-1119
  prefs: []
  type: TYPE_NORMAL
  zh: åŠ è½½æ•°æ®å¹¶æ ¼å¼åŒ–ï¼Œ
- en: drop the response feature
  id: totrans-1120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åˆ é™¤å“åº”ç‰¹å¾
- en: reformate the features as needed
  id: totrans-1121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ ¹æ®éœ€è¦é‡æ–°æ ¼å¼åŒ–ç‰¹å¾
- en: also, I like to store the metadata in lists
  id: totrans-1122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œæˆ‘è¿˜å–œæ¬¢å°†å…ƒæ•°æ®å­˜å‚¨åœ¨åˆ—è¡¨ä¸­
- en: '[PRE80]'
  id: totrans-1123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: '|  | Por | Perm | AI | Density | PVel | Youngs | SVel | Shear | CumulativeOil
    |'
  id: totrans-1124
  prefs: []
  type: TYPE_TB
  zh: '|  | Por | Perm | AI | Density | PVel | Youngs | SVel | Shear | CumulativeOil
    |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-1125
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| 1 | 12.907730 | 133.910637 | 7.308846 | 2.146360 | 3563.549461 | 25.688560
    | 1673.770439 | 6.429229 | 1201.20 |'
  id: totrans-1126
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 12.907730 | 133.910637 | 7.308846 | 2.146360 | 3563.549461 | 25.688560
    | 1673.770439 | 6.429229 | 1201.20 |'
- en: '| 7 | 12.647965 | 114.359667 | 7.343836 | 2.188597 | 3570.094553 | 25.444064
    | 1670.043495 | 6.100984 | 683.92 |'
  id: totrans-1127
  prefs: []
  type: TYPE_TB
  zh: '| 7 | 12.647965 | 114.359667 | 7.343836 | 2.188597 | 3570.094553 | 25.444064
    | 1670.043495 | 6.100984 | 683.92 |'
- en: '| 10 | 12.998469 | 129.332122 | 7.282051 | 2.131121 | 3524.448615 | 25.985734
    | 1681.960101 | 6.203527 | 978.14 |'
  id: totrans-1128
  prefs: []
  type: TYPE_TB
  zh: '| 10 | 12.998469 | 129.332122 | 7.282051 | 2.131121 | 3524.448615 | 25.985734
    | 1681.960101 | 6.203527 | 978.14 |'
- en: '| 15 | 12.426141 | 123.227677 | 7.351795 | 2.203026 | 3417.596818 | 25.976462
    | 1675.355860 | 6.288040 | 608.09 |'
  id: totrans-1129
  prefs: []
  type: TYPE_TB
  zh: '| 15 | 12.426141 | 123.227677 | 7.351795 | 2.203026 | 3417.596818 | 25.976462
    | 1675.355860 | 6.288040 | 608.09 |'
- en: '| 16 | 13.507371 | 147.562087 | 7.300360 | 2.210916 | 3476.167397 | 24.817767
    | 1656.890690 | 6.222528 | 1062.10 |'
  id: totrans-1130
  prefs: []
  type: TYPE_TB
  zh: '| 16 | 13.507371 | 147.562087 | 7.300360 | 2.210916 | 3476.167397 | 24.817767
    | 1656.890690 | 6.222528 | 1062.10 |'
- en: '| 36 | 13.309477 | 122.818961 | 7.345220 | 2.178749 | 3346.347661 | 25.436579
    | 1651.679529 | 6.334308 | 539.98 |'
  id: totrans-1131
  prefs: []
  type: TYPE_TB
  zh: '| 36 | 13.309477 | 122.818961 | 7.345220 | 2.178749 | 3346.347661 | 25.436579
    | 1651.679529 | 6.334308 | 539.98 |'
- en: '| 49 | 11.822910 | 98.168307 | 7.386212 | 2.301552 | 3250.020705 | 24.340656
    | 1662.438742 | 6.617267 | 1095.30 |'
  id: totrans-1132
  prefs: []
  type: TYPE_TB
  zh: '| 49 | 11.822910 | 98.168307 | 7.386212 | 2.301552 | 3250.020705 | 24.340656
    | 1662.438742 | 6.617267 | 1095.30 |'
- en: '| 51 | 13.986616 | 132.575456 | 7.194749 | 2.108986 | 3415.255945 | 26.253236
    | 1712.017629 | 5.583251 | 805.49 |'
  id: totrans-1133
  prefs: []
  type: TYPE_TB
  zh: '| 51 | 13.986616 | 132.575456 | 7.194749 | 2.108986 | 3415.255945 | 26.253236
    | 1712.017629 | 5.583251 | 805.49 |'
- en: '| 61 | 14.735895 | 128.201000 | 7.172693 | 1.841786 | 3886.950307 | 28.289950
    | 1672.370150 | 5.044439 | 1146.00 |'
  id: totrans-1134
  prefs: []
  type: TYPE_TB
  zh: '| 61 | 14.735895 | 128.201000 | 7.172693 | 1.841786 | 3886.950307 | 28.289950
    | 1672.370150 | 5.044439 | 1146.00 |'
- en: Build and Check Model
  id: totrans-1135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ„å»ºå’Œæ£€æŸ¥æ¨¡å‹
- en: We apply the follow steps,
  id: totrans-1136
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åº”ç”¨ä»¥ä¸‹æ­¥éª¤ï¼Œ
- en: specify the K-fold method
  id: totrans-1137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æŒ‡å®š K æŠ˜å æ–¹æ³•
- en: loop over number of leaf nodes, instantiate, fit and record the error
  id: totrans-1138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å¾ªç¯éå†å¶èŠ‚ç‚¹æ•°é‡ï¼Œå®ä¾‹åŒ–ã€æ‹Ÿåˆå¹¶è®°å½•è¯¯å·®
- en: plot the test error vs. number of leaf nodes, select the hyperparameter that
    minimizes test error
  id: totrans-1139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç»˜åˆ¶æµ‹è¯•è¯¯å·®ä¸å¶èŠ‚ç‚¹æ•°é‡çš„å…³ç³»å›¾ï¼Œé€‰æ‹©æœ€å°åŒ–æµ‹è¯•è¯¯å·®çš„è¶…å‚æ•°
- en: retrain the model with the tuned hyperparameter and all of the data
  id: totrans-1140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è°ƒæ•´å¥½çš„è¶…å‚æ•°å’Œæ‰€æœ‰æ•°æ®é‡æ–°è®­ç»ƒæ¨¡å‹
- en: '[PRE81]'
  id: totrans-1141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: '![_images/800e93156a21d23fb27ec3b349cbd0c234a2789e27a8582567a80abbbf0e08b0.png](../Images/a3d66d6b8f851c5edb5b770a5393116c.png)'
  id: totrans-1142
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/a3d66d6b8f851c5edb5b770a5393116c.png)'
- en: Comments
  id: totrans-1143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ³¨é‡Š
- en: This was a basic treatment of decision tree. Much more could be done and discussed,
    I have many more resources. Check out my [shared resource inventory](https://michaelpyrcz.com/my-resources)
    and the YouTube lecture links at the start of this chapter with resource links
    in the videosâ€™ descriptions.
  id: totrans-1144
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯å¯¹å†³ç­–æ ‘çš„åŸºæœ¬å¤„ç†ã€‚å¯ä»¥åšå’Œè®¨è®ºçš„è¿˜æœ‰å¾ˆå¤šï¼Œæˆ‘æœ‰å¾ˆå¤šæ›´å¤šçš„èµ„æºã€‚æŸ¥çœ‹æˆ‘çš„[å…±äº«èµ„æºæ¸…å•](https://michaelpyrcz.com/my-resources)ä»¥åŠæœ¬ç« å¼€å¤´YouTubeè®²åº§çš„é“¾æ¥ï¼Œè§†é¢‘æè¿°ä¸­åŒ…å«èµ„æºé“¾æ¥ã€‚
- en: I hope this is helpful,
  id: totrans-1145
  prefs: []
  type: TYPE_NORMAL
  zh: å¸Œæœ›è¿™æœ‰æ‰€å¸®åŠ©ï¼Œ
- en: '*Michael*'
  id: totrans-1146
  prefs: []
  type: TYPE_NORMAL
  zh: '*è¿ˆå…‹å°”*'
- en: About the Author
  id: totrans-1147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å…³äºä½œè€…
- en: '![](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
  id: totrans-1148
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/eb709b2c0a0c715da01ae0165efdf3b2.png)'
- en: Professor Michael Pyrcz in his office on the 40 acres, campus of The University
    of Texas at Austin.
  id: totrans-1149
  prefs: []
  type: TYPE_NORMAL
  zh: å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡40è‹±äº©æ ¡å›­å†…ï¼Œè¿ˆå…‹å°”Â·çš®å°”å¥‡æ•™æˆçš„åŠå…¬å®¤ã€‚
- en: Michael Pyrcz is a professor in the [Cockrell School of Engineering](https://cockrell.utexas.edu/faculty-directory/alphabetical/p),
    and the [Jackson School of Geosciences](https://www.jsg.utexas.edu/researcher/michael_pyrcz/),
    at [The University of Texas at Austin](https://www.utexas.edu/), where he researches
    and teaches subsurface, spatial data analytics, geostatistics, and machine learning.
    Michael is also,
  id: totrans-1150
  prefs: []
  type: TYPE_NORMAL
  zh: è¿ˆå…‹å°”Â·çš®å°”å¥‡æ˜¯å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡[ç§‘å…‹é›·å°”å·¥ç¨‹å­¦é™¢](https://cockrell.utexas.edu/faculty-directory/alphabetical/p)å’Œ[æ°å…‹é€Šåœ°çƒç§‘å­¦å­¦é™¢](https://www.jsg.utexas.edu/researcher/michael_pyrcz/)çš„æ•™æˆï¼Œåœ¨é‚£é‡Œä»–ç ”ç©¶å¹¶æ•™æˆåœ°ä¸‹ã€ç©ºé—´æ•°æ®åˆ†æã€åœ°ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ã€‚è¿ˆå…‹å°”è¿˜æ˜¯ï¼Œ
- en: the principal investigator of the [Energy Analytics](https://fri.cns.utexas.edu/energy-analytics)
    freshmen research initiative and a core faculty in the Machine Learn Laboratory
    in the College of Natural Sciences, The University of Texas at Austin
  id: totrans-1151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[èƒ½æºåˆ†æ](https://fri.cns.utexas.edu/energy-analytics)æ–°ç”Ÿç ”ç©¶é¡¹ç›®çš„ä¸»è¦ç ”ç©¶å‘˜ï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡è‡ªç„¶ç§‘å­¦å­¦é™¢æœºå™¨å­¦ä¹ å®éªŒå®¤çš„æ ¸å¿ƒæ•™å‘˜ã€‚'
- en: an associate editor for [Computers and Geosciences](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board),
    and a board member for [Mathematical Geosciences](https://link.springer.com/journal/11004/editorial-board),
    the International Association for Mathematical Geosciences.
  id: totrans-1152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[è®¡ç®—æœºä¸åœ°çƒç§‘å­¦](https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board)çš„å‰¯ç¼–è¾‘ï¼Œä»¥åŠå›½é™…æ•°å­¦åœ°çƒç§‘å­¦åä¼š[æ•°å­¦åœ°çƒç§‘å­¦](https://link.springer.com/journal/11004/editorial-board)çš„è‘£äº‹ä¼šæˆå‘˜ã€‚'
- en: 'Michael has written over 70 [peer-reviewed publications](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en),
    a [Python package](https://pypi.org/project/geostatspy/) for spatial data analytics,
    co-authored a textbook on spatial data analytics, [Geostatistical Reservoir Modeling](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    and author of two recently released e-books, [Applied Geostatistics in Python:
    a Hands-on Guide with GeostatsPy](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    and [Applied Machine Learning in Python: a Hands-on Guide with Code](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html).'
  id: totrans-1153
  prefs: []
  type: TYPE_NORMAL
  zh: è¿ˆå…‹å°”å·²ç»æ’°å†™äº†70å¤šç¯‡[åŒè¡Œè¯„å®¡å‡ºç‰ˆç‰©](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en)ï¼Œä¸€ä¸ªç”¨äºç©ºé—´æ•°æ®åˆ†æçš„[PythonåŒ…](https://pypi.org/project/geostatspy/)ï¼Œåˆè‘—äº†ä¸€æœ¬å…³äºç©ºé—´æ•°æ®åˆ†æçš„æ•™ç§‘ä¹¦[åœ°ç»Ÿè®¡å­¦å‚¨å±‚å»ºæ¨¡](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)ï¼Œå¹¶æ˜¯ä¸¤æœ¬æœ€è¿‘å‘å¸ƒçš„ç”µå­ä¹¦çš„ä½œè€…ï¼Œ[Pythonåº”ç”¨åœ°ç»Ÿè®¡å­¦ï¼šGeostatsPyå®è·µæŒ‡å—](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)å’Œ[Pythonåº”ç”¨æœºå™¨å­¦ä¹ ï¼šå®è·µæŒ‡å—ä¸ä»£ç ](https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html)ã€‚
- en: All of Michaelâ€™s university lectures are available on his [YouTube Channel](https://www.youtube.com/@GeostatsGuyLectures)
    with links to 100s of Python interactive dashboards and well-documented workflows
    in over 40 repositories on his [GitHub account](https://github.com/GeostatsGuy),
    to support any interested students and working professionals with evergreen content.
    To find out more about Michaelâ€™s work and shared educational resources visit his
    Website.
  id: totrans-1154
  prefs: []
  type: TYPE_NORMAL
  zh: è¿ˆå…‹å°”çš„æ‰€æœ‰å¤§å­¦è®²åº§éƒ½å¯ä»¥åœ¨ä»–çš„[YouTubeé¢‘é“](https://www.youtube.com/@GeostatsGuyLectures)ä¸Šæ‰¾åˆ°ï¼Œå…¶ä¸­åŒ…å«100å¤šä¸ªPythonäº¤äº’å¼ä»ªè¡¨æ¿å’Œ40å¤šä¸ªGitHubè´¦æˆ·ä¸Šçš„è¯¦ç»†æ–‡æ¡£å·¥ä½œæµç¨‹ï¼Œä»¥æ”¯æŒä»»ä½•æ„Ÿå…´è¶£çš„å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«ï¼Œæä¾›å¸¸é’å†…å®¹ã€‚æƒ³äº†è§£æ›´å¤šå…³äºè¿ˆå…‹å°”çš„å·¥ä½œå’Œå…±äº«æ•™è‚²èµ„æºï¼Œè¯·è®¿é—®ä»–çš„ç½‘ç«™ã€‚
- en: Want to Work Together?
  id: totrans-1155
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æƒ³ä¸€èµ·å·¥ä½œå—ï¼Ÿ
- en: I hope this content is helpful to those that want to learn more about subsurface
    modeling, data analytics and machine learning. Students and working professionals
    are welcome to participate.
  id: totrans-1156
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å¸Œæœ›è¿™äº›å†…å®¹å¯¹é‚£äº›æƒ³äº†è§£æ›´å¤šå…³äºåœ°ä¸‹å»ºæ¨¡ã€æ•°æ®åˆ†æå’Œå­¦ä¹ çš„äººæ¥è¯´æœ‰å¸®åŠ©ã€‚å­¦ç”Ÿå’Œåœ¨èŒä¸“ä¸šäººå£«æ¬¢è¿å‚åŠ ã€‚
- en: Want to invite me to visit your company for training, mentoring, project review,
    workflow design and / or consulting? Iâ€™d be happy to drop by and work with you!
  id: totrans-1157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æƒ³é‚€è¯·æˆ‘åˆ°è´µå…¬å¸è¿›è¡ŒåŸ¹è®­ã€è¾…å¯¼ã€é¡¹ç›®å®¡æŸ¥ã€å·¥ä½œæµç¨‹è®¾è®¡å’Œ/æˆ–å’¨è¯¢å—ï¼Ÿæˆ‘å¾ˆä¹æ„æ‹œè®¿å¹¶ä¸æ‚¨åˆä½œï¼
- en: Interested in partnering, supporting my graduate student research or my Subsurface
    Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)?
    My research combines data analytics, stochastic modeling and machine learning
    theory with practice to develop novel methods and workflows to add value. We are
    solving challenging subsurface problems!
  id: totrans-1158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ„Ÿå…´è¶£åˆä½œï¼Œæ”¯æŒæˆ‘çš„ç ”ç©¶ç”Ÿç ”ç©¶æˆ–æˆ‘çš„åœ°ä¸‹æ•°æ®åˆ†æä¸æœºå™¨å­¦ä¹ è”ç›Ÿï¼ˆå…±åŒè´Ÿè´£äººæ˜¯çº¦ç¿°Â·ç¦æ–¯ç‰¹æ•™æˆï¼‰å—ï¼Ÿæˆ‘çš„ç ”ç©¶å°†æ•°æ®åˆ†æã€éšæœºå»ºæ¨¡å’Œæœºå™¨å­¦ä¹ ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œä»¥å¼€å‘æ–°çš„æ–¹æ³•å’Œå·¥ä½œæµç¨‹æ¥å¢åŠ ä»·å€¼ã€‚æˆ‘ä»¬æ­£åœ¨è§£å†³å…·æœ‰æŒ‘æˆ˜æ€§çš„åœ°ä¸‹é—®é¢˜ï¼
- en: I can be reached at [mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu).
  id: totrans-1159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ‚¨å¯ä»¥é€šè¿‡ [mpyrcz@austin.utexas.edu](mailto:mpyrcz%40austin.utexas.edu) è”ç³»åˆ°æˆ‘ã€‚
- en: Iâ€™m always happy to discuss,
  id: totrans-1160
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æ€»æ˜¯å¾ˆé«˜å…´è®¨è®ºï¼Œ
- en: '*Michael*'
  id: totrans-1161
  prefs: []
  type: TYPE_NORMAL
  zh: '*è¿ˆå…‹å°”*'
- en: Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The
    Jackson School of Geosciences, The University of Texas at Austin
  id: totrans-1162
  prefs: []
  type: TYPE_NORMAL
  zh: è¿ˆå…‹å°”Â·çš®å°”å¥‡ï¼Œåšå£«ï¼ŒP.Eng. æ•™æˆï¼Œå¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡ Cockrell å·¥ç¨‹å­¦é™¢å’Œ Jackson åœ°çƒç§‘å­¦å­¦é™¢
- en: 'More Resources Available at: [Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [Website](http://michaelpyrcz.com) | [GoogleScholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [Geostatistics Book](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Applied
    Geostats in Python e-book](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html)
    | [Applied Machine Learning in Python e-book](https://geostatsguy.github.io/MachineLearningDemos_Book/)
    | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)'
  id: totrans-1163
  prefs: []
  type: TYPE_NORMAL
  zh: æ›´å¤šèµ„æºè¯·è®¿é—®ï¼š[Twitter](https://twitter.com/geostatsguy) | [GitHub](https://github.com/GeostatsGuy)
    | [ç½‘ç«™](http://michaelpyrcz.com) | [Google Scholar](https://scholar.google.com/citations?user=QVZ20eQAAAAJ&hl=en&oi=ao)
    | [åœ°ç»Ÿè®¡å­¦ä¹¦ç±](https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446)
    | [YouTube](https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig) | [Python
    ä¸­åº”ç”¨åœ°ç»Ÿè®¡å­¦ç”µå­ä¹¦](https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html) | [Python
    ä¸­åº”ç”¨æœºå™¨å­¦ä¹ ç”µå­ä¹¦](https://geostatsguy.github.io/MachineLearningDemos_Book/) | [LinkedIn](https://www.linkedin.com/in/michael-pyrcz-61a648a1)
